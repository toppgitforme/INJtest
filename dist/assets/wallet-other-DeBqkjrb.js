const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/injective-sdk-yGcRIHv8.js","assets/injective-utils-C9MYzl-J.js","assets/icons-Dj0zHVqu.js","assets/features-DBU5X4_o.js","assets/wallet-core-CdETWVBX.js","assets/injective-networks-BywkriB7.js","assets/embedded-wallet-DvYjUEAS.js","assets/index-CMXM9Vs9.js","assets/index-cH30WZ-q.js","assets/if-defined-pKzrT_vf.js","assets/ref-dsQEHo0r.js","assets/index-C_iDTYjL.js","assets/HelpersUtil-CBwPTZUE.js","assets/ConstantsUtil-B2AlNxxW.js","assets/index-DN0i5kja.js","assets/index-WHoUBxUI.js","assets/index-CGnD9YQJ.js","assets/index-B8FWWaSE.js","assets/index-D5wH_mwz.js","assets/email-Du3JC2TG.js","assets/index-CKcE2-MQ.js","assets/index-BgZyw5vj.js","assets/socials-mAEzJhnn.js","assets/index-Bd28HSF6.js","assets/index-DfMf3yBv.js","assets/index-CxtrZNVv.js","assets/index-C4cy8WK0.js","assets/index-DCr1WvI9.js","assets/swaps-AuoW-ZpA.js","assets/index-pTfRZxXC.js","assets/index-CCzSgA34.js","assets/index-CmBbbiRi.js","assets/send-SOiirIzb.js","assets/index-DRztFIP2.js","assets/index-D0BfO0Hj.js","assets/index-CoMAzjdn.js","assets/index-CCUlrnC3.js","assets/receive-CaNKdLO0.js","assets/onramp-C8kaJLGL.js","assets/index-B05M7aCq.js","assets/index-BfFmjlK6.js","assets/index-DhY8gONV.js","assets/pay-with-exchange-B1MxP0xw.js","assets/transactions-BGVcbT2g.js","assets/index-CNz_FYUX.js","assets/index-T8CpGRAP.js","assets/index-BhZRTcHZ.js","assets/index-DZ9p9Zof.js","assets/index-C47vXIUy.js","assets/data-capture-CXBxhp1e.js","assets/index-CCYNP-nY.js","assets/index-S3M9VTtU.js","assets/w3m-modal-i2kTVUTs.js","assets/index-D11iBRcf.js","assets/index-DaxwYOrQ.js"])))=>i.map(i=>d[i]);
import{M as Du,e as Ke,U as Me,x as Ce,T as Rl,E as ng,C as H1,Z as Ft,$ as lt,a0 as m_,Q as Td,a1 as iw,G as z1,_ as $e,a2 as Es,A as q1}from"./injective-utils-C9MYzl-J.js";import{b7 as rg,b8 as sg,aQ as Mh,bl as ow,a_ as V1,b9 as y_,bm as K1,j as Yd,k as aw,B as w_,s as E_,bn as G1,bo as Y1,bp as J1,bq as Z1,c as cw,h as X1,b5 as hn,br as Ff,aF as Q1,aE as eN,bs as tN,bt as b_,bu as Uu,bv as nN,bw as rN,bx as sN,by as lw,az as Mu,t as uw,bz as iN,bA as oN,bB as aN,bC as jf,bD as Wf,bE as cN,bF as lN,bG as uN,bH as dN,bI as hN,bJ as fN,bK as pN}from"./injective-sdk-yGcRIHv8.js";import{a as Lh,c as $h,e as Ge,n as ig,m as v_,T as dw,f as gN,M as mN,d as xa,o as yN}from"./wallet-core-CdETWVBX.js";import{g as _o,c as it,a as __}from"./icons-Dj0zHVqu.js";function Pl(t){"@babel/helpers - typeof";return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pl(t)}function wN(t,e){if(Pl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Pl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EN(t){var e=wN(t,"string");return Pl(e)=="symbol"?e:e+""}function bN(t,e,n){return(e=EN(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vN=class extends Lh{constructor(...t){super(...t),bN(this,"privateKey",void 0)}async getWalletDeviceType(){return Promise.resolve($h.Other)}async enable(){return Promise.resolve(!0)}async disconnect(){this.listeners={}}async getAddresses(){const t=this.getPrivateKey();try{return Promise.resolve([t.toAddress().toHex()])}catch(e){throw new Du(new Error(e.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}}async getAddressesInfo(){throw new Ce(new Error("getAddressesInfo is not implemented"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}async getSessionOrConfirm(t){return Promise.resolve(`0x${rg(sg(`Confirmation for ${t} at time: ${Date.now()}`))}`)}async sendEvmTransaction(t,e){throw new Ce(new Error("This wallet does not support sending Evm transactions"),{code:Me,type:Ke.WalletError,contextModule:Ge.SendEvmTransaction})}async sendTransaction(t,e){const{endpoints:n,txTimeout:r}=e;if(!n)throw new Ce(new Error("You have to pass endpoints within the options for using Ethereum native wallets"));const s=await new Mh(n.grpc).broadcast(t,{txTimeout:r});if(s.code!==0)throw new Rl(new Error(s.rawLog),{code:Me,contextCode:s.code,contextModule:s.codespace});return s}async signEip712TypedData(t,e){const n=this.getPrivateKey();if(ow(e)!==n.toAddress().toBech32())throw new Ce(new Error("Signer address does not match the private key address"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction});try{return`0x${rg(await n.signTypedData(JSON.parse(t)))}`}catch(r){throw new Du(new Error(r.message),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}}async signAminoCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signing Cosmos transactions"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signing Cosmos transactions"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signArbitrary(t,e){const n=this.getPrivateKey();if(ow(t)!==n.toAddress().toBech32())throw new Ce(new Error("Signer address does not match the private key address"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignArbitrary});try{return`0x${V1(await n.signHashed(sg(y_(e))))}`}catch(r){throw new Du(new Error(r.message),{code:Me,type:Ke.WalletError,contextModule:Ge.SignArbitrary})}}async getEthereumChainId(){try{return Promise.resolve((this.chainId===H1.Mainnet?ng.Mainnet:ng.Sepolia).toString(16))}catch(t){throw new Du(new Error(t.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetChainId})}}async getEvmTransactionReceipt(t){throw new Ce(new Error("Not supported"))}async getPubKey(){return this.getPrivateKey().toPublicKey().toBase64()}async onChainIdChanged(t){}async onAccountChange(t){}getPrivateKey(){if(!this.privateKey){var t;if(!(!((t=this.metadata)===null||t===void 0||(t=t.privateKey)===null||t===void 0)&&t.privateKey))throw new Ce(new Error("Please provide private key in the constructor"),{code:Me,type:Ke.WalletNotInstalledError,contextModule:Ge.GetAccounts});this.privateKey=K1.fromHex(this.metadata.privateKey.privateKey)}return this.privateKey}};const OZ=Object.freeze(Object.defineProperty({__proto__:null,PrivateKeyWalletStrategy:vN},Symbol.toStringTag,{value:"Module"}));function _N(t){if(typeof t=="string"){if(!Yd(t,{strict:!1}))throw new aw({address:t});return{address:t,type:"json-rpc"}}if(!Yd(t.address,{strict:!1}))throw new aw({address:t.address});return{address:t.address,nonceManager:t.nonceManager,sign:t.sign,signAuthorization:t.signAuthorization,signMessage:t.signMessage,signTransaction:t.signTransaction,signTypedData:t.signTypedData,source:"custom",type:"local"}}function hw(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function CN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Bh(t,...e){if(!CN(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function AN(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");hw(t.outputLen),hw(t.blockLen)}function Jd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function IN(t,e){Bh(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const ka=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const Hf=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),bs=(t,e)=>t<<32-e|t>>>e;function SN(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Rm(t){return typeof t=="string"&&(t=SN(t)),Bh(t),t}function TN(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Bh(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let C_=class{clone(){return this._cloneInto()}};function NN(t){const e=r=>t().update(Rm(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function ON(t=32){if(ka&&typeof ka.getRandomValues=="function")return ka.getRandomValues(new Uint8Array(t));if(ka&&typeof ka.randomBytes=="function")return ka.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function RN(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}const PN=(t,e,n)=>t&e^~t&n,xN=(t,e,n)=>t&e^t&n^e&n;let kN=class extends C_{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Hf(this.buffer)}update(e){Jd(this);const{view:n,buffer:r,blockLen:s}=this;e=Rm(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Hf(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Jd(this),IN(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;RN(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Hf(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const DN=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ii=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Si=new Uint32Array(64);let UN=class extends kN{constructor(){super(64,32,8,!1),this.A=Ii[0]|0,this.B=Ii[1]|0,this.C=Ii[2]|0,this.D=Ii[3]|0,this.E=Ii[4]|0,this.F=Ii[5]|0,this.G=Ii[6]|0,this.H=Ii[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Si[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Si[d-15],f=Si[d-2],p=bs(h,7)^bs(h,18)^h>>>3,m=bs(f,17)^bs(f,19)^f>>>10;Si[d]=m+Si[d-7]+p+Si[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=bs(a,6)^bs(a,11)^bs(a,25),f=u+h+PN(a,c,l)+DN[d]+Si[d]|0,m=(bs(r,2)^bs(r,13)^bs(r,22))+xN(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Si.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const MN=NN(()=>new UN);class A_ extends C_{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,AN(e);const r=Rm(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Jd(this),this.iHash.update(e),this}digestInto(e){Jd(this),Bh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const I_=(t,e,n)=>new A_(t,e).update(n).digest();I_.create=(t,e)=>new A_(t,e);const Pm=BigInt(0),S_=BigInt(1),LN=BigInt(2);function aa(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function uu(t){if(!aa(t))throw new Error("Uint8Array expected")}function fc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const $N=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pc(t){uu(t);let e="";for(let n=0;n<t.length;n++)e+=$N[t[n]];return e}function ll(t){const e=t.toString(16);return e.length&1?"0"+e:e}function xm(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Pm:BigInt("0x"+t)}const zs={_0:48,_9:57,A:65,F:70,a:97,f:102};function fw(t){if(t>=zs._0&&t<=zs._9)return t-zs._0;if(t>=zs.A&&t<=zs.F)return t-(zs.A-10);if(t>=zs.a&&t<=zs.f)return t-(zs.a-10)}function xl(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=fw(t.charCodeAt(i)),a=fw(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function na(t){return xm(pc(t))}function km(t){return uu(t),xm(pc(Uint8Array.from(t).reverse()))}function gc(t,e){return xl(t.toString(16).padStart(e*2,"0"))}function Dm(t,e){return gc(t,e).reverse()}function os(t,e,n){let r;if(typeof e=="string")try{r=xl(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(aa(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function kl(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];uu(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const zf=t=>typeof t=="bigint"&&Pm<=t;function Fh(t,e,n){return zf(t)&&zf(e)&&zf(n)&&e<=t&&t<n}function ra(t,e,n,r){if(!Fh(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function T_(t){let e;for(e=0;t>Pm;t>>=S_,e+=1);return e}const Um=t=>(LN<<BigInt(t-1))-S_,qf=t=>new Uint8Array(t),pw=t=>Uint8Array.from(t);function N_(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=qf(t),s=qf(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=qf())=>{s=a(pw([0]),d),r=a(),d.length!==0&&(s=a(pw([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){r=a();const f=r.slice();h.push(f),d+=r.length}return kl(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}const BN={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||aa(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function du(t,e,n={}){const r=(s,i,o)=>{const a=BN[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function og(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const FN=Object.freeze(Object.defineProperty({__proto__:null,aInRange:ra,abool:fc,abytes:uu,bitLen:T_,bitMask:Um,bytesToHex:pc,bytesToNumberBE:na,bytesToNumberLE:km,concatBytes:kl,createHmacDrbg:N_,ensureBytes:os,hexToBytes:xl,hexToNumber:xm,inRange:Fh,isBytes:aa,memoized:og,numberToBytesBE:gc,numberToBytesLE:Dm,numberToHexUnpadded:ll,validateObject:du},Symbol.toStringTag,{value:"Module"}));const Cn=BigInt(0),Zt=BigInt(1),qo=BigInt(2),jN=BigInt(3),ag=BigInt(4),gw=BigInt(5),mw=BigInt(8);function gr(t,e){const n=t%e;return n>=Cn?n:e+n}function WN(t,e,n){if(e<Cn)throw new Error("invalid exponent, negatives unsupported");if(n<=Cn)throw new Error("invalid modulus");if(n===Zt)return Cn;let r=Zt;for(;e>Cn;)e&Zt&&(r=r*t%n),t=t*t%n,e>>=Zt;return r}function Lr(t,e,n){let r=t;for(;e-- >Cn;)r*=r,r%=n;return r}function cg(t,e){if(t===Cn)throw new Error("invert: expected non-zero number");if(e<=Cn)throw new Error("invert: expected positive modulus, got "+e);let n=gr(t,e),r=e,s=Cn,i=Zt;for(;n!==Cn;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==Zt)throw new Error("invert: does not exist");return gr(s,e)}function HN(t){const e=(t-Zt)/qo;let n,r,s;for(n=t-Zt,r=0;n%qo===Cn;n/=qo,r++);for(s=qo;s<t&&WN(s,e,t)!==t-Zt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+Zt)/ag;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(n+Zt)/qo;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,s),n),d=a.pow(c,i),h=a.pow(c,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let m=a.sqr(h);f<l&&!a.eql(m,a.ONE);f++)m=a.sqr(m);const p=a.pow(u,Zt<<BigInt(l-f-1));u=a.sqr(p),d=a.mul(d,p),h=a.mul(h,u),l=f}return d}}function zN(t){if(t%ag===jN){const e=(t+Zt)/ag;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%mw===gw){const e=(t-gw)/mw;return function(r,s){const i=r.mul(s,qo),o=r.pow(i,e),a=r.mul(s,o),c=r.mul(r.mul(a,qo),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return HN(t)}const qN=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function VN(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=qN.reduce((r,s)=>(r[s]="function",r),e);return du(t,n)}function KN(t,e,n){if(n<Cn)throw new Error("invalid exponent, negatives unsupported");if(n===Cn)return t.ONE;if(n===Zt)return e;let r=t.ONE,s=e;for(;n>Cn;)n&Zt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Zt;return r}function GN(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function O_(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function R_(t,e,n=!1,r={}){if(t<=Cn)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=O_(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:Um(s),ZERO:Cn,ONE:Zt,create:c=>gr(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Cn<=c&&c<t},is0:c=>c===Cn,isOdd:c=>(c&Zt)===Zt,neg:c=>gr(-c,t),eql:(c,l)=>c===l,sqr:c=>gr(c*c,t),add:(c,l)=>gr(c+l,t),sub:(c,l)=>gr(c-l,t),mul:(c,l)=>gr(c*l,t),pow:(c,l)=>KN(a,c,l),div:(c,l)=>gr(c*cg(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>cg(c,t),sqrt:r.sqrt||(c=>(o||(o=zN(t)),o(a,c))),invertBatch:c=>GN(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Dm(c,i):gc(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?km(c):na(c)}});return Object.freeze(a)}function P_(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function x_(t){const e=P_(t);return e+Math.ceil(e/2)}function YN(t,e,n=!1){const r=t.length,s=P_(e),i=x_(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?km(t):na(t),a=gr(o,e-Zt)+Zt;return n?Dm(a,s):gc(a,s)}const yw=BigInt(0),Lu=BigInt(1);function Vf(t,e){const n=e.negate();return t?n:e}function k_(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Kf(t,e){k_(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function JN(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function ZN(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Gf=new WeakMap,D_=new WeakMap;function Yf(t){return D_.get(t)||1}function XN(t,e){return{constTimeNegate:Vf,hasPrecomputes(n){return Yf(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>yw;)r&Lu&&(s=s.add(i)),i=i.double(),r>>=Lu;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Kf(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Kf(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=Lu);const m=f,g=f+Math.abs(p)-1,T=h%2!==0,N=p<0;p===0?c=c.add(Vf(T,r[m])):a=a.add(Vf(N,r[g]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=Kf(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===yw)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=Lu),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=Gf.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&Gf.set(r,s(i))),i},wNAFCached(n,r,s){const i=Yf(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Yf(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){k_(r,e),D_.set(n,r),Gf.delete(n)}}}function QN(t,e,n,r){if(JN(n,t),ZN(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=T_(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],m=Number(p>>BigInt(d)&BigInt(a));c[m]=c[m].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function U_(t){return VN(t.Fp),du(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...O_(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function ww(t){t.lowS!==void 0&&fc("lowS",t.lowS),t.prehash!==void 0&&fc("prehash",t.prehash)}function eO(t){const e=U_(t);du(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:tO,hexToBytes:nO}=FN;class rO extends Error{constructor(e=""){super(e)}}const ai={Err:rO,_tlv:{encode:(t,e)=>{const{Err:n}=ai;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=ll(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?ll(s.length/2|128):"";return ll(t)+i+s+e},decode(t,e){const{Err:n}=ai;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=ai;if(t<li)throw new e("integer: negative integers are not allowed");let n=ll(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=ai;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return tO(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=ai,s=typeof t=="string"?nO(t):t;uu(s);const{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=ai,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},li=BigInt(0),bn=BigInt(1);BigInt(2);const Ew=BigInt(3);BigInt(4);function sO(t){const e=eO(t),{Fp:n}=e,r=R_(e.n,e.nBitLength),s=e.toBytes||((m,g,T)=>{const N=g.toAffine();return kl(Uint8Array.from([4]),n.toBytes(N.x),n.toBytes(N.y))}),i=e.fromBytes||(m=>{const g=m.subarray(1),T=n.fromBytes(g.subarray(0,n.BYTES)),N=n.fromBytes(g.subarray(n.BYTES,2*n.BYTES));return{x:T,y:N}});function o(m){const{a:g,b:T}=e,N=n.sqr(m),_=n.mul(N,m);return n.add(n.add(_,n.mul(m,g)),T)}if(!n.eql(n.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(m){return Fh(m,bn,e.n)}function c(m){const{allowedPrivateKeyLengths:g,nByteLength:T,wrapPrivateKey:N,n:_}=e;if(g&&typeof m!="bigint"){if(aa(m)&&(m=pc(m)),typeof m!="string"||!g.includes(m.length))throw new Error("invalid private key");m=m.padStart(T*2,"0")}let O;try{O=typeof m=="bigint"?m:na(os("private key",m,T))}catch{throw new Error("invalid private key, expected hex or "+T+" bytes, got "+typeof m)}return N&&(O=gr(O,_)),ra("private key",O,bn,_),O}function l(m){if(!(m instanceof h))throw new Error("ProjectivePoint expected")}const u=og((m,g)=>{const{px:T,py:N,pz:_}=m;if(n.eql(_,n.ONE))return{x:T,y:N};const O=m.is0();g==null&&(g=O?n.ONE:n.inv(_));const A=n.mul(T,g),x=n.mul(N,g),k=n.mul(_,g);if(O)return{x:n.ZERO,y:n.ZERO};if(!n.eql(k,n.ONE))throw new Error("invZ was invalid");return{x:A,y:x}}),d=og(m=>{if(m.is0()){if(e.allowInfinityPoint&&!n.is0(m.py))return;throw new Error("bad point: ZERO")}const{x:g,y:T}=m.toAffine();if(!n.isValid(g)||!n.isValid(T))throw new Error("bad point: x or y not FE");const N=n.sqr(T),_=o(g);if(!n.eql(N,_))throw new Error("bad point: equation left != right");if(!m.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class h{constructor(g,T,N){if(this.px=g,this.py=T,this.pz=N,g==null||!n.isValid(g))throw new Error("x required");if(T==null||!n.isValid(T))throw new Error("y required");if(N==null||!n.isValid(N))throw new Error("z required");Object.freeze(this)}static fromAffine(g){const{x:T,y:N}=g||{};if(!g||!n.isValid(T)||!n.isValid(N))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const _=O=>n.eql(O,n.ZERO);return _(T)&&_(N)?h.ZERO:new h(T,N,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const T=n.invertBatch(g.map(N=>N.pz));return g.map((N,_)=>N.toAffine(T[_])).map(h.fromAffine)}static fromHex(g){const T=h.fromAffine(i(os("pointHex",g)));return T.assertValidity(),T}static fromPrivateKey(g){return h.BASE.multiply(c(g))}static msm(g,T){return QN(h,r,g,T)}_setWindowSize(g){p.setWindowSize(this,g)}assertValidity(){d(this)}hasEvenY(){const{y:g}=this.toAffine();if(n.isOdd)return!n.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){l(g);const{px:T,py:N,pz:_}=this,{px:O,py:A,pz:x}=g,k=n.eql(n.mul(T,x),n.mul(O,_)),L=n.eql(n.mul(N,x),n.mul(A,_));return k&&L}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:g,b:T}=e,N=n.mul(T,Ew),{px:_,py:O,pz:A}=this;let x=n.ZERO,k=n.ZERO,L=n.ZERO,M=n.mul(_,_),z=n.mul(O,O),J=n.mul(A,A),H=n.mul(_,O);return H=n.add(H,H),L=n.mul(_,A),L=n.add(L,L),x=n.mul(g,L),k=n.mul(N,J),k=n.add(x,k),x=n.sub(z,k),k=n.add(z,k),k=n.mul(x,k),x=n.mul(H,x),L=n.mul(N,L),J=n.mul(g,J),H=n.sub(M,J),H=n.mul(g,H),H=n.add(H,L),L=n.add(M,M),M=n.add(L,M),M=n.add(M,J),M=n.mul(M,H),k=n.add(k,M),J=n.mul(O,A),J=n.add(J,J),M=n.mul(J,H),x=n.sub(x,M),L=n.mul(J,z),L=n.add(L,L),L=n.add(L,L),new h(x,k,L)}add(g){l(g);const{px:T,py:N,pz:_}=this,{px:O,py:A,pz:x}=g;let k=n.ZERO,L=n.ZERO,M=n.ZERO;const z=e.a,J=n.mul(e.b,Ew);let H=n.mul(T,O),F=n.mul(N,A),P=n.mul(_,x),w=n.add(T,N),E=n.add(O,A);w=n.mul(w,E),E=n.add(H,F),w=n.sub(w,E),E=n.add(T,_);let R=n.add(O,x);return E=n.mul(E,R),R=n.add(H,P),E=n.sub(E,R),R=n.add(N,_),k=n.add(A,x),R=n.mul(R,k),k=n.add(F,P),R=n.sub(R,k),M=n.mul(z,E),k=n.mul(J,P),M=n.add(k,M),k=n.sub(F,M),M=n.add(F,M),L=n.mul(k,M),F=n.add(H,H),F=n.add(F,H),P=n.mul(z,P),E=n.mul(J,E),F=n.add(F,P),P=n.sub(H,P),P=n.mul(z,P),E=n.add(E,P),H=n.mul(F,E),L=n.add(L,H),H=n.mul(R,E),k=n.mul(w,k),k=n.sub(k,H),H=n.mul(w,F),M=n.mul(R,M),M=n.add(M,H),new h(k,L,M)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return p.wNAFCached(this,g,h.normalizeZ)}multiplyUnsafe(g){const{endo:T,n:N}=e;ra("scalar",g,li,N);const _=h.ZERO;if(g===li)return _;if(this.is0()||g===bn)return this;if(!T||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,g,h.normalizeZ);let{k1neg:O,k1:A,k2neg:x,k2:k}=T.splitScalar(g),L=_,M=_,z=this;for(;A>li||k>li;)A&bn&&(L=L.add(z)),k&bn&&(M=M.add(z)),z=z.double(),A>>=bn,k>>=bn;return O&&(L=L.negate()),x&&(M=M.negate()),M=new h(n.mul(M.px,T.beta),M.py,M.pz),L.add(M)}multiply(g){const{endo:T,n:N}=e;ra("scalar",g,bn,N);let _,O;if(T){const{k1neg:A,k1:x,k2neg:k,k2:L}=T.splitScalar(g);let{p:M,f:z}=this.wNAF(x),{p:J,f:H}=this.wNAF(L);M=p.constTimeNegate(A,M),J=p.constTimeNegate(k,J),J=new h(n.mul(J.px,T.beta),J.py,J.pz),_=M.add(J),O=z.add(H)}else{const{p:A,f:x}=this.wNAF(g);_=A,O=x}return h.normalizeZ([_,O])[0]}multiplyAndAddUnsafe(g,T,N){const _=h.BASE,O=(x,k)=>k===li||k===bn||!x.equals(_)?x.multiplyUnsafe(k):x.multiply(k),A=O(this,T).add(O(g,N));return A.is0()?void 0:A}toAffine(g){return u(this,g)}isTorsionFree(){const{h:g,isTorsionFree:T}=e;if(g===bn)return!0;if(T)return T(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:T}=e;return g===bn?this:T?T(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return fc("isCompressed",g),this.assertValidity(),s(h,this,g)}toHex(g=!0){return fc("isCompressed",g),pc(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,p=XN(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function iO(t){const e=U_(t);return du(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function oO(t){const e=iO(t),{Fp:n,n:r}=e,s=n.BYTES+1,i=2*n.BYTES+1;function o(P){return gr(P,r)}function a(P){return cg(P,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:d}=sO({...e,toBytes(P,w,E){const R=w.toAffine(),b=n.toBytes(R.x),y=kl;return fc("isCompressed",E),E?y(Uint8Array.from([w.hasEvenY()?2:3]),b):y(Uint8Array.from([4]),b,n.toBytes(R.y))},fromBytes(P){const w=P.length,E=P[0],R=P.subarray(1);if(w===s&&(E===2||E===3)){const b=na(R);if(!Fh(b,bn,n.ORDER))throw new Error("Point is not on curve");const y=u(b);let C;try{C=n.sqrt(y)}catch(G){const Y=G instanceof Error?": "+G.message:"";throw new Error("Point is not on curve"+Y)}const $=(C&bn)===bn;return(E&1)===1!==$&&(C=n.neg(C)),{x:b,y:C}}else if(w===i&&E===4){const b=n.fromBytes(R.subarray(0,n.BYTES)),y=n.fromBytes(R.subarray(n.BYTES,2*n.BYTES));return{x:b,y}}else{const b=s,y=i;throw new Error("invalid Point, expected length of "+b+", or uncompressed "+y+", got "+w)}}}),h=P=>pc(gc(P,e.nByteLength));function f(P){const w=r>>bn;return P>w}function p(P){return f(P)?o(-P):P}const m=(P,w,E)=>na(P.slice(w,E));class g{constructor(w,E,R){this.r=w,this.s=E,this.recovery=R,this.assertValidity()}static fromCompact(w){const E=e.nByteLength;return w=os("compactSignature",w,E*2),new g(m(w,0,E),m(w,E,2*E))}static fromDER(w){const{r:E,s:R}=ai.toSig(os("DER",w));return new g(E,R)}assertValidity(){ra("r",this.r,bn,r),ra("s",this.s,bn,r)}addRecoveryBit(w){return new g(this.r,this.s,w)}recoverPublicKey(w){const{r:E,s:R,recovery:b}=this,y=x(os("msgHash",w));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");const C=b===2||b===3?E+e.n:E;if(C>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const $=b&1?"03":"02",B=c.fromHex($+h(C)),G=a(C),Y=o(-y*G),Q=o(R*G),ye=c.BASE.multiplyAndAddUnsafe(B,Y,Q);if(!ye)throw new Error("point at infinify");return ye.assertValidity(),ye}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return xl(this.toDERHex())}toDERHex(){return ai.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return xl(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const T={isValidPrivateKey(P){try{return l(P),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const P=x_(e.n);return YN(e.randomBytes(P),e.n)},precompute(P=8,w=c.BASE){return w._setWindowSize(P),w.multiply(BigInt(3)),w}};function N(P,w=!0){return c.fromPrivateKey(P).toRawBytes(w)}function _(P){const w=aa(P),E=typeof P=="string",R=(w||E)&&P.length;return w?R===s||R===i:E?R===2*s||R===2*i:P instanceof c}function O(P,w,E=!0){if(_(P))throw new Error("first arg must be private key");if(!_(w))throw new Error("second arg must be public key");return c.fromHex(w).multiply(l(P)).toRawBytes(E)}const A=e.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const w=na(P),E=P.length*8-e.nBitLength;return E>0?w>>BigInt(E):w},x=e.bits2int_modN||function(P){return o(A(P))},k=Um(e.nBitLength);function L(P){return ra("num < 2^"+e.nBitLength,P,li,k),gc(P,e.nByteLength)}function M(P,w,E=z){if(["recovered","canonical"].some(De=>De in E))throw new Error("sign() legacy options not supported");const{hash:R,randomBytes:b}=e;let{lowS:y,prehash:C,extraEntropy:$}=E;y==null&&(y=!0),P=os("msgHash",P),ww(E),C&&(P=os("prehashed msgHash",R(P)));const B=x(P),G=l(w),Y=[L(G),L(B)];if($!=null&&$!==!1){const De=$===!0?b(n.BYTES):$;Y.push(os("extraEntropy",De))}const Q=kl(...Y),ye=B;function be(De){const ve=A(De);if(!d(ve))return;const Be=a(ve),ct=c.BASE.multiply(ve).toAffine(),Ct=o(ct.x);if(Ct===li)return;const $t=o(Be*o(ye+Ct*G));if($t===li)return;let tn=(ct.x===Ct?0:2)|Number(ct.y&bn),Sn=$t;return y&&f($t)&&(Sn=p($t),tn^=1),new g(Ct,Sn,tn)}return{seed:Q,k2sig:be}}const z={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function H(P,w,E=z){const{seed:R,k2sig:b}=M(P,w,E),y=e;return N_(y.hash.outputLen,y.nByteLength,y.hmac)(R,b)}c.BASE._setWindowSize(8);function F(P,w,E,R=J){const b=P;w=os("msgHash",w),E=os("publicKey",E);const{lowS:y,prehash:C,format:$}=R;if(ww(R),"strict"in R)throw new Error("options.strict was renamed to lowS");if($!==void 0&&$!=="compact"&&$!=="der")throw new Error("format must be compact or der");const B=typeof b=="string"||aa(b),G=!B&&!$&&typeof b=="object"&&b!==null&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!B&&!G)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Y,Q;try{if(G&&(Y=new g(b.r,b.s)),B){try{$!=="compact"&&(Y=g.fromDER(b))}catch(tn){if(!(tn instanceof ai.Err))throw tn}!Y&&$!=="der"&&(Y=g.fromCompact(b))}Q=c.fromHex(E)}catch{return!1}if(!Y||y&&Y.hasHighS())return!1;C&&(w=e.hash(w));const{r:ye,s:be}=Y,De=x(w),ve=a(be),Be=o(De*ve),ct=o(ye*ve),Ct=c.BASE.multiplyAndAddUnsafe(Q,Be,ct)?.toAffine();return Ct?o(Ct.x)===ye:!1}return{CURVE:e,getPublicKey:N,getSharedSecret:O,sign:H,verify:F,ProjectivePoint:c,Signature:g,utils:T}}function aO(t){return{hash:t,hmac:(e,...n)=>I_(t,e,TN(...n)),randomBytes:ON}}function cO(t,e){const n=r=>oO({...t,...aO(r)});return{...n(e),create:n}}const M_=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),bw=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),lO=BigInt(1),lg=BigInt(2),vw=(t,e)=>(t+e/lg)/e;function uO(t){const e=M_,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Lr(u,n,e)*u%e,h=Lr(d,n,e)*u%e,f=Lr(h,lg,e)*l%e,p=Lr(f,s,e)*f%e,m=Lr(p,i,e)*p%e,g=Lr(m,a,e)*m%e,T=Lr(g,c,e)*g%e,N=Lr(T,a,e)*m%e,_=Lr(N,n,e)*u%e,O=Lr(_,o,e)*p%e,A=Lr(O,r,e)*l%e,x=Lr(A,lg,e);if(!ug.eql(ug.sqr(x),t))throw new Error("Cannot find square root");return x}const ug=R_(M_,void 0,void 0,{sqrt:uO}),dO=cO({a:BigInt(0),b:BigInt(7),Fp:ug,n:bw,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=bw,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-lO*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=vw(i*t,e),c=vw(-r*t,e);let l=gr(t-a*n-c*s,e),u=gr(-a*r-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},MN);BigInt(0);function L_(t){if(t.length!==65||t[0]!==4)throw new Error("Invalid uncompressed P-256 key");const e=t.slice(1,33),n=t.slice(33,65);if(e.length!==32||n.length!==32)throw new Error("Invalid x or y length");const r=n[31]&1?3:2,s=new Uint8Array(33);return s[0]=r,s.set(e,1),s}function $_(t){const e=pO(t);return hO(e)}function hO(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Zd(t){return t.reduce((e,n)=>e+n.toString(16).padStart(2,"0"),"")}const fO=(t,e)=>{const n=/^[0-9A-Fa-f]+$/;if(!t||t.length%2!=0||!n.test(t))throw new Error(`cannot create uint8array from invalid hex string: "${t}"`);return new Uint8Array(t.match(/../g).map(s=>parseInt(s,16)))};function pO(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let e;for(t=`${t}`,e=0;e<t.length;e++)if(t.charCodeAt(e)>255)throw new Error(`InvalidCharacterError: found code point greater than 255:${t.charCodeAt(e)} at position ${e}`);let n="";for(e=0;e<t.length;e+=3){const r=[void 0,void 0,void 0,void 0];r[0]=t.charCodeAt(e)>>2,r[1]=(t.charCodeAt(e)&3)<<4,t.length>e+1&&(r[1]|=t.charCodeAt(e+1)>>4,r[2]=(t.charCodeAt(e+1)&15)<<2),t.length>e+2&&(r[2]|=t.charCodeAt(e+2)>>6,r[3]=t.charCodeAt(e+2)&63);for(let s=0;s<r.length;s++)typeof r[s]>"u"?n+="=":n+=gO(r[s])}return n}function gO(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(t>=0&&t<64)return e[t]}typeof Ft<"u"&&Ft.versions!=null&&Ft.versions.node!=null;var dg={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof it<"u"&&it,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof it<"u"&&it||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(w){return w&&DataView.prototype.isPrototypeOf(w)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(w){return w&&u.indexOf(Object.prototype.toString.call(w))>-1};function h(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(w)||w==="")throw new TypeError('Invalid character in header field name: "'+w+'"');return w.toLowerCase()}function f(w){return typeof w!="string"&&(w=String(w)),w}function p(w){var E={next:function(){var R=w.shift();return{done:R===void 0,value:R}}};return c.iterable&&(E[Symbol.iterator]=function(){return E}),E}function m(w){this.map={},w instanceof m?w.forEach(function(E,R){this.append(R,E)},this):Array.isArray(w)?w.forEach(function(E){if(E.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+E.length);this.append(E[0],E[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(E){this.append(E,w[E])},this)}m.prototype.append=function(w,E){w=h(w),E=f(E);var R=this.map[w];this.map[w]=R?R+", "+E:E},m.prototype.delete=function(w){delete this.map[h(w)]},m.prototype.get=function(w){return w=h(w),this.has(w)?this.map[w]:null},m.prototype.has=function(w){return this.map.hasOwnProperty(h(w))},m.prototype.set=function(w,E){this.map[h(w)]=f(E)},m.prototype.forEach=function(w,E){for(var R in this.map)this.map.hasOwnProperty(R)&&w.call(E,this.map[R],R,this)},m.prototype.keys=function(){var w=[];return this.forEach(function(E,R){w.push(R)}),p(w)},m.prototype.values=function(){var w=[];return this.forEach(function(E){w.push(E)}),p(w)},m.prototype.entries=function(){var w=[];return this.forEach(function(E,R){w.push([R,E])}),p(w)},c.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function g(w){if(!w._noBody){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}}function T(w){return new Promise(function(E,R){w.onload=function(){E(w.result)},w.onerror=function(){R(w.error)}})}function N(w){var E=new FileReader,R=T(E);return E.readAsArrayBuffer(w),R}function _(w){var E=new FileReader,R=T(E),b=/charset=([A-Za-z0-9_-]+)/.exec(w.type),y=b?b[1]:"utf-8";return E.readAsText(w,y),R}function O(w){for(var E=new Uint8Array(w),R=new Array(E.length),b=0;b<E.length;b++)R[b]=String.fromCharCode(E[b]);return R.join("")}function A(w){if(w.slice)return w.slice(0);var E=new Uint8Array(w.byteLength);return E.set(new Uint8Array(w)),E.buffer}function x(){return this.bodyUsed=!1,this._initBody=function(w){this.bodyUsed=this.bodyUsed,this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:c.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:c.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():c.arrayBuffer&&c.blob&&l(w)?(this._bodyArrayBuffer=A(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||d(w))?this._bodyArrayBuffer=A(w):this._bodyText=w=Object.prototype.toString.call(w):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var w=g(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var w=g(this);return w||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(N);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var w=g(this);if(w)return w;if(this._bodyBlob)return _(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(O(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(z)}),this.json=function(){return this.text().then(JSON.parse)},this}var k=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function L(w){var E=w.toUpperCase();return k.indexOf(E)>-1?E:w}function M(w,E){if(!(this instanceof M))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E=E||{};var R=E.body;if(w instanceof M){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,E.headers||(this.headers=new m(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!R&&w._bodyInit!=null&&(R=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new m(E.headers)),this.method=L(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal||function(){if("AbortController"in a){var C=new AbortController;return C.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&R)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(R),(this.method==="GET"||this.method==="HEAD")&&(E.cache==="no-store"||E.cache==="no-cache")){var b=/([?&])_=[^&]*/;if(b.test(this.url))this.url=this.url.replace(b,"$1_="+new Date().getTime());else{var y=/\?/;this.url+=(y.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}M.prototype.clone=function(){return new M(this,{body:this._bodyInit})};function z(w){var E=new FormData;return w.trim().split("&").forEach(function(R){if(R){var b=R.split("="),y=b.shift().replace(/\+/g," "),C=b.join("=").replace(/\+/g," ");E.append(decodeURIComponent(y),decodeURIComponent(C))}}),E}function J(w){var E=new m,R=w.replace(/\r?\n[\t ]+/g," ");return R.split("\r").map(function(b){return b.indexOf(`
`)===0?b.substr(1,b.length):b}).forEach(function(b){var y=b.split(":"),C=y.shift().trim();if(C){var $=y.join(":").trim();try{E.append(C,$)}catch{}}}),E}x.call(M.prototype);function H(w,E){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=E.statusText===void 0?"":""+E.statusText,this.headers=new m(E.headers),this.url=E.url||"",this._initBody(w)}x.call(H.prototype),H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},H.error=function(){var w=new H(null,{status:200,statusText:""});return w.ok=!1,w.status=0,w.type="error",w};var F=[301,302,303,307,308];H.redirect=function(w,E){if(F.indexOf(E)===-1)throw new RangeError("Invalid status code");return new H(null,{status:E,headers:{location:w}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(E,R){this.message=E,this.name=R;var b=Error(E);this.stack=b.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function P(w,E){return new Promise(function(R,b){var y=new M(w,E);if(y.signal&&y.signal.aborted)return b(new o.DOMException("Aborted","AbortError"));var C=new XMLHttpRequest;function $(){C.abort()}C.onload=function(){var Y={statusText:C.statusText,headers:J(C.getAllResponseHeaders()||"")};y.url.indexOf("file://")===0&&(C.status<200||C.status>599)?Y.status=200:Y.status=C.status,Y.url="responseURL"in C?C.responseURL:Y.headers.get("X-Request-URL");var Q="response"in C?C.response:C.responseText;setTimeout(function(){R(new H(Q,Y))},0)},C.onerror=function(){setTimeout(function(){b(new TypeError("Network request failed"))},0)},C.ontimeout=function(){setTimeout(function(){b(new TypeError("Network request timed out"))},0)},C.onabort=function(){setTimeout(function(){b(new o.DOMException("Aborted","AbortError"))},0)};function B(Y){try{return Y===""&&a.location.href?a.location.href:Y}catch{return Y}}if(C.open(y.method,B(y.url),!0),y.credentials==="include"?C.withCredentials=!0:y.credentials==="omit"&&(C.withCredentials=!1),"responseType"in C&&(c.blob?C.responseType="blob":c.arrayBuffer&&(C.responseType="arraybuffer")),E&&typeof E.headers=="object"&&!(E.headers instanceof m||a.Headers&&E.headers instanceof a.Headers)){var G=[];Object.getOwnPropertyNames(E.headers).forEach(function(Y){G.push(h(Y)),C.setRequestHeader(Y,f(E.headers[Y]))}),y.headers.forEach(function(Y,Q){G.indexOf(Q)===-1&&C.setRequestHeader(Q,Y)})}else y.headers.forEach(function(Y,Q){C.setRequestHeader(Q,Y)});y.signal&&(y.signal.addEventListener("abort",$),C.onreadystatechange=function(){C.readyState===4&&y.signal.removeEventListener("abort",$)}),C.send(typeof y._bodyInit>"u"?null:y._bodyInit)})}return P.polyfill=!0,a.fetch||(a.fetch=P,a.Headers=m,a.Request=M,a.Response=H),o.Headers=m,o.Request=M,o.Response=H,o.fetch=P,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(dg,dg.exports);var mO=dg.exports;const _w=_o(mO);function B_(t){return t?.name==="TurnkeyClient"}let jh=class extends Error{constructor(e){const{message:n,cause:r,activityId:s,activityStatus:i,activityType:o}=e;super(n),this.name="TurnkeyActivityError",this.activityId=s??void 0,this.activityStatus=i??void 0,this.activityType=o??void 0,this.cause=r??void 0}};class Mm extends Error{constructor(e){const{message:n,cause:r,activityId:s,activityStatus:i,activityType:o}=e;super(n),this.name="TurnkeyActivityConsensusNeededError",this.activityId=s??void 0,this.activityStatus=i??void 0,this.activityType=o??void 0,this.cause=r??void 0}}function Xd(t){const{id:e,status:n}=t;if(n==="ACTIVITY_STATUS_CONSENSUS_NEEDED")throw new Mm({message:"Activity requires consensus",activityId:e,activityStatus:n});if(n!=="ACTIVITY_STATUS_COMPLETED")throw new jh({message:`Expected COMPLETED status, got ${n}`,activityId:e,activityStatus:n});return!0}function Qd(t){if(t==null)throw new Error(`Got unexpected ${JSON.stringify(t)}`);return t}class F_ extends w_{constructor({message:e="Turnkey activity requires consensus.",activityId:n,activityStatus:r}){super(e),this.name="TurnkeyConsensusNeededError",this.activityId=n,this.activityStatus=r}}class po extends w_{constructor({message:e="Received unexpected Turnkey activity status.",activityId:n,activityStatus:r}){super(e),this.name="TurnkeyActivityError",this.activityId=n,this.activityStatus=r}}function yO(t){const{client:e,organizationId:n,signWith:r}=t;let{ethereumAddress:s}=t;if(!r)throw new jh({message:"Missing signWith parameter"});if(Yd(r))s=r;else if(!s)throw new po({message:"Missing ethereumAddress parameter"});return _N({address:s,signMessage:function({message:i}){return bO(e,i,n,r)},signTransaction:function(i,o){const a=o?.serializer??E_;return vO(e,i,a,n,r)},signTypedData:function(i){return _O(e,i,n,r)},signAuthorization:function(i){return EO(e,i,n,r)}})}async function wO(t){const{client:e,organizationId:n,signWith:r}=t;let{ethereumAddress:s}=t;if(!r)throw new po({message:"Missing signWith parameter"});if(Yd(r))s=r;else if(!s&&(s=(await e.getPrivateKey({privateKeyId:r,organizationId:n})).privateKey.addresses.find(o=>o.format==="ADDRESS_FORMAT_ETHEREUM")?.address,typeof s!="string"||!s))throw new po({message:`Unable to find Ethereum address for key ${r} under organization ${n}`});return yO({client:e,organizationId:n,signWith:r,ethereumAddress:s})}async function EO(t,e,n,r){const{chainId:s,nonce:i,to:o="object"}=e,a=e.contractAddress??e.address;if(!a)throw new po({message:"Unable to sign authorization: address is undefined."});const c=G1({address:a,chainId:s,nonce:i}),l=await Lm(t,c,n,r,o);return o==="object"?{address:a,chainId:s,nonce:i,...l,yParity:l.v}:l}async function bO(t,e,n,r){const s=Y1(e);return`${await Lm(t,s,n,r)}`}async function vO(t,e,n,r,s){const i=e.type==="eip4844"?{...e,sidecars:!1}:e,a=n(i).replace(/^0x/,""),c=await CO(t,a,r,s);if(e.type==="eip4844"){const{r:l,s:u,v:d}=J1(c);return E_(e,{r:l,s:u,v:d})}return c}async function _O(t,e,n,r){const s=Z1(e);return await Lm(t,s,n,r,"hex")}async function CO(t,e,n,r){let s;try{s=await AO(t,e,n,r)}catch(i){throw i instanceof jh?new po({message:i.message,activityId:i.activityId,activityStatus:i.activityStatus}):i instanceof Mm?new F_({message:i.message,activityId:i.activityId,activityStatus:i.activityStatus}):new po({message:`Failed to sign: ${i.message}`})}return`0x${s}`}async function AO(t,e,n,r){if(B_(t)){const{activity:s}=await t.signTransaction({type:"ACTIVITY_TYPE_SIGN_TRANSACTION_V2",organizationId:n,parameters:{signWith:r,type:"TRANSACTION_TYPE_ETHEREUM",unsignedTransaction:e},timestampMs:String(Date.now())});return Xd(s),Qd(s?.result?.signTransactionResult?.signedTransaction)}else{const{activity:s,signedTransaction:i}=await t.signTransaction({organizationId:n,signWith:r,type:"TRANSACTION_TYPE_ETHEREUM",unsignedTransaction:e});return Xd(s),Qd(i)}}async function Lm(t,e,n,r,s){let i;try{i=await IO(t,e,n,r,s)}catch(o){throw o instanceof jh?new po({message:o.message,activityId:o.activityId,activityStatus:o.activityStatus}):o instanceof Mm?new F_({message:o.message,activityId:o.activityId,activityStatus:o.activityStatus}):new po({message:`Failed to sign: ${o.message}`})}return i}async function IO(t,e,n,r,s){let i;if(B_(t)){const{activity:o}=await t.signRawPayload({type:"ACTIVITY_TYPE_SIGN_RAW_PAYLOAD_V2",organizationId:n,parameters:{signWith:r,payload:e,encoding:"PAYLOAD_ENCODING_HEXADECIMAL",hashFunction:"HASH_FUNCTION_NO_OP"},timestampMs:String(Date.now())});Xd(o),i=Qd(o?.result?.signRawPayloadResult)}else{const{activity:o,r:a,s:c,v:l}=await t.signRawPayload({organizationId:n,signWith:r,payload:e,encoding:"PAYLOAD_ENCODING_HEXADECIMAL",hashFunction:"HASH_FUNCTION_NO_OP"});Xd(o),i={r:a,s:c,v:l}}return s==="object"?{r:`0x${i.r}`,s:`0x${i.s}`,v:BigInt(i.v)}:Qd(SO(i,s))}function SO(t,e="hex"){const{r:n,s:r,v:s}=t,i=`0x${n}`,o=`0x${r}`,c=BigInt(s),l=`0x${new dO.Signature(cw(i),cw(o)).toCompactHex()}${c===0n?"1b":"1c"}`;return e==="hex"?l:X1(l)}typeof Ft<"u"&&Ft.versions!=null&&Ft.versions.node!=null;function TO(t){const e=new Uint8Array(t);let n="";for(const i of e)n+=String.fromCharCode(i);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}const so="copy",Nd="convert";function hg(t,e,n){if(e===so)return n;if(e===Nd)return t(n);if(e instanceof Array)return n.map(r=>hg(t,e[0],r));if(e instanceof Object){const r={};for(const[s,i]of Object.entries(e)){if(i.derive){const o=i.derive(n);o!==void 0&&(n[s]=o)}if(!(s in n)){if(i.required)throw new Error(`Missing key: ${s}`);continue}if(n[s]==null){r[s]=null;continue}r[s]=hg(t,i.schema,n[s])}return r}}function Cw(t,e){return{required:!0,schema:t,derive:e}}function Da(t){return{required:!0,schema:t}}function Od(t){return{required:!1,schema:t}}const NO={appid:Od(so),appidExclude:Od(so),credProps:Od(so)},OO={type:Da(so),id:Da(so),rawId:Da(Nd),authenticatorAttachment:Od(so),response:Da({clientDataJSON:Da(Nd),attestationObject:Da(Nd),transports:Cw(so,t=>t.getTransports?.()||[])}),clientExtensionResults:Cw(NO,t=>t.getClientExtensionResults())};function RO(t){return hg(TO,OO,t)}async function PO(t){const e=await navigator.credentials.create(t);return e.toJSON=()=>RO(e),e}function xO(t){switch(t){case"internal":return"AUTHENTICATOR_TRANSPORT_INTERNAL";case"usb":return"AUTHENTICATOR_TRANSPORT_USB";case"nfc":return"AUTHENTICATOR_TRANSPORT_NFC";case"ble":return"AUTHENTICATOR_TRANSPORT_BLE";case"hybrid":return"AUTHENTICATOR_TRANSPORT_HYBRID";default:throw new Error("unsupported transport format")}}function kO(t){return{credentialId:t.rawId,attestationObject:t.response.attestationObject,clientDataJson:t.response.clientDataJSON,transports:t.response.transports.map(xO)}}async function DO(t){if(!UO())throw new Error("webauthn is not supported by this browser");const n=await PO(t);return kO(n.toJSON())}function UO(){return!!window.PublicKeyCredential}const Aw=["ACTIVITY_STATUS_COMPLETED","ACTIVITY_STATUS_FAILED","ACTIVITY_STATUS_REJECTED"],MO="X-Stamp";var wn;(function(t){t.PublicKeyReady="PUBLIC_KEY_READY",t.InjectCredentialBundle="INJECT_CREDENTIAL_BUNDLE",t.InjectKeyExportBundle="INJECT_KEY_EXPORT_BUNDLE",t.InjectWalletExportBundle="INJECT_WALLET_EXPORT_BUNDLE",t.InjectImportBundle="INJECT_IMPORT_BUNDLE",t.ExtractWalletEncryptedBundle="EXTRACT_WALLET_ENCRYPTED_BUNDLE",t.ExtractKeyEncryptedBundle="EXTRACT_KEY_ENCRYPTED_BUNDLE",t.ApplySettings="APPLY_SETTINGS",t.BundleInjected="BUNDLE_INJECTED",t.EncryptedBundleExtracted="ENCRYPTED_BUNDLE_EXTRACTED",t.SettingsApplied="SETTINGS_APPLIED",t.StampRequest="STAMP_REQUEST",t.Stamp="STAMP",t.TurnkeyInitMessageChannel="TURNKEY_INIT_MESSAGE_CHANNEL",t.GetEmbeddedPublicKey="GET_EMBEDDED_PUBLIC_KEY",t.ClearEmbeddedKey="RESET_EMBEDDED_KEY",t.InitEmbeddedKey="INIT_EMBEDDED_KEY",t.Error="ERROR"})(wn||(wn={}));var Iw;(function(t){t.Hexadecimal="HEXADECIMAL",t.Solana="SOLANA"})(Iw||(Iw={}));function LO(){return crypto.randomUUID()}class $O{constructor(e){if(typeof window>"u")throw new Error("Cannot initialize iframe in non-browser environment");if(typeof MessageChannel>"u")throw new Error("Cannot initialize iframe without MessageChannel support");if(!e.iframeContainer)throw new Error("Iframe container cannot be found");if(this.container=e.iframeContainer,this.container.querySelector(`#${e.iframeElementId}`))throw new Error(`Iframe element with ID ${e.iframeElementId} already exists`);let n=window.document.createElement("iframe");n.setAttribute("sandbox","allow-scripts allow-same-origin"),n.id=e.iframeElementId,n.src=e.iframeUrl,this.iframe=n;const r=new URL(e.iframeUrl);this.iframeOrigin=r.origin,this.iframePublicKey=null,this.messageChannel=new MessageChannel,this.pendingRequests=new Map}onMessageHandler(e){const{type:n,value:r,requestId:s}=e.data||{};if(!s){if(n===wn.PublicKeyReady){this.iframePublicKey=r;return}return}const i=this.pendingRequests.get(s);if(i){if(this.pendingRequests.delete(s),n===wn.Error){i.reject(new Error(r));return}switch(n){case wn.Stamp:i.resolve({stampHeaderName:MO,stampHeaderValue:r});break;default:i.resolve(r)}}}async init(e){return new Promise((n,r)=>{this.container.appendChild(this.iframe),this.iframe.addEventListener("load",()=>{if(!this.iframe.contentWindow?.postMessage){r(new Error("contentWindow or contentWindow.postMessage does not exist"));return}this.iframe.contentWindow.postMessage({type:wn.TurnkeyInitMessageChannel,dangerouslyOverrideIframeKeyTtl:e},this.iframeOrigin,[this.messageChannel.port2])}),this.messageChannel.port1.onmessage=s=>{s.data?.type===wn.PublicKeyReady&&(this.iframePublicKey=s.data.value,n(s.data.value)),this.onMessageHandler(s)}})}clear(){this.messageChannel?.port1?.close(),this.messageChannel?.port2?.close(),this.iframe.remove(),this.pendingRequests.clear()}publicKey(){return this.iframePublicKey}async getEmbeddedPublicKey(){const e=await this.createRequest(wn.GetEmbeddedPublicKey);return this.iframePublicKey=e,e}async clearEmbeddedKey(){return await this.createRequest(wn.ClearEmbeddedKey),this.iframePublicKey="",null}async initEmbeddedKey(){const e=await this.createRequest(wn.InitEmbeddedKey);return this.iframePublicKey=e,e}createRequest(e,n={}){return new Promise((r,s)=>{const i=LO();this.pendingRequests.set(i,{resolve:r,reject:s,requestId:i}),this.messageChannel.port1.postMessage({type:e,requestId:i,...n})})}async injectCredentialBundle(e){return this.createRequest(wn.InjectCredentialBundle,{value:e})}async injectKeyExportBundle(e,n,r){return this.createRequest(wn.InjectKeyExportBundle,{value:e,keyFormat:r,organizationId:n})}async injectWalletExportBundle(e,n){return this.createRequest(wn.InjectWalletExportBundle,{value:e,organizationId:n})}async injectImportBundle(e,n,r){return this.createRequest(wn.InjectImportBundle,{value:e,organizationId:n,userId:r})}async extractWalletEncryptedBundle(){return this.createRequest(wn.ExtractWalletEncryptedBundle)}async extractKeyEncryptedBundle(e){return this.createRequest(wn.ExtractKeyEncryptedBundle,{keyFormat:e})}async applySettings(e){return this.createRequest(wn.ApplySettings,{value:JSON.stringify(e)})}async stamp(e){if(this.iframePublicKey===null)throw new Error("null iframe public key. Have you called/awaited .init()?");return this.createRequest(wn.StampRequest,{value:e})}}function BO(t){const e=new Uint8Array(t);let n="";for(const i of e)n+=String.fromCharCode(i);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}const sa="copy",Ga="convert";function fg(t,e,n){if(e===sa)return n;if(e===Ga)return t(n);if(e instanceof Array)return n.map(r=>fg(t,e[0],r));if(e instanceof Object){const r={};for(const[s,i]of Object.entries(e)){if(i.derive){const o=i.derive(n);o!==void 0&&(n[s]=o)}if(!(s in n)){if(i.required)throw new Error(`Missing key: ${s}`);continue}if(n[s]==null){r[s]=null;continue}r[s]=fg(t,i.schema,n[s])}return r}}function FO(t,e){return{required:!0,schema:t,derive:e}}function Ti(t){return{required:!0,schema:t}}function Rd(t){return{required:!1,schema:t}}const jO={appid:Rd(sa),appidExclude:Rd(sa),credProps:Rd(sa)},WO={type:Ti(sa),id:Ti(sa),rawId:Ti(Ga),authenticatorAttachment:Rd(sa),response:Ti({clientDataJSON:Ti(Ga),authenticatorData:Ti(Ga),signature:Ti(Ga),userHandle:Ti(Ga)}),clientExtensionResults:FO(jO,t=>t.getClientExtensionResults())};function HO(t){return fg(BO,WO,t)}async function zO(t){const e=await navigator.credentials.get(t);return e.toJSON=()=>HO(e),e}const qO=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];function VO(t){return new KO}class KO{constructor(){this.A=1779033703,this.B=-1150833019,this.C=1013904242,this.D=-1521486534,this.E=1359893119,this.F=-1694144372,this.G=528734635,this.H=1541459225,this._size=0,this._sp=0,(!$u||jc>=8e3)&&($u=new ArrayBuffer(8e3),jc=0),this._byte=new Uint8Array($u,jc,80),this._word=new Int32Array($u,jc,20),jc+=80}update(e){if(typeof e=="string")return this._utf8(e);if(e==null)throw new TypeError("Invalid type: "+typeof e);const n=e.byteOffset,r=e.byteLength;let s=r/64|0,i=0;if(s&&!(n&3)&&!(this._size%64)){const a=new Int32Array(e.buffer,n,s*16);for(;s--;)this._int32(a,i>>2),i+=64;this._size+=i}if(e.BYTES_PER_ELEMENT!==1&&e.buffer){const a=new Uint8Array(e.buffer,n+i,r-i);return this._uint8(a)}return i===r?this:this._uint8(e,i)}_uint8(e,n){const{_byte:r,_word:s}=this,i=e.length;for(n=n|0;n<i;){const o=this._size%64;let a=o;for(;n<i&&a<64;)r[a++]=e[n++];a>=64&&this._int32(s),this._size+=a-o}return this}_utf8(e){const{_byte:n,_word:r}=this,s=e.length;let i=this._sp;for(let o=0;o<s;){const a=this._size%64;let c=a;for(;o<s&&c<64;){let l=e.charCodeAt(o++)|0;l<128?n[c++]=l:l<2048?(n[c++]=192|l>>>6,n[c++]=128|l&63):l<55296||l>57343?(n[c++]=224|l>>>12,n[c++]=128|l>>>6&63,n[c++]=128|l&63):i?(l=((i&1023)<<10)+(l&1023)+65536,n[c++]=240|l>>>18,n[c++]=128|l>>>12&63,n[c++]=128|l>>>6&63,n[c++]=128|l&63,i=0):i=l}c>=64&&(this._int32(r),r[0]=r[16]),this._size+=c-a}return this._sp=i,this}_int32(e,n){let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this,d=0;for(n=n|0;d<16;)Ro[d++]=Zr(e[n++]);for(d=16;d<64;d++)Ro[d]=tR(Ro[d-2])+Ro[d-7]+eR(Ro[d-15])+Ro[d-16]|0;for(d=0;d<64;d++){const h=u+QO(a)+JO(a,c,l)+qO[d]+Ro[d]|0,f=XO(r)+ZO(r,s,i)|0;u=l,l=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+f|0}this.A=r+this.A|0,this.B=s+this.B|0,this.C=i+this.C|0,this.D=o+this.D|0,this.E=a+this.E|0,this.F=c+this.F|0,this.G=l+this.G|0,this.H=u+this.H|0}digest(e){const{_byte:n,_word:r}=this;let s=this._size%64|0;for(n[s++]=128;s&3;)n[s++]=0;if(s>>=2,s>14){for(;s<16;)r[s++]=0;s=0,this._int32(r)}for(;s<16;)r[s++]=0;const i=this._size*8,o=(i&4294967295)>>>0,a=(i-o)/4294967296;return a&&(r[14]=Zr(a)),o&&(r[15]=Zr(o)),this._int32(r),e==="hex"?this._hex():this._bin()}_hex(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return Ni(e)+Ni(n)+Ni(r)+Ni(s)+Ni(i)+Ni(o)+Ni(a)+Ni(c)}_bin(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c,_byte:l,_word:u}=this;return u[0]=Zr(e),u[1]=Zr(n),u[2]=Zr(r),u[3]=Zr(s),u[4]=Zr(i),u[5]=Zr(o),u[6]=Zr(a),u[7]=Zr(c),l.slice(0,32)}}const Ro=new Int32Array(64);let $u,jc=0;const Ni=t=>(t+4294967296).toString(16).substr(-8),GO=t=>t<<24&4278190080|t<<8&16711680|t>>8&65280|t>>24&255,YO=t=>t,Zr=nR()?YO:GO,JO=(t,e,n)=>n^t&(e^n),ZO=(t,e,n)=>t&e|n&(t|e),XO=t=>(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),QO=t=>(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7),eR=t=>(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3,tR=t=>(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10;function nR(){return new Uint8Array(new Uint16Array([65279]).buffer)[0]===254}const rR="X-Stamp-Webauthn",sR=5*60*1e3,iR="preferred";class oR{constructor(e){this.rpId=e.rpId,this.timeout=e.timeout||sR,this.userVerification=e.userVerification||iR,this.allowCredentials=e.allowCredentials||[]}async stamp(e){const n=aR(e),r={publicKey:{rpId:this.rpId,challenge:n,allowCredentials:this.allowCredentials,timeout:this.timeout,userVerification:this.userVerification}},i=(await zO(r)).toJSON(),o={authenticatorData:i.response.authenticatorData,clientDataJson:i.response.clientDataJSON,credentialId:i.id,signature:i.response.signature};return{stampHeaderName:rR,stampHeaderValue:JSON.stringify(o)}}}function aR(t){const e=VO().update(t).digest("hex");return new TextEncoder().encode(e)}const cR="SIGNATURE_SCHEME_TK_API_SECP256K1_EIP191",lR="SIGNATURE_SCHEME_TK_API_ED25519",uR="X-Stamp";class Sw extends Error{constructor(e,n=null){super(`${e}${n?` - error: ${n.message}`:""}`),this.originalError=n,this.name="WalletStamperError"}}var eh;(function(t){t.Ethereum="ethereum",t.Solana="solana"})(eh||(eh={}));class dR{constructor(e){this.wallet=e}async stamp(e){let n;try{n=await this.wallet.signMessage(e)}catch(o){throw new Sw("Failed to sign the message",o)}const r=this.wallet.type===eh.Solana?lR:cR;let s;try{if(this.wallet.type===eh.Ethereum){const{recoverPublicKey:o,hashMessage:a}=await hn(async()=>{const{recoverPublicKey:h,hashMessage:f}=await import("./injective-sdk-yGcRIHv8.js").then(p=>p.bz);return{recoverPublicKey:h,hashMessage:f}},__vite__mapDeps([0,1,2])),{compressRawPublicKey:c,toDerSignature:l}=await hn(async()=>{const{compressRawPublicKey:h,toDerSignature:f}=await Promise.resolve().then(()=>TR);return{compressRawPublicKey:h,toDerSignature:f}},void 0);s=(await o({hash:a(e),signature:n})).replace("0x","");const d=Uint8Array.from(lt.Buffer.from(s,"hex"));s=lt.Buffer.from(c(d)).toString("hex"),n=l(n.replace("0x",""))}else s=await this.wallet.getPublicKey()}catch(o){throw new Sw("Failed to recover public key",o)}return{stampHeaderName:uR,stampHeaderValue:$_(JSON.stringify({publicKey:s,scheme:r,signature:n}))}}}const hR=t=>{const e=t.byteLength;var n=t.slice(0,1+e>>>1);return n[0]=2|t[e-1]&1,n},fR=t=>{const e=fO(t),n=e.slice(0,32),r=e.slice(32,64),s=c=>{if(c===void 0||c.length===0||c[0]===void 0)throw new Error("Invalid integer: input is undefined or empty.");const u=c[0]&128?new Uint8Array([0,...c]):c;return new Uint8Array([2,u.length,...u])},i=s(n),o=s(r),a=new Uint8Array([48,i.length+o.length,...i,...o]);return Zd(a)};var ks={},Dt={},sr={},$m={},Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.crypto=void 0;Wh.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=n,t.anumber=r,t.abytes=s,t.ahash=i,t.aexists=o,t.aoutput=a,t.u8=c,t.u32=l,t.clean=u,t.createView=d,t.rotr=h,t.rotl=f,t.byteSwap=p,t.byteSwap32=m,t.bytesToHex=N,t.hexToBytes=A,t.asyncLoop=k,t.utf8ToBytes=L,t.bytesToUtf8=M,t.toBytes=z,t.kdfInputToBytes=J,t.concatBytes=H,t.checkOpts=F,t.createHasher=w,t.createOptHasher=E,t.createXOFer=R,t.randomBytes=b;const e=Wh;function n(y){return y instanceof Uint8Array||ArrayBuffer.isView(y)&&y.constructor.name==="Uint8Array"}function r(y){if(!Number.isSafeInteger(y)||y<0)throw new Error("positive integer expected, got "+y)}function s(y,...C){if(!n(y))throw new Error("Uint8Array expected");if(C.length>0&&!C.includes(y.length))throw new Error("Uint8Array expected of length "+C+", got length="+y.length)}function i(y){if(typeof y!="function"||typeof y.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");r(y.outputLen),r(y.blockLen)}function o(y,C=!0){if(y.destroyed)throw new Error("Hash instance has been destroyed");if(C&&y.finished)throw new Error("Hash#digest() has already been called")}function a(y,C){s(y);const $=C.outputLen;if(y.length<$)throw new Error("digestInto() expects output buffer of length at least "+$)}function c(y){return new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}function l(y){return new Uint32Array(y.buffer,y.byteOffset,Math.floor(y.byteLength/4))}function u(...y){for(let C=0;C<y.length;C++)y[C].fill(0)}function d(y){return new DataView(y.buffer,y.byteOffset,y.byteLength)}function h(y,C){return y<<32-C|y>>>C}function f(y,C){return y<<C|y>>>32-C>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function p(y){return y<<24&4278190080|y<<8&16711680|y>>>8&65280|y>>>24&255}t.swap8IfBE=t.isLE?y=>y:y=>p(y),t.byteSwapIfBE=t.swap8IfBE;function m(y){for(let C=0;C<y.length;C++)y[C]=p(y[C]);return y}t.swap32IfBE=t.isLE?y=>y:m;const g=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",T=Array.from({length:256},(y,C)=>C.toString(16).padStart(2,"0"));function N(y){if(s(y),g)return y.toHex();let C="";for(let $=0;$<y.length;$++)C+=T[y[$]];return C}const _={_0:48,_9:57,A:65,F:70,a:97,f:102};function O(y){if(y>=_._0&&y<=_._9)return y-_._0;if(y>=_.A&&y<=_.F)return y-(_.A-10);if(y>=_.a&&y<=_.f)return y-(_.a-10)}function A(y){if(typeof y!="string")throw new Error("hex string expected, got "+typeof y);if(g)return Uint8Array.fromHex(y);const C=y.length,$=C/2;if(C%2)throw new Error("hex string expected, got unpadded hex of length "+C);const B=new Uint8Array($);for(let G=0,Y=0;G<$;G++,Y+=2){const Q=O(y.charCodeAt(Y)),ye=O(y.charCodeAt(Y+1));if(Q===void 0||ye===void 0){const be=y[Y]+y[Y+1];throw new Error('hex string expected, got non-hex character "'+be+'" at index '+Y)}B[G]=Q*16+ye}return B}const x=async()=>{};t.nextTick=x;async function k(y,C,$){let B=Date.now();for(let G=0;G<y;G++){$(G);const Y=Date.now()-B;Y>=0&&Y<C||(await(0,t.nextTick)(),B+=Y)}}function L(y){if(typeof y!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(y))}function M(y){return new TextDecoder().decode(y)}function z(y){return typeof y=="string"&&(y=L(y)),s(y),y}function J(y){return typeof y=="string"&&(y=L(y)),s(y),y}function H(...y){let C=0;for(let B=0;B<y.length;B++){const G=y[B];s(G),C+=G.length}const $=new Uint8Array(C);for(let B=0,G=0;B<y.length;B++){const Y=y[B];$.set(Y,G),G+=Y.length}return $}function F(y,C){if(C!==void 0&&{}.toString.call(C)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(y,C)}class P{}t.Hash=P;function w(y){const C=B=>y().update(z(B)).digest(),$=y();return C.outputLen=$.outputLen,C.blockLen=$.blockLen,C.create=()=>y(),C}function E(y){const C=(B,G)=>y(G).update(z(B)).digest(),$=y({});return C.outputLen=$.outputLen,C.blockLen=$.blockLen,C.create=B=>y(B),C}function R(y){const C=(B,G)=>y(G).update(z(B)).digest(),$=y({});return C.outputLen=$.outputLen,C.blockLen=$.blockLen,C.create=B=>y(B),C}t.wrapConstructor=w,t.wrapConstructorWithOpts=E,t.wrapXOFConstructorWithOpts=R;function b(y=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(y));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(y));throw new Error("crypto.getRandomValues must be defined")}})($m);Object.defineProperty(sr,"__esModule",{value:!0});sr.SHA512_IV=sr.SHA384_IV=sr.SHA224_IV=sr.SHA256_IV=sr.HashMD=void 0;sr.setBigUint64=j_;sr.Chi=pR;sr.Maj=gR;const vs=$m;function j_(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function pR(t,e,n){return t&e^~t&n}function gR(t,e,n){return t&e^t&n^e&n}class mR extends vs.Hash{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=(0,vs.createView)(this.buffer)}update(e){(0,vs.aexists)(this),e=(0,vs.toBytes)(e),(0,vs.abytes)(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=(0,vs.createView)(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,vs.aexists)(this),(0,vs.aoutput)(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,(0,vs.clean)(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;j_(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=(0,vs.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}sr.HashMD=mR;sr.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);sr.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);sr.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);sr.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Je={};Object.defineProperty(Je,"__esModule",{value:!0});Je.toBig=Je.shrSL=Je.shrSH=Je.rotrSL=Je.rotrSH=Je.rotrBL=Je.rotrBH=Je.rotr32L=Je.rotr32H=Je.rotlSL=Je.rotlSH=Je.rotlBL=Je.rotlBH=Je.add5L=Je.add5H=Je.add4L=Je.add4H=Je.add3L=Je.add3H=void 0;Je.add=nC;Je.fromBig=Bm;Je.split=W_;const Bu=BigInt(2**32-1),pg=BigInt(32);function Bm(t,e=!1){return e?{h:Number(t&Bu),l:Number(t>>pg&Bu)}:{h:Number(t>>pg&Bu)|0,l:Number(t&Bu)|0}}function W_(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=Bm(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const H_=(t,e)=>BigInt(t>>>0)<<pg|BigInt(e>>>0);Je.toBig=H_;const z_=(t,e,n)=>t>>>n;Je.shrSH=z_;const q_=(t,e,n)=>t<<32-n|e>>>n;Je.shrSL=q_;const V_=(t,e,n)=>t>>>n|e<<32-n;Je.rotrSH=V_;const K_=(t,e,n)=>t<<32-n|e>>>n;Je.rotrSL=K_;const G_=(t,e,n)=>t<<64-n|e>>>n-32;Je.rotrBH=G_;const Y_=(t,e,n)=>t>>>n-32|e<<64-n;Je.rotrBL=Y_;const J_=(t,e)=>e;Je.rotr32H=J_;const Z_=(t,e)=>t;Je.rotr32L=Z_;const X_=(t,e,n)=>t<<n|e>>>32-n;Je.rotlSH=X_;const Q_=(t,e,n)=>e<<n|t>>>32-n;Je.rotlSL=Q_;const eC=(t,e,n)=>e<<n-32|t>>>64-n;Je.rotlBH=eC;const tC=(t,e,n)=>t<<n-32|e>>>64-n;Je.rotlBL=tC;function nC(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const rC=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0);Je.add3L=rC;const sC=(t,e,n,r)=>e+n+r+(t/2**32|0)|0;Je.add3H=sC;const iC=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0);Je.add4L=iC;const oC=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0;Je.add4H=oC;const aC=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0);Je.add5L=aC;const cC=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0;Je.add5H=cC;const yR={fromBig:Bm,split:W_,toBig:H_,shrSH:z_,shrSL:q_,rotrSH:V_,rotrSL:K_,rotrBH:G_,rotrBL:Y_,rotr32H:J_,rotr32L:Z_,rotlSH:X_,rotlSL:Q_,rotlBH:eC,rotlBL:tC,add:nC,add3L:rC,add3H:sC,add4L:iC,add4H:oC,add5H:cC,add5L:aC};Je.default=yR;Object.defineProperty(Dt,"__esModule",{value:!0});Dt.sha512_224=Dt.sha512_256=Dt.sha384=Dt.sha512=Dt.sha224=Dt.sha256=Dt.SHA512_256=Dt.SHA512_224=Dt.SHA384=Dt.SHA512=Dt.SHA224=Dt.SHA256=void 0;const We=sr,nt=Je,on=$m,wR=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Oi=new Uint32Array(64);class Fm extends We.HashMD{constructor(e=32){super(64,e,8,!1),this.A=We.SHA256_IV[0]|0,this.B=We.SHA256_IV[1]|0,this.C=We.SHA256_IV[2]|0,this.D=We.SHA256_IV[3]|0,this.E=We.SHA256_IV[4]|0,this.F=We.SHA256_IV[5]|0,this.G=We.SHA256_IV[6]|0,this.H=We.SHA256_IV[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Oi[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Oi[d-15],f=Oi[d-2],p=(0,on.rotr)(h,7)^(0,on.rotr)(h,18)^h>>>3,m=(0,on.rotr)(f,17)^(0,on.rotr)(f,19)^f>>>10;Oi[d]=m+Oi[d-7]+p+Oi[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=(0,on.rotr)(a,6)^(0,on.rotr)(a,11)^(0,on.rotr)(a,25),f=u+h+(0,We.Chi)(a,c,l)+wR[d]+Oi[d]|0,m=((0,on.rotr)(r,2)^(0,on.rotr)(r,13)^(0,on.rotr)(r,22))+(0,We.Maj)(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){(0,on.clean)(Oi)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,on.clean)(this.buffer)}}Dt.SHA256=Fm;class lC extends Fm{constructor(){super(28),this.A=We.SHA224_IV[0]|0,this.B=We.SHA224_IV[1]|0,this.C=We.SHA224_IV[2]|0,this.D=We.SHA224_IV[3]|0,this.E=We.SHA224_IV[4]|0,this.F=We.SHA224_IV[5]|0,this.G=We.SHA224_IV[6]|0,this.H=We.SHA224_IV[7]|0}}Dt.SHA224=lC;const uC=nt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ER=uC[0],bR=uC[1],Ri=new Uint32Array(80),Pi=new Uint32Array(80);class hu extends We.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=We.SHA512_IV[0]|0,this.Al=We.SHA512_IV[1]|0,this.Bh=We.SHA512_IV[2]|0,this.Bl=We.SHA512_IV[3]|0,this.Ch=We.SHA512_IV[4]|0,this.Cl=We.SHA512_IV[5]|0,this.Dh=We.SHA512_IV[6]|0,this.Dl=We.SHA512_IV[7]|0,this.Eh=We.SHA512_IV[8]|0,this.El=We.SHA512_IV[9]|0,this.Fh=We.SHA512_IV[10]|0,this.Fl=We.SHA512_IV[11]|0,this.Gh=We.SHA512_IV[12]|0,this.Gl=We.SHA512_IV[13]|0,this.Hh=We.SHA512_IV[14]|0,this.Hl=We.SHA512_IV[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:m,Hl:g}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=g|0}process(e,n){for(let _=0;_<16;_++,n+=4)Ri[_]=e.getUint32(n),Pi[_]=e.getUint32(n+=4);for(let _=16;_<80;_++){const O=Ri[_-15]|0,A=Pi[_-15]|0,x=nt.rotrSH(O,A,1)^nt.rotrSH(O,A,8)^nt.shrSH(O,A,7),k=nt.rotrSL(O,A,1)^nt.rotrSL(O,A,8)^nt.shrSL(O,A,7),L=Ri[_-2]|0,M=Pi[_-2]|0,z=nt.rotrSH(L,M,19)^nt.rotrBH(L,M,61)^nt.shrSH(L,M,6),J=nt.rotrSL(L,M,19)^nt.rotrBL(L,M,61)^nt.shrSL(L,M,6),H=nt.add4L(k,J,Pi[_-7],Pi[_-16]),F=nt.add4H(H,x,z,Ri[_-7],Ri[_-16]);Ri[_]=F|0,Pi[_]=H|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:m,Gl:g,Hh:T,Hl:N}=this;for(let _=0;_<80;_++){const O=nt.rotrSH(d,h,14)^nt.rotrSH(d,h,18)^nt.rotrBH(d,h,41),A=nt.rotrSL(d,h,14)^nt.rotrSL(d,h,18)^nt.rotrBL(d,h,41),x=d&f^~d&m,k=h&p^~h&g,L=nt.add5L(N,A,k,bR[_],Pi[_]),M=nt.add5H(L,T,O,x,ER[_],Ri[_]),z=L|0,J=nt.rotrSH(r,s,28)^nt.rotrBH(r,s,34)^nt.rotrBH(r,s,39),H=nt.rotrSL(r,s,28)^nt.rotrBL(r,s,34)^nt.rotrBL(r,s,39),F=r&i^r&a^i&a,P=s&o^s&c^o&c;T=m|0,N=g|0,m=f|0,g=p|0,f=d|0,p=h|0,{h:d,l:h}=nt.add(l|0,u|0,M|0,z|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const w=nt.add3L(z,H,P);r=nt.add3H(w,M,J,F),s=w|0}({h:r,l:s}=nt.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=nt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=nt.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=nt.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=nt.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=nt.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:g}=nt.add(this.Gh|0,this.Gl|0,m|0,g|0),{h:T,l:N}=nt.add(this.Hh|0,this.Hl|0,T|0,N|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,m,g,T,N)}roundClean(){(0,on.clean)(Ri,Pi)}destroy(){(0,on.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}Dt.SHA512=hu;class dC extends hu{constructor(){super(48),this.Ah=We.SHA384_IV[0]|0,this.Al=We.SHA384_IV[1]|0,this.Bh=We.SHA384_IV[2]|0,this.Bl=We.SHA384_IV[3]|0,this.Ch=We.SHA384_IV[4]|0,this.Cl=We.SHA384_IV[5]|0,this.Dh=We.SHA384_IV[6]|0,this.Dl=We.SHA384_IV[7]|0,this.Eh=We.SHA384_IV[8]|0,this.El=We.SHA384_IV[9]|0,this.Fh=We.SHA384_IV[10]|0,this.Fl=We.SHA384_IV[11]|0,this.Gh=We.SHA384_IV[12]|0,this.Gl=We.SHA384_IV[13]|0,this.Hh=We.SHA384_IV[14]|0,this.Hl=We.SHA384_IV[15]|0}}Dt.SHA384=dC;const $n=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Bn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class hC extends hu{constructor(){super(28),this.Ah=$n[0]|0,this.Al=$n[1]|0,this.Bh=$n[2]|0,this.Bl=$n[3]|0,this.Ch=$n[4]|0,this.Cl=$n[5]|0,this.Dh=$n[6]|0,this.Dl=$n[7]|0,this.Eh=$n[8]|0,this.El=$n[9]|0,this.Fh=$n[10]|0,this.Fl=$n[11]|0,this.Gh=$n[12]|0,this.Gl=$n[13]|0,this.Hh=$n[14]|0,this.Hl=$n[15]|0}}Dt.SHA512_224=hC;class fC extends hu{constructor(){super(32),this.Ah=Bn[0]|0,this.Al=Bn[1]|0,this.Bh=Bn[2]|0,this.Bl=Bn[3]|0,this.Ch=Bn[4]|0,this.Cl=Bn[5]|0,this.Dh=Bn[6]|0,this.Dl=Bn[7]|0,this.Eh=Bn[8]|0,this.El=Bn[9]|0,this.Fh=Bn[10]|0,this.Fl=Bn[11]|0,this.Gh=Bn[12]|0,this.Gl=Bn[13]|0,this.Hh=Bn[14]|0,this.Hl=Bn[15]|0}}Dt.SHA512_256=fC;Dt.sha256=(0,on.createHasher)(()=>new Fm);Dt.sha224=(0,on.createHasher)(()=>new lC);Dt.sha512=(0,on.createHasher)(()=>new hu);Dt.sha384=(0,on.createHasher)(()=>new dC);Dt.sha512_256=(0,on.createHasher)(()=>new fC);Dt.sha512_224=(0,on.createHasher)(()=>new hC);Object.defineProperty(ks,"__esModule",{value:!0});ks.sha224=ks.SHA224=ks.sha256=ks.SHA256=void 0;const Hh=Dt;ks.SHA256=Hh.SHA256;ks.sha256=Hh.sha256;ks.SHA224=Hh.SHA224;ks.sha224=Hh.sha224;function vR(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var s=t.charAt(r),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=r}var o=t.length,a=t.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function u(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var p=0,m=0,g=0,T=f.length;g!==T&&f[g]===0;)g++,p++;for(var N=(T-g)*l+1>>>0,_=new Uint8Array(N);g!==T;){for(var O=f[g],A=0,x=N-1;(O!==0||A<m)&&x!==-1;x--,A++)O+=256*_[x]>>>0,_[x]=O%o>>>0,O=O/o>>>0;if(O!==0)throw new Error("Non-zero carry");m=A,g++}for(var k=N-m;k!==N&&_[k]===0;)k++;for(var L=a.repeat(p);k<N;++k)L+=t.charAt(_[k]);return L}function d(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;for(var p=0,m=0,g=0;f[p]===a;)m++,p++;for(var T=(f.length-p)*c+1>>>0,N=new Uint8Array(T);f[p];){var _=f.charCodeAt(p);if(_>255)return;var O=e[_];if(O===255)return;for(var A=0,x=T-1;(O!==0||A<g)&&x!==-1;x--,A++)O+=o*N[x]>>>0,N[x]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");g=A,p++}for(var k=T-g;k!==T&&N[k]===0;)k++;for(var L=new Uint8Array(m+(T-k)),M=m;k!==T;)L[M++]=N[k++];return L}function h(f){var p=d(f);if(p)return p;throw new Error("Non-base"+o+" character")}return{encode:u,decodeUnsafe:d,decode:h}}var _R=vR;const CR=_R,AR="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";CR(AR);var{sha256:DZ}=ks;function IR(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const f=l.length;for(;h!==f&&l[h]===0;)h++,u++;const p=(f-h)*i+1>>>0,m=new Uint8Array(p);for(;h!==f;){let N=l[h],_=0;for(let O=p-1;(N!==0||_<d)&&O!==-1;O--,_++)N+=256*m[O]>>>0,m[O]=N%n>>>0,N=N/n>>>0;if(N!==0)throw new Error("Non-zero carry");d=_,h++}let g=p-d;for(;g!==p&&m[g]===0;)g++;let T=r.repeat(u);for(;g<p;++g)T+=t.charAt(m[g]);return T}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const f=(l.length-u)*s+1>>>0,p=new Uint8Array(f);for(;u<l.length;){const N=l.charCodeAt(u);if(N>255)return;let _=e[N];if(_===255)return;let O=0;for(let A=f-1;(_!==0||O<h)&&A!==-1;A--,O++)_+=n*p[A]>>>0,p[A]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");h=O,u++}let m=f-h;for(;m!==f&&p[m]===0;)m++;const g=new Uint8Array(d+(f-m));let T=d;for(;m!==f;)g[T++]=p[m++];return g}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var SR="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Nc=IR(SR),TR=Object.freeze(Object.defineProperty({__proto__:null,compressRawPublicKey:hR,toDerSignature:fR},Symbol.toStringTag,{value:"Module"})),NR=()=>typeof window<"u"?window:{localStorage:{getItem:t=>null,setItem:(t,e)=>{},removeItem:t=>{},clear:()=>{},key:t=>null,length:0},location:{hostname:""}};var Pd=NR(),Tw;(function(t){t[t.Get=0]="Get",t[t.List=1]="List",t[t.Command=2]="Command"})(Tw||(Tw={}));class pC extends Error{constructor(e){let n=`Turnkey error ${e.code}: ${e.message}`;e.details!=null&&(n+=` (Details: ${JSON.stringify(e.details)})`),super(n),this.name="TurnkeyRequestError",this.details=e.details??null,this.code=e.code}}var er;(function(t){t.Passkey="passkey",t.Wallet="wallet",t.Iframe="iframe",t.IndexedDb="indexed-db"})(er||(er={}));var se;(function(t){t.Session="@turnkey/session/v2",t.Client="@turnkey/client"})(se||(se={}));var ia;(function(t){t.Local="local",t.Secure="secure",t.Session="session"})(ia||(ia={}));const jm={[se.Session]:ia.Session,[se.Client]:ia.Session},Wm={[ia.Local]:Pd.localStorage,[ia.Secure]:Pd.localStorage,[ia.Session]:Pd.localStorage},fe=async t=>{const e=jm[t],r=Wm[e].getItem(t);return r?JSON.parse(r):void 0},Nw=async(t,e)=>{const n=jm[t];Wm[n].setItem(t,JSON.stringify(e))},Fu=async t=>{const e=jm[t];Wm[e].removeItem(t)},_s=async(t,e)=>{await Nw(se.Session,t),e&&await Nw(se.Client,e)};var En;(function(t){t.READ_ONLY="SESSION_TYPE_READ_ONLY",t.READ_WRITE="SESSION_TYPE_READ_WRITE"})(En||(En={}));var Ow;(function(t){t.COINBASE="FIAT_ON_RAMP_PROVIDER_COINBASE",t.MOONPAY="FIAT_ON_RAMP_PROVIDER_MOONPAY"})(Ow||(Ow={}));var Rw;(function(t){t.BITCOIN="FIAT_ON_RAMP_CRYPTO_CURRENCY_BTC",t.ETHEREUM="FIAT_ON_RAMP_CRYPTO_CURRENCY_ETH",t.SOLANA="FIAT_ON_RAMP_CRYPTO_CURRENCY_SOL",t.USDC="FIAT_ON_RAMP_CRYPTO_CURRENCY_USDC"})(Rw||(Rw={}));const gC="@turnkey/sdk-browser@5.2.3",Pw=()=>{const t=new Uint8Array(32);return crypto.getRandomValues(t),t.buffer},xw=t=>lt.Buffer.from(t).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pe(t){if(typeof t!="string")return t;const[,e]=t.split(".");if(!e)throw new Error("Invalid JWT: Missing payload");const n=JSON.parse(atob(e)),{exp:r,public_key:s,session_type:i,user_id:o,organization_id:a}=n;if(!r||!s||!i||!o||!a)throw new Error("JWT payload missing required fields");return{sessionType:i,userId:o,organizationId:a,expiry:r,token:s}}class OR{constructor(e){this.getActivity=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_activity",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetActivity=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_activity",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getApiKey=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_api_key",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetApiKey=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_api_key",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getApiKeys=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_api_keys",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetApiKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_api_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getAttestationDocument=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_attestation",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetAttestationDocument=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_attestation",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getAuthenticator=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_authenticator",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetAuthenticator=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_authenticator",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getAuthenticators=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_authenticators",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetAuthenticators=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_authenticators",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getOauthProviders=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_oauth_providers",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetOauthProviders=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_oauth_providers",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getOrganization=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_organization",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetOrganization=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_organization",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getOrganizationConfigs=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_organization_configs",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetOrganizationConfigs=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_organization_configs",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getPolicy=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_policy",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetPolicy=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_policy",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getPrivateKey=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_private_key",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetPrivateKey=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_private_key",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getUser=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_user",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetUser=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_user",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getWallet=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_wallet",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getWalletAccount=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/get_wallet_account",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetWalletAccount=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/get_wallet_account",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getActivities=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_activities",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetActivities=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_activities",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getPolicies=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_policies",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetPolicies=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_policies",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.listPrivateKeyTags=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_private_key_tags",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampListPrivateKeyTags=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_private_key_tags",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getPrivateKeys=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_private_keys",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetPrivateKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_private_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getSubOrgIds=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_suborgs",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetSubOrgIds=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_suborgs",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.listUserTags=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_user_tags",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampListUserTags=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_user_tags",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getUsers=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_users",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetUsers=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_users",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getVerifiedSubOrgIds=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_verified_suborgs",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetVerifiedSubOrgIds=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_verified_suborgs",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getWalletAccounts=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_wallet_accounts",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetWalletAccounts=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_wallet_accounts",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getWallets=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/list_wallets",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetWallets=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/list_wallets",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.getWhoami=async(n={})=>{let r=await fe(se.Session);return r=pe(r),this.request("/public/v1/query/whoami",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampGetWhoami=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/query/whoami",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.approveActivity=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.activityDecision("/public/v1/submit/approve_activity",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_APPROVE_ACTIVITY"})},this.stampApproveActivity=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/approve_activity",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createApiKeys=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_api_keys",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_API_KEYS_V2"},"createApiKeysResult")},this.stampCreateApiKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_api_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createApiOnlyUsers=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_api_only_users",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_API_ONLY_USERS"},"createApiOnlyUsersResult")},this.stampCreateApiOnlyUsers=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_api_only_users",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createAuthenticators=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_authenticators",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_AUTHENTICATORS_V2"},"createAuthenticatorsResult")},this.stampCreateAuthenticators=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_authenticators",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createInvitations=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_invitations",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_INVITATIONS"},"createInvitationsResult")},this.stampCreateInvitations=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_invitations",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createOauthProviders=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_oauth_providers",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_OAUTH_PROVIDERS"},"createOauthProvidersResult")},this.stampCreateOauthProviders=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_oauth_providers",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createPolicies=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_policies",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_POLICIES"},"createPoliciesResult")},this.stampCreatePolicies=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_policies",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createPolicy=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_policy",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_POLICY_V3"},"createPolicyResult")},this.stampCreatePolicy=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_policy",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createPrivateKeyTag=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_private_key_tag",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_PRIVATE_KEY_TAG"},"createPrivateKeyTagResult")},this.stampCreatePrivateKeyTag=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_private_key_tag",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createPrivateKeys=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_private_keys",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_PRIVATE_KEYS_V2"},"createPrivateKeysResultV2")},this.stampCreatePrivateKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_private_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createReadOnlySession=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_read_only_session",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_READ_ONLY_SESSION"},"createReadOnlySessionResult")},this.stampCreateReadOnlySession=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_read_only_session",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createReadWriteSession=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_read_write_session",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_READ_WRITE_SESSION_V2"},"createReadWriteSessionResultV2")},this.stampCreateReadWriteSession=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_read_write_session",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createSubOrganization=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_sub_organization",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_SUB_ORGANIZATION_V7"},"createSubOrganizationResultV7")},this.stampCreateSubOrganization=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_sub_organization",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createUserTag=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_user_tag",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_USER_TAG"},"createUserTagResult")},this.stampCreateUserTag=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_user_tag",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createUsers=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_users",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_USERS_V3"},"createUsersResult")},this.stampCreateUsers=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_users",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createWallet=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_wallet",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_WALLET"},"createWalletResult")},this.stampCreateWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.createWalletAccounts=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/create_wallet_accounts",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_CREATE_WALLET_ACCOUNTS"},"createWalletAccountsResult")},this.stampCreateWalletAccounts=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/create_wallet_accounts",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteApiKeys=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_api_keys",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_API_KEYS"},"deleteApiKeysResult")},this.stampDeleteApiKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_api_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteAuthenticators=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_authenticators",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_AUTHENTICATORS"},"deleteAuthenticatorsResult")},this.stampDeleteAuthenticators=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_authenticators",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteInvitation=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_invitation",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_INVITATION"},"deleteInvitationResult")},this.stampDeleteInvitation=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_invitation",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteOauthProviders=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_oauth_providers",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_OAUTH_PROVIDERS"},"deleteOauthProvidersResult")},this.stampDeleteOauthProviders=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_oauth_providers",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deletePolicy=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_policy",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_POLICY"},"deletePolicyResult")},this.stampDeletePolicy=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_policy",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deletePrivateKeyTags=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_private_key_tags",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_PRIVATE_KEY_TAGS"},"deletePrivateKeyTagsResult")},this.stampDeletePrivateKeyTags=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_private_key_tags",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deletePrivateKeys=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_private_keys",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_PRIVATE_KEYS"},"deletePrivateKeysResult")},this.stampDeletePrivateKeys=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_private_keys",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteSubOrganization=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_sub_organization",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_SUB_ORGANIZATION"},"deleteSubOrganizationResult")},this.stampDeleteSubOrganization=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_sub_organization",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteUserTags=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_user_tags",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_USER_TAGS"},"deleteUserTagsResult")},this.stampDeleteUserTags=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_user_tags",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteUsers=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_users",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_USERS"},"deleteUsersResult")},this.stampDeleteUsers=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_users",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.deleteWallets=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/delete_wallets",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_DELETE_WALLETS"},"deleteWalletsResult")},this.stampDeleteWallets=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/delete_wallets",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.emailAuth=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/email_auth",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_EMAIL_AUTH_V2"},"emailAuthResult")},this.stampEmailAuth=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/email_auth",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.exportPrivateKey=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/export_private_key",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_EXPORT_PRIVATE_KEY"},"exportPrivateKeyResult")},this.stampExportPrivateKey=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/export_private_key",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.exportWallet=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/export_wallet",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_EXPORT_WALLET"},"exportWalletResult")},this.stampExportWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/export_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.exportWalletAccount=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/export_wallet_account",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_EXPORT_WALLET_ACCOUNT"},"exportWalletAccountResult")},this.stampExportWalletAccount=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/export_wallet_account",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.importPrivateKey=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/import_private_key",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_IMPORT_PRIVATE_KEY"},"importPrivateKeyResult")},this.stampImportPrivateKey=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/import_private_key",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.importWallet=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/import_wallet",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_IMPORT_WALLET"},"importWalletResult")},this.stampImportWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/import_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.initImportPrivateKey=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/init_import_private_key",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_INIT_IMPORT_PRIVATE_KEY"},"initImportPrivateKeyResult")},this.stampInitImportPrivateKey=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/init_import_private_key",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.initImportWallet=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/init_import_wallet",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_INIT_IMPORT_WALLET"},"initImportWalletResult")},this.stampInitImportWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/init_import_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.initOtp=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/init_otp",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_INIT_OTP"},"initOtpResult")},this.stampInitOtp=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/init_otp",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.initOtpAuth=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/init_otp_auth",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_INIT_OTP_AUTH_V2"},"initOtpAuthResultV2")},this.stampInitOtpAuth=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/init_otp_auth",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.initUserEmailRecovery=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/init_user_email_recovery",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_INIT_USER_EMAIL_RECOVERY"},"initUserEmailRecoveryResult")},this.stampInitUserEmailRecovery=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/init_user_email_recovery",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.oauth=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/oauth",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_OAUTH"},"oauthResult")},this.stampOauth=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/oauth",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.oauthLogin=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/oauth_login",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_OAUTH_LOGIN"},"oauthLoginResult")},this.stampOauthLogin=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/oauth_login",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.otpAuth=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/otp_auth",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_OTP_AUTH"},"otpAuthResult")},this.stampOtpAuth=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/otp_auth",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.otpLogin=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/otp_login",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_OTP_LOGIN"},"otpLoginResult")},this.stampOtpLogin=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/otp_login",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.recoverUser=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/recover_user",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_RECOVER_USER"},"recoverUserResult")},this.stampRecoverUser=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/recover_user",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.rejectActivity=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.activityDecision("/public/v1/submit/reject_activity",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_REJECT_ACTIVITY"})},this.stampRejectActivity=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/reject_activity",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.removeOrganizationFeature=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/remove_organization_feature",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_REMOVE_ORGANIZATION_FEATURE"},"removeOrganizationFeatureResult")},this.stampRemoveOrganizationFeature=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/remove_organization_feature",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.setOrganizationFeature=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/set_organization_feature",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_SET_ORGANIZATION_FEATURE"},"setOrganizationFeatureResult")},this.stampSetOrganizationFeature=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/set_organization_feature",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.signRawPayload=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/sign_raw_payload",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_SIGN_RAW_PAYLOAD_V2"},"signRawPayloadResult")},this.stampSignRawPayload=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/sign_raw_payload",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.signRawPayloads=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/sign_raw_payloads",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_SIGN_RAW_PAYLOADS"},"signRawPayloadsResult")},this.stampSignRawPayloads=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/sign_raw_payloads",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.signTransaction=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/sign_transaction",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_SIGN_TRANSACTION_V2"},"signTransactionResult")},this.stampSignTransaction=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/sign_transaction",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.stampLogin=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/stamp_login",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_STAMP_LOGIN"},"stampLoginResult")},this.stampStampLogin=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/stamp_login",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updatePolicy=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_policy",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_POLICY_V2"},"updatePolicyResultV2")},this.stampUpdatePolicy=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_policy",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updatePrivateKeyTag=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_private_key_tag",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_PRIVATE_KEY_TAG"},"updatePrivateKeyTagResult")},this.stampUpdatePrivateKeyTag=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_private_key_tag",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updateRootQuorum=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_root_quorum",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_ROOT_QUORUM"},"updateRootQuorumResult")},this.stampUpdateRootQuorum=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_root_quorum",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updateUser=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_user",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_USER"},"updateUserResult")},this.stampUpdateUser=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_user",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updateUserTag=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_user_tag",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_USER_TAG"},"updateUserTagResult")},this.stampUpdateUserTag=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_user_tag",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.updateWallet=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/update_wallet",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_UPDATE_WALLET"},"updateWalletResult")},this.stampUpdateWallet=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/update_wallet",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.verifyOtp=async n=>{const{organizationId:r,timestampMs:s,...i}=n;let o=await fe(se.Session);return o=pe(o),this.command("/public/v1/submit/verify_otp",{parameters:i,organizationId:r??o?.organizationId??this.config.organizationId,timestampMs:s??String(Date.now()),type:"ACTIVITY_TYPE_VERIFY_OTP"},"verifyOtpResult")},this.stampVerifyOtp=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/public/v1/submit/verify_otp",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.testRateLimits=async n=>{let r=await fe(se.Session);return r=pe(r),this.request("/tkhq/api/v1/test_rate_limits",{...n,organizationId:n.organizationId??r?.organizationId??this.config.organizationId})},this.stampTestRateLimits=async n=>{if(!this.stamper)return;const r=this.config.apiBaseUrl+"/tkhq/api/v1/test_rate_limits",s=JSON.stringify(n),i=await this.stamper.stamp(s);return{body:s,stamp:i,url:r}},this.config=e,e.stamper&&(this.stamper=e.stamper)}async request(e,n){const r=this.config.apiBaseUrl+e,s=JSON.stringify(n);var i={"X-Client-Version":gC};if(this.stamper){const c=await this.stamper.stamp(s);i[c.stampHeaderName]=c.stampHeaderValue}this.config.readOnlySession&&(i["X-Session"]=this.config.readOnlySession);const o=await fetch(r,{method:"POST",headers:i,body:s,redirect:"follow"});if(!o.ok){let c;try{c=await o.json()}catch{throw new Error(`${o.status} ${o.statusText}`)}throw new pC(c)}return await o.json()}async command(e,n,r){const s=this.config.activityPoller?.intervalMs??1e3,i=this.config.activityPoller?.numRetries??3,o=d=>new Promise(h=>setTimeout(h,d)),a=d=>{const{result:h,status:f}=d.activity;return f==="ACTIVITY_STATUS_COMPLETED"?{...h[`${r}`],...d}:d};let c=0;const l=async d=>{const h={activityId:d},f=await this.getActivity(h);return c>i?a(f):(c+=1,Aw.includes(f.activity.status)?a(f):(await o(s),l(d)))},u=await this.request(e,n);return Aw.includes(u.activity.status)?a(u):l(u.activity.id)}async activityDecision(e,n){const r=await this.request(e,n);return{...r.activity.result,...r}}}class RR extends OR{constructor(e,n){super(e),this.authClient=n}}const ju="900";class zh extends RR{constructor(e,n){super(e,n),this.login=async r=>{const s=await this.createReadOnlySession(r||{}),i={sessionType:En.READ_ONLY,userId:s.userId,organizationId:s.organizationId,expiry:Number(s.sessionExpiry),token:s.session};return await _s(i,this.authClient),s},this.refreshSession=async({sessionType:r=En.READ_WRITE,expirationSeconds:s=ju,invalidateExisting:i=!1,publicKey:o}={})=>{try{switch(r){case En.READ_ONLY:{if(!(this instanceof mC))throw new Error("You must use a passkey client to refresh a read-only session.");const a=await this.createReadOnlySession({}),c={sessionType:En.READ_ONLY,userId:a.userId,organizationId:a.organizationId,expiry:Number(a.sessionExpiry),token:a.session};await _s(c,er.Passkey);return}case En.READ_WRITE:{if(this instanceof mg){let a,c=o;if(!o){a=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"]);const u=new Uint8Array(await crypto.subtle.exportKey("raw",a.publicKey));c=Zd(L_(u))}const l=await this.stampLogin({publicKey:c,expirationSeconds:s,invalidateExisting:i});await this.resetKeyPair(a),await _s(l.session,er.IndexedDb);return}if(this instanceof gg){const a=o??await this.getEmbeddedPublicKey();if(!a)throw new Error("Unable to refresh session: missing target public key.");const c=await this.createReadWriteSession({targetPublicKey:a,expirationSeconds:s,invalidateExisting:i}),l={sessionType:En.READ_WRITE,userId:c.userId,organizationId:c.organizationId,expiry:Date.now()+Number(s)*1e3,token:c.credentialBundle};await this.injectCredentialBundle(l.token),await _s(l,er.Iframe);return}throw new Error("Unsupported client type for read-write session refresh.")}default:throw new Error(`Invalid session type passed: ${r}`)}}catch(a){throw new Error(`Unable to refresh session: ${a}`)}},this.loginWithBundle=async r=>{const{bundle:s,expirationSeconds:i=ju}=r;if(this instanceof gg)await this.injectCredentialBundle(s);else throw new Error("You must use an iframe client to log in with a session.");const o=await this.getWhoami(),a={sessionType:En.READ_WRITE,userId:o.userId,organizationId:o.organizationId,expiry:Date.now()+Number(i)*1e3,token:s};await _s(a,er.Iframe)},this.loginWithSession=async r=>{if(this instanceof mg)await _s(r,er.IndexedDb);else throw new Error("You must use an indexedDb client to log in with a session.")},this.loginWithPasskey=async r=>{try{const{sessionType:s=En.READ_WRITE,publicKey:i,expirationSeconds:o=ju}=r;if(s===En.READ_ONLY){const a=await this.createReadOnlySession({}),c={sessionType:En.READ_ONLY,userId:a.userId,organizationId:a.organizationId,expiry:Number(a.sessionExpiry),token:a.session};await _s(c,er.Passkey)}else if(s===En.READ_WRITE){if(!i)throw new Error("You must provide a publicKey to create a passkey read write session.");const a=await this.stampLogin({publicKey:i,expirationSeconds:o});await _s(a.session,er.IndexedDb)}else throw new Error(`Invalid session type passed: ${s}`)}catch(s){throw new Error(`Unable to log in with the provided passkey: ${s}`)}},this.loginWithWallet=async r=>{try{const{sessionType:s=En.READ_WRITE,publicKey:i,expirationSeconds:o=ju}=r;if(s===En.READ_ONLY){const a=await this.createReadOnlySession({}),c={sessionType:En.READ_ONLY,userId:a.userId,organizationId:a.organizationId,expiry:Number(a.sessionExpiry),token:a.session};await _s(c,er.Wallet)}else if(s===En.READ_WRITE){if(!i)throw new Error("You must provide a publicKey to create a read-write session.");const a=await this.stampLogin({publicKey:i,expirationSeconds:o});await _s(a.session,er.IndexedDb)}else throw new Error(`Invalid session type passed: ${s}`)}catch(s){throw new Error(`Unable to log in with the provided wallet: ${s}`)}},this.deleteUserAuth=async r=>{try{const{userId:s,phoneNumber:i,email:o,authenticatorIds:a,oauthProviderIds:c,apiKeyIds:l}=r,u=[];return i&&u.push(this.updateUser({userId:s,userPhoneNumber:"",userTagIds:[]})),o&&u.push(this.updateUser({userId:s,userEmail:"",userTagIds:[]})),a&&a.length>0&&u.push(this.deleteAuthenticators({userId:s,authenticatorIds:a})),c&&c.length>0&&u.push(this.deleteOauthProviders({userId:s,providerIds:c})),l&&l.length>0&&u.push(this.deleteApiKeys({userId:s,apiKeyIds:l})),await Promise.all(u)}catch(s){throw s}},this.addUserAuth=async r=>{try{const{userId:s,phoneNumber:i,email:o,authenticators:a,oauthProviders:c,apiKeys:l}=r,u=[];return i&&u.push(this.updateUser({userId:s,userPhoneNumber:i,userTagIds:[]})),o&&u.push(this.updateUser({userId:s,userEmail:o,userTagIds:[]})),a&&a.length>0&&u.push(this.createAuthenticators({userId:s,authenticators:a})),c&&c.length>0&&u.push(this.createOauthProviders({userId:s,oauthProviders:c})),l&&l.length>0&&u.push(this.createApiKeys({userId:s,apiKeys:l})),await Promise.all(u)}catch(s){throw s}}}async updateUserAuth(e){try{const{userId:n,phoneNumber:r,email:s,authenticators:i,oauthProviders:o,apiKeys:a}=e,c=[],l={};return r!==void 0&&(l.userPhoneNumber=r===null?"":r),s!==void 0&&(l.userEmail=s===null?"":s),Object.keys(l).length>0&&c.push(this.updateUser({userId:n,...l,userTagIds:[]})),i&&(i.add?.length&&c.push(this.createAuthenticators({userId:n,authenticators:i.add})),i.deleteIds?.length&&c.push(this.deleteAuthenticators({userId:n,authenticatorIds:i.deleteIds}))),o&&(o.add?.length&&c.push(this.createOauthProviders({userId:n,oauthProviders:o.add})),o.deleteIds?.length&&c.push(this.deleteOauthProviders({userId:n,providerIds:o.deleteIds}))),a&&(a.add?.length&&c.push(this.createApiKeys({userId:n,apiKeys:a.add})),a.deleteIds?.length&&c.push(this.deleteApiKeys({userId:n,apiKeyIds:a.deleteIds}))),await Promise.all(c),!0}catch(n){throw n}}}class mC extends zh{constructor(e){super(e,er.Passkey),this.createUserPasskey=async(n={})=>{const r=Pw(),s=xw(r),i=Pw(),o={publicKey:{rp:{id:n.publicKey?.rp?.id??this.rpId,name:n.publicKey?.rp?.name??""},challenge:n.publicKey?.challenge??r,pubKeyCredParams:n.publicKey?.pubKeyCredParams??[{type:"public-key",alg:-7},{type:"public-key",alg:-257}],user:{id:n.publicKey?.user?.id??i,name:n.publicKey?.user?.name??"Default User",displayName:n.publicKey?.user?.displayName??"Default User"},authenticatorSelection:{authenticatorAttachment:n.publicKey?.authenticatorSelection?.authenticatorAttachment??void 0,requireResidentKey:n.publicKey?.authenticatorSelection?.requireResidentKey??!0,residentKey:n.publicKey?.authenticatorSelection?.residentKey??"required",userVerification:n.publicKey?.authenticatorSelection?.userVerification??"preferred"}}},a=await DO(o);return{encodedChallenge:n.publicKey?.challenge?xw(n.publicKey?.challenge):s,attestation:a}},this.rpId=this.stamper.rpId}}class gg extends zh{constructor(e){super(e,er.Iframe),this.injectCredentialBundle=async n=>await this.stamper.injectCredentialBundle(n),this.injectWalletExportBundle=async(n,r)=>await this.stamper.injectWalletExportBundle(n,r),this.injectKeyExportBundle=async(n,r,s)=>await this.stamper.injectKeyExportBundle(n,r,s),this.injectImportBundle=async(n,r,s)=>await this.stamper.injectImportBundle(n,r,s),this.extractWalletEncryptedBundle=async()=>await this.stamper.extractWalletEncryptedBundle(),this.extractKeyEncryptedBundle=async()=>await this.stamper.extractKeyEncryptedBundle(),this.getEmbeddedPublicKey=async()=>await this.stamper.getEmbeddedPublicKey(),this.clearEmbeddedKey=async()=>await this.stamper.clearEmbeddedKey(),this.initEmbeddedKey=async()=>await this.stamper.initEmbeddedKey(),this.iframePublicKey=this.stamper.iframePublicKey}}class PR extends zh{constructor(e){super(e,er.Wallet),this.wallet=e.wallet}async getPublicKey(){return this.wallet.getPublicKey()}getWalletInterface(){return this.wallet}}class mg extends zh{constructor(e){super(e,er.IndexedDb),this.clear=async()=>await this.stamper.clear(),this.getPublicKey=async()=>await this.stamper.getPublicKey(),this.init=async()=>await this.stamper.init(),this.resetKeyPair=async n=>await this.stamper.resetKeyPair(n)}}const xR="TurnkeyStamperDB",Po="KeyStore",Ua="turnkeyKeyPair",kR="X-Stamp";function DR(t){if(t.length%2!=0||t.length==0||t.length>132)throw new Error("Invalid IEEE P1363 signature encoding. Length: "+t.length);const e=kw(t.subarray(0,t.length/2)),n=kw(t.subarray(t.length/2,t.length));let r=0;const s=2+e.length+1+1+n.length;let i;return s>=128?(i=new Uint8Array(s+3),i[r++]=48,i[r++]=129,i[r++]=s):(i=new Uint8Array(s+2),i[r++]=48,i[r++]=s),i[r++]=2,i[r++]=e.length,i.set(e,r),r+=e.length,i[r++]=2,i[r++]=n.length,i.set(n,r),i}function kw(t){let e=0;for(;e<t.length&&t[e]==0;)e++;e==t.length&&(e=t.length-1);let n=0;(t[e]&128)==128&&(n=1);const r=new Uint8Array(t.length-e+n);return r.set(t.subarray(e),n),r}class UR{constructor(){if(this.publicKeyHex=null,this.privateKey=null,typeof window>"u")throw new Error("IndexedDB is only available in the browser")}async openDb(){return new Promise((e,n)=>{const r=indexedDB.open(xR,1);r.onupgradeneeded=s=>{s.target.result.createObjectStore(Po)},r.onsuccess=()=>e(r.result),r.onerror=()=>n(r.error)})}async storeKeyPair(e,n){const r=await this.openDb();return new Promise((s,i)=>{const o=r.transaction(Po,"readwrite"),a=o.objectStore(Po);a.put(e,`${Ua}-pub`),a.put(n,`${Ua}-priv`),o.oncomplete=()=>{r.close(),s()},o.onerror=()=>i(o.error),o.onabort=()=>i(o.error)})}async getStoredKeys(){const e=await this.openDb();return new Promise((n,r)=>{const s=e.transaction(Po,"readonly"),i=s.objectStore(Po),o=i.get(`${Ua}-pub`),a=i.get(`${Ua}-priv`);let c=null,l=null;o.onsuccess=()=>c=o.result||null,a.onsuccess=()=>l=a.result||null,s.oncomplete=()=>{e.close(),n({publicKey:c,privateKey:l})},s.onerror=()=>r(s.error)})}async init(){const{publicKey:e,privateKey:n}=await this.getStoredKeys();e&&n?(this.publicKeyHex=e,this.privateKey=n):await this.resetKeyPair()}async resetKeyPair(e){let n,r;if(e){if(e.privateKey.extractable!==!1)throw new Error("Provided privateKey must be non-extractable.");n=e.privateKey,r=e.publicKey}else{const a=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"]);n=a.privateKey,r=a.publicKey}const s=new Uint8Array(await crypto.subtle.exportKey("raw",r)),i=L_(s),o=Zd(i);await this.storeKeyPair(o,n),this.publicKeyHex=o,this.privateKey=n}getPublicKey(){return this.publicKeyHex}async sign(e){if(!this.privateKey)throw new Error("Key not initialized. Call init() first.");const n=new TextEncoder().encode(e),r=await crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},this.privateKey,n),s=DR(new Uint8Array(r));return Zd(s)}async stamp(e){if(!this.publicKeyHex||!this.privateKey)throw new Error("Key not initialized. Call init() first.");const n=await this.sign(e),r={publicKey:this.publicKeyHex,scheme:"SIGNATURE_SCHEME_TK_API_P256",signature:n};return{stampHeaderName:kR,stampHeaderValue:$_(JSON.stringify(r))}}async clear(){const e=await this.openDb();return new Promise((n,r)=>{const s=e.transaction(Po,"readwrite"),i=s.objectStore(Po);i.delete(`${Ua}-pub`),i.delete(`${Ua}-priv`),s.oncomplete=()=>{e.close(),this.publicKeyHex=null,this.privateKey=null,n()},s.onerror=()=>r(s.error)})}}class yC{constructor(e){this.passkeyClient=n=>{const r=n?.rpId??this.config.rpId??Pd.location.hostname;if(!r)throw new Error("Tried to initialize a passkey client with no rpId defined");return this.stamper=new oR({rpId:r,...n?.timeout!==void 0&&{timeout:n?.timeout},...n?.userVerification!==void 0&&{userVerification:n?.userVerification},...n?.allowCredentials!==void 0&&{allowCredentials:n?.allowCredentials}}),new mC({stamper:this.stamper,apiBaseUrl:this.config.apiBaseUrl,organizationId:this.config.defaultOrganizationId})},this.iframeClient=async n=>{if(!n.iframeUrl)throw new Error("Tried to initialize iframeClient with no iframeUrl defined");const r=n.iframeElementId??"turnkey-default-iframe-element-id";return this.stamper=new $O({iframeContainer:n.iframeContainer,iframeUrl:n.iframeUrl,iframeElementId:r}),await this.stamper.init(n.dangerouslyOverrideIframeKeyTtl??void 0),new gg({stamper:this.stamper,apiBaseUrl:this.config.apiBaseUrl,organizationId:this.config.defaultOrganizationId})},this.walletClient=n=>new PR({stamper:new dR(n),wallet:n,apiBaseUrl:this.config.apiBaseUrl,organizationId:this.config.defaultOrganizationId}),this.indexedDbClient=async()=>(this.stamper=new UR,new mg({stamper:this.stamper,apiBaseUrl:this.config.apiBaseUrl,organizationId:this.config.defaultOrganizationId})),this.serverSign=async(n,r,s)=>{const i=s??this.config.serverSignUrl;if(!i)throw new Error("Tried to call serverSign with no serverSignUrl defined");const o=JSON.stringify({methodName:n,params:r}),a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-Client-Version":gC},body:o,redirect:"follow"});if(!a.ok){let l;try{l=await a.json()}catch{throw new Error(`${a.status} ${a.statusText}`)}throw new pC(l)}return await a.json()},this.getSession=async()=>{const n=await fe(se.Session);let r;if(typeof n=="string"?r=pe(n):r=n,r&&r.expiry*1e3>Date.now())return r;await Fu(se.Session)},this.getRawSession=async()=>{const n=await fe(se.Session);let r;if(typeof n=="string"){if(r=pe(n),r&&r.expiry*1e3>Date.now())return n}else if(n&&n.expiry*1e3>Date.now())return JSON.stringify(n);await Fu(se.Session)},this.logout=async()=>(await Fu(se.Client),await Fu(se.Session),!0),this.config=e}}const yg={UserLoggedOut:7},wC="turnkey/oauth",EC="turnkey/otp",bC=`${EC}/init`,vC=`${EC}/verify`,wg="86400";var Dw=class{static async initEmailOTP(t){const{client:e,indexedDbClient:n,expirationSeconds:r}=t;try{await n.resetKeyPair();let s=await n.getPublicKey();if(!s)throw new Ce(new Error("Public key not found"));const i=await e.post(t.otpInitPath||bC,{targetPublicKey:s,email:t.email,suborgId:t.subOrgId,invalidateExistingSessions:t.invalidateExistingSessions,isUsingIndexedDB:!0,expirationSeconds:r||wg});return i?.data}catch(s){throw new Ce(new Error(s.message),{code:Me,type:Ke.WalletError,contextModule:"turnkey-init-email-otp"})}}static async confirmEmailOTP(t){const{client:e,expirationSeconds:n,targetPublicKey:r}=t;try{var s;const i=t.organizationId,o=t.emailOTPId,a=t.otpVerifyPath||vC;if(!o)throw new Ce(new Error("Email OTP ID is required"));if(!i)throw new Ce(new Error("Organization ID is required"));const c=await e.post(a,{isUsingIndexedDB:!0,targetPublicKey:r,otpId:o,otpCode:t.otpCode,suborgID:i,expirationSeconds:(s=n||wg)===null||s===void 0?void 0:s.toString()});return c?.data}catch(i){throw new Ce(new Error(i.message),{code:Me,type:Ke.WalletError,contextModule:"turnkey-confirm-email-otp"})}}},Uw=class{static async generateOAuthNonce(t){try{await t.resetKeyPair();const e=await t.getPublicKey();if(!e)throw new Ce(new Error("Target public key not found"));return Array.from(tN(new TextEncoder().encode(e))).map(n=>n.toString(16).padStart(2,"0")).join("")}catch(e){throw new Ce(new Error(e.message),{code:Me,type:Ke.WalletError,contextModule:"turnkey-generate-oauth-nonce"})}}static async oauthLogin(t){const{client:e,indexedDbClient:n,expirationSeconds:r}=t,s=t.oauthLoginPath||wC;try{var i;const o=await n.getPublicKey();if(!o)throw new Ce(new Error("Target public key not found"));return(await e.post(s,{targetPublicKey:o,oidcToken:t.oidcToken,providerName:t.providerName,expirationSeconds:(i=r||wg)===null||i===void 0?void 0:i.toString()})).data}catch(o){throw new Ce(new Error(o.message),{code:Me,type:Ke.WalletError,contextModule:"turnkey-oauth-login"})}}};function MR({nonce:t,clientId:e,redirectUri:n,scope:r="openid profile email",prompt:s="consent"}){if(!e)throw new Error("Google client ID not found");return`https://accounts.google.com/o/oauth2/v2/auth?prompt=${s}&client_id=${e}&redirect_uri=${n}&response_type=id_token&scope=${r}&nonce=${t}`}function Dl(t){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dl(t)}function LR(t,e){if(Dl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Dl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $R(t){var e=LR(t,"string");return Dl(e)=="symbol"?e:e+""}function Jn(t,e,n){return(e=$R(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _C=class{setMetadata(t){this.metadata={...this.metadata,...t}}constructor(t){Jn(this,"otpId",void 0),Jn(this,"turnkey",void 0),Jn(this,"userOrganizationId",void 0),Jn(this,"client",void 0),Jn(this,"metadata",void 0),Jn(this,"indexedDbClient",void 0),Jn(this,"accountMap",{}),this.metadata=t,this.client=new m_(t.apiServerEndpoint)}static async getTurnkeyInstance(t){const{turnkey:e,indexedDbClient:n}=await Mw(t);return{turnkey:e,indexedDbClient:n}}async getTurnkey(){return this.indexedDbClient||await this.initClient(),this.turnkey||(this.turnkey=new yC(this.metadata)),this.turnkey}async getIndexedDbClient(){if(this.indexedDbClient||await this.initClient(),!this.indexedDbClient)throw new Ce(new Error("Indexed DB client not initialized"));return this.indexedDbClient}async getSession(t){try{const{metadata:e}=this,n=await this.getIndexedDbClient(),r=await(await this.getTurnkey()).getSession(),s=r?.organizationId||e.defaultOrganizationId;if(!(t||r?.token))return{session:void 0,organizationId:s};const i=await n.getWhoami(),o=i?.organizationId||r?.organizationId||s;return i?(this.userOrganizationId=o,{session:r,organizationId:o}):{session:void 0,organizationId:o}}catch{throw new iw(new Error("Session expired. Please login again."))}}async getAccounts(){const t=await this.getIndexedDbClient();if(!this.userOrganizationId)return[];try{const e=await t.getWallets({organizationId:this.userOrganizationId});return(await Promise.allSettled(e.wallets.map(n=>t.getWalletAccounts({walletId:n.walletId,organizationId:this.userOrganizationId})))).filter(n=>n.status==="fulfilled").flatMap(n=>{var r;return(r=n.value)===null||r===void 0?void 0:r.accounts}).filter(n=>!!n&&n.addressFormat==="ADDRESS_FORMAT_ETHEREUM"&&!!n.address).map(n=>eN(n.address))}catch(e){throw e.code===yg.UserLoggedOut?new Ce(new Error("User is not logged in"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts,contextCode:yg.UserLoggedOut}):new Ce(new Error(e.message),{code:Me,type:Ke.WalletError,contextModule:"turnkey-wallet-get-accounts"})}}async getOrCreateAndGetAccount(t){const{accountMap:e}=this,n=await this.getIndexedDbClient(),r=this.userOrganizationId;if(e[t]||e[t.toLowerCase()])return e[t]||e[t.toLowerCase()];if(!r)throw new Ce(new Error("Organization ID is required"));if(n.config.organizationId=r,!t)throw new Ce(new Error("Account address not found"));const s=await wO({organizationId:r,signWith:t,client:n});return this.accountMap[t]=s,s}async initOTP(t){const e=await this.getIndexedDbClient(),n=await Dw.initEmailOTP({client:this.client,indexedDbClient:e,email:t,otpInitPath:this.metadata.otpInitPath||bC});if(!n||!n.otpId)throw new Ce(new Error("Failed to initialize OTP"));return n?.organizationId&&(this.userOrganizationId=n.organizationId),n?.otpId&&(this.otpId=n.otpId),n}async confirmOTP(t){const e=await this.getIndexedDbClient(),n=await e.getPublicKey();if(!this.otpId)throw new Ce(new Error("OTP ID is required"));if(!n)throw new Ce(new Error("Target public key not found"));if(!this.userOrganizationId)throw new Ce(new Error("Organization ID is required"));const r=await Dw.confirmEmailOTP({otpCode:t,client:this.client,emailOTPId:this.otpId,organizationId:this.userOrganizationId,targetPublicKey:n,otpVerifyPath:this.metadata.otpVerifyPath||vC});if(!r||!r.session)throw new Ce(new Error("Failed to confirm OTP"));return await e.loginWithSession(r.session),this.userOrganizationId=r.organizationId,r}async initOAuth(t){var e,n;if(t===dw.Apple)throw new Ce(new Error("Apple sign in option is currently not supported"));const r=await this.getIndexedDbClient(),s=await Uw.generateOAuthNonce(r);if(!(!((e=this.metadata)===null||e===void 0)&&e.googleClientId)||!(!((n=this.metadata)===null||n===void 0)&&n.googleRedirectUri))throw new Ce(new Error("googleClientId and googleRedirectUri are required"));return MR({nonce:s,clientId:this.metadata.googleClientId,redirectUri:this.metadata.googleRedirectUri})}async confirmOAuth(t,e){if(t===dw.Apple)throw new Ce(new Error("Apple sign in option is currently not supported"));const n=await this.getIndexedDbClient(),r=await Uw.oauthLogin({oidcToken:e,indexedDbClient:n,client:this.client,providerName:t.toString(),oauthLoginPath:this.metadata.oauthLoginPath||wC});if(!r||!r.credentialBundle)throw new Ce(new Error("Unexpected OAuth result"));return await n.loginWithSession(r.credentialBundle),this.userOrganizationId=r.organizationId,r.credentialBundle}async refreshSession(){var t;const e=await this.getSession(),n=await this.getIndexedDbClient();if(!((t=e.session)===null||t===void 0)&&t.token)return await n.refreshSession({sessionType:En.READ_WRITE,expirationSeconds:this.metadata.expirationSeconds}),this.userOrganizationId=e.organizationId,e.session.token;throw new iw(new Error("Session expired. Please login again."))}async initClient(){const{metadata:t}=this,{turnkey:e,indexedDbClient:n}=await Mw(t);return this.turnkey=e,this.indexedDbClient=n,{turnkey:e,indexedDbClient:n}}};async function Mw(t){const e=new yC(t),n=await e.indexedDbClient();if(await n.init(),!e)throw new z1(new Error("Turnkey is not initialized"));return{turnkey:e,indexedDbClient:n}}const BR=async(t,e)=>new FR({chainId:parseInt(e,16),signTypedData:t.signTypedData.bind(t),signMessage:t.signMessage.bind(t),signTransaction:t.signTransaction.bind(t),account:t,address:t.address});var FR=class{constructor(t){var e;Jn(this,"chainId",void 0),Jn(this,"signTypedData",void 0),Jn(this,"signMessage",void 0),Jn(this,"signTransaction",void 0),Jn(this,"account",void 0),Jn(this,"address",void 0),this.chainId=(e=t.chainId)!==null&&e!==void 0?e:1,this.signTypedData=t.signTypedData,this.signMessage=t.signMessage,this.account=t.account,this.address=t.address,this.signTransaction=t.signTransaction}async requestAccounts(){return[this.address]}getClient(){return ig({chainId:this.chainId,account:this.account})}getChain(){return gN(this.chainId)}on(t,e){throw new Error("Not implemented")}removeListener(...t){throw new Error("Not implemented!")}async request(t){if(t.method==="eth_requestAccounts")return this.requestAccounts();if(t.method==="eth_signTypedData"){if(!t.params)throw new Error("params is required");return this.signTypedData(t.params[0])}if(t.method==="eth_signMessage"){if(!t.params)throw new Error("params is required");return this.signMessage(t.params[0])}if(t.method==="eth_chainId")return this.chainId;if(t.method==="wallet_switchEthereumChain"){if(!t.params)throw new Error("params is required");const e=String(t.params[0].chainId).replace("0x","");return this.chainId=parseInt(e,16),!0}if(t.method==="eth_sendTransaction"){if(!t.params)throw new Error("params is required");const e=ig({chainId:this.chainId,account:this.account}),n=this.getClient(),r=a=>{if(typeof a=="string"){const c=a.startsWith("0x")?a:`0x${a}`;return BigInt(c)}return BigInt(a)},s={...t.params[0]};for(const a of["value","gas","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas"])s[a]!==void 0&&(s[a]=r(s[a]));const i=await e.prepareTransactionRequest(s),o=await this.signTransaction(i);return await n.sendRawTransaction({serializedTransaction:o})}if(t.method==="eth_getTransactionCount"){if(!t.params)throw new Error("params is required");return`0x${(await v_(this.chainId).getTransactionCount({address:this.address,blockTag:"pending"})).toString(16)}`}return this.getClient().request({method:t.method,params:t.params})}},jR=class extends Lh{constructor(t){var e;super(t),Jn(this,"turnkeyWallet",void 0),Jn(this,"evmOptions",void 0),Jn(this,"client",void 0);const n=t.apiServerEndpoint||((e=this.metadata)===null||e===void 0||(e=e.turnkey)===null||e===void 0?void 0:e.apiServerEndpoint);if(!n)throw new Ce(new Error("apiServerEndpoint is required"));this.client=new m_(n),this.evmOptions=t.evmOptions}async getWalletDeviceType(){return Promise.resolve($h.Browser)}setMetadata(t){if(t?.turnkey){var e,n,r;this.metadata={...this.metadata,turnkey:{...(e=this.metadata)===null||e===void 0?void 0:e.turnkey,...t.turnkey}},(n=this.turnkeyWallet)===null||n===void 0||n.setMetadata((r=this.metadata)===null||r===void 0?void 0:r.turnkey)}}async enable(){const t=await this.getTurnkeyWallet();try{const n=await t.getSession();if(n.session){var e;return!((e=this.metadata)===null||e===void 0)&&e.turnkey&&(this.metadata.turnkey.session=n.session),!0}return!!await t.getIndexedDbClient()}catch{return!1}}async disconnect(){const t=await this.getTurnkeyWallet(),e=await t.getTurnkey(),n=await t.getIndexedDbClient();await e.getSession()&&await Promise.allSettled([e.logout(),n.clear()])}async getAddresses(){const t=await this.getTurnkeyWallet();try{return await t.getAccounts()}catch(e){throw e.contextCode===yg.UserLoggedOut?(await this.disconnect(),e):new Ce(new Error(e.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}}async getAddressesInfo(){throw new Ce(new Error("getAddressesInfo is not implemented"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}async getSessionOrConfirm(t){return await(await this.getTurnkeyWallet()).refreshSession()}async getWalletClient(){return await this.getTurnkeyWallet()}async sendEvmTransaction(t,e){try{var n;const r=this.evmOptions,s=await this.getTurnkeyWallet(),i=e.evmChainId||r.evmChainId,o=r.rpcUrl||((n=r.rpcUrls)===null||n===void 0?void 0:n[e.evmChainId]);if(!o)throw new Ce(new Error("Please pass rpcUrl within the evmOptions"),{code:Me,context:Ge.SendEvmTransaction});const a=ig({chainId:i,account:await s.getOrCreateAndGetAccount(Ff(e.address)),rpcUrl:o}),c=f=>{if(typeof f=="string"){const p=f.startsWith("0x")?f:`0x${f}`;return BigInt(p)}return BigInt(f)},l={...t};for(const f of["value","gas","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas"])l[f]!==void 0&&(l[f]=c(l[f]));const{account:u,...d}=await a.prepareTransactionRequest(l),h=await a.signTransaction(d);return await a.sendRawTransaction({serializedTransaction:h})}catch(r){throw new Ce(r,{code:Me,context:Ge.SendEvmTransaction})}}async sendTransaction(t,e){const{endpoints:n,txTimeout:r}=e;if(!n)throw new Ce(new Error("You have to pass endpoints.grpc within the options for using Turnkey wallet"));const s=await new Mh(n.grpc).broadcast(t,{txTimeout:r});if(s.code!==0)throw new Rl(new Error(s.rawLog),{code:Me,contextCode:s.code,contextModule:s.codespace});return s}async signEip712TypedData(t,e){var n;const r=await this.getTurnkeyWallet(),s=Ff(e),i=await r.getOrCreateAndGetAccount(s);if(!i)throw new Ce(new Error("Turnkey account not found"));let o;try{o=JSON.parse(t)}catch{throw new Ce(new Error("Failed to parse EIP-712 data: Invalid JSON format"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}return!((n=o.domain)===null||n===void 0)&&n.chainId&&typeof o.domain.chainId=="string"&&(o.domain.chainId=Number(o.domain.chainId)),await i.signTypedData(o)}async signCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signing Cosmos transactions"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signAminoCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signAminoCosmosTransaction"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signArbitrary(t,e){throw new Ce(new Error("This wallet does not support signArbitrary"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async getEthereumChainId(){throw new Td(new Error("getEthereumChainId is not supported on Turnkey wallet"),{code:Me,context:Ge.GetChainId})}async getEvmTransactionReceipt(t,e){var n;const r=this.evmOptions,s=e||r.evmChainId,i=r.rpcUrl||((n=r.rpcUrls)===null||n===void 0?void 0:n[s]);if(!i)throw new Ce(new Error("Please pass rpcUrl within the evmOptions"),{code:Me,context:Ge.GetEvmTransactionReceipt});const o=v_(s,i);try{return await o.waitForTransactionReceipt({hash:t,timeout:3e4,pollingInterval:3e3})}catch{throw new Error(`Failed to retrieve transaction receipt for txHash: ${t}`)}}async getPubKey(){throw new Ce(new Error("You can only fetch PubKey from Cosmos native wallets"))}async getIndexedDbClient(){return await(await this.getTurnkeyWallet()).getIndexedDbClient()}async getTurnkeyWallet(){const{metadata:t}=this;if(!this.turnkeyWallet){if(!t?.turnkey)throw new Ce(new Error("Turnkey metadata is required"));if(!t.turnkey.apiBaseUrl)throw new Ce(new Error("Turnkey apiBaseUrl is required"));if(!t.turnkey.apiServerEndpoint)throw new Ce(new Error("Turnkey apiServerEndpoint is required"));this.turnkeyWallet=new _C(t.turnkey)}return this.turnkeyWallet}async getEip1193Provider(){const t=await this.getTurnkeyWallet(),e=Ff(Q1((await t.getAccounts())[0]));return await BR(await t.getOrCreateAndGetAccount(e),String(this.evmOptions.evmChainId))}};const UZ=Object.freeze(Object.defineProperty({__proto__:null,TurnkeyWallet:_C,TurnkeyWalletStrategy:jR},Symbol.toStringTag,{value:"Module"}));var ba=(t=>(t.MissingApiKey="MISSING_API_KEY",t.ModalNotReady="MODAL_NOT_READY",t.ConnectionLost="CONNECTION_WAS_LOST",t.MalformedResponse="MALFORMED_RESPONSE",t.InvalidArgument="INVALID_ARGUMENT",t.ExtensionNotInitialized="EXTENSION_NOT_INITIALIZED",t.IncompatibleExtensions="INCOMPATIBLE_EXTENSIONS",t))(ba||{}),Oc=(t=>(t.SyncWeb3Method="SYNC_WEB3_METHOD",t.DuplicateIframe="DUPLICATE_IFRAME",t.ReactNativeEndpointConfiguration="REACT_NATIVE_ENDPOINT_CONFIGURATION",t.DeprecationNotice="DEPRECATION_NOTICE",t.ProductAnnouncement="ANNOUNCEMENT",t))(Oc||{}),qh=(t=>(t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.MagicLinkFailedVerification=-1e4]="MagicLinkFailedVerification",t[t.MagicLinkExpired=-10001]="MagicLinkExpired",t[t.MagicLinkRateLimited=-10002]="MagicLinkRateLimited",t[t.MagicLinkInvalidRedirectURL=-10006]="MagicLinkInvalidRedirectURL",t[t.UserAlreadyLoggedIn=-10003]="UserAlreadyLoggedIn",t[t.UpdateEmailFailed=-10004]="UpdateEmailFailed",t[t.UserRequestEditEmail=-10005]="UserRequestEditEmail",t[t.InactiveRecipient=-10010]="InactiveRecipient",t[t.AccessDeniedToUser=-10011]="AccessDeniedToUser",t[t.RedirectLoginComplete=-10015]="RedirectLoginComplete",t[t.DpopInvalidated=-10019]="DpopInvalidated",t))(qh||{}),Vi=(t=>(t.PROVIDER="magic_3pw_provider",t.ADDRESS="magic_3pw_address",t.CHAIN_ID="magic_3pw_chainId",t))(Vi||{}),WR=(t=>(t.WalletConnected="wallet_connected",t.WalletRejected="wallet_rejected",t.Web3ModalSelected="web3modal_selected",t))(WR||{}),Ve=(t=>(t.LoginWithSms="magic_auth_login_with_sms",t.LoginWithEmailOTP="magic_auth_login_with_email_otp",t.LoginWithMagicLink="magic_auth_login_with_magic_link",t.LoginWithCredential="magic_auth_login_with_credential",t.SetAuthorizationToken="magic_auth_set_authorization_token",t.GetIdToken="magic_auth_get_id_token",t.GenerateIdToken="magic_auth_generate_id_token",t.GetMetadata="magic_auth_get_metadata",t.IsLoggedIn="magic_is_logged_in",t.Logout="magic_auth_logout",t.UpdateEmail="magic_auth_update_email",t.UserSettings="magic_auth_settings",t.UserSettingsTestMode="magic_auth_settings_testing_mode",t.LoginWithSmsTestMode="magic_auth_login_with_sms_testing_mode",t.LoginWithEmailOTPTestMode="magic_auth_login_with_email_otp_testing_mode",t.LoginWithMagicLinkTestMode="magic_login_with_magic_link_testing_mode",t.LoginWithCredentialTestMode="magic_auth_login_with_credential_testing_mode",t.GetIdTokenTestMode="magic_auth_get_id_token_testing_mode",t.GenerateIdTokenTestMode="magic_auth_generate_id_token_testing_mode",t.GetMetadataTestMode="magic_auth_get_metadata_testing_mode",t.IsLoggedInTestMode="magic_auth_is_logged_in_testing_mode",t.LogoutTestMode="magic_auth_logout_testing_mode",t.UpdateEmailTestMode="magic_auth_update_email_testing_mode",t.IntermediaryEvent="magic_intermediary_event",t.RequestAccounts="eth_requestAccounts",t.GetInfo="magic_get_info",t.ShowUI="magic_wallet",t.NFTPurchase="magic_nft_purchase",t.NFTCheckout="magic_nft_checkout",t.NFTTransfer="magic_nft_transfer",t.RequestUserInfoWithUI="mc_request_user_info",t.Disconnect="mc_disconnect",t.RecoverAccount="magic_auth_recover_account",t.RecoverAccountTestMode="magic_auth_recover_account_testing_mode",t.MagicBoxHeartBeat="magic_box_heart_beat",t.AutoConnect="mc_auto_connect",t.Login="mc_login",t.EncryptV1="magic_auth_encrypt_v1",t.DecryptV1="magic_auth_decrypt_v1",t.ShowNFTs="magic_show_nfts",t.ShowOnRamp="magic_show_fiat_onramp",t.ShowSendTokensUI="magic_show_send_tokens_ui",t.ShowAddress="magic_show_address",t.ShowBalances="magic_show_balances",t.SendGaslessTransaction="eth_sendGaslessTransaction",t.RevealPK="magic_reveal_key",t.EnableMFA="magic_auth_enable_mfa_flow",t.DisableMFA="magic_auth_disable_mfa_flow",t.GetMultichainPublicAddress="magic_get_multichain_public_address",t))(Ve||{}),HR=["magic_intermediary_event","magic_nft_checkout","mc_login"],Zi=(t=>(t.MAGIC_HANDLE_RESPONSE="MAGIC_HANDLE_RESPONSE",t.MAGIC_OVERLAY_READY="MAGIC_OVERLAY_READY",t.MAGIC_SHOW_OVERLAY="MAGIC_SHOW_OVERLAY",t.MAGIC_HIDE_OVERLAY="MAGIC_HIDE_OVERLAY",t.MAGIC_HANDLE_EVENT="MAGIC_HANDLE_EVENT",t.MAGIC_MG_BOX_SEND_RECEIPT="MAGIC_MG_BOX_SEND_RECEIPT",t.MAGIC_SEND_PRODUCT_ANNOUNCEMENT="MAGIC_SEND_PRODUCT_ANNOUNCEMENT",t.MAGIC_PONG="MAGIC_PONG",t.MAGIC_POPUP_RESPONSE="MAGIC_POPUP_RESPONSE",t.MAGIC_POPUP_OAUTH_VERIFY_RESPONSE="MAGIC_POPUP_OAUTH_VERIFY_RESPONSE",t))(Zi||{}),Ul=(t=>(t.MAGIC_HANDLE_REQUEST="MAGIC_HANDLE_REQUEST",t.MAGIC_PING="MAGIC_PING",t))(Ul||{}),zR=(t=>(t.UpdateEmail="update-email",t.MFA="mfa",t.Recovery="recovery",t))(zR||{}),qR=(t=>(t.Retry="retry",t))(qR||{}),VR=(t=>(t.EmailSent="email-sent",t.EmailNotDeliverable="email-not-deliverable",t))(VR||{}),rs=(t=>(t.VerifyEmailOtp="verify-email-otp",t.VerifyMFACode="verify-mfa-code",t.LostDevice="lost-device",t.VerifyRecoveryCode="verify-recovery-code",t.Cancel="cancel",t))(rs||{}),ul=(t=>(t.VerifySmsOtp="verify-sms-otp",t.Cancel="cancel",t.Retry="retry",t))(ul||{}),KR=(t=>(t.SmsOTPSent="sms-otp-sent",t.InvalidSmsOtp="invalid-sms-otp",t.ExpiredSmsOtp="expired-sms-otp",t))(KR||{}),GR=(t=>(t.EmailOTPSent="email-otp-sent",t.InvalidEmailOtp="invalid-email-otp",t.InvalidMfaOtp="invalid-mfa-otp",t.ExpiredEmailOtp="expired-email-otp",t.MfaSentHandle="mfa-sent-handle",t.RecoveryCodeSentHandle="recovery-code-sent-handle",t.InvalidRecoveryCode="invalid-recovery-code",t.RecoveryCodeSuccess="recovery-code-success",t.LoginThrottled="login-throttled",t))(GR||{}),Eg=(t=>(t.Retry="device-retry",t))(Eg||{}),YR=(t=>(t.DeviceApproved="device-approved",t.DeviceNeedsApproval="device-needs-approval",t.DeviceVerificationLinkExpired="device-verification-link-expired",t.DeviceVerificationEmailSent="device-verification-email-sent",t))(YR||{}),as=(t=>(t.Retry="Recency/auth-factor-retry",t.Cancel="Recency/auth-factor-verification-cancel",t.VerifyEmailOtp="Recency/auth-factor-verify-email-otp",t.VerifyMFACode="Recency/verify-mfa-code",t))(as||{}),JR=(t=>(t.PrimaryAuthFactorNeedsVerification="Recency/auth-factor-needs-verification",t.PrimaryAuthFactorVerified="Recency/auth-factor-verified",t.InvalidEmailOtp="Recency/auth-factor-invalid-email-otp",t.EmailExpired="Recency/auth-factor-verification-email-expired",t.EmailSent="Recency/auth-factor-verification-email-sent",t.EmailNotDeliverable="Recency/auth-factor-verification-email-not-deliverable",t))(JR||{}),xr=(t=>(t.RetryWithNewEmail="UpdateEmail/retry-with-new-email",t.Cancel="UpdateEmail/new-email-verification-cancel",t.VerifyEmailOtp="UpdateEmail/new-email-verify-otp",t))(xr||{}),ZR=(t=>(t.NewAuthFactorNeedsVerification="UpdateEmail/new-email-needs-verification",t.EmailUpdated="UpdateEmail/email-updated",t.InvalidEmailOtp="UpdateEmail/new-email-invalid-email-otp",t.EmailExpired="UpdateEmail/new-email-verification-email-expired",t.EmailSent="UpdateEmail/new-email-verification-email-sent",t.EmailNotDeliverable="UpdateEmail/new-email-verification-email-not-deliverable",t.InvalidEmail="UpdateEmail/new-email-invalid",t.EmailAlreadyExists="UpdateEmail/new-email-already-exists",t))(ZR||{}),XR=(t=>(t.IDTokenCreated="Auth/id-token-created",t))(XR||{}),QR=(t=>(t.Cancel="Farcaster/cancel",t))(QR||{}),eP=(t=>(t.MFASecretGenerated="mfa-secret-generated",t.InvalidMFAOtp="invalid-mfa-otp",t.MFARecoveryCodes="mfa-recovery-codes",t))(eP||{}),dl=(t=>(t.VerifyMFACode="verify-mfa-code",t.Cancel="cancel-mfa-setup",t))(dl||{}),tP=(t=>(t.MFACodeRequested="mfa-code-requested",t.InvalidMFAOtp="invalid-mfa-otp",t.InvalidRecoveryCode="invalid-recovery-code",t))(tP||{}),Wo=(t=>(t.VerifyMFACode="verify-mfa-code",t.LostDevice="lost-device",t.Cancel="cancel-mfa-disable",t))(Wo||{}),nP=(t=>(t.Harmony="HARMONY",t))(nP||{}),CC=(t=>(t.ClosedByUser="closed-by-user",t))(CC||{}),AC=(t=>(t.ClosedByUser="closed-by-user-on-received",t))(AC||{}),rP=(t=>(t.EnterNewPhoneNumber="enter-new-phone-number",t.EnterOtpCode="enter-otp-code",t.RecoveryFactorAlreadyExists="recovery-factor-already-exists",t.MalformedPhoneNumber="malformed-phone-number",t.InvalidOtpCode="invalid-otp-code",t.RecoveryFactorUpdated="recovery-factor-updated",t.RecoveryFactorDeleted="recovery-factor-deleted",t))(rP||{}),Qs=(t=>(t.SendNewPhoneNumber="send-new-phone-number",t.SendOtpCode="send-otp-code",t.Cancel="cancel",t.StartEditPhoneNumber="start-edit-phone-number",t))(Qs||{}),sP=(t=>(t.PhoneNumber="phone_number",t))(sP||{}),iP=(t=>(t.SmsOtpSent="sms-otp-sent",t.LoginThrottled="login-throttled",t.InvalidSmsOtp="invalid-sms-otp",t.SmsVerified="sms-verified",t.AccountRecovered="account-recovered",t.UpdateEmailRequired="update-email-required",t))(iP||{}),ei=(t=>(t.Cancel="cancel",t.VerifyOtp="verify-otp-code",t.ResendSms="resend-sms-otp",t.UpdateEmail="update-email",t))(ei||{}),hl=(t=>(t.Success="nft-checkout-success",t.Failure="nft-checkout-failure",t.Initiated="nft-checkout-initiated",t.Disconnect="disconnect",t))(hl||{}),oP=(t=>(t.WalletInfoFetched="Wallet/wallet-info-fetched",t))(oP||{}),aP=(t=>(t.CloseMagicWindow="close-magic-window",t))(aP||{}),cP=(t=>(t.PopupUrl="popup-url",t))(cP||{}),lP=(t=>(t.PopupEvent="popup-event",t.Cancel="cancel",t))(lP||{}),Jf={},uP=Object.create,Hm=Object.defineProperty,dP=Object.getOwnPropertyDescriptor,hP=Object.getOwnPropertyNames,fP=Object.getPrototypeOf,pP=Object.prototype.hasOwnProperty,gP=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),mP=(t,e)=>{for(var n in e)Hm(t,n,{get:e[n],enumerable:!0})},yP=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of hP(e))!pP.call(t,s)&&s!==n&&Hm(t,s,{get:()=>e[s],enumerable:!(r=dP(e,s))||r.enumerable});return t},wP=(t,e,n)=>(n=t!=null?uP(fP(t)):{},yP(!t||!t.__esModule?Hm(n,"default",{value:t,enumerable:!0}):n,t)),EP=gP((t,e)=>{var n=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function i(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function o(l,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,h||l,f),m=r?r+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],p]:l._events[m].push(p):(l._events[m]=p,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new s:delete l._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)n.call(u,d)&&l.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},c.prototype.listeners=function(l){var u=r?r+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},c.prototype.listenerCount=function(l){var u=r?r+l:l,d=this._events[u];return d?d.fn?1:d.length:0},c.prototype.emit=function(l,u,d,h,f,p){var m=r?r+l:l;if(!this._events[m])return!1;var g=this._events[m],T=arguments.length,N,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),T){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,h),!0;case 5:return g.fn.call(g.context,u,d,h,f),!0;case 6:return g.fn.call(g.context,u,d,h,f,p),!0}for(_=1,N=new Array(T-1);_<T;_++)N[_-1]=arguments[_];g.fn.apply(g.context,N)}else{var O=g.length,A;for(_=0;_<O;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),T){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,d);break;case 4:g[_].fn.call(g[_].context,u,d,h);break;default:if(!N)for(A=1,N=new Array(T-1);A<T;A++)N[A-1]=arguments[A];g[_].fn.apply(g[_].context,N)}}return!0},c.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},c.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},c.prototype.removeListener=function(l,u,d,h){var f=r?r+l:l;if(!this._events[f])return this;if(!u)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&a(this,f);else{for(var m=0,g=[],T=p.length;m<T;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:a(this,f)}return this},c.prototype.removeAllListeners=function(l){var u;return l?(u=r?r+l:l,this._events[u]&&a(this,u)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,typeof e<"u"&&(e.exports=c)});function bP(t){let e={exports:{}};return t(e,e.exports),e.exports}var vP=Number.MAX_SAFE_INTEGER||9007199254740991,zm={MAX_LENGTH:256,MAX_SAFE_INTEGER:vP,MAX_SAFE_COMPONENT_LENGTH:16},_P=typeof Ft=="object"&&Jf&&Jf.NODE_DEBUG&&/\bsemver\b/i.test(Jf.NODE_DEBUG)?(...t)=>{}:()=>{},Nt=_P,fu=bP(function(t,e){let{MAX_SAFE_COMPONENT_LENGTH:n}=zm,r=(e=t.exports={}).re=[],s=e.src=[],i=e.t={},o=0,a=(c,l,u)=>{let d=o++;Nt(d,l),i[c]=d,s[d]=l,r[d]=new RegExp(l,u?"g":void 0)};a("NUMERICIDENTIFIER","0|[1-9]\\d*"),a("NUMERICIDENTIFIERLOOSE","[0-9]+"),a("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),a("MAINVERSION",`(${s[i.NUMERICIDENTIFIER]})\\.(${s[i.NUMERICIDENTIFIER]})\\.(${s[i.NUMERICIDENTIFIER]})`),a("MAINVERSIONLOOSE",`(${s[i.NUMERICIDENTIFIERLOOSE]})\\.(${s[i.NUMERICIDENTIFIERLOOSE]})\\.(${s[i.NUMERICIDENTIFIERLOOSE]})`),a("PRERELEASEIDENTIFIER",`(?:${s[i.NUMERICIDENTIFIER]}|${s[i.NONNUMERICIDENTIFIER]})`),a("PRERELEASEIDENTIFIERLOOSE",`(?:${s[i.NUMERICIDENTIFIERLOOSE]}|${s[i.NONNUMERICIDENTIFIER]})`),a("PRERELEASE",`(?:-(${s[i.PRERELEASEIDENTIFIER]}(?:\\.${s[i.PRERELEASEIDENTIFIER]})*))`),a("PRERELEASELOOSE",`(?:-?(${s[i.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[i.PRERELEASEIDENTIFIERLOOSE]})*))`),a("BUILDIDENTIFIER","[0-9A-Za-z-]+"),a("BUILD",`(?:\\+(${s[i.BUILDIDENTIFIER]}(?:\\.${s[i.BUILDIDENTIFIER]})*))`),a("FULLPLAIN",`v?${s[i.MAINVERSION]}${s[i.PRERELEASE]}?${s[i.BUILD]}?`),a("FULL",`^${s[i.FULLPLAIN]}$`),a("LOOSEPLAIN",`[v=\\s]*${s[i.MAINVERSIONLOOSE]}${s[i.PRERELEASELOOSE]}?${s[i.BUILD]}?`),a("LOOSE",`^${s[i.LOOSEPLAIN]}$`),a("GTLT","((?:<|>)?=?)"),a("XRANGEIDENTIFIERLOOSE",`${s[i.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),a("XRANGEIDENTIFIER",`${s[i.NUMERICIDENTIFIER]}|x|X|\\*`),a("XRANGEPLAIN",`[v=\\s]*(${s[i.XRANGEIDENTIFIER]})(?:\\.(${s[i.XRANGEIDENTIFIER]})(?:\\.(${s[i.XRANGEIDENTIFIER]})(?:${s[i.PRERELEASE]})?${s[i.BUILD]}?)?)?`),a("XRANGEPLAINLOOSE",`[v=\\s]*(${s[i.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[i.XRANGEIDENTIFIERLOOSE]})(?:${s[i.PRERELEASELOOSE]})?${s[i.BUILD]}?)?)?`),a("XRANGE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAIN]}$`),a("XRANGELOOSE",`^${s[i.GTLT]}\\s*${s[i.XRANGEPLAINLOOSE]}$`),a("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),a("COERCERTL",s[i.COERCE],!0),a("LONETILDE","(?:~>?)"),a("TILDETRIM",`(\\s*)${s[i.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",a("TILDE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAIN]}$`),a("TILDELOOSE",`^${s[i.LONETILDE]}${s[i.XRANGEPLAINLOOSE]}$`),a("LONECARET","(?:\\^)"),a("CARETTRIM",`(\\s*)${s[i.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",a("CARET",`^${s[i.LONECARET]}${s[i.XRANGEPLAIN]}$`),a("CARETLOOSE",`^${s[i.LONECARET]}${s[i.XRANGEPLAINLOOSE]}$`),a("COMPARATORLOOSE",`^${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]})$|^$`),a("COMPARATOR",`^${s[i.GTLT]}\\s*(${s[i.FULLPLAIN]})$|^$`),a("COMPARATORTRIM",`(\\s*)${s[i.GTLT]}\\s*(${s[i.LOOSEPLAIN]}|${s[i.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",a("HYPHENRANGE",`^\\s*(${s[i.XRANGEPLAIN]})\\s+-\\s+(${s[i.XRANGEPLAIN]})\\s*$`),a("HYPHENRANGELOOSE",`^\\s*(${s[i.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[i.XRANGEPLAINLOOSE]})\\s*$`),a("STAR","(<|>)?=?\\s*\\*"),a("GTE0","^\\s*>=\\s*0.0.0\\s*$"),a("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),Lw=/^[0-9]+$/,CP=(t,e)=>{let n=Lw.test(t),r=Lw.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},AP={compareIdentifiers:CP},{MAX_LENGTH:$w,MAX_SAFE_INTEGER:Wu}=zm,{re:Bw,t:Fw}=fu,{compareIdentifiers:Wc}=AP,go=class Ts{constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof Ts){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>$w)throw new TypeError(`version is longer than ${$w} characters`);Nt("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let r=e.trim().match(n.loose?Bw[Fw.LOOSE]:Bw[Fw.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Wu||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Wu||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Wu||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<Wu)return i}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Nt("SemVer.compare",this.version,this.options,e),!(e instanceof Ts)){if(typeof e=="string"&&e===this.version)return 0;e=new Ts(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ts||(e=new Ts(e,this.options)),Wc(this.major,e.major)||Wc(this.minor,e.minor)||Wc(this.patch,e.patch)}comparePre(e){if(e instanceof Ts||(e=new Ts(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{let r=this.prerelease[n],s=e.prerelease[n];if(Nt("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return Wc(r,s)}while(++n)}compareBuild(e){e instanceof Ts||(e=new Ts(e,this.options));let n=0;do{let r=this.build[n],s=e.build[n];if(Nt("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return Wc(r,s)}while(++n)}inc(e,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}},IP=(t,e,n)=>new go(t,n).compare(new go(e,n)),Rc=IP,SP=(t,e,n)=>Rc(t,e,n)===0,TP=SP,NP=(t,e,n)=>Rc(t,e,n)!==0,OP=NP,RP=(t,e,n)=>Rc(t,e,n)>0,PP=RP,xP=(t,e,n)=>Rc(t,e,n)>=0,kP=xP,DP=(t,e,n)=>Rc(t,e,n)<0,UP=DP,MP=(t,e,n)=>Rc(t,e,n)<=0,LP=MP,$P=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return TP(t,n,r);case"!=":return OP(t,n,r);case">":return PP(t,n,r);case">=":return kP(t,n,r);case"<":return UP(t,n,r);case"<=":return LP(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}},Zf=$P,Hc=Symbol("SemVer ANY"),bg=class vg{static get ANY(){return Hc}constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof vg){if(e.loose===!!n.loose)return e;e=e.value}Nt("comparator",e,n),this.options=n,this.loose=!!n.loose,this.parse(e),this.semver===Hc?this.value="":this.value=this.operator+this.semver.version,Nt("comp",this)}parse(e){let n=this.options.loose?jw[Ww.COMPARATORLOOSE]:jw[Ww.COMPARATOR],r=e.match(n);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new go(r[2],this.options.loose):this.semver=Hc}toString(){return this.value}test(e){if(Nt("Comparator.test",e,this.options.loose),this.semver===Hc||e===Hc)return!0;if(typeof e=="string")try{e=new go(e,this.options)}catch{return!1}return Zf(e,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof vg))throw new TypeError("a Comparator is required");if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""||new _g(e.value,n).test(this.value);if(e.operator==="")return e.value===""||new _g(this.value,n).test(e.semver);let r=!(this.operator!==">="&&this.operator!==">"||e.operator!==">="&&e.operator!==">"),s=!(this.operator!=="<="&&this.operator!=="<"||e.operator!=="<="&&e.operator!=="<"),i=this.semver.version===e.semver.version,o=!(this.operator!==">="&&this.operator!=="<="||e.operator!==">="&&e.operator!=="<="),a=Zf(this.semver,"<",e.semver,n)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=Zf(this.semver,">",e.semver,n)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||s||i&&o||a||c}},{re:jw,t:Ww}=fu,_g=class xd{constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof xd)return e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease?e:new xd(e.raw,n);if(e instanceof bg)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let{loose:n}=this.options;e=e.trim();let r=n?Yn[Dn.HYPHENRANGELOOSE]:Yn[Dn.HYPHENRANGE];e=e.replace(r,ZP(this.options.includePrerelease)),Nt("hyphen replace",e),e=e.replace(Yn[Dn.COMPARATORTRIM],BP),Nt("comparator trim",e,Yn[Dn.COMPARATORTRIM]),e=(e=(e=e.replace(Yn[Dn.TILDETRIM],FP)).replace(Yn[Dn.CARETTRIM],jP)).split(/\s+/).join(" ");let s=n?Yn[Dn.COMPARATORLOOSE]:Yn[Dn.COMPARATOR];return e.split(" ").map(i=>WP(i,this.options)).join(" ").split(/\s+/).map(i=>JP(i,this.options)).filter(this.options.loose?i=>!!i.match(s):()=>!0).map(i=>new bg(i,this.options))}intersects(e,n){if(!(e instanceof xd))throw new TypeError("a Range is required");return this.set.some(r=>Hw(r,n)&&e.set.some(s=>Hw(s,n)&&r.every(i=>s.every(o=>i.intersects(o,n)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new go(e,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(XP(this.set[n],e,this.options))return!0;return!1}},{re:Yn,t:Dn,comparatorTrimReplace:BP,tildeTrimReplace:FP,caretTrimReplace:jP}=fu,Hw=(t,e)=>{let n=!0,r=t.slice(),s=r.pop();for(;n&&r.length;)n=r.every(i=>s.intersects(i,e)),s=r.pop();return n},WP=(t,e)=>(Nt("comp",t,e),t=qP(t,e),Nt("caret",t),t=HP(t,e),Nt("tildes",t),t=KP(t,e),Nt("xrange",t),t=YP(t,e),Nt("stars",t),t),rr=t=>!t||t.toLowerCase()==="x"||t==="*",HP=(t,e)=>t.trim().split(/\s+/).map(n=>zP(n,e)).join(" "),zP=(t,e)=>{let n=e.loose?Yn[Dn.TILDELOOSE]:Yn[Dn.TILDE];return t.replace(n,(r,s,i,o,a)=>{let c;return Nt("tilde",t,r,s,i,o,a),rr(s)?c="":rr(i)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:rr(o)?c=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:a?(Nt("replaceTilde pr",a),c=`>=${s}.${i}.${o}-${a} <${s}.${+i+1}.0-0`):c=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,Nt("tilde return",c),c})},qP=(t,e)=>t.trim().split(/\s+/).map(n=>VP(n,e)).join(" "),VP=(t,e)=>{Nt("caret",t,e);let n=e.loose?Yn[Dn.CARETLOOSE]:Yn[Dn.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,(s,i,o,a,c)=>{let l;return Nt("caret",t,s,i,o,a,c),rr(i)?l="":rr(o)?l=`>=${i}.0.0${r} <${+i+1}.0.0-0`:rr(a)?l=i==="0"?`>=${i}.${o}.0${r} <${i}.${+o+1}.0-0`:`>=${i}.${o}.0${r} <${+i+1}.0.0-0`:c?(Nt("replaceCaret pr",c),l=i==="0"?o==="0"?`>=${i}.${o}.${a}-${c} <${i}.${o}.${+a+1}-0`:`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`:`>=${i}.${o}.${a}-${c} <${+i+1}.0.0-0`):(Nt("no pr"),l=i==="0"?o==="0"?`>=${i}.${o}.${a}${r} <${i}.${o}.${+a+1}-0`:`>=${i}.${o}.${a}${r} <${i}.${+o+1}.0-0`:`>=${i}.${o}.${a} <${+i+1}.0.0-0`),Nt("caret return",l),l})},KP=(t,e)=>(Nt("replaceXRanges",t,e),t.split(/\s+/).map(n=>GP(n,e)).join(" ")),GP=(t,e)=>{t=t.trim();let n=e.loose?Yn[Dn.XRANGELOOSE]:Yn[Dn.XRANGE];return t.replace(n,(r,s,i,o,a,c)=>{Nt("xRange",t,r,s,i,o,a,c);let l=rr(i),u=l||rr(o),d=u||rr(a),h=d;return s==="="&&h&&(s=""),c=e.includePrerelease?"-0":"",l?r=s===">"||s==="<"?"<0.0.0-0":"*":s&&h?(u&&(o=0),a=0,s===">"?(s=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):s==="<="&&(s="<",u?i=+i+1:o=+o+1),s==="<"&&(c="-0"),r=`${s+i}.${o}.${a}${c}`):u?r=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(r=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),Nt("xRange return",r),r})},YP=(t,e)=>(Nt("replaceStars",t,e),t.trim().replace(Yn[Dn.STAR],"")),JP=(t,e)=>(Nt("replaceGTE0",t,e),t.trim().replace(Yn[e.includePrerelease?Dn.GTE0PRE:Dn.GTE0],"")),ZP=t=>(e,n,r,s,i,o,a,c,l,u,d,h,f)=>`${n=rr(r)?"":rr(s)?`>=${r}.0.0${t?"-0":""}`:rr(i)?`>=${r}.${s}.0${t?"-0":""}`:o?`>=${n}`:`>=${n}${t?"-0":""}`} ${c=rr(l)?"":rr(u)?`<${+l+1}.0.0-0`:rr(d)?`<${l}.${+u+1}.0-0`:h?`<=${l}.${u}.${d}-${h}`:t?`<${l}.${u}.${+d+1}-0`:`<=${c}`}`.trim(),XP=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let r=0;r<t.length;r++)if(Nt(t[r].semver),t[r].semver!==bg.ANY&&t[r].semver.prerelease.length>0){let s=t[r].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0},QP=(t,e,n)=>{try{e=new _g(e,n)}catch{return!1}return e.test(t)},{MAX_LENGTH:ex}=zm,{re:zw,t:qw}=fu,tx=(t,e)=>{if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof go)return t;if(typeof t!="string"||t.length>ex||!(e.loose?zw[qw.LOOSE]:zw[qw.FULL]).test(t))return null;try{return new go(t,e)}catch{return null}},nx=tx,{re:Hu,t:zu}=fu,rx=(t,e)=>{if(t instanceof go)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;let n=null;if((e=e||{}).rtl){let r;for(;(r=Hu[zu.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),Hu[zu.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;Hu[zu.COERCERTL].lastIndex=-1}else n=t.match(Hu[zu.COERCE]);return n===null?null:nx(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,e)};function sx(t){return String.fromCharCode(parseInt(t.slice(1),16))}function ix(t){return`%${`00${t.charCodeAt(0).toString(16)}`.slice(-2)}`}function ox(t){return btoa(encodeURIComponent(t).replace(/%[0-9A-F]{2}/g,sx))}function ax(t){return decodeURIComponent(Array.from(atob(t),ix).join(""))}function IC(t){return ox(JSON.stringify(t))}function cx(t){return JSON.parse(ax(t))}function fl(t){return typeof t>"u"}function lx(t){return t===null}function SC(t){return lx(t)||fl(t)}function ux(t){return SC(t)?!1:!fl(t.jsonrpc)&&!fl(t.id)&&(!fl(t.result)||!fl(t.error))}function dx(t){return SC(t)?!1:typeof t=="number"&&Object.values(qh).includes(t)}function th(t){if(!t)return!0;for(let e in t)if(Object.hasOwnProperty.call(t,e))return!1;return!0}var Lt={};function hx(t,e){return Object.assign(Lt,e),t}var fx={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn","@magic-sdk/react-native-bare":"magic-sdk-rn-bare","@magic-sdk/react-native-expo":"magic-sdk-rn-expo"},Pc=class TC extends Error{constructor(e,n){super(`Magic SDK Error: [${e}] ${n}`),this.code=e,this.rawMessage=n,Object.setPrototypeOf(this,TC.prototype)}__proto__=Error},Cg=class NC extends Error{__proto__=Error;code;rawMessage;data;constructor(e){super();let n=Number(e?.code);this.rawMessage=e?.message||"Internal error",this.code=dx(n)?n:qh.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,this.data=e?.data||void 0,Object.setPrototypeOf(this,NC.prototype)}},pu=class{constructor(e,n){this.code=e,this.rawMessage=n,this.message=`Magic SDK Warning: [${e}] ${n}`}message;log(){}},px=class OC extends Error{constructor(e,n,r,s){super(`Magic Extension Error (${e.name}): [${n}] ${r}`),this.code=n,this.rawMessage=r,this.data=s,Object.setPrototypeOf(this,OC.prototype)}__proto__=Error},Vw=class{constructor(e,n,r){this.code=n,this.rawMessage=r,this.message=`Magic Extension Warning (${e.name}): [${n}] ${r}`}message;log(){}};function gx(){return new Pc(ba.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function RC(){return new Pc(ba.ModalNotReady,"Modal is not ready")}function mx(){return new Pc(ba.MalformedResponse,"Response from the Magic iframe is malformed.")}function yx(t){return new Pc(ba.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${t}\` can be accessed. Do not invoke \`Extension.${t}\` inside an extension constructor.`)}function wx(t){let e=`Some extensions are incompatible with \`${Lt.sdkName}@${Lt.version}\`:`;return t.filter(n=>typeof n.compat<"u"&&n.compat!==null).forEach(n=>{let r=n.compat[Lt.sdkName];typeof r=="string"?e+=`
  - Extension \`${n.name}\` supports version(s) \`${r}\``:r||(e+=`
  - Extension \`${n.name}\` does not support ${Lt.platform} environments.`)}),new Pc(ba.IncompatibleExtensions,e)}function Ex(t){let e=n=>{let r=n+1,s=r%10,i=r%100;return s===1&&i!==11?`${r}st`:s===2&&i!==12?`${r}nd`:s===3&&i!==13?`${r}rd`:`${r}th`};return new Pc(ba.InvalidArgument,`Invalid ${e(t.argument)} argument given to \`${t.procedure}\`.
  Expected: \`${t.expected}\`
  Received: \`${t.received}\``)}function bx(){return new pu(Oc.DuplicateIframe,"Duplicate iframes found.")}function vx(){return new pu(Oc.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function _x(){return new pu(Oc.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${Lt.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function Cx(t){let{method:e,removalVersions:n,useInstead:r}=t,s=n[Lt.sdkName],i=r?` Use \`${r}\` instead.`:"",o=`\`${e}\` will be removed from \`${Lt.sdkName}\` in version \`${s}\`.${i}`;return new pu(Oc.DeprecationNotice,o)}function*Ax(){let t=0;for(;;)t<Number.MAX_SAFE_INTEGER?yield++t:t=0}var Ix=Ax();function PC(){return Ix.next().value}var xC={};mP(xC,{clear:()=>Sx,getItem:()=>Gr,iterate:()=>kC,key:()=>Nx,keys:()=>Ox,length:()=>Tx,removeItem:()=>mc,setItem:()=>lo});var qu;function Co(t){return async(...e)=>(qu||(qu=await Lt.configureStorage()),await qu.ready(),qu[t](...e))}var Gr=Co("getItem"),lo=Co("setItem"),mc=Co("removeItem"),Sx=Co("clear"),Tx=Co("length"),Nx=Co("key"),Ox=Co("keys"),kC=Co("iterate");function Rx(){let t=window.crypto.getRandomValues(new Uint8Array(16));t[6]=t[6]&15|64,t[8]=t[8]&191|128;let e="";return e+=t[0].toString(16),e+=t[1].toString(16),e+=t[2].toString(16),e+=t[3].toString(16),e+="-",e+=t[4].toString(16),e+=t[5].toString(16),e+="-",e+=t[6].toString(16),e+=t[7].toString(16),e+="-",e+=t[8].toString(16),e+=t[9].toString(16),e+="-",e+=t[10].toString(16),e+=t[11].toString(16),e+=t[12].toString(16),e+=t[13].toString(16),e+=t[14].toString(16),e+=t[15].toString(16),e}var qm="STORE_KEY_PRIVATE_KEY",nh="STORE_KEY_PUBLIC_JWK",DC="ECDSA",Px="P-256",xx={name:DC,namedCurve:Px};function Vh(){let t=typeof window<"u"&&!!window.crypto,e=t&&!!window.crypto.subtle;return t&&e}function kx(){mc(nh),mc(qm)}async function Dx(){let t=await Ux();if(!t)return;let{subtle:e}=window.crypto,n=await Gr(qm);if(!n||!e)return;let r={iat:Math.floor(new Date().getTime()/1e3),jti:Rx()},s={protected:Kw(JSON.stringify({typ:"dpop+jwt",alg:"ES256",jwk:t})),claims:Kw(JSON.stringify(r))},i=Lx(`${s.protected}.${s.claims}`),o={name:DC,hash:{name:"SHA-256"}},a=Bx(new Uint8Array(await e.sign(o,n,i)));return`${s.protected}.${s.claims}.${a}`}async function Ux(){if(Vh())return await Gr(nh)||await Mx(),Gr(nh)}async function Mx(){let{subtle:t}=window.crypto,e=await t.generateKey(xx,!1,["sign"]),n=await t.exportKey("jwk",e.publicKey);await lo(qm,e.privateKey),await lo(nh,n)}function Kw(t){return UC($x(t))}function Lx(t){return new TextEncoder().encode(t)}function UC(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function $x(t){return encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(e,n)=>String.fromCharCode(parseInt(n,16)))}function Bx(t){let e="";return t.forEach(n=>{e+=String.fromCharCode(n)}),UC(e)}var MC=Symbol("Payload pre-processed by Magic SDK");function LC(t){return Object.defineProperty(t,MC,{value:!0,enumerable:!1}),t}function Fx(t){return!!t[MC]}function rh(t){return Fx(t)||(t.jsonrpc=t.jsonrpc??"2.0",t.id=PC(),t.method=t.method??"noop",t.params=t.params??[],LC(t)),t}function vt(t,e=[]){return LC({params:e,method:t,jsonrpc:"2.0",id:PC()})}var $C=class BC{_jsonrpc;_id;_result;_error;constructor(e){e instanceof BC?(this._jsonrpc=e.payload.jsonrpc,this._id=e.payload.id,this._result=e.payload.result,this._error=e.payload.error):ux(e)?(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=e.result,this._error=e.error):(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=void 0,this._error=void 0)}applyError(e){return this._error=e,this}applyResult(e){return this._result=e,this}get hasError(){return this._error?.code===qh.DpopInvalidated&&kx(),typeof this._error<"u"&&this._error!==null}get hasResult(){return typeof this._result<"u"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}},jx=wP(EP()),Wx=class extends jx.default{};function FC(){let t=new Wx;return{emitter:t,createChainingEmitterMethod:(e,n)=>(...r)=>(t[e].apply(t,r),n),createBoundEmitterMethod:e=>(...n)=>t[e].apply(t,n)}}var jC=Symbol("isPromiEvent");function Hx(t){return!!t[jC]}function ds(t){let e=WC(t),{createBoundEmitterMethod:n,createChainingEmitterMethod:r}=FC(),s=Symbol("Promise.then"),i=Symbol("Promise.catch"),o=Symbol("Promise.finally"),a=(u,d)=>(...h)=>{let f=d[u].apply(d,h);return c(f)},c=u=>Object.assign(u,{[jC]:!0,[s]:u[s]||u.then,[i]:u[i]||u.catch,[o]:u[o]||u.finally,then:a(s,u),catch:a(i,u),finally:a(o,u),on:r("on",u),once:r("once",u),addListener:r("addListener",u),off:r("off",u),removeListener:r("removeListener",u),removeAllListeners:r("removeAllListeners",u),emit:n("emit"),eventNames:n("eventNames"),listeners:n("listeners"),listenerCount:n("listenerCount")}),l=c(e.then(u=>(l.emit("done",u),l.emit("settled"),u),u=>{throw l.emit("error",u),l.emit("settled"),u}));return l.on(AC.ClosedByUser,()=>{l.emit(CC.ClosedByUser)}),l}function WC(t){return new Promise((e,n)=>{let r=t(e,n);Promise.resolve(r).catch(n)})}var Ao=class{constructor(e){this.sdk=e}get overlay(){return this.sdk.overlay}request(e){if(this.sdk.thirdPartyWallets.isConnected&&!HR.includes(e.method))return ds((i,o)=>{this.sdk.thirdPartyWallets.requestOverride(e).then(i).catch(o)});let n=this.overlay.post(Ul.MAGIC_HANDLE_REQUEST,rh(e)),r=ds((i,o)=>{n.then(a=>{if(s(),a.hasError)o(new Cg(a.payload.error));else if(a.hasResult)i(a.payload.result);else throw mx()}).catch(a=>{s(),o(a)})}),s=this.overlay.on(Zi.MAGIC_HANDLE_EVENT,i=>{let{response:o}=i.data;if(o.id===e.id&&o.result?.event){let{event:a,params:c=[]}=o.result;r.emit(a,...c)}});return r}createIntermediaryEvent(e,n){return r=>{let s=vt(Ve.IntermediaryEvent,[{payloadId:n,eventType:e,args:r}]);this.request(s)}}};function zx(t,e){let[n]=t.split(".").map(Number);return n>=e}var qx={"magic-sdk":"v18.0.0","@magic-sdk/react-native":"v14.0.0","@magic-sdk/react-native-bare":"v19.0.0","@magic-sdk/react-native-expo":"v19.0.0"},Vx=class extends Ao{loginWithMagicLink(e){let n=Lt.sdkName==="@magic-sdk/react-native"||Lt.sdkName==="@magic-sdk/react-native-bare"||Lt.sdkName==="@magic-sdk/react-native-expo";if(n&&zx(Lt.version,19))throw new Error("loginWithMagicLink() is deprecated for this package, please utilize a passcode method like loginWithSMS or loginWithEmailOTP instead.");n&&Cx({method:"auth.loginWithMagicLink()",removalVersions:qx,useInstead:"auth.loginWithEmailOTP()"}).log();let{email:r,showUI:s=!0,redirectURI:i,overrides:o,lifespan:a}=e,c=vt(this.sdk.testMode?Ve.LoginWithMagicLinkTestMode:Ve.LoginWithMagicLink,[{email:r,showUI:s,redirectURI:i,overrides:o,lifespan:a}]);return this.request(c)}loginWithSMS(e){let{phoneNumber:n,showUI:r=!0,lifespan:s}=e,i=vt(this.sdk.testMode?Ve.LoginWithSmsTestMode:Ve.LoginWithSms,[{phoneNumber:n,showUI:r,lifespan:s}]),o=this.request(i);return!r&&o&&(o.on(ul.VerifySmsOtp,a=>{this.createIntermediaryEvent(ul.VerifySmsOtp,i.id)(a)}),o.on(ul.Cancel,()=>{this.createIntermediaryEvent(ul.Cancel,i.id)()})),o}loginWithEmailOTP(e){let{email:n,showUI:r,deviceCheckUI:s,overrides:i,lifespan:o}=e,a=vt(this.sdk.testMode?Ve.LoginWithEmailOTPTestMode:Ve.LoginWithEmailOTP,[{email:n,showUI:r,deviceCheckUI:s,overrides:i,lifespan:o}]),c=this.request(a);return!s&&c&&c.on(Eg.Retry,()=>{this.createIntermediaryEvent(Eg.Retry,a.id)()}),!r&&c&&(c.on(rs.VerifyEmailOtp,l=>{this.createIntermediaryEvent(rs.VerifyEmailOtp,a.id)(l)}),c.on(rs.VerifyMFACode,l=>{this.createIntermediaryEvent(rs.VerifyMFACode,a.id)(l)}),c.on(rs.LostDevice,()=>{this.createIntermediaryEvent(rs.LostDevice,a.id)()}),c.on(rs.VerifyRecoveryCode,l=>{this.createIntermediaryEvent(rs.VerifyRecoveryCode,a.id)(l)}),c.on(rs.Cancel,()=>{this.createIntermediaryEvent(rs.Cancel,a.id)()})),c}loginWithCredential(e){let{credentialOrQueryString:n,lifespan:r}=e||{},s=n??"";if(!n&&Lt.platform==="web"){s=window.location.search;let o=window.location.origin+window.location.pathname;window.history.replaceState(null,"",o)}let i=vt(this.sdk.testMode?Ve.LoginWithCredentialTestMode:Ve.LoginWithCredential,[s,r]);return this.request(i)}setAuthorizationToken(e){let n=vt(Ve.SetAuthorizationToken,[{jwt:e}]);return this.request(n)}updateEmailWithUI(e){let{email:n,showUI:r=!0}=e,s=vt(this.sdk.testMode?Ve.UpdateEmailTestMode:Ve.UpdateEmail,[{email:n,showUI:r}]),i=this.request(s);return r||(i.on(as.Retry,()=>{this.createIntermediaryEvent(as.Retry,s.id)()}),i.on(as.Cancel,()=>{this.createIntermediaryEvent(as.Cancel,s.id)()}),i.on(as.VerifyEmailOtp,o=>{this.createIntermediaryEvent(as.VerifyEmailOtp,s.id)(o)}),i.on(as.VerifyMFACode,o=>{this.createIntermediaryEvent(as.VerifyMFACode,s.id)(o)}),i.on(xr.RetryWithNewEmail,o=>{this.createIntermediaryEvent(xr.RetryWithNewEmail,s.id)(o)}),i.on(xr.Cancel,()=>{this.createIntermediaryEvent(xr.Cancel,s.id)()}),i.on(xr.VerifyEmailOtp,o=>{this.createIntermediaryEvent(xr.VerifyEmailOtp,s.id)(o)})),i}},Vm="ds",Km="ek",Gm="iv",Ym="AES-GCM",Kx=256;async function HC(){let t=[];await kC((e,n,r)=>{n.startsWith(`${Vm}_`)&&t.push(n)});for(let e of t)await mc(e)}function zC(t){let e="",n=new Uint8Array(t),r=n.byteLength;for(let s=0;s<r;s++)e+=String.fromCharCode(n[s]);return window.btoa(e)}function qC(t){let e=window.atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return r.buffer}async function Gx(){if(!Vh())return;let{crypto:t}=window;return await Gr(Gm)||t.getRandomValues(new Uint8Array(12))}async function Yx(){if(!Vh())return;let{subtle:t}=window.crypto;return await Gr(Km)||await t.generateKey({name:Ym,length:Kx},!1,["encrypt","decrypt"])}async function Jx(t,e){let n=await Gx(),r=await Yx();if(!n||!r||!t)return;let s=qC(t),{subtle:i}=window.crypto,o=await i.encrypt({name:Ym,iv:n},r,s),a=zC(o);await lo(`${Vm}_${e}`,a),await lo(Km,r),await lo(Gm,n)}async function Zx(t){let e=await Gr(`${Vm}_${t}`),n=await Gr(Gm),r=await Gr(Km);if(!n||!e||!r||!Vh())return;let{subtle:s}=window.crypto,i=await s.decrypt({name:Ym,iv:n},r,qC(e));return zC(i)}function sh(t,e){return e?new URL(t,e):new URL(t)}var Xx=class extends Ao{getIdToken(e){let n=vt(this.sdk.testMode?Ve.GetIdTokenTestMode:Ve.GetIdToken,[e]);return this.request(n)}generateIdToken(e){let n=vt(this.sdk.testMode?Ve.GenerateIdTokenTestMode:Ve.GenerateIdToken,[e]);return this.request(n)}getInfo(){let e=vt(Ve.GetInfo,[]);return this.request(e)}isLoggedIn(){return ds(async(e,n)=>{try{let r=!1;this.sdk.useStorageCache&&(r=await Gr(this.localForageIsLoggedInKey)==="true",r&&e(!0));let s=vt(this.sdk.testMode?Ve.IsLoggedInTestMode:Ve.IsLoggedIn),i=await this.request(s);this.sdk.useStorageCache&&(i?lo(this.localForageIsLoggedInKey,!0):mc(this.localForageIsLoggedInKey),r&&!i&&this.emitUserLoggedOut(!0)),e(i)}catch(r){n(r)}})}logout(){return mc(this.localForageIsLoggedInKey),HC(),ds(async(e,n)=>{try{let r=vt(this.sdk.testMode?Ve.LogoutTestMode:Ve.Logout),s=await this.request(r);this.sdk.useStorageCache&&this.emitUserLoggedOut(s),e(s)}catch(r){n(r)}})}requestInfoWithUI(e){let n=vt(Ve.RequestUserInfoWithUI,e?[e]:[]);return this.request(n)}showSettings(e){let{showUI:n=!0}=e||{},r=vt(this.sdk.testMode?Ve.UserSettingsTestMode:Ve.UserSettings,[e]),s=this.request(r);return!n&&s&&(s.on(Qs.SendNewPhoneNumber,i=>{this.createIntermediaryEvent(Qs.SendNewPhoneNumber,r.id)(i)}),s.on(Qs.SendOtpCode,i=>{this.createIntermediaryEvent(Qs.SendOtpCode,r.id)(i)}),s.on(Qs.StartEditPhoneNumber,()=>{this.createIntermediaryEvent(Qs.StartEditPhoneNumber,r.id)()}),s.on(Qs.Cancel,()=>{this.createIntermediaryEvent(Qs.Cancel,r.id)()}),s.on(as.VerifyEmailOtp,i=>{this.createIntermediaryEvent(as.VerifyEmailOtp,r.id)(i)})),s}recoverAccount(e){let{email:n,showUI:r}=e,s=vt(this.sdk.testMode?Ve.RecoverAccountTestMode:Ve.RecoverAccount,[{email:n,showUI:r}]),i=this.request(s);return!r&&i&&(i.on(ei.Cancel,()=>{this.createIntermediaryEvent(ei.Cancel,s.id)()}),i.on(ei.ResendSms,()=>{this.createIntermediaryEvent(ei.ResendSms,s.id)()}),i.on(ei.VerifyOtp,o=>{this.createIntermediaryEvent(ei.VerifyOtp,s.id)(o)}),i.on(ei.UpdateEmail,o=>{this.createIntermediaryEvent(ei.UpdateEmail,s.id)(o)}),i.on(xr.Cancel,()=>{this.createIntermediaryEvent(xr.Cancel,s.id)()}),i.on(xr.RetryWithNewEmail,o=>{this.createIntermediaryEvent(xr.RetryWithNewEmail,s.id)(o)}),i.on(xr.VerifyEmailOtp,o=>{this.createIntermediaryEvent(xr.VerifyEmailOtp,s.id)(o)})),i}revealEVMPrivateKey(){let e=vt(Ve.RevealPK,[{chain:"ETH"}]);return this.request(e)}revealPrivateKey(){throw new Error("revealPrivateKey() has been decommissioned. For EVM chains, use `user.revealEVMPrivateKey()` instead. For non-EVM chains, use `[extension].revealPrivateKey()` instead.")}onUserLoggedOut(e){this.userLoggedOutCallbacks.push(e)}enableMFA(e){let{showUI:n=!0}=e,r=vt(Ve.EnableMFA,[{showUI:n}]),s=this.request(r);return!n&&s&&(s.on(dl.VerifyMFACode,i=>{this.createIntermediaryEvent(dl.VerifyMFACode,r.id)(i)}),s.on(dl.Cancel,()=>{this.createIntermediaryEvent(dl.Cancel,r.id)()})),s}disableMFA(e){let{showUI:n=!0}=e,r=vt(Ve.DisableMFA,[{showUI:n}]),s=this.request(r);return!n&&s&&(s.on(Wo.VerifyMFACode,i=>{this.createIntermediaryEvent(Wo.VerifyMFACode,r.id)(i)}),s.on(Wo.LostDevice,i=>{this.createIntermediaryEvent(Wo.LostDevice,r.id)(i)}),s.on(Wo.Cancel,()=>{this.createIntermediaryEvent(Wo.Cancel,r.id)()})),s}emitUserLoggedOut(e){this.userLoggedOutCallbacks.forEach(n=>{n(e)})}localForageIsLoggedInKey="magic_auth_is_logged_in";userLoggedOutCallbacks=[]},Qx=class extends Ao{connectWithUI(e){let n=ds(async(r,s)=>{try{let i=vt(Ve.Login,[{enabledWallets:this.sdk.thirdPartyWallets.enabledWallets,...e}]),o=this.request(i);this.sdk.thirdPartyWallets.eventListeners.forEach(({event:c,callback:l})=>{o.on(c,()=>l(i.id))}),o.on("id-token-created",c=>{n.emit("id-token-created",c)});let a=await o;a.error&&s(a),r(a)}catch(i){s(i)}});return n}showUI(e){return this.request(vt(Ve.ShowUI,[e]))}showAddress(){return this.request(vt(Ve.ShowAddress))}showSendTokensUI(){return this.request(vt(Ve.ShowSendTokensUI))}showOnRamp(){return this.request(vt(Ve.ShowOnRamp))}showNFTs(){return this.request(vt(Ve.ShowNFTs))}showBalances(){return this.request(vt(Ve.ShowBalances))}sendGaslessTransaction(e,n){return this.request(vt(Ve.SendGaslessTransaction,[e,n]))}},e2=class extends Ao{eventListeners=[];enabledWallets={};isConnected=!1;resetThirdPartyWalletState(){localStorage.removeItem(Vi.PROVIDER),localStorage.removeItem(Vi.ADDRESS),localStorage.removeItem(Vi.CHAIN_ID),this.isConnected=!1}requestOverride(e){if(e.method===Ve.Login)return this.resetThirdPartyWalletState(),super.request(e);if(e.method===Ve.GetInfo)return this.getInfo(e);if(e.method===Ve.IsLoggedIn)return this.isLoggedIn(e);if(e.method===Ve.Logout)return this.logout(e);switch(localStorage.getItem(Vi.PROVIDER)){case"web3modal":return this.web3modalRequest(e);default:return this.resetThirdPartyWalletState(),super.request(e)}}isLoggedIn(e){switch(localStorage.getItem(Vi.PROVIDER)){case"web3modal":return this.web3modalIsLoggedIn();default:return this.resetThirdPartyWalletState(),super.request(e)}}getInfo(e){switch(localStorage.getItem(Vi.PROVIDER)){case"web3modal":return this.web3modalGetInfo();default:return this.resetThirdPartyWalletState(),super.request(e)}}logout(e){let n=localStorage.getItem(Vi.PROVIDER);switch(this.resetThirdPartyWalletState(),n){case"web3modal":return this.web3modalLogout();default:return super.request(e)}}web3modalRequest(e){return ds((n,r)=>{this.sdk.web3modal.modal.getWalletProvider().request(e).then(n).catch(r)})}web3modalIsLoggedIn(){return ds(e=>{let n=this.sdk.web3modal.modal.getStatus();if(n==="connected"&&e(!0),n==="disconnected"&&(this.resetThirdPartyWalletState(),e(!1)),n==="reconnecting"){let r=this.sdk.web3modal.modal.subscribeProvider(({status:s})=>{s==="connected"&&(r(),e(!0)),s==="disconnected"&&(r(),this.resetThirdPartyWalletState(),e(!1))})}})}formatWeb3modalGetInfoResponse(){let e=this.sdk.web3modal.modal.getWalletInfo()?.name,n=this.sdk.web3modal.modal.getAddress();return{publicAddress:n,email:null,issuer:`did:ethr:${n}`,phoneNumber:null,isMfaEnabled:!1,recoveryFactors:[],walletType:e||"web3modal",firstLoginAt:null}}web3modalGetInfo(){return ds((e,n)=>{let r=this.sdk.web3modal.modal.getStatus();if(r==="connected"&&e(this.formatWeb3modalGetInfoResponse()),r==="disconnected"&&(this.resetThirdPartyWalletState(),n("Magic RPC Error: [-32603] Internal error: User denied account access.")),r==="reconnecting"){let s=this.sdk.web3modal.modal.subscribeProvider(({status:i})=>{i==="connected"&&(s(),e(this.formatWeb3modalGetInfoResponse())),i==="disconnected"&&(s(),this.resetThirdPartyWalletState(),n("Magic RPC Error: [-32603] Internal error: User denied account access."))})}})}web3modalLogout(){return ds(async e=>{try{await this.sdk.web3modal.modal.disconnect()}catch{}e(!0)})}},{createBoundEmitterMethod:Vu,createChainingEmitterMethod:Ma}=FC(),t2=class extends Ao{isMagic=!0;sendAsync(e,n){if(!n)throw Ex({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:n===null?"null":typeof n});if(Array.isArray(e))this.overlay.post(Ul.MAGIC_HANDLE_REQUEST,e.map(r=>{let s=rh(r);return this.prefixPayloadMethodForTestMode(s),s})).then(r=>{n(null,r.map(s=>({...s.payload,error:s.hasError?new Cg(s.payload.error):null})))});else{let r=rh(e);this.prefixPayloadMethodForTestMode(r),this.overlay.post(Ul.MAGIC_HANDLE_REQUEST,r).then(s=>{n(s.hasError?new Cg(s.payload.error):null,s.payload)})}}send(e,n){if(typeof e=="string"){let s=vt(e,Array.isArray(n)?n:[]);return this.request(s)}if(Array.isArray(e)||n){this.sendAsync(e,n);return}let r=vx();return r.log(),new $C(e).applyError({code:-32603,message:r.rawMessage}).payload}enable(){let e=vt(Ve.Login);return this.request(e)}request(e){return this.prefixPayloadMethodForTestMode(e),super.request(e)}prefixPayloadMethodForTestMode(e){let n="testMode/eth/";this.sdk.testMode&&(e.method=`${n}${e.method}`)}on=Ma("on",this);once=Ma("once",this);addListener=Ma("addListener",this);off=Ma("off",this);removeListener=Ma("removeListener",this);removeAllListeners=Ma("removeAllListeners",this);emit=Vu("emit");eventNames=Vu("eventNames");listeners=Vu("listeners");listenerCount=Vu("listenerCount")},n2=class extends Ao{purchase(e){let n=vt(Ve.NFTPurchase,[e]);return this.request(n)}checkout(e){let n=this.sdk.thirdPartyWallets.isConnected,r=vt(Ve.NFTCheckout,[{...e,walletProvider:n?"web3modal":"magic"}]),s=this.request(r);return n&&(s.on(hl.Initiated,async i=>{try{let o=await this.request({method:"eth_sendTransaction",params:[i]});this.createIntermediaryEvent(hl.Success,r.id)(o)}catch{this.createIntermediaryEvent(hl.Failure,r.id)()}}),s.on(hl.Disconnect,()=>{this.sdk.thirdPartyWallets.resetThirdPartyWalletState(),s.emit("disconnect")})),s}transfer(e){let n=vt(Ve.NFTTransfer,[e]);return this.request(n)}};function Gw(t){return t.compat&&t.compat[Lt.sdkName]!=null?typeof t.compat[Lt.sdkName]=="string"?QP(rx(Lt.version),t.compat[Lt.sdkName]):!!t.compat[Lt.sdkName]:!0}function r2(t,e,n){return!e&&!n?`${t}_eth_mainnet`:n?`${t}_${JSON.stringify(n)}`:e?typeof e=="string"?`${t}_eth_${e}`:`${t}_${e.rpcUrl}_${e.chainId}_${e.chainType}`:`${t}_unknown`}function s2(t){let e=t?.extensions??[],n={},r=[];if(Array.isArray(e)?e.forEach(s=>{Gw(s)?(s.init(this),s.name&&(this[s.name]=s),th(s.config)||(n[s.name]=s.config)):r.push(s)}):Object.keys(e).forEach(s=>{if(Gw(e[s])){e[s].init(this);let i=e[s];this[s]=i,th(i.config)||(n[e[s].name]=i.config)}else r.push(e[s])}),r.length)throw wx(r);return n}var i2=class kd{constructor(e,n){if(this.apiKey=e,!e)throw gx();Lt.platform==="react-native"&&n?.endpoint&&_x().log();let{defaultEndpoint:r,version:s}=Lt;this.testMode=!!n?.testMode,this.useStorageCache=!!n?.useStorageCache,this.endpoint=sh(n?.endpoint??r).origin,this.auth=new Vx(this),this.user=new Xx(this),this.wallet=new Qx(this),this.nft=new n2(this),this.thirdPartyWallets=new e2(this),this.rpcProvider=new t2(this);let i=s2.call(this,n);this.parameters=IC({API_KEY:this.apiKey,DOMAIN_ORIGIN:typeof window<"u"&&window?.location?window?.location.origin:"",ETH_NETWORK:n?.network,host:sh(this.endpoint).host,sdk:fx[Lt.sdkName],version:s,ext:th(i)?void 0:i,locale:n?.locale||"en_US",authConfig:n?.authConfig?{...n.authConfig}:void 0,...Lt.bundleId?{bundleId:Lt.bundleId}:{},meta:n?.meta}),this.networkHash=r2(this.apiKey,n?.network,th(i)?void 0:i),n?.deferPreload||this.preload()}static __overlays__=new Map;endpoint;parameters;networkHash;testMode;useStorageCache;auth;user;wallet;nft;thirdPartyWallets;rpcProvider;get overlay(){if(!kd.__overlays__.has(this.parameters)){let e=new Lt.ViewController(this.endpoint,this.parameters,this.networkHash);e.init(),kd.__overlays__.set(this.parameters,e)}return kd.__overlays__.get(this.parameters)}async preload(){await this.overlay.waitForReady()}};function o2(t,e){return e&&Array.isArray(t)?t.find(n=>n.id===e):t}function a2(t,e){let n=e.data.response?.id,r=o2(t,n);if(n&&r){let s=new $C(r).applyResult(e.data.response.result).applyError(e.data.response.error);return{id:n,response:s}}return{}}async function c2(t,e,n){let r=await Gr("rt"),s;if(Lt.platform==="web")try{s=await Gr("jwt")??await Dx()}catch{}let i={msgType:t,payload:e};s&&(i.jwt=s),s&&r&&(i.rt=r);let o=await Zx(n);return o&&(i.deviceShare=o),i}async function l2(t){t.data.rt&&await lo("rt",t.data.rt)}function u2(t,e){let n=null;return function(...r){n&&clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}}var d2=1e3,VC=60*d2,Yw=5*VC,h2=60*VC,f2=class{constructor(e,n,r){this.endpoint=e,this.parameters=n,this.networkHash=r,this.listen()}isReadyForRequest=!1;messageHandlers=new Set;isConnectedToInternet=!0;lastPongTime=null;heartbeatIntervalTimer=null;heartbeatDebounce=u2(()=>{this.endpoint==="https://auth.magic.link/"&&this.heartBeatCheck()},h2);async post(e,n){return WC(async(r,s)=>{if(!this.isConnectedToInternet){let u=RC();s(u)}await this.checkRelayerExistsInDOM()||(this.isReadyForRequest=!1,await this.reloadRelayer()),this.isReadyForRequest||await this.waitForReady();let i=[],o=Array.isArray(n)?n.map(u=>u.id):[],a=await c2(`${e}-${this.parameters}`,n,this.networkHash);await this._post(a);let c=u=>d=>{let{id:h,response:f}=a2(n,d);if(l2(d),f?.payload.error?.message==="User denied account access.")HC();else if(d.data.deviceShare){let{deviceShare:p}=d.data;Jx(p,this.networkHash)}h&&f&&Array.isArray(n)&&o.includes(h)?(i.push(f),i.length===n.length&&(u(),r(i))):h&&f&&!Array.isArray(n)&&h===n.id&&(u(),r(f))},l=this.on(Zi.MAGIC_HANDLE_RESPONSE,c(()=>l()))})}on(e,n){let r=n.bind(window),s=i=>{i.data.msgType===`${e}-${this.parameters}`&&r(i)};return this.messageHandlers.add(s),()=>this.messageHandlers.delete(s)}waitForReady(){return new Promise(e=>{let n=this.on(Zi.MAGIC_OVERLAY_READY,()=>{this.isReadyForRequest=!0,e(),n()})})}listen(){this.on(Zi.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(Zi.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()}),this.on(Zi.MAGIC_SEND_PRODUCT_ANNOUNCEMENT,e=>{e.data.response.result.product_announcement&&new pu(Oc.ProductAnnouncement,e.data.response.result.product_announcement).log()})}heartBeatCheck(){let e=!0,n=async()=>{let r={msgType:`${Ul.MAGIC_PING}-${this.parameters}`,payload:[]};await this._post(r)};this.heartbeatIntervalTimer=setInterval(async()=>{if(this.lastPongTime){if(Date.now()-this.lastPongTime>Yw*2){this.reloadRelayer(),e=!0;return}}else if(!e){this.reloadRelayer(),e=!0;return}await n(),e=!1},Yw)}stopHeartBeat(){this.heartbeatDebounce(),this.lastPongTime=null,this.heartbeatIntervalTimer&&(clearInterval(this.heartbeatIntervalTimer),this.heartbeatIntervalTimer=null)}},Jw=["request","overlay","sdk"];function p2(t){let e=Object.getPrototypeOf(t),n=[e];for(;e!==Ao.prototype;)e=Object.getPrototypeOf(e),n.push(e);return n}var g2=class extends Ao{compat;__sdk_access_field_descriptors__=new Map;__is_initialized__=!1;utils={createPromiEvent:ds,isPromiEvent:Hx,encodeJSON:IC,decodeJSON:cx,createJsonRpcRequestPayload:vt,standardizeJsonRpcRequestPayload:rh,storage:xC};constructor(){super(void 0);let e=[this,...p2(this)];Jw.forEach(n=>{let r=e.map(a=>Object.getOwnPropertyDescriptor(a,n)),s=r.findIndex(a=>!!a),i=s>0,o=r[s];o&&(this.__sdk_access_field_descriptors__.set(n,{descriptor:o,isPrototypeField:i}),Object.defineProperty(this,n,{configurable:!0,get:()=>{throw yx(n)}}))})}init(e){this.__is_initialized__||(Jw.forEach(n=>{if(this.__sdk_access_field_descriptors__.has(n)){let{descriptor:r,isPrototypeField:s}=this.__sdk_access_field_descriptors__.get(n);s?delete this[n]:Object.defineProperty(this,n,r)}}),this.sdk=e,this.__is_initialized__=!0)}createDeprecationWarning(e){let{method:n,removalVersion:r,useInstead:s}=e,i=s?` Use \`${s}\` instead.`:"",o=`\`${n}\` will be removed from this Extension in version \`${r}\`.${i}`;return new Vw(this,"DEPRECATION_NOTICE",o)}createWarning(e,n){return new Vw(this,e,n)}createError(e,n,r){return new px(this,e,n,r)}},KC=class extends g2{},m2=class{static Internal=KC},y2=class extends KC{constructor(e){super(),this.config=e,this.chain=e.chainType}chain;getPublicAddress(){return this.request(this.utils.createJsonRpcRequestPayload(Ve.GetMultichainPublicAddress,[{chain:this.chain}]))}revealPrivateKey(){return this.request(this.utils.createJsonRpcRequestPayload(Ve.RevealPK,[{chain:this.chain}]))}},w2=Object.create,GC=Object.defineProperty,E2=Object.getOwnPropertyDescriptor,b2=Object.getOwnPropertyNames,v2=Object.getPrototypeOf,_2=Object.prototype.hasOwnProperty,Ku=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),YC=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),C2=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of b2(e))!_2.call(t,s)&&s!==n&&GC(t,s,{get:()=>e[s],enumerable:!(r=E2(e,s))||r.enumerable});return t},JC=(t,e,n)=>(n=t!=null?w2(v2(t)):{},C2(!t||!t.__esModule?GC(n,"default",{value:t,enumerable:!0}):n,t)),A2=YC((t,e)=>{(function(n){if(typeof t=="object"&&typeof e<"u")e.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var r;typeof window<"u"?r=window:typeof $e<"u"?r=$e:typeof self<"u"?r=self:r=this,r.localforage=n()}})(function(){return function n(r,s,i){function o(l,u){if(!s[l]){if(!r[l]){var d=typeof Ku=="function"&&Ku;if(!u&&d)return d(l,!0);if(a)return a(l,!0);var h=new Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h}var f=s[l]={exports:{}};r[l][0].call(f.exports,function(p){var m=r[l][1][p];return o(m||p)},f,f.exports,n,r,s,i)}return s[l].exports}for(var a=typeof Ku=="function"&&Ku,c=0;c<i.length;c++)o(i[c]);return o}({1:[function(n,r,s){(function(i){var o=i.MutationObserver||i.WebKitMutationObserver,a;if(o){var c=0,l=new o(p),u=i.document.createTextNode("");l.observe(u,{characterData:!0}),a=function(){u.data=c=++c%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var d=new i.MessageChannel;d.port1.onmessage=p,a=function(){d.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?a=function(){var g=i.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:a=function(){setTimeout(p,0)};var h,f=[];function p(){h=!0;for(var g,T,N=f.length;N;){for(T=f,f=[],g=-1;++g<N;)T[g]();N=f.length}h=!1}r.exports=m;function m(g){f.push(g)===1&&!h&&a()}}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,s){var i=n(1);function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];r.exports=d;function d(A){if(typeof A!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,A!==o&&m(this,A)}d.prototype.catch=function(A){return this.then(null,A)},d.prototype.then=function(A,x){if(typeof A!="function"&&this.state===l||typeof x!="function"&&this.state===c)return this;var k=new this.constructor(o);if(this.state!==u){var L=this.state===l?A:x;f(k,L,this.outcome)}else this.queue.push(new h(k,A,x));return k};function h(A,x,k){this.promise=A,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(A){a.resolve(this.promise,A)},h.prototype.otherCallFulfilled=function(A){f(this.promise,this.onFulfilled,A)},h.prototype.callRejected=function(A){a.reject(this.promise,A)},h.prototype.otherCallRejected=function(A){f(this.promise,this.onRejected,A)};function f(A,x,k){i(function(){var L;try{L=x(k)}catch(M){return a.reject(A,M)}L===A?a.reject(A,new TypeError("Cannot resolve promise with itself")):a.resolve(A,L)})}a.resolve=function(A,x){var k=g(p,x);if(k.status==="error")return a.reject(A,k.value);var L=k.value;if(L)m(A,L);else{A.state=l,A.outcome=x;for(var M=-1,z=A.queue.length;++M<z;)A.queue[M].callFulfilled(x)}return A},a.reject=function(A,x){A.state=c,A.outcome=x;for(var k=-1,L=A.queue.length;++k<L;)A.queue[k].callRejected(x);return A};function p(A){var x=A&&A.then;if(A&&(typeof A=="object"||typeof A=="function")&&typeof x=="function")return function(){x.apply(A,arguments)}}function m(A,x){var k=!1;function L(H){k||(k=!0,a.reject(A,H))}function M(H){k||(k=!0,a.resolve(A,H))}function z(){x(M,L)}var J=g(z);J.status==="error"&&L(J.value)}function g(A,x){var k={};try{k.value=A(x),k.status="success"}catch(L){k.status="error",k.value=L}return k}d.resolve=T;function T(A){return A instanceof this?A:a.resolve(new this(o),A)}d.reject=N;function N(A){var x=new this(o);return a.reject(x,A)}d.all=_;function _(A){var x=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=A.length,L=!1;if(!k)return this.resolve([]);for(var M=new Array(k),z=0,J=-1,H=new this(o);++J<k;)F(A[J],J);return H;function F(P,w){x.resolve(P).then(E,function(R){L||(L=!0,a.reject(H,R))});function E(R){M[w]=R,++z===k&&!L&&(L=!0,a.resolve(H,M))}}}d.race=O;function O(A){var x=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=A.length,L=!1;if(!k)return this.resolve([]);for(var M=-1,z=new this(o);++M<k;)J(A[M]);return z;function J(H){x.resolve(H).then(function(F){L||(L=!0,a.resolve(z,F))},function(F){L||(L=!0,a.reject(z,F))})}}},{1:1}],3:[function(n,r,s){(function(i){typeof i.Promise!="function"&&(i.Promise=n(2))}).call(this,typeof $e<"u"?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,s){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S};function o(S,D){if(!(S instanceof D))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=a();function l(){try{if(!c||!c.open)return!1;var S=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),D=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!S||D)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function u(S,D){S=S||[],D=D||{};try{return new Blob(S,D)}catch(V){if(V.name!=="TypeError")throw V;for(var U=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,q=new U,W=0;W<S.length;W+=1)q.append(S[W]);return q.getBlob(D.type)}}typeof Promise>"u"&&n(3);var d=Promise;function h(S,D){D&&S.then(function(U){D(null,U)},function(U){D(U)})}function f(S,D,U){typeof D=="function"&&S.then(D),typeof U=="function"&&S.catch(U)}function p(S){return typeof S!="string"&&(S=String(S)),S}function m(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var g="local-forage-detect-blob-support",T=void 0,N={},_=Object.prototype.toString,O="readonly",A="readwrite";function x(S){for(var D=S.length,U=new ArrayBuffer(D),q=new Uint8Array(U),W=0;W<D;W++)q[W]=S.charCodeAt(W);return U}function k(S){return new d(function(D){var U=S.transaction(g,A),q=u([""]);U.objectStore(g).put(q,"key"),U.onabort=function(W){W.preventDefault(),W.stopPropagation(),D(!1)},U.oncomplete=function(){var W=navigator.userAgent.match(/Chrome\/(\d+)/),V=navigator.userAgent.match(/Edge\//);D(V||!W||parseInt(W[1],10)>=43)}}).catch(function(){return!1})}function L(S){return typeof T=="boolean"?d.resolve(T):k(S).then(function(D){return T=D,T})}function M(S){var D=N[S.name],U={};U.promise=new d(function(q,W){U.resolve=q,U.reject=W}),D.deferredOperations.push(U),D.dbReady?D.dbReady=D.dbReady.then(function(){return U.promise}):D.dbReady=U.promise}function z(S){var D=N[S.name],U=D.deferredOperations.pop();if(U)return U.resolve(),U.promise}function J(S,D){var U=N[S.name],q=U.deferredOperations.pop();if(q)return q.reject(D),q.promise}function H(S,D){return new d(function(U,q){if(N[S.name]=N[S.name]||B(),S.db)if(D)M(S),S.db.close();else return U(S.db);var W=[S.name];D&&W.push(S.version);var V=c.open.apply(c,W);D&&(V.onupgradeneeded=function(ee){var ie=V.result;try{ie.createObjectStore(S.storeName),ee.oldVersion<=1&&ie.createObjectStore(g)}catch(le){if(le.name!=="ConstraintError")throw le}}),V.onerror=function(ee){ee.preventDefault(),q(V.error)},V.onsuccess=function(){var ee=V.result;ee.onversionchange=function(ie){ie.target.close()},U(ee),z(S)}})}function F(S){return H(S,!1)}function P(S){return H(S,!0)}function w(S,D){if(!S.db)return!0;var U=!S.db.objectStoreNames.contains(S.storeName),q=S.version<S.db.version,W=S.version>S.db.version;if(q&&(S.version,S.version=S.db.version),W||U){if(U){var V=S.db.version+1;V>S.version&&(S.version=V)}return!0}return!1}function E(S){return new d(function(D,U){var q=new FileReader;q.onerror=U,q.onloadend=function(W){var V=btoa(W.target.result||"");D({__local_forage_encoded_blob:!0,data:V,type:S.type})},q.readAsBinaryString(S)})}function R(S){var D=x(atob(S.data));return u([D],{type:S.type})}function b(S){return S&&S.__local_forage_encoded_blob}function y(S){var D=this,U=D._initReady().then(function(){var q=N[D._dbInfo.name];if(q&&q.dbReady)return q.dbReady});return f(U,S,S),U}function C(S){M(S);for(var D=N[S.name],U=D.forages,q=0;q<U.length;q++){var W=U[q];W._dbInfo.db&&(W._dbInfo.db.close(),W._dbInfo.db=null)}return S.db=null,F(S).then(function(V){return S.db=V,w(S)?P(S):V}).then(function(V){S.db=D.db=V;for(var ee=0;ee<U.length;ee++)U[ee]._dbInfo.db=V}).catch(function(V){throw J(S,V),V})}function $(S,D,U,q){q===void 0&&(q=1);try{var W=S.db.transaction(S.storeName,D);U(null,W)}catch(V){if(q>0&&(!S.db||V.name==="InvalidStateError"||V.name==="NotFoundError"))return d.resolve().then(function(){if(!S.db||V.name==="NotFoundError"&&!S.db.objectStoreNames.contains(S.storeName)&&S.version<=S.db.version)return S.db&&(S.version=S.db.version+1),P(S)}).then(function(){return C(S).then(function(){$(S,D,U,q-1)})}).catch(U);U(V)}}function B(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function G(S){var D=this,U={db:null};if(S)for(var q in S)U[q]=S[q];var W=N[U.name];W||(W=B(),N[U.name]=W),W.forages.push(D),D._initReady||(D._initReady=D.ready,D.ready=y);var V=[];function ee(){return d.resolve()}for(var ie=0;ie<W.forages.length;ie++){var le=W.forages[ie];le!==D&&V.push(le._initReady().catch(ee))}var ce=W.forages.slice(0);return d.all(V).then(function(){return U.db=W.db,F(U)}).then(function(oe){return U.db=oe,w(U,D._defaultConfig.version)?P(U):oe}).then(function(oe){U.db=W.db=oe,D._dbInfo=U;for(var Le=0;Le<ce.length;Le++){var ut=ce[Le];ut!==D&&(ut._dbInfo.db=U.db,ut._dbInfo.version=U.version)}})}function Y(S,D){var U=this;S=p(S);var q=new d(function(W,V){U.ready().then(function(){$(U._dbInfo,O,function(ee,ie){if(ee)return V(ee);try{var le=ie.objectStore(U._dbInfo.storeName),ce=le.get(S);ce.onsuccess=function(){var oe=ce.result;oe===void 0&&(oe=null),b(oe)&&(oe=R(oe)),W(oe)},ce.onerror=function(){V(ce.error)}}catch(oe){V(oe)}})}).catch(V)});return h(q,D),q}function Q(S,D){var U=this,q=new d(function(W,V){U.ready().then(function(){$(U._dbInfo,O,function(ee,ie){if(ee)return V(ee);try{var le=ie.objectStore(U._dbInfo.storeName),ce=le.openCursor(),oe=1;ce.onsuccess=function(){var Le=ce.result;if(Le){var ut=Le.value;b(ut)&&(ut=R(ut));var Pt=S(ut,Le.key,oe++);Pt!==void 0?W(Pt):Le.continue()}else W()},ce.onerror=function(){V(ce.error)}}catch(Le){V(Le)}})}).catch(V)});return h(q,D),q}function ye(S,D,U){var q=this;S=p(S);var W=new d(function(V,ee){var ie;q.ready().then(function(){return ie=q._dbInfo,_.call(D)==="[object Blob]"?L(ie.db).then(function(le){return le?D:E(D)}):D}).then(function(le){$(q._dbInfo,A,function(ce,oe){if(ce)return ee(ce);try{var Le=oe.objectStore(q._dbInfo.storeName);le===null&&(le=void 0);var ut=Le.put(le,S);oe.oncomplete=function(){le===void 0&&(le=null),V(le)},oe.onabort=oe.onerror=function(){var Pt=ut.error?ut.error:ut.transaction.error;ee(Pt)}}catch(Pt){ee(Pt)}})}).catch(ee)});return h(W,U),W}function be(S,D){var U=this;S=p(S);var q=new d(function(W,V){U.ready().then(function(){$(U._dbInfo,A,function(ee,ie){if(ee)return V(ee);try{var le=ie.objectStore(U._dbInfo.storeName),ce=le.delete(S);ie.oncomplete=function(){W()},ie.onerror=function(){V(ce.error)},ie.onabort=function(){var oe=ce.error?ce.error:ce.transaction.error;V(oe)}}catch(oe){V(oe)}})}).catch(V)});return h(q,D),q}function De(S){var D=this,U=new d(function(q,W){D.ready().then(function(){$(D._dbInfo,A,function(V,ee){if(V)return W(V);try{var ie=ee.objectStore(D._dbInfo.storeName),le=ie.clear();ee.oncomplete=function(){q()},ee.onabort=ee.onerror=function(){var ce=le.error?le.error:le.transaction.error;W(ce)}}catch(ce){W(ce)}})}).catch(W)});return h(U,S),U}function ve(S){var D=this,U=new d(function(q,W){D.ready().then(function(){$(D._dbInfo,O,function(V,ee){if(V)return W(V);try{var ie=ee.objectStore(D._dbInfo.storeName),le=ie.count();le.onsuccess=function(){q(le.result)},le.onerror=function(){W(le.error)}}catch(ce){W(ce)}})}).catch(W)});return h(U,S),U}function Be(S,D){var U=this,q=new d(function(W,V){if(S<0){W(null);return}U.ready().then(function(){$(U._dbInfo,O,function(ee,ie){if(ee)return V(ee);try{var le=ie.objectStore(U._dbInfo.storeName),ce=!1,oe=le.openKeyCursor();oe.onsuccess=function(){var Le=oe.result;if(!Le){W(null);return}S===0||ce?W(Le.key):(ce=!0,Le.advance(S))},oe.onerror=function(){V(oe.error)}}catch(Le){V(Le)}})}).catch(V)});return h(q,D),q}function ct(S){var D=this,U=new d(function(q,W){D.ready().then(function(){$(D._dbInfo,O,function(V,ee){if(V)return W(V);try{var ie=ee.objectStore(D._dbInfo.storeName),le=ie.openKeyCursor(),ce=[];le.onsuccess=function(){var oe=le.result;if(!oe){q(ce);return}ce.push(oe.key),oe.continue()},le.onerror=function(){W(le.error)}}catch(oe){W(oe)}})}).catch(W)});return h(U,S),U}function Ct(S,D){D=m.apply(this,arguments);var U=this.config();S=typeof S!="function"&&S||{},S.name||(S.name=S.name||U.name,S.storeName=S.storeName||U.storeName);var q=this,W;if(!S.name)W=d.reject("Invalid arguments");else{var V=S.name===U.name&&q._dbInfo.db,ee=V?d.resolve(q._dbInfo.db):F(S).then(function(ie){var le=N[S.name],ce=le.forages;le.db=ie;for(var oe=0;oe<ce.length;oe++)ce[oe]._dbInfo.db=ie;return ie});S.storeName?W=ee.then(function(ie){if(ie.objectStoreNames.contains(S.storeName)){var le=ie.version+1;M(S);var ce=N[S.name],oe=ce.forages;ie.close();for(var Le=0;Le<oe.length;Le++){var ut=oe[Le];ut._dbInfo.db=null,ut._dbInfo.version=le}var Pt=new d(function(St,nn){var qt=c.open(S.name,le);qt.onerror=function(Mr){var $f=qt.result;$f.close(),nn(Mr)},qt.onupgradeneeded=function(){var Mr=qt.result;Mr.deleteObjectStore(S.storeName)},qt.onsuccess=function(){var Mr=qt.result;Mr.close(),St(Mr)}});return Pt.then(function(St){ce.db=St;for(var nn=0;nn<oe.length;nn++){var qt=oe[nn];qt._dbInfo.db=St,z(qt._dbInfo)}}).catch(function(St){throw(J(S,St)||d.resolve()).catch(function(){}),St})}}):W=ee.then(function(ie){M(S);var le=N[S.name],ce=le.forages;ie.close();for(var oe=0;oe<ce.length;oe++){var Le=ce[oe];Le._dbInfo.db=null}var ut=new d(function(Pt,St){var nn=c.deleteDatabase(S.name);nn.onerror=function(){var qt=nn.result;qt&&qt.close(),St(nn.error)},nn.onblocked=function(){},nn.onsuccess=function(){var qt=nn.result;qt&&qt.close(),Pt(qt)}});return ut.then(function(Pt){le.db=Pt;for(var St=0;St<ce.length;St++){var nn=ce[St];z(nn._dbInfo)}}).catch(function(Pt){throw(J(S,Pt)||d.resolve()).catch(function(){}),Pt})})}return h(W,D),W}var $t={_driver:"asyncStorage",_initStorage:G,_support:l(),iterate:Q,getItem:Y,setItem:ye,removeItem:be,clear:De,length:ve,key:Be,keys:ct,dropInstance:Ct};function tn(){return typeof openDatabase=="function"}var Sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bc="~~local_forage_type~",Ra=/^~~local_forage_type~([^~]+)~/,bi="__lfsc__:",vi=bi.length,_i="arbf",Hs="blob",To="si08",No="ui08",Oo="uic8",X="si16",ae="si32",Re="ur16",Xe="ui32",Tn="fl32",Ci="fl64",Jy=vi+_i.length,Zy=Object.prototype.toString;function Xy(S){var D=S.length*.75,U=S.length,q,W=0,V,ee,ie,le;S[S.length-1]==="="&&(D--,S[S.length-2]==="="&&D--);var ce=new ArrayBuffer(D),oe=new Uint8Array(ce);for(q=0;q<U;q+=4)V=Sn.indexOf(S[q]),ee=Sn.indexOf(S[q+1]),ie=Sn.indexOf(S[q+2]),le=Sn.indexOf(S[q+3]),oe[W++]=V<<2|ee>>4,oe[W++]=(ee&15)<<4|ie>>2,oe[W++]=(ie&3)<<6|le&63;return ce}function Df(S){var D=new Uint8Array(S),U="",q;for(q=0;q<D.length;q+=3)U+=Sn[D[q]>>2],U+=Sn[(D[q]&3)<<4|D[q+1]>>4],U+=Sn[(D[q+1]&15)<<2|D[q+2]>>6],U+=Sn[D[q+2]&63];return D.length%3===2?U=U.substring(0,U.length-1)+"=":D.length%3===1&&(U=U.substring(0,U.length-2)+"=="),U}function o1(S,D){var U="";if(S&&(U=Zy.call(S)),S&&(U==="[object ArrayBuffer]"||S.buffer&&Zy.call(S.buffer)==="[object ArrayBuffer]")){var q,W=bi;S instanceof ArrayBuffer?(q=S,W+=_i):(q=S.buffer,U==="[object Int8Array]"?W+=To:U==="[object Uint8Array]"?W+=No:U==="[object Uint8ClampedArray]"?W+=Oo:U==="[object Int16Array]"?W+=X:U==="[object Uint16Array]"?W+=Re:U==="[object Int32Array]"?W+=ae:U==="[object Uint32Array]"?W+=Xe:U==="[object Float32Array]"?W+=Tn:U==="[object Float64Array]"?W+=Ci:D(new Error("Failed to get type for BinaryArray"))),D(W+Df(q))}else if(U==="[object Blob]"){var V=new FileReader;V.onload=function(){var ee=Bc+S.type+"~"+Df(this.result);D(bi+Hs+ee)},V.readAsArrayBuffer(S)}else try{D(JSON.stringify(S))}catch(ee){D(null,ee)}}function a1(S){if(S.substring(0,vi)!==bi)return JSON.parse(S);var D=S.substring(Jy),U=S.substring(vi,Jy),q;if(U===Hs&&Ra.test(D)){var W=D.match(Ra);q=W[1],D=D.substring(W[0].length)}var V=Xy(D);switch(U){case _i:return V;case Hs:return u([V],{type:q});case To:return new Int8Array(V);case No:return new Uint8Array(V);case Oo:return new Uint8ClampedArray(V);case X:return new Int16Array(V);case Re:return new Uint16Array(V);case ae:return new Int32Array(V);case Xe:return new Uint32Array(V);case Tn:return new Float32Array(V);case Ci:return new Float64Array(V);default:throw new Error("Unkown type: "+U)}}var Uf={serialize:o1,deserialize:a1,stringToBuffer:Xy,bufferToString:Df};function Qy(S,D,U,q){S.executeSql("CREATE TABLE IF NOT EXISTS "+D.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],U,q)}function c1(S){var D=this,U={db:null};if(S)for(var q in S)U[q]=typeof S[q]!="string"?S[q].toString():S[q];var W=new d(function(V,ee){try{U.db=openDatabase(U.name,String(U.version),U.description,U.size)}catch(ie){return ee(ie)}U.db.transaction(function(ie){Qy(ie,U,function(){D._dbInfo=U,V()},function(le,ce){ee(ce)})},ee)});return U.serializer=Uf,W}function Ai(S,D,U,q,W,V){S.executeSql(U,q,W,function(ee,ie){ie.code===ie.SYNTAX_ERR?ee.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[D.storeName],function(le,ce){ce.rows.length?V(le,ie):Qy(le,D,function(){le.executeSql(U,q,W,V)},V)},V):V(ee,ie)},V)}function l1(S,D){var U=this;S=p(S);var q=new d(function(W,V){U.ready().then(function(){var ee=U._dbInfo;ee.db.transaction(function(ie){Ai(ie,ee,"SELECT * FROM "+ee.storeName+" WHERE key = ? LIMIT 1",[S],function(le,ce){var oe=ce.rows.length?ce.rows.item(0).value:null;oe&&(oe=ee.serializer.deserialize(oe)),W(oe)},function(le,ce){V(ce)})})}).catch(V)});return h(q,D),q}function u1(S,D){var U=this,q=new d(function(W,V){U.ready().then(function(){var ee=U._dbInfo;ee.db.transaction(function(ie){Ai(ie,ee,"SELECT * FROM "+ee.storeName,[],function(le,ce){for(var oe=ce.rows,Le=oe.length,ut=0;ut<Le;ut++){var Pt=oe.item(ut),St=Pt.value;if(St&&(St=ee.serializer.deserialize(St)),St=S(St,Pt.key,ut+1),St!==void 0){W(St);return}}W()},function(le,ce){V(ce)})})}).catch(V)});return h(q,D),q}function ew(S,D,U,q){var W=this;S=p(S);var V=new d(function(ee,ie){W.ready().then(function(){D===void 0&&(D=null);var le=D,ce=W._dbInfo;ce.serializer.serialize(D,function(oe,Le){Le?ie(Le):ce.db.transaction(function(ut){Ai(ut,ce,"INSERT OR REPLACE INTO "+ce.storeName+" (key, value) VALUES (?, ?)",[S,oe],function(){ee(le)},function(Pt,St){ie(St)})},function(ut){if(ut.code===ut.QUOTA_ERR){if(q>0){ee(ew.apply(W,[S,le,U,q-1]));return}ie(ut)}})})}).catch(ie)});return h(V,U),V}function d1(S,D,U){return ew.apply(this,[S,D,U,1])}function h1(S,D){var U=this;S=p(S);var q=new d(function(W,V){U.ready().then(function(){var ee=U._dbInfo;ee.db.transaction(function(ie){Ai(ie,ee,"DELETE FROM "+ee.storeName+" WHERE key = ?",[S],function(){W()},function(le,ce){V(ce)})})}).catch(V)});return h(q,D),q}function f1(S){var D=this,U=new d(function(q,W){D.ready().then(function(){var V=D._dbInfo;V.db.transaction(function(ee){Ai(ee,V,"DELETE FROM "+V.storeName,[],function(){q()},function(ie,le){W(le)})})}).catch(W)});return h(U,S),U}function p1(S){var D=this,U=new d(function(q,W){D.ready().then(function(){var V=D._dbInfo;V.db.transaction(function(ee){Ai(ee,V,"SELECT COUNT(key) as c FROM "+V.storeName,[],function(ie,le){var ce=le.rows.item(0).c;q(ce)},function(ie,le){W(le)})})}).catch(W)});return h(U,S),U}function g1(S,D){var U=this,q=new d(function(W,V){U.ready().then(function(){var ee=U._dbInfo;ee.db.transaction(function(ie){Ai(ie,ee,"SELECT key FROM "+ee.storeName+" WHERE id = ? LIMIT 1",[S+1],function(le,ce){var oe=ce.rows.length?ce.rows.item(0).key:null;W(oe)},function(le,ce){V(ce)})})}).catch(V)});return h(q,D),q}function m1(S){var D=this,U=new d(function(q,W){D.ready().then(function(){var V=D._dbInfo;V.db.transaction(function(ee){Ai(ee,V,"SELECT key FROM "+V.storeName,[],function(ie,le){for(var ce=[],oe=0;oe<le.rows.length;oe++)ce.push(le.rows.item(oe).key);q(ce)},function(ie,le){W(le)})})}).catch(W)});return h(U,S),U}function y1(S){return new d(function(D,U){S.transaction(function(q){q.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(W,V){for(var ee=[],ie=0;ie<V.rows.length;ie++)ee.push(V.rows.item(ie).name);D({db:S,storeNames:ee})},function(W,V){U(V)})},function(q){U(q)})})}function w1(S,D){D=m.apply(this,arguments);var U=this.config();S=typeof S!="function"&&S||{},S.name||(S.name=S.name||U.name,S.storeName=S.storeName||U.storeName);var q=this,W;return S.name?W=new d(function(V){var ee;S.name===U.name?ee=q._dbInfo.db:ee=openDatabase(S.name,"","",0),S.storeName?V({db:ee,storeNames:[S.storeName]}):V(y1(ee))}).then(function(V){return new d(function(ee,ie){V.db.transaction(function(le){function ce(Pt){return new d(function(St,nn){le.executeSql("DROP TABLE IF EXISTS "+Pt,[],function(){St()},function(qt,Mr){nn(Mr)})})}for(var oe=[],Le=0,ut=V.storeNames.length;Le<ut;Le++)oe.push(ce(V.storeNames[Le]));d.all(oe).then(function(){ee()}).catch(function(Pt){ie(Pt)})},function(le){ie(le)})})}):W=d.reject("Invalid arguments"),h(W,D),W}var E1={_driver:"webSQLStorage",_initStorage:c1,_support:tn(),iterate:u1,getItem:l1,setItem:d1,removeItem:h1,clear:f1,length:p1,key:g1,keys:m1,dropInstance:w1};function b1(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function tw(S,D){var U=S.name+"/";return S.storeName!==D.storeName&&(U+=S.storeName+"/"),U}function v1(){var S="_localforage_support_test";try{return localStorage.setItem(S,!0),localStorage.removeItem(S),!1}catch{return!0}}function _1(){return!v1()||localStorage.length>0}function C1(S){var D=this,U={};if(S)for(var q in S)U[q]=S[q];return U.keyPrefix=tw(S,D._defaultConfig),_1()?(D._dbInfo=U,U.serializer=Uf,d.resolve()):d.reject()}function A1(S){var D=this,U=D.ready().then(function(){for(var q=D._dbInfo.keyPrefix,W=localStorage.length-1;W>=0;W--){var V=localStorage.key(W);V.indexOf(q)===0&&localStorage.removeItem(V)}});return h(U,S),U}function I1(S,D){var U=this;S=p(S);var q=U.ready().then(function(){var W=U._dbInfo,V=localStorage.getItem(W.keyPrefix+S);return V&&(V=W.serializer.deserialize(V)),V});return h(q,D),q}function S1(S,D){var U=this,q=U.ready().then(function(){for(var W=U._dbInfo,V=W.keyPrefix,ee=V.length,ie=localStorage.length,le=1,ce=0;ce<ie;ce++){var oe=localStorage.key(ce);if(oe.indexOf(V)===0){var Le=localStorage.getItem(oe);if(Le&&(Le=W.serializer.deserialize(Le)),Le=S(Le,oe.substring(ee),le++),Le!==void 0)return Le}}});return h(q,D),q}function T1(S,D){var U=this,q=U.ready().then(function(){var W=U._dbInfo,V;try{V=localStorage.key(S)}catch{V=null}return V&&(V=V.substring(W.keyPrefix.length)),V});return h(q,D),q}function N1(S){var D=this,U=D.ready().then(function(){for(var q=D._dbInfo,W=localStorage.length,V=[],ee=0;ee<W;ee++){var ie=localStorage.key(ee);ie.indexOf(q.keyPrefix)===0&&V.push(ie.substring(q.keyPrefix.length))}return V});return h(U,S),U}function O1(S){var D=this,U=D.keys().then(function(q){return q.length});return h(U,S),U}function R1(S,D){var U=this;S=p(S);var q=U.ready().then(function(){var W=U._dbInfo;localStorage.removeItem(W.keyPrefix+S)});return h(q,D),q}function P1(S,D,U){var q=this;S=p(S);var W=q.ready().then(function(){D===void 0&&(D=null);var V=D;return new d(function(ee,ie){var le=q._dbInfo;le.serializer.serialize(D,function(ce,oe){if(oe)ie(oe);else try{localStorage.setItem(le.keyPrefix+S,ce),ee(V)}catch(Le){(Le.name==="QuotaExceededError"||Le.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ie(Le),ie(Le)}})})});return h(W,U),W}function x1(S,D){if(D=m.apply(this,arguments),S=typeof S!="function"&&S||{},!S.name){var U=this.config();S.name=S.name||U.name,S.storeName=S.storeName||U.storeName}var q=this,W;return S.name?W=new d(function(V){S.storeName?V(tw(S,q._defaultConfig)):V(S.name+"/")}).then(function(V){for(var ee=localStorage.length-1;ee>=0;ee--){var ie=localStorage.key(ee);ie.indexOf(V)===0&&localStorage.removeItem(ie)}}):W=d.reject("Invalid arguments"),h(W,D),W}var k1={_driver:"localStorageWrapper",_initStorage:C1,_support:b1(),iterate:S1,getItem:I1,setItem:P1,removeItem:R1,clear:A1,length:O1,key:T1,keys:N1,dropInstance:x1},D1=function(S,D){return S===D||typeof S=="number"&&typeof D=="number"&&isNaN(S)&&isNaN(D)},U1=function(S,D){for(var U=S.length,q=0;q<U;){if(D1(S[q],D))return!0;q++}return!1},nw=Array.isArray||function(S){return Object.prototype.toString.call(S)==="[object Array]"},Fc={},rw={},Pa={INDEXEDDB:$t,WEBSQL:E1,LOCALSTORAGE:k1},M1=[Pa.INDEXEDDB._driver,Pa.WEBSQL._driver,Pa.LOCALSTORAGE._driver],ku=["dropInstance"],Mf=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ku),L1={description:"",driver:M1.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function $1(S,D){S[D]=function(){var U=arguments;return S.ready().then(function(){return S[D].apply(S,U)})}}function Lf(){for(var S=1;S<arguments.length;S++){var D=arguments[S];if(D)for(var U in D)D.hasOwnProperty(U)&&(nw(D[U])?arguments[0][U]=D[U].slice():arguments[0][U]=D[U])}return arguments[0]}var B1=function(){function S(D){o(this,S);for(var U in Pa)if(Pa.hasOwnProperty(U)){var q=Pa[U],W=q._driver;this[U]=W,Fc[W]||this.defineDriver(q)}this._defaultConfig=Lf({},L1),this._config=Lf({},this._defaultConfig,D),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return S.prototype.config=function(D){if((typeof D>"u"?"undefined":i(D))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var U in D){if(U==="storeName"&&(D[U]=D[U].replace(/\W/g,"_")),U==="version"&&typeof D[U]!="number")return new Error("Database version must be a number.");this._config[U]=D[U]}return"driver"in D&&D.driver?this.setDriver(this._config.driver):!0}else return typeof D=="string"?this._config[D]:this._config},S.prototype.defineDriver=function(D,U,q){var W=new d(function(V,ee){try{var ie=D._driver,le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!D._driver){ee(le);return}for(var ce=Mf.concat("_initStorage"),oe=0,Le=ce.length;oe<Le;oe++){var ut=ce[oe],Pt=!U1(ku,ut);if((Pt||D[ut])&&typeof D[ut]!="function"){ee(le);return}}var St=function(){for(var qt=function(j1){return function(){var W1=new Error("Method "+j1+" is not implemented by the current driver"),sw=d.reject(W1);return h(sw,arguments[arguments.length-1]),sw}},Mr=0,$f=ku.length;Mr<$f;Mr++){var Bf=ku[Mr];D[Bf]||(D[Bf]=qt(Bf))}};St();var nn=function(qt){Fc[ie],Fc[ie]=D,rw[ie]=qt,V()};"_support"in D?D._support&&typeof D._support=="function"?D._support().then(nn,ee):nn(!!D._support):nn(!0)}catch(qt){ee(qt)}});return f(W,U,q),W},S.prototype.driver=function(){return this._driver||null},S.prototype.getDriver=function(D,U,q){var W=Fc[D]?d.resolve(Fc[D]):d.reject(new Error("Driver not found."));return f(W,U,q),W},S.prototype.getSerializer=function(D){var U=d.resolve(Uf);return f(U,D),U},S.prototype.ready=function(D){var U=this,q=U._driverSet.then(function(){return U._ready===null&&(U._ready=U._initDriver()),U._ready});return f(q,D,D),q},S.prototype.setDriver=function(D,U,q){var W=this;nw(D)||(D=[D]);var V=this._getSupportedDrivers(D);function ee(){W._config.driver=W.driver()}function ie(oe){return W._extend(oe),ee(),W._ready=W._initStorage(W._config),W._ready}function le(oe){return function(){var Le=0;function ut(){for(;Le<oe.length;){var Pt=oe[Le];return Le++,W._dbInfo=null,W._ready=null,W.getDriver(Pt).then(ie).catch(ut)}ee();var St=new Error("No available storage method found.");return W._driverSet=d.reject(St),W._driverSet}return ut()}}var ce=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=ce.then(function(){var oe=V[0];return W._dbInfo=null,W._ready=null,W.getDriver(oe).then(function(Le){W._driver=Le._driver,ee(),W._wrapLibraryMethodsWithReady(),W._initDriver=le(V)})}).catch(function(){ee();var oe=new Error("No available storage method found.");return W._driverSet=d.reject(oe),W._driverSet}),f(this._driverSet,U,q),this._driverSet},S.prototype.supports=function(D){return!!rw[D]},S.prototype._extend=function(D){Lf(this,D)},S.prototype._getSupportedDrivers=function(D){for(var U=[],q=0,W=D.length;q<W;q++){var V=D[q];this.supports(V)&&U.push(V)}return U},S.prototype._wrapLibraryMethodsWithReady=function(){for(var D=0,U=Mf.length;D<U;D++)$1(this,Mf[D])},S.prototype.createInstance=function(D){return new S(D)},S}(),F1=new B1;r.exports=F1},{3:3}]},{},[4])(4)})}),I2=YC((t,e)=>{(function(n,r){typeof t=="object"&&typeof e<"u"?r(t):typeof define=="function"&&define.amd?define("localforage-driver-memory",["exports"],r):r(n.LocalforageDriverMemory={})})(typeof self<"u"?self:t,function(n){var r="localforage-driver-memory";function s(b){var y=typeof Symbol=="function"&&b[Symbol.iterator],C=0;return y?y.call(b):{next:function(){return b&&C>=b.length&&(b=void 0),{value:b&&b[C++],done:!b}}}}function i(b,y){b=b||[],y=y||{};try{return new Blob(b,y)}catch(G){if(G.name!=="TypeError")throw G;for(var C=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,$=new C,B=0;B<b.length;B+=1)$.append(b[B]);return $.getBlob(y.type)}}var o=/^~~local_forage_type~([^~]+)~/,a=9,c=a+4,l=Object.prototype.toString;function u(b){var y=b.length*.75,C=b.length;b[b.length-1]==="="&&(y--,b[b.length-2]==="="&&y--);for(var $=new ArrayBuffer(y),B=new Uint8Array($),G=0,Y=0;G<C;G+=4){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[G]),ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[G+1]),be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[G+2]),De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b[G+3]);B[Y++]=Q<<2|ye>>4,B[Y++]=(ye&15)<<4|be>>2,B[Y++]=(be&3)<<6|De&63}return $}function d(b){for(var y=new Uint8Array(b),C="",$=0;$<y.length;$+=3)C+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[y[$]>>2],C+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(y[$]&3)<<4|y[$+1]>>4],C+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(y[$+1]&15)<<2|y[$+2]>>6],C+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[y[$+2]&63];return y.length%3===2?C=C.substring(0,C.length-1)+"=":y.length%3===1&&(C=C.substring(0,C.length-2)+"=="),C}function h(b,y){var C="";if(b&&(C=l.call(b)),b&&(C==="[object ArrayBuffer]"||b.buffer&&l.call(b.buffer)==="[object ArrayBuffer]")){var $=void 0,B="__lfsc__:";b instanceof ArrayBuffer?($=b,B+="arbf"):($=b.buffer,C==="[object Int8Array]"?B+="si08":C==="[object Uint8Array]"?B+="ui08":C==="[object Uint8ClampedArray]"?B+="uic8":C==="[object Int16Array]"?B+="si16":C==="[object Uint16Array]"?B+="ur16":C==="[object Int32Array]"?B+="si32":C==="[object Uint32Array]"?B+="ui32":C==="[object Float32Array]"?B+="fl32":C==="[object Float64Array]"?B+="fl64":y(new Error("Failed to get type for BinaryArray"))),y(B+d($))}else if(C==="[object Blob]"){var G=new FileReader;G.onload=function(){var Y="~~local_forage_type~"+b.type+"~"+d(this.result);y("__lfsc__:blob"+Y)},G.readAsArrayBuffer(b)}else try{y(JSON.stringify(b))}catch(Y){y(null,Y)}}function f(b){if(b.substring(0,a)!=="__lfsc__:")return JSON.parse(b);var y=b.substring(c),C=b.substring(a,c),$;if(C==="blob"&&o.test(y)){var B=y.match(o);$=B[1],y=y.substring(B[0].length)}var G=u(y);switch(C){case"arbf":return G;case"blob":return i([G],{type:$});case"si08":return new Int8Array(G);case"ui08":return new Uint8Array(G);case"uic8":return new Uint8ClampedArray(G);case"si16":return new Int16Array(G);case"ur16":return new Uint16Array(G);case"si32":return new Int32Array(G);case"ui32":return new Uint32Array(G);case"fl32":return new Float32Array(G);case"fl64":return new Float64Array(G);default:throw new Error("Unkown type: "+C)}}function p(b){var y,C;if(b===null||typeof b!="object"||"isActiveClone"in b)return b;var $=b instanceof Date?new Date(b):b.constructor();try{for(var B=s(Object.keys(b)),G=B.next();!G.done;G=B.next()){var Y=G.value;Object.prototype.hasOwnProperty.call(b,Y)&&(b.isActiveClone=null,$[Y]=p(b[Y]),delete b.isActiveClone)}}catch(Q){y={error:Q}}finally{try{G&&!G.done&&(C=B.return)&&C.call(B)}finally{if(y)throw y.error}}return $}function m(b,y){return(b.name||y.name)+"/"+(b.storeName||y.storeName)+"/"}function g(b,y){y&&b.then(function(C){y(null,C)},function(C){y(C)})}function T(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}function N(b,y){var C=this;if(y=T.apply(this,arguments),b=typeof b!="function"&&b||{},!b.name){var $=this.config();b.name=b.name||$.name,b.storeName=b.storeName||$.storeName}var B;return b.name?B=new Promise(function(G){b.storeName?G(m(b,C._defaultConfig)):G(b.name+"/")}):B=Promise.reject("Invalid arguments"),{promise:B,callback:y}}function _(b){return typeof b!="string"&&(b=String(b)),b}var O={bufferToString:d,deserialize:f,serialize:h,stringToBuffer:u},A={},x=function(){function b(y){this.kp=y,this.data={}}return b.resolve=function(y){return A[y]||(A[y]=new b(y)),A[y]},b.prototype.clear=function(){this.data={}},b.prototype.drop=function(){this.clear(),delete A[this.kp]},b.prototype.get=function(y){return this.data[y]},b.prototype.key=function(y){return this.keys()[y]},b.prototype.keys=function(){return Object.keys(this.data)},b.prototype.rm=function(y){delete this.data[y]},b.prototype.set=function(y,C){this.data[y]=C},b}();function k(b){var y=b?p(b):{},C=m(y,this._defaultConfig),$=x.resolve(C);return this._dbInfo=y,this._dbInfo.serializer=O,this._dbInfo.keyPrefix=C,this._dbInfo.mStore=$,Promise.resolve()}function L(b){var y=this,C=this.ready().then(function(){y._dbInfo.mStore.clear()});return g(C,b),C}function M(b,y){var C=N.apply(this,arguments),$=C.promise,B=C.callback,G=$.then(function(Y){x.resolve(Y).drop()});return g(G,B),$}function z(b,y){var C=this;b=_(b);var $=this.ready().then(function(){var B=C._dbInfo.mStore.get(b);return B==null?null:C._dbInfo.serializer.deserialize(B)});return g($,y),$}function J(b,y){var C=this,$=this.ready().then(function(){for(var B=C._dbInfo.mStore,G=B.keys(),Y=0;Y<G.length;Y++){var Q=B.get(G[Y]);if(Q&&(Q=C._dbInfo.serializer.deserialize(Q)),Q=b(Q,G[Y],Y+1),Q!==void 0)return Q}});return g($,y),$}function H(b,y){var C=this,$=this.ready().then(function(){var B;try{B=C._dbInfo.mStore.key(b),B===void 0&&(B=null)}catch{B=null}return B});return g($,y),$}function F(b){var y=this,C=this.ready().then(function(){return y._dbInfo.mStore.keys()});return g(C,b),C}function P(b){var y=this.keys().then(function(C){return C.length});return g(y,b),y}function w(b,y){var C=this;b=_(b);var $=this.ready().then(function(){C._dbInfo.mStore.rm(b)});return g($,y),$}function E(b,y,C){var $=this;b=_(b);var B=this.ready().then(function(){y===void 0&&(y=null);var G=y;return new Promise(function(Y,Q){$._dbInfo.serializer.serialize(y,function(ye,be){if(be)Q(be);else try{$._dbInfo.mStore.set(b,ye),Y(G)}catch(De){Q(De)}})})});return g(B,C),B}var R=!0;n._support=R,n._driver=r,n._initStorage=k,n.clear=L,n.dropInstance=M,n.getItem=z,n.iterate=J,n.key=H,n.keys=F,n.length=P,n.removeItem=w,n.setItem=E,Object.defineProperty(n,"__esModule",{value:!0})})}),Xf=JC(A2()),Zw=JC(I2()),S2={display:"none",position:"fixed",top:"0",right:"0",width:"100%",height:"100%",borderRadius:"0",border:"none",opacity:"0",zIndex:"-1"};function T2(t){for(let[e,n]of Object.entries(S2))t.style[e]=n}function N2(t){return!![].slice.call(document.querySelectorAll(".magic-iframe")).find(e=>e.src.includes(t))}var O2=class extends f2{activeElement=null;iframe;relayerSrc=sh(`/send?params=${encodeURIComponent(this.parameters)}`,this.endpoint).href;init(){this.test="hello",this.iframe=new Promise(e=>{let n=()=>{if(N2(encodeURIComponent(this.parameters)))bx().log();else{let r=document.createElement("iframe");r.classList.add("magic-iframe"),r.dataset.magicIframeLabel=sh(this.endpoint).host,r.title="Secure Modal",r.src=this.relayerSrc,r.allow="clipboard-read; clipboard-write",T2(r),document.body.appendChild(r),e(r)}};["loaded","interactive","complete"].includes(document.readyState)?n():window.addEventListener("load",n,!1)}),this.iframe.then(e=>{e instanceof HTMLIFrameElement&&e.addEventListener("load",async()=>{this.heartbeatDebounce()})}),window.addEventListener("message",e=>{if(e.origin===this.endpoint&&e.data.msgType&&(e.data.msgType.includes(Zi.MAGIC_PONG)&&(this.lastPongTime=Date.now()),e.data&&this.messageHandlers.size)){e.data.response=e.data.response??{},this.stopHeartBeat();for(let n of this.messageHandlers.values())n(e)}}),window.addEventListener("beforeunload",()=>{this.stopHeartBeat()})}async showOverlay(){let e=await this.iframe;e.style.display="block",e.style.zIndex="2147483647",e.style.opacity="1",this.activeElement=document.activeElement,e.focus()}async hideOverlay(){let e=await this.iframe;e.style.display="none",e.style.zIndex="-1",e.style.opacity="0",this.activeElement?.focus&&this.activeElement.focus(),this.activeElement=null}async _post(e){let n=await this.iframe;if(n&&n.contentWindow)n.contentWindow.postMessage(e,this.endpoint);else throw RC()}async checkRelayerExistsInDOM(){let e=await this.iframe;return!e||!e.contentWindow?!1:!![].slice.call(document.querySelectorAll(".magic-iframe")).find(n=>n.src.includes(encodeURIComponent(this.parameters)))}async reloadRelayer(){let e=await this.iframe;if(this.stopHeartBeat(),!e){this.init();return}if(!e.contentWindow){document.body.appendChild(e);return}e&&(e.src=this.relayerSrc)}},R2=hx(i2,{platform:"web",sdkName:"magic-sdk",version:"31.2.0",defaultEndpoint:"https://auth.magic.link/",ViewController:O2,configureStorage:async()=>{let t=Xf.default.createInstance({name:"MagicAuthLocalStorageDB",storeName:"MagicAuthLocalStorage"});return await t.defineDriver(Zw),await t.setDriver([Xf.default.INDEXEDDB,Xf.default.LOCALSTORAGE,Zw._driver]),t}}),P2=(t=>(t.Start="magic_oauth_login_with_redirect_start",t.Verify="magic_oauth_login_with_redirect_verify",t.Popup="magic_oauth_login_with_popup",t.VerifyTelegramData="magic_oauth_verify_telegram_data",t))(P2||{}),x2=(t=>(t.InvalidRequest="invalid_request",t.InvalidClient="invalid_client",t.InvalidScope="invalid_scope",t.InvalidGrant="invalid_grant",t.UnauthorizedClient="unauthorized_client",t.UnsupportedResponseType="unsupported_response_type",t.UnsupportedGrantType="unsupported_grant_type",t.UnsupportedTokenType="unsupported_token_type",t.AccessDenied="access_denied",t.ServerError="server_error",t.TemporarilyUnavailable="temporarily_unavailable",t))(x2||{}),k2=(t=>(t.MissingApiKey="MISSING_API_KEY",t.ModalNotReady="MODAL_NOT_READY",t.ConnectionLost="CONNECTION_WAS_LOST",t.MalformedResponse="MALFORMED_RESPONSE",t.InvalidArgument="INVALID_ARGUMENT",t.ExtensionNotInitialized="EXTENSION_NOT_INITIALIZED",t.IncompatibleExtensions="INCOMPATIBLE_EXTENSIONS",t))(k2||{}),D2=(t=>(t.SyncWeb3Method="SYNC_WEB3_METHOD",t.DuplicateIframe="DUPLICATE_IFRAME",t.ReactNativeEndpointConfiguration="REACT_NATIVE_ENDPOINT_CONFIGURATION",t.DeprecationNotice="DEPRECATION_NOTICE",t.ProductAnnouncement="ANNOUNCEMENT",t))(D2||{}),U2=(t=>(t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.MagicLinkFailedVerification=-1e4]="MagicLinkFailedVerification",t[t.MagicLinkExpired=-10001]="MagicLinkExpired",t[t.MagicLinkRateLimited=-10002]="MagicLinkRateLimited",t[t.MagicLinkInvalidRedirectURL=-10006]="MagicLinkInvalidRedirectURL",t[t.UserAlreadyLoggedIn=-10003]="UserAlreadyLoggedIn",t[t.UpdateEmailFailed=-10004]="UpdateEmailFailed",t[t.UserRequestEditEmail=-10005]="UserRequestEditEmail",t[t.InactiveRecipient=-10010]="InactiveRecipient",t[t.AccessDeniedToUser=-10011]="AccessDeniedToUser",t[t.RedirectLoginComplete=-10015]="RedirectLoginComplete",t[t.DpopInvalidated=-10019]="DpopInvalidated",t))(U2||{}),M2=(t=>(t.PROVIDER="magic_3pw_provider",t.ADDRESS="magic_3pw_address",t.CHAIN_ID="magic_3pw_chainId",t))(M2||{}),L2=(t=>(t.WalletConnected="wallet_connected",t.WalletRejected="wallet_rejected",t.Web3ModalSelected="web3modal_selected",t))(L2||{}),$2=(t=>(t.LoginWithSms="magic_auth_login_with_sms",t.LoginWithEmailOTP="magic_auth_login_with_email_otp",t.LoginWithMagicLink="magic_auth_login_with_magic_link",t.LoginWithCredential="magic_auth_login_with_credential",t.SetAuthorizationToken="magic_auth_set_authorization_token",t.GetIdToken="magic_auth_get_id_token",t.GenerateIdToken="magic_auth_generate_id_token",t.GetMetadata="magic_auth_get_metadata",t.IsLoggedIn="magic_is_logged_in",t.Logout="magic_auth_logout",t.UpdateEmail="magic_auth_update_email",t.UserSettings="magic_auth_settings",t.UserSettingsTestMode="magic_auth_settings_testing_mode",t.LoginWithSmsTestMode="magic_auth_login_with_sms_testing_mode",t.LoginWithEmailOTPTestMode="magic_auth_login_with_email_otp_testing_mode",t.LoginWithMagicLinkTestMode="magic_login_with_magic_link_testing_mode",t.LoginWithCredentialTestMode="magic_auth_login_with_credential_testing_mode",t.GetIdTokenTestMode="magic_auth_get_id_token_testing_mode",t.GenerateIdTokenTestMode="magic_auth_generate_id_token_testing_mode",t.GetMetadataTestMode="magic_auth_get_metadata_testing_mode",t.IsLoggedInTestMode="magic_auth_is_logged_in_testing_mode",t.LogoutTestMode="magic_auth_logout_testing_mode",t.UpdateEmailTestMode="magic_auth_update_email_testing_mode",t.IntermediaryEvent="magic_intermediary_event",t.RequestAccounts="eth_requestAccounts",t.GetInfo="magic_get_info",t.ShowUI="magic_wallet",t.NFTPurchase="magic_nft_purchase",t.NFTCheckout="magic_nft_checkout",t.NFTTransfer="magic_nft_transfer",t.RequestUserInfoWithUI="mc_request_user_info",t.Disconnect="mc_disconnect",t.RecoverAccount="magic_auth_recover_account",t.RecoverAccountTestMode="magic_auth_recover_account_testing_mode",t.MagicBoxHeartBeat="magic_box_heart_beat",t.AutoConnect="mc_auto_connect",t.Login="mc_login",t.EncryptV1="magic_auth_encrypt_v1",t.DecryptV1="magic_auth_decrypt_v1",t.ShowNFTs="magic_show_nfts",t.ShowOnRamp="magic_show_fiat_onramp",t.ShowSendTokensUI="magic_show_send_tokens_ui",t.ShowAddress="magic_show_address",t.ShowBalances="magic_show_balances",t.SendGaslessTransaction="eth_sendGaslessTransaction",t.RevealPK="magic_reveal_key",t.EnableMFA="magic_auth_enable_mfa_flow",t.DisableMFA="magic_auth_disable_mfa_flow",t.GetMultichainPublicAddress="magic_get_multichain_public_address",t))($2||{}),B2=(t=>(t.MAGIC_HANDLE_RESPONSE="MAGIC_HANDLE_RESPONSE",t.MAGIC_OVERLAY_READY="MAGIC_OVERLAY_READY",t.MAGIC_SHOW_OVERLAY="MAGIC_SHOW_OVERLAY",t.MAGIC_HIDE_OVERLAY="MAGIC_HIDE_OVERLAY",t.MAGIC_HANDLE_EVENT="MAGIC_HANDLE_EVENT",t.MAGIC_MG_BOX_SEND_RECEIPT="MAGIC_MG_BOX_SEND_RECEIPT",t.MAGIC_SEND_PRODUCT_ANNOUNCEMENT="MAGIC_SEND_PRODUCT_ANNOUNCEMENT",t.MAGIC_PONG="MAGIC_PONG",t.MAGIC_POPUP_RESPONSE="MAGIC_POPUP_RESPONSE",t.MAGIC_POPUP_OAUTH_VERIFY_RESPONSE="MAGIC_POPUP_OAUTH_VERIFY_RESPONSE",t))(B2||{}),F2=(t=>(t.MAGIC_HANDLE_REQUEST="MAGIC_HANDLE_REQUEST",t.MAGIC_PING="MAGIC_PING",t))(F2||{}),j2=(t=>(t.UpdateEmail="update-email",t.MFA="mfa",t.Recovery="recovery",t))(j2||{}),W2=(t=>(t.Retry="retry",t))(W2||{}),H2=(t=>(t.EmailSent="email-sent",t.EmailNotDeliverable="email-not-deliverable",t))(H2||{}),z2=(t=>(t.VerifyEmailOtp="verify-email-otp",t.VerifyMFACode="verify-mfa-code",t.LostDevice="lost-device",t.VerifyRecoveryCode="verify-recovery-code",t.Cancel="cancel",t))(z2||{}),q2=(t=>(t.VerifySmsOtp="verify-sms-otp",t.Cancel="cancel",t.Retry="retry",t))(q2||{}),V2=(t=>(t.SmsOTPSent="sms-otp-sent",t.InvalidSmsOtp="invalid-sms-otp",t.ExpiredSmsOtp="expired-sms-otp",t))(V2||{}),K2=(t=>(t.EmailOTPSent="email-otp-sent",t.InvalidEmailOtp="invalid-email-otp",t.InvalidMfaOtp="invalid-mfa-otp",t.ExpiredEmailOtp="expired-email-otp",t.MfaSentHandle="mfa-sent-handle",t.RecoveryCodeSentHandle="recovery-code-sent-handle",t.InvalidRecoveryCode="invalid-recovery-code",t.RecoveryCodeSuccess="recovery-code-success",t.LoginThrottled="login-throttled",t))(K2||{}),G2=(t=>(t.Retry="device-retry",t))(G2||{}),Y2=(t=>(t.DeviceApproved="device-approved",t.DeviceNeedsApproval="device-needs-approval",t.DeviceVerificationLinkExpired="device-verification-link-expired",t.DeviceVerificationEmailSent="device-verification-email-sent",t))(Y2||{}),J2=(t=>(t.Retry="Recency/auth-factor-retry",t.Cancel="Recency/auth-factor-verification-cancel",t.VerifyEmailOtp="Recency/auth-factor-verify-email-otp",t.VerifyMFACode="Recency/verify-mfa-code",t))(J2||{}),Z2=(t=>(t.PrimaryAuthFactorNeedsVerification="Recency/auth-factor-needs-verification",t.PrimaryAuthFactorVerified="Recency/auth-factor-verified",t.InvalidEmailOtp="Recency/auth-factor-invalid-email-otp",t.EmailExpired="Recency/auth-factor-verification-email-expired",t.EmailSent="Recency/auth-factor-verification-email-sent",t.EmailNotDeliverable="Recency/auth-factor-verification-email-not-deliverable",t))(Z2||{}),X2=(t=>(t.RetryWithNewEmail="UpdateEmail/retry-with-new-email",t.Cancel="UpdateEmail/new-email-verification-cancel",t.VerifyEmailOtp="UpdateEmail/new-email-verify-otp",t))(X2||{}),Q2=(t=>(t.NewAuthFactorNeedsVerification="UpdateEmail/new-email-needs-verification",t.EmailUpdated="UpdateEmail/email-updated",t.InvalidEmailOtp="UpdateEmail/new-email-invalid-email-otp",t.EmailExpired="UpdateEmail/new-email-verification-email-expired",t.EmailSent="UpdateEmail/new-email-verification-email-sent",t.EmailNotDeliverable="UpdateEmail/new-email-verification-email-not-deliverable",t.InvalidEmail="UpdateEmail/new-email-invalid",t.EmailAlreadyExists="UpdateEmail/new-email-already-exists",t))(Q2||{}),ek=(t=>(t.IDTokenCreated="Auth/id-token-created",t))(ek||{}),tk=(t=>(t.Cancel="Farcaster/cancel",t))(tk||{}),nk=(t=>(t.MFASecretGenerated="mfa-secret-generated",t.InvalidMFAOtp="invalid-mfa-otp",t.MFARecoveryCodes="mfa-recovery-codes",t))(nk||{}),rk=(t=>(t.VerifyMFACode="verify-mfa-code",t.Cancel="cancel-mfa-setup",t))(rk||{}),sk=(t=>(t.MFACodeRequested="mfa-code-requested",t.InvalidMFAOtp="invalid-mfa-otp",t.InvalidRecoveryCode="invalid-recovery-code",t))(sk||{}),ik=(t=>(t.VerifyMFACode="verify-mfa-code",t.LostDevice="lost-device",t.Cancel="cancel-mfa-disable",t))(ik||{}),ok=(t=>(t.Harmony="HARMONY",t))(ok||{}),ak=(t=>(t.ClosedByUser="closed-by-user",t))(ak||{}),ck=(t=>(t.ClosedByUser="closed-by-user-on-received",t))(ck||{}),lk=(t=>(t.EnterNewPhoneNumber="enter-new-phone-number",t.EnterOtpCode="enter-otp-code",t.RecoveryFactorAlreadyExists="recovery-factor-already-exists",t.MalformedPhoneNumber="malformed-phone-number",t.InvalidOtpCode="invalid-otp-code",t.RecoveryFactorUpdated="recovery-factor-updated",t.RecoveryFactorDeleted="recovery-factor-deleted",t))(lk||{}),uk=(t=>(t.SendNewPhoneNumber="send-new-phone-number",t.SendOtpCode="send-otp-code",t.Cancel="cancel",t.StartEditPhoneNumber="start-edit-phone-number",t))(uk||{}),dk=(t=>(t.PhoneNumber="phone_number",t))(dk||{}),hk=(t=>(t.SmsOtpSent="sms-otp-sent",t.LoginThrottled="login-throttled",t.InvalidSmsOtp="invalid-sms-otp",t.SmsVerified="sms-verified",t.AccountRecovered="account-recovered",t.UpdateEmailRequired="update-email-required",t))(hk||{}),fk=(t=>(t.Cancel="cancel",t.VerifyOtp="verify-otp-code",t.ResendSms="resend-sms-otp",t.UpdateEmail="update-email",t))(fk||{}),pk=(t=>(t.Success="nft-checkout-success",t.Failure="nft-checkout-failure",t.Initiated="nft-checkout-initiated",t.Disconnect="disconnect",t))(pk||{}),gk=(t=>(t.WalletInfoFetched="Wallet/wallet-info-fetched",t))(gk||{}),mk=(t=>(t.CloseMagicWindow="close-magic-window",t))(mk||{}),Ag=(t=>(t.PopupUrl="popup-url",t))(Ag||{}),Dd=(t=>(t.PopupEvent="popup-event",t.Cancel="cancel",t))(Dd||{}),yk=class extends m2.Internal{name="oauth2";config={};compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1,"@magic-sdk/react-native-bare":!1,"@magic-sdk/react-native-expo":!1};constructor(){super(),this.seamlessTelegramLogin()}loginWithRedirect(e){return this.utils.createPromiEvent(async(n,r)=>{let s=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_start",[{...e,apiKey:this.sdk.apiKey,platform:"web"}]),i=await this.request(s),o=i,a=i;if(a.error&&r(this.createError(a.error,a.error_description??"An error occurred.",{errorURI:a.error_uri,provider:a.provider})),o?.oauthAuthoriationURI){let c=o.useMagicServerCallback?new URL(o.oauthAuthoriationURI,this.sdk.endpoint).href:o.oauthAuthoriationURI;o?.shouldReturnURI?n(c):window.location.href=c}n(null)})}getRedirectResult(e={}){let n=e?.optionalQueryString||window.location.search,r=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",r),wk.call(this,e,n)}loginWithPopup(e){let n=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_popup",[{...e,returnTo:window.location.href,apiKey:this.sdk.apiKey,platform:"web"}]),r=ds(async(s,i)=>{try{let o=this.request(n),a=l=>{this.createIntermediaryEvent(Dd.PopupEvent,n.id)(l.data)};e.shouldReturnURI&&o.on(Ag.PopupUrl,l=>{window.addEventListener("message",a),r.emit(Ag.PopupUrl,l)});let c=await o;window.removeEventListener("message",a),c.error?i(c):s(c)}catch(o){i(o)}});return r.on(Dd.Cancel,()=>{this.createIntermediaryEvent(Dd.Cancel,n.id)()}),r}seamlessTelegramLogin(){try{if(!window.location.hash.toString().includes("#tgWebAppData"))return;let e=document.createElement("script");e.src="https://telegram.org/js/telegram-web-app.js",document.head.prepend(e),e.onload=async()=>{try{let n=window.Telegram?.WebApp.initData,r=this.utils.createJsonRpcRequestPayload("magic_oauth_verify_telegram_data",[{userData:n,isMiniApp:!0}]);await this.request(r)}catch{}}}catch{}}};function wk(t,e){return this.utils.createPromiEvent(async(n,r)=>{let s=this.utils.createJsonRpcRequestPayload("magic_oauth_login_with_redirect_verify",[{authorizationResponseParams:e,magicApiKey:this.sdk.apiKey,platform:"web",...t}]),i=await this.request(s),o=i,a=i;a.error&&r(this.createError(a.error,a.error_description??"An error occurred.",{errorURI:a.error_uri,provider:a.provider})),n(o)})}var Ek=class extends y2{constructor(e){super({rpcUrl:e.rpcUrl,chainType:"COSMOS",options:{chain:e.chain}}),this.cosmosConfig=e}name="cosmos";signAndBroadcast=async(e,n)=>this.request({id:42,jsonrpc:"2.0",method:"cos_signAndBroadcast",params:{message:e,fee:n}});sign=async(e,n)=>this.request({id:42,jsonrpc:"2.0",method:"cos_sign",params:{message:e,fee:n}});signTypedData=e=>this.request({id:42,jsonrpc:"2.0",method:"cos_signTypedData",params:{message:e}});sendTokens=async(e,n,r,s)=>this.request({id:42,jsonrpc:"2.0",method:"cos_sendTokens",params:{recipientAddress:e,transferAmount:n,denom:r,memo:s}});changeAddress=async e=>this.request({id:41,jsonrpc:"2.0",method:"cos_changeAddress",params:{prefix:e}})};function Ml(t){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ml(t)}function bk(t,e){if(Ml(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ml(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vk(t){var e=bk(t,"string");return Ml(e)=="symbol"?e:e+""}function Xw(t,e,n){return(e=vk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _k=class extends Lh{constructor(...t){super(...t),Xw(this,"provider",void 0),Xw(this,"magicWallet",void 0)}async getWalletDeviceType(){return Promise.resolve($h.Browser)}async enable({email:t,provider:e}){if(!e)return Promise.resolve(!0);try{return e===mN.Email?await this.connectViaEmail(t):await this.connectViaOauth(e),await this.pollUserLoggedInState(),Promise.resolve(!0)}catch(n){throw new Ce(new Error(n.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}}async connectViaEmail(t){const e=await this.getMagicWallet();if(!t)throw new Ce(new Error("You have to pass the email for using Magic wallet"));return e.auth.loginWithMagicLink({email:t})}async connectViaOauth(t){return(await this.getMagicWallet()).oauth2.loginWithRedirect({provider:t,redirectURI:window.location.origin})}async disconnect(){const t=await this.getMagicWallet();await t.user.isLoggedIn()&&await t.user.logout()}async getAddresses({provider:t}){const e=await this.getMagicWallet();if(!t)try{await e.oauth2.getRedirectResult()}catch{}try{const{publicAddress:n}=await e.user.getInfo();return n?.startsWith("inj")?[n||""]:[await e.cosmos.changeAddress("inj")||""]}catch(n){throw new Ce(new Error(n.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}}async getAddressesInfo(){throw new Ce(new Error("getAddressesInfo is not implemented"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}async getSessionOrConfirm(t){return Promise.resolve(`0x${rg(sg(`Confirmation for ${t} at time: ${Date.now()}`))}`)}async sendEvmTransaction(t,e){throw new Td(new Error("sendEvmTransaction is not supported. Leap only supports sending cosmos transactions"),{code:Me,context:Ge.SendEvmTransaction})}async sendTransaction(t,e){const{endpoints:n,txTimeout:r}=e;if(!n)throw new Ce(new Error("You have to pass endpoints.grpc within the options for using Magic wallet"));const s=await new Mh(n.grpc).broadcast(t,{txTimeout:r});if(s.code!==0)throw new Rl(new Error(s.rawLog),{code:Me,contextCode:s.code,contextModule:s.codespace});return s}async signEip712TypedData(t,e){return`0x${await(await this.getMagicWallet()).cosmos.signTypedData(t)}`}async signCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signing Cosmos transactions"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signAminoCosmosTransaction(t){throw new Ce(new Error("This wallet does not support signAminoCosmosTransaction"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signArbitrary(t,e){throw new Ce(new Error("This wallet does not support signArbitrary"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async getEthereumChainId(){throw new Td(new Error("getEthereumChainId is not supported on Magic wallet"),{code:Me,context:Ge.GetChainId})}async getEvmTransactionReceipt(t){throw new Td(new Error("getEvmTransactionReceipt is not supported on Cosmostation"),{code:Me,type:Ke.WalletError,context:Ge.GetEvmTransactionReceipt})}async getPubKey(){throw new Ce(new Error("You can only fetch PubKey from Cosmos native wallets"))}async pollUserLoggedInState(t=60*1e3){const e=await this.getMagicWallet(),n=3*1e3;for(let r=0;r<=t/n;r+=1){try{const s=await e.user.isLoggedIn();if(s)return s}catch(s){if(s instanceof Rl)throw s}await new Promise(s=>setTimeout(s,n))}throw new Ce(new Error(`User did not verify sign in - timeout of ${t}ms`),{context:"Wallet",contextModule:"Magic-Wallet-pollUserLoggedInState"})}async getMagicWallet(){const{metadata:t}=this;if(!this.magicWallet){var e,n;if(!(!(t==null||(e=t.magic)===null||e===void 0)&&e.apiKey))throw new Ce(new Error("You have to pass the apiKey within metadata to use Magic wallet"));if(!(!(t==null||(n=t.magic)===null||n===void 0)&&n.rpcEndpoint))throw new Ce(new Error("You have to pass the rpc url endpoint within metadata to use Magic wallet"));this.magicWallet=new R2(t.magic.apiKey,{extensions:[new yk,new Ek({rpcUrl:t.magic.rpcEndpoint,chain:"inj"})]})}return this.magicWallet}};const eX=Object.freeze(Object.defineProperty({__proto__:null,MagicStrategy:_k},Symbol.toStringTag,{value:"Module"})),Ck=Symbol(),Qw=Object.getPrototypeOf,Ig=new WeakMap,Ak=t=>t&&(Ig.has(t)?Ig.get(t):Qw(t)===Object.prototype||Qw(t)===Array.prototype),Ik=t=>Ak(t)&&t[Ck]||null,eE=(t,e=!0)=>{Ig.set(t,e)},ih={},Jm=t=>typeof t=="object"&&t!==null,Sk=t=>Jm(t)&&!gu.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),ZC=(t,e)=>{const n=Sg.get(t);if(n?.[0]===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return eE(r,!0),Sg.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(gu.has(i))eE(i,!1);else if(mo.has(i)){const[c,l]=mo.get(i);a.value=ZC(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},Tk=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(tE(l,o)||Ll.has(o)&&tE(l,Ll.get(o))))return!0;n(i),Jm(o)&&(o=Ik(o)||o);const u=!mo.has(o)&&Ok(o)?Rt(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),mo=new WeakMap,gu=new WeakSet,Sg=new WeakMap,Ud=[1],Ll=new WeakMap;let tE=Object.is,Nk=(t,e)=>new Proxy(t,e),Ok=Sk,Rk=ZC,Pk=Tk;function Rt(t={}){if(!Jm(t))throw new Error("object required");const e=Ll.get(t);if(e)return e;let n=Ud[0];const r=new Set,s=(g,T=++Ud[0])=>{n!==T&&(i=n=T,r.forEach(N=>N(g,T)))};let i=n;const o=(g=Ud[0])=>(i!==g&&(i=g,c.forEach(([T])=>{const N=T[1](g);N>n&&(n=N)})),n),a=g=>(T,N)=>{const _=[...T];_[1]=[g,..._[1]],s(_,N)},c=new Map,l=(g,T)=>{const N=!gu.has(T)&&mo.get(T);if(N){if((ih?"production":void 0)!=="production"&&c.has(g))throw new Error("prop listener already exists");if(r.size){const _=N[2](a(g));c.set(g,[N,_])}else c.set(g,[N])}},u=g=>{var T;const N=c.get(g);N&&(c.delete(g),(T=N[1])==null||T.call(N))},d=g=>(r.add(g),r.size===1&&c.forEach(([N,_],O)=>{if((ih?"production":void 0)!=="production"&&_)throw new Error("remove already exists");const A=N[2](a(O));c.set(O,[N,A])}),()=>{r.delete(g),r.size===0&&c.forEach(([N,_],O)=>{_&&(_(),c.set(O,[N]))})});let h=!0;const f=Pk(()=>h,l,u,s),p=Nk(t,f);Ll.set(t,p);const m=[t,o,d];return mo.set(p,m),Reflect.ownKeys(t).forEach(g=>{const T=Object.getOwnPropertyDescriptor(t,g);"value"in T&&T.writable&&(p[g]=t[g])}),h=!1,p}function Qt(t,e,n){const r=mo.get(t);let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function $l(t){const e=mo.get(t),[n,r]=e;return Rk(n,r())}function Bl(t){return gu.add(t),t}function xk(){return{proxyStateMap:mo,refSet:gu,snapCache:Sg,versionHolder:Ud,proxyCache:Ll}}function en(t,e,n,r){let s=t[e];return Qt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:kk,snapCache:Dk}=xk(),Gu=t=>kk.has(t);function Uk(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=Dk.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return Gu(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Gu(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!Gu(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!Gu(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Rt(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}const XC={isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()}};var QC={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(it,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",c="hour",l="day",u="week",d="month",h="quarter",f="year",p="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,T=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var w=["th","st","nd","rd"],E=P%100;return"["+P+(w[(E-20)%10]||w[E]||w[0])+"]"}},_=function(P,w,E){var R=String(P);return!R||R.length>=w?P:""+Array(w+1-R.length).join(E)+P},O={s:_,z:function(P){var w=-P.utcOffset(),E=Math.abs(w),R=Math.floor(E/60),b=E%60;return(w<=0?"+":"-")+_(R,2,"0")+":"+_(b,2,"0")},m:function P(w,E){if(w.date()<E.date())return-P(E,w);var R=12*(E.year()-w.year())+(E.month()-w.month()),b=w.clone().add(R,d),y=E-b<0,C=w.clone().add(R+(y?-1:1),d);return+(-(R+(E-b)/(y?b-C:C-b))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:f,w:u,d:l,D:p,h:c,m:a,s:o,ms:i,Q:h}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},A="en",x={};x[A]=N;var k="$isDayjsObject",L=function(P){return P instanceof H||!(!P||!P[k])},M=function P(w,E,R){var b;if(!w)return A;if(typeof w=="string"){var y=w.toLowerCase();x[y]&&(b=y),E&&(x[y]=E,b=y);var C=w.split("-");if(!b&&C.length>1)return P(C[0])}else{var $=w.name;x[$]=w,b=$}return!R&&b&&(A=b),b||!R&&A},z=function(P,w){if(L(P))return P.clone();var E=typeof w=="object"?w:{};return E.date=P,E.args=arguments,new H(E)},J=O;J.l=M,J.i=L,J.w=function(P,w){return z(P,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var H=function(){function P(E){this.$L=M(E.locale,null,!0),this.parse(E),this.$x=this.$x||E.x||{},this[k]=!0}var w=P.prototype;return w.parse=function(E){this.$d=function(R){var b=R.date,y=R.utc;if(b===null)return new Date(NaN);if(J.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var C=b.match(g);if(C){var $=C[2]-1||0,B=(C[7]||"0").substring(0,3);return y?new Date(Date.UTC(C[1],$,C[3]||1,C[4]||0,C[5]||0,C[6]||0,B)):new Date(C[1],$,C[3]||1,C[4]||0,C[5]||0,C[6]||0,B)}}return new Date(b)}(E),this.init()},w.init=function(){var E=this.$d;this.$y=E.getFullYear(),this.$M=E.getMonth(),this.$D=E.getDate(),this.$W=E.getDay(),this.$H=E.getHours(),this.$m=E.getMinutes(),this.$s=E.getSeconds(),this.$ms=E.getMilliseconds()},w.$utils=function(){return J},w.isValid=function(){return this.$d.toString()!==m},w.isSame=function(E,R){var b=z(E);return this.startOf(R)<=b&&b<=this.endOf(R)},w.isAfter=function(E,R){return z(E)<this.startOf(R)},w.isBefore=function(E,R){return this.endOf(R)<z(E)},w.$g=function(E,R,b){return J.u(E)?this[R]:this.set(b,E)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(E,R){var b=this,y=!!J.u(R)||R,C=J.p(E),$=function(ve,Be){var ct=J.w(b.$u?Date.UTC(b.$y,Be,ve):new Date(b.$y,Be,ve),b);return y?ct:ct.endOf(l)},B=function(ve,Be){return J.w(b.toDate()[ve].apply(b.toDate("s"),(y?[0,0,0,0]:[23,59,59,999]).slice(Be)),b)},G=this.$W,Y=this.$M,Q=this.$D,ye="set"+(this.$u?"UTC":"");switch(C){case f:return y?$(1,0):$(31,11);case d:return y?$(1,Y):$(0,Y+1);case u:var be=this.$locale().weekStart||0,De=(G<be?G+7:G)-be;return $(y?Q-De:Q+(6-De),Y);case l:case p:return B(ye+"Hours",0);case c:return B(ye+"Minutes",1);case a:return B(ye+"Seconds",2);case o:return B(ye+"Milliseconds",3);default:return this.clone()}},w.endOf=function(E){return this.startOf(E,!1)},w.$set=function(E,R){var b,y=J.p(E),C="set"+(this.$u?"UTC":""),$=(b={},b[l]=C+"Date",b[p]=C+"Date",b[d]=C+"Month",b[f]=C+"FullYear",b[c]=C+"Hours",b[a]=C+"Minutes",b[o]=C+"Seconds",b[i]=C+"Milliseconds",b)[y],B=y===l?this.$D+(R-this.$W):R;if(y===d||y===f){var G=this.clone().set(p,1);G.$d[$](B),G.init(),this.$d=G.set(p,Math.min(this.$D,G.daysInMonth())).$d}else $&&this.$d[$](B);return this.init(),this},w.set=function(E,R){return this.clone().$set(E,R)},w.get=function(E){return this[J.p(E)]()},w.add=function(E,R){var b,y=this;E=Number(E);var C=J.p(R),$=function(Y){var Q=z(y);return J.w(Q.date(Q.date()+Math.round(Y*E)),y)};if(C===d)return this.set(d,this.$M+E);if(C===f)return this.set(f,this.$y+E);if(C===l)return $(1);if(C===u)return $(7);var B=(b={},b[a]=r,b[c]=s,b[o]=n,b)[C]||1,G=this.$d.getTime()+E*B;return J.w(G,this)},w.subtract=function(E,R){return this.add(-1*E,R)},w.format=function(E){var R=this,b=this.$locale();if(!this.isValid())return b.invalidDate||m;var y=E||"YYYY-MM-DDTHH:mm:ssZ",C=J.z(this),$=this.$H,B=this.$m,G=this.$M,Y=b.weekdays,Q=b.months,ye=b.meridiem,be=function(Be,ct,Ct,$t){return Be&&(Be[ct]||Be(R,y))||Ct[ct].slice(0,$t)},De=function(Be){return J.s($%12||12,Be,"0")},ve=ye||function(Be,ct,Ct){var $t=Be<12?"AM":"PM";return Ct?$t.toLowerCase():$t};return y.replace(T,function(Be,ct){return ct||function(Ct){switch(Ct){case"YY":return String(R.$y).slice(-2);case"YYYY":return J.s(R.$y,4,"0");case"M":return G+1;case"MM":return J.s(G+1,2,"0");case"MMM":return be(b.monthsShort,G,Q,3);case"MMMM":return be(Q,G);case"D":return R.$D;case"DD":return J.s(R.$D,2,"0");case"d":return String(R.$W);case"dd":return be(b.weekdaysMin,R.$W,Y,2);case"ddd":return be(b.weekdaysShort,R.$W,Y,3);case"dddd":return Y[R.$W];case"H":return String($);case"HH":return J.s($,2,"0");case"h":return De(1);case"hh":return De(2);case"a":return ve($,B,!0);case"A":return ve($,B,!1);case"m":return String(B);case"mm":return J.s(B,2,"0");case"s":return String(R.$s);case"ss":return J.s(R.$s,2,"0");case"SSS":return J.s(R.$ms,3,"0");case"Z":return C}return null}(Be)||C.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(E,R,b){var y,C=this,$=J.p(R),B=z(E),G=(B.utcOffset()-this.utcOffset())*r,Y=this-B,Q=function(){return J.m(C,B)};switch($){case f:y=Q()/12;break;case d:y=Q();break;case h:y=Q()/3;break;case u:y=(Y-G)/6048e5;break;case l:y=(Y-G)/864e5;break;case c:y=Y/s;break;case a:y=Y/r;break;case o:y=Y/n;break;default:y=Y}return b?y:J.a(y)},w.daysInMonth=function(){return this.endOf(d).$D},w.$locale=function(){return x[this.$L]},w.locale=function(E,R){if(!E)return this.$L;var b=this.clone(),y=M(E,R,!0);return y&&(b.$L=y),b},w.clone=function(){return J.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},P}(),F=H.prototype;return z.prototype=F,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",l],["$M",d],["$y",f],["$D",p]].forEach(function(P){F[P[1]]=function(w){return this.$g(w,P[0],P[1])}}),z.extend=function(P,w){return P.$i||(P(w,H,z),P.$i=!0),z},z.locale=M,z.isDayjs=L,z.unix=function(P){return z(1e3*P)},z.en=x[A],z.Ls=x,z.p={},z})})(QC);var Mk=QC.exports;const sc=_o(Mk);var eA={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(it,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var r=["th","st","nd","rd"],s=n%100;return"["+n+(r[(s-20)%10]||r[s]||r[0])+"]"}}})})(eA);var Lk=eA.exports;const $k=_o(Lk);var tA={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(it,function(){return function(n,r,s){n=n||{};var i=r.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(l,u,d,h){return i.fromToBase(l,u,d,h)}s.en.relativeTime=o,i.fromToBase=function(l,u,d,h,f){for(var p,m,g,T=d.$locale().relativeTime||o,N=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=N.length,O=0;O<_;O+=1){var A=N[O];A.d&&(p=h?s(l).diff(d,A.d,!0):d.diff(l,A.d,!0));var x=(n.rounding||Math.round)(Math.abs(p));if(g=p>0,x<=A.r||!A.r){x<=1&&O>0&&(A=N[O-1]);var k=T[A.l];f&&(x=f(""+x)),m=typeof k=="string"?k.replace("%d",x):k(x,u,A.l,g);break}}if(u)return m;var L=g?T.future:T.past;return typeof L=="function"?L(m):L.replace("%s",m)},i.to=function(l,u){return a(l,u,this,!0)},i.from=function(l,u){return a(l,u,this)};var c=function(l){return l.$u?s.utc():s()};i.toNow=function(l){return this.to(c(this),l)},i.fromNow=function(l){return this.from(c(this),l)}}})})(tA);var Bk=tA.exports;const Fk=_o(Bk);var nA={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(it,function(){return function(n,r,s){s.updateLocale=function(i,o){var a=s.Ls[i];if(a)return(o?Object.keys(o):[]).forEach(function(c){a[c]=o[c]}),a}}})})(nA);var jk=nA.exports;const Wk=_o(jk);sc.extend(Fk);sc.extend(Wk);const Hk={...$k,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},zk=["January","February","March","April","May","June","July","August","September","October","November","December"];sc.locale("en-web3-modal",Hk);const nE={getMonthNameByIndex(t){return zk[t]},getYear(t=new Date().toISOString()){return sc(t).year()},getRelativeDateFromNow(t){return sc(t).locale("en-web3-modal").fromNow(!0)},formatDate(t,e="DD MMM"){return sc(t).format(e)}};var rE={};const j={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",BASE_ACCOUNT:"baseAccount",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122",TON:"ton"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks",ton:"TON"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",TON:"ton"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof Ft<"u"&&typeof rE<"u"?rE.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}},HEADLESS_NOT_ENABLED:{DEFAULT:{displayMessage:"",debugMessage:"Headless support is not enabled. Please enable it with the features.headless option in the AppKit configuration and make sure your current plan supports it."}}},IS_DEVELOPMENT:typeof Ft<"u"&&!1,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"],METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH"},rA={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(n=>n.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const n=t.find(s=>s.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return j.CHAIN_NAME_MAP?.[r]||void 0}},sA=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var qk=20,Vk=1,ca=1e6,sE=1e6,Kk=-7,Gk=21,Yk=!1,mu="[big.js] ",va=mu+"Invalid ",Kh=va+"decimal places",Jk=va+"rounding mode",iA=mu+"Division by zero",Ot={},Ms=void 0,Zk=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function oA(){function t(e){var n=this;if(!(n instanceof t))return e===Ms?oA():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(va+"value");e=e===0&&1/e<0?"-0":String(e)}Xk(n,e)}n.constructor=t}return t.prototype=Ot,t.DP=qk,t.RM=Vk,t.NE=Kk,t.PE=Gk,t.strict=Yk,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Xk(t,e){var n,r,s;if(!Zk.test(e))throw Error(va+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function _a(t,e,n,r){var s=t.c;if(n===Ms&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(Jk);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==Ms))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==Ms||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Ca(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}Ot.abs=function(){var t=new this.constructor(this);return t.s=1,t};Ot.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Ot.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>ca)throw Error(Kh);if(!s[0])throw Error(iA);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),f=a=s.length,p=r.length,m=r.slice(0,a),g=m.length,T=t,N=T.c=[],_=0,O=o+(T.e=e.e-t.e)+1;for(T.s=i,i=O<0?0:O,h.unshift(0);g++<a;)m.push(0);do{for(l=0;l<10;l++){if(a!=(g=m.length))u=a>g?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=m[d]){u=s[d]>m[d]?1:-1;break}if(u<0){for(c=g==a?s:h;g;){if(m[--g]<c[g]){for(d=g;d&&!m[--d];)m[d]=9;--m[d],m[g]+=10}m[g]-=c[g]}for(;!m[0];)m.shift()}else break}N[_++]=u?l:++l,m[0]&&u?m[g]=r[f]||0:m=[r[f]]}while((f++<p||m[0]!==Ms)&&i--);return!N[0]&&_!=1&&(N.shift(),T.e--,O--),_>O&&_a(T,O,n.RM,m[0]!==Ms),T};Ot.eq=function(t){return this.cmp(t)===0};Ot.gt=function(t){return this.cmp(t)>0};Ot.gte=function(t){return this.cmp(t)>-1};Ot.lt=function(t){return this.cmp(t)<0};Ot.lte=function(t){return this.cmp(t)<1};Ot.minus=Ot.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};Ot.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(iA);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};Ot.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Ot.plus=Ot.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Ot.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-sE||t>sE)throw Error(va+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};Ot.prec=function(t,e){if(t!==~~t||t<1||t>ca)throw Error(va+"precision");return _a(new this.constructor(this),t,e)};Ot.round=function(t,e){if(t===Ms)t=0;else if(t!==~~t||t<-ca||t>ca)throw Error(Kh);return _a(new this.constructor(this),t+this.e+1,e)};Ot.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(mu+"No square root");i=Math.sqrt(+Ca(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return _a(t,(s.DP-=4)+t.e+1,s.RM)};Ot.times=Ot.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Ot.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==Ms){if(t!==~~t||t<0||t>ca)throw Error(Kh);for(n=_a(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return Ca(n,!0,!!r)};Ot.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==Ms){if(t!==~~t||t<0||t>ca)throw Error(Kh);for(n=_a(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return Ca(n,!1,!!r)};Ot[Symbol.for("nodejs.util.inspect.custom")]=Ot.toJSON=Ot.toString=function(){var t=this,e=t.constructor;return Ca(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Ot.toNumber=function(){var t=+Ca(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(mu+"Imprecise conversion");return t};Ot.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==Ms){if(t!==~~t||t<1||t>ca)throw Error(va+"precision");for(n=_a(new r(n),t,e);n.c.length<t;)n.c.push(0)}return Ca(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};Ot.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(mu+"valueOf disallowed");return Ca(t,t.e<=e.NE||t.e>=e.PE,!0)};var xi=oA();const Jt={bigNumber(t){return t?new xi(t):new xi(0)},multiply(t,e){if(t===void 0||e===void 0)return new xi(0);const n=new xi(t),r=new xi(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new xi(0).toFixed(e):new xi(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new xi(e).toNumber()}},tX={numericInputKeyDown(t,e,n){const r=["Backspace","Meta","Ctrl","a","A","c","C","x","X","v","V","ArrowLeft","ArrowRight","Tab"],s=t.metaKey||t.ctrlKey,i=t.key,o=i.toLocaleLowerCase(),a=o==="a",c=o==="c",l=o==="v",u=o==="x",d=i===",",h=i===".",f=i>="0"&&i<="9";!s&&(a||c||l||u)&&t.preventDefault(),e==="0"&&!d&&!h&&i==="0"&&t.preventDefault(),e==="0"&&f&&(n(i),t.preventDefault()),(d||h)&&(e||(n("0."),t.preventDefault()),(e?.includes(".")||e?.includes(","))&&t.preventDefault()),!f&&!r.includes(i)&&!h&&!d&&t.preventDefault()}},Qk=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],eD=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],tD=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],nD={getERC20Abi:t=>j.USDT_CONTRACT_ADDRESSES.includes(t)?tD:Qk,getSwapAbi:()=>eD},nX={URLS:{FAQ:"https://walletconnect.com/faq"}},Rr={ConnectorExplorerIds:{[j.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[j.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[j.CONNECTOR_ID.BASE_ACCOUNT]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[j.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[j.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[j.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[j.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[j.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[j.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[j.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[j.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[j.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[j.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[j.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[j.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[j.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[j.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[j.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[j.BINANCE_CONNECTOR_NAME]:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25"},ConnectorImageIds:{[j.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[j.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[j.CONNECTOR_ID.BASE_ACCOUNT]:"bba2c8be-7fd1-463e-42b1-796ecb0ad200",[j.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[j.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[j.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[j.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[j.CONNECTOR_ID.INJECTED]:"Browser Wallet",[j.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[j.CONNECTOR_ID.COINBASE]:"Coinbase",[j.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[j.CONNECTOR_ID.BASE_ACCOUNT]:"Base Account",[j.CONNECTOR_ID.LEDGER]:"Ledger",[j.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[j.CONNECTOR_ID.INJECTED]:"INJECTED",[j.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[j.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[j.CONNECTOR_ID.AUTH]:"AUTH"}},pn={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},xs={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001,USER_REJECTED_METHODS:5002,USER_REJECTED:5e3},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){if(xs.isRpcProviderError(t)){const e=t.code===xs.RPC_ERROR_CODE.USER_REJECTED_REQUEST,n=t.code===xs.RPC_ERROR_CODE.USER_REJECTED_METHODS;return e||n||xs.isUserRejectedMessage(t.message)}return t instanceof Error?xs.isUserRejectedMessage(t.message):!1}};class rD extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=xs.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}}class Zm extends rD{constructor(e){super(e,{code:xs.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=xs.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}}const xe={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version",TON_WALLETS_CACHE:"@appkit/ton_wallets_cache"};function Qf(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const Pe={setItem(t,e){pl()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(pl())return localStorage.getItem(t)||void 0},removeItem(t){pl()&&localStorage.removeItem(t)},clear(){pl()&&localStorage.clear()}};function pl(){return typeof window<"u"&&typeof localStorage<"u"}function Fl(t,e){const n=t?.["--apkt-accent"]??t?.["--w3m-accent"];return e==="light"?{"--w3m-accent":n||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":n||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var iE={};const ep=(typeof Ft<"u"&&typeof iE<"u"?iE.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",aA=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],sD="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",et={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:ep,SECURE_SITE_DASHBOARD:`${ep}/dashboard`,SECURE_SITE_FAVICON:`${ep}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],SUGGESTED_TOKENS_BY_CHAIN:{"eip155:42161":["USD0"]},BALANCE_SUPPORTED_CHAINS:[j.CHAIN.EVM,j.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[j.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[j.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[j.CHAIN.EVM,j.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[j.CHAIN.EVM,j.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[j.CHAIN.EVM,j.CHAIN.TON],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x",ton:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[j.CHAIN.EVM,j.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1,headless:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1,headless:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1,headless:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa",ton:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0},MANDATORY_WALLET_IDS_ON_MOBILE:[Rr.ConnectorExplorerIds[j.CONNECTOR_ID.COINBASE],Rr.ConnectorExplorerIds[j.CONNECTOR_ID.COINBASE_SDK],Rr.ConnectorExplorerIds[j.CONNECTOR_ID.BASE_ACCOUNT],Rr.ConnectorExplorerIds[j.SOLFLARE_CONNECTOR_NAME],Rr.ConnectorExplorerIds[j.PHANTOM_CONNECTOR_NAME],Rr.ConnectorExplorerIds[j.BINANCE_CONNECTOR_NAME]],DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"]},te={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5,tonWallets:864e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=te.getActiveNamespace(),e=te.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{Pe.setItem(xe.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{}},getWalletConnectDeepLink(){try{const t=Pe.getItem(xe.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{}},deleteWalletConnectDeepLink(){try{Pe.removeItem(xe.DEEPLINK_CHOICE)}catch{}},setActiveNamespace(t){try{Pe.setItem(xe.ACTIVE_NAMESPACE,t)}catch{}},setActiveCaipNetworkId(t){try{Pe.setItem(xe.ACTIVE_CAIP_NETWORK_ID,t),te.setActiveNamespace(t.split(":")[0])}catch{}},getActiveCaipNetworkId(){try{return Pe.getItem(xe.ACTIVE_CAIP_NETWORK_ID)}catch{return}},deleteActiveCaipNetworkId(){try{Pe.removeItem(xe.ACTIVE_CAIP_NETWORK_ID)}catch{}},deleteConnectedConnectorId(t){try{const e=Qf(t);Pe.removeItem(e)}catch{}},setAppKitRecent(t){try{const e=te.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),Pe.setItem(xe.RECENT_WALLETS,JSON.stringify(e)),Pe.setItem(xe.RECENT_WALLET,JSON.stringify(t)))}catch{}},getRecentWallets(){try{const t=Pe.getItem(xe.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{}return[]},getRecentWallet(){try{const t=Pe.getItem(xe.RECENT_WALLET);return t?JSON.parse(t):null}catch{}return null},deleteRecentWallet(){try{Pe.removeItem(xe.RECENT_WALLET)}catch{}},setConnectedConnectorId(t,e){try{const n=Qf(t);Pe.setItem(n,e)}catch{}},getActiveNamespace(){try{return Pe.getItem(xe.ACTIVE_NAMESPACE)}catch{}},getConnectedConnectorId(t){if(t)try{const e=Qf(t);return Pe.getItem(e)}catch{}},setConnectedSocialProvider(t){try{Pe.setItem(xe.CONNECTED_SOCIAL,t)}catch{}},getConnectedSocialProvider(){try{return Pe.getItem(xe.CONNECTED_SOCIAL)}catch{}},deleteConnectedSocialProvider(){try{Pe.removeItem(xe.CONNECTED_SOCIAL)}catch{}},getConnectedSocialUsername(){try{return Pe.getItem(xe.CONNECTED_SOCIAL_USERNAME)}catch{}},getStoredActiveCaipNetworkId(){return Pe.getItem(xe.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{Pe.setItem(xe.CONNECTION_STATUS,t)}catch{}},getConnectionStatus(){try{return Pe.getItem(xe.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=Pe.getItem(xe.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));Pe.setItem(xe.CONNECTED_NAMESPACES,e.join(","))}catch{}},addConnectedNamespace(t){try{const e=te.getConnectedNamespaces();e.includes(t)||(e.push(t),te.setConnectedNamespaces(e))}catch{}},removeConnectedNamespace(t){try{const e=te.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),te.setConnectedNamespaces(e))}catch{}},getTelegramSocialProvider(){try{return Pe.getItem(xe.TELEGRAM_SOCIAL_PROVIDER)}catch{return null}},setTelegramSocialProvider(t){try{Pe.setItem(xe.TELEGRAM_SOCIAL_PROVIDER,t)}catch{}},removeTelegramSocialProvider(){try{Pe.removeItem(xe.TELEGRAM_SOCIAL_PROVIDER)}catch{}},getBalanceCache(){let t={};try{const e=Pe.getItem(xe.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{}return t},removeAddressFromBalanceCache(t){try{const e=te.getBalanceCache();Pe.setItem(xe.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{}},getBalanceCacheForCaipAddress(t){try{const n=te.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;te.removeAddressFromBalanceCache(t)}catch{}},updateBalanceCache(t){try{const e=te.getBalanceCache();e[t.caipAddress]=t,Pe.setItem(xe.PORTFOLIO_CACHE,JSON.stringify(e))}catch{}},getNativeBalanceCache(){let t={};try{const e=Pe.getItem(xe.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{}return t},removeAddressFromNativeBalanceCache(t){try{const e=te.getBalanceCache();Pe.setItem(xe.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{}},getNativeBalanceCacheForCaipAddress(t){try{const n=te.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;te.removeAddressFromBalanceCache(t)}catch{}},updateNativeBalanceCache(t){try{const e=te.getNativeBalanceCache();e[t.caipAddress]=t,Pe.setItem(xe.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{}},getEnsCache(){let t={};try{const e=Pe.getItem(xe.ENS_CACHE);t=e?JSON.parse(e):{}}catch{}return t},getEnsFromCacheForAddress(t){try{const n=te.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;te.removeEnsFromCache(t)}catch{}},updateEnsCache(t){try{const e=te.getEnsCache();e[t.address]=t,Pe.setItem(xe.ENS_CACHE,JSON.stringify(e))}catch{}},removeEnsFromCache(t){try{const e=te.getEnsCache();Pe.setItem(xe.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{}},getIdentityCache(){let t={};try{const e=Pe.getItem(xe.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{}return t},getIdentityFromCacheForAddress(t){try{const n=te.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;te.removeIdentityFromCache(t)}catch{}},updateIdentityCache(t){try{const e=te.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},Pe.setItem(xe.IDENTITY_CACHE,JSON.stringify(e))}catch{}},removeIdentityFromCache(t){try{const e=te.getIdentityCache();Pe.setItem(xe.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{}},getTonWalletsCache(){try{const t=Pe.getItem(xe.TON_WALLETS_CACHE),e=t?JSON.parse(t):void 0;if(e&&!this.isCacheExpired(e.timestamp,this.cacheExpiry.tonWallets))return e;te.removeTonWalletsCache()}catch{}},updateTonWalletsCache(t){try{const e=te.getTonWalletsCache()||{timestamp:0,wallets:[]};e.timestamp=new Date().getTime(),e.wallets=t,Pe.setItem(xe.TON_WALLETS_CACHE,JSON.stringify(e))}catch{}},removeTonWalletsCache(){try{Pe.removeItem(xe.TON_WALLETS_CACHE)}catch{}},clearAddressCache(){try{Pe.removeItem(xe.PORTFOLIO_CACHE),Pe.removeItem(xe.NATIVE_BALANCE_CACHE),Pe.removeItem(xe.ENS_CACHE),Pe.removeItem(xe.IDENTITY_CACHE),Pe.removeItem(xe.HISTORY_TRANSACTIONS_CACHE)}catch{}},setPreferredAccountTypes(t){try{Pe.setItem(xe.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{}},getPreferredAccountTypes(){try{const t=Pe.getItem(xe.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{}return{}},setConnections(t,e){try{const n=te.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===j.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};Pe.setItem(xe.CONNECTIONS,JSON.stringify(i))}catch{}},getConnections(){try{const t=Pe.getItem(xe.CONNECTIONS);return t?JSON.parse(t):{}}catch{return{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=te.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),Pe.setItem(xe.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{}},getDisconnectedConnectorIds(){try{const t=Pe.getItem(xe.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{}return{}},addDisconnectedConnectorId(t,e){try{const n=te.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),Pe.setItem(xe.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{}},removeDisconnectedConnectorId(t,e){try{const n=te.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),Pe.setItem(xe.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{}},isConnectorDisconnected(t,e){try{return(te.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{}return!1},getTransactionsCache(){try{const t=Pe.getItem(xe.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const r=te.getTransactionsCache()[t]?.[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;te.removeTransactionsCache({address:t,chainId:e})}catch{}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=te.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},Pe.setItem(xe.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{}},removeTransactionsCache({address:t,chainId:e}){try{const n=te.getTransactionsCache(),r=n?.[t]||{},{[e]:s,...i}=r;Pe.setItem(xe.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{}},getTokenPriceCache(){try{const t=Pe.getItem(xe.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{}return{}},getTokenPriceCacheForAddresses(t){try{const n=te.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;te.removeTokenPriceCache(t)}catch{}},updateTokenPriceCache(t){try{const e=te.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},Pe.setItem(xe.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{}},removeTokenPriceCache(t){try{const e=te.getTokenPriceCache();Pe.setItem(xe.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t?.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{}},getLatestAppKitVersionCache(){try{const t=Pe.getItem(xe.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{}return{}},updateLatestAppKitVersion(t){try{const e=te.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,Pe.setItem(xe.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{}}},de={getWindow(){if(!(typeof window>"u"))return window},isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return de.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=et.TEN_SEC_MS:!0},isAllowedRetry(t,e=et.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(de.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const n=new URL(t),r=new URL(e);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+et.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(de.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!de.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?te.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,de.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(n=l)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return j.W3M_API_URL},getBlockchainApiUrl(){return j.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return j.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?et.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in j.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l}},cA={BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org"},iD={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}};var yc={};const oD="https://secure.walletconnect.org/sdk",aD=(typeof Ft<"u"&&typeof yc<"u"?yc.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||oD,cD=(typeof Ft<"u"&&typeof yc<"u"?yc.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",lD=(typeof Ft<"u"&&typeof yc<"u"?yc.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",Oe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},Kt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},oE={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},dn={set(t,e){kr.isClient&&localStorage.setItem(`${Oe.STORAGE_KEY}${t}`,e)},get(t){return kr.isClient?localStorage.getItem(`${Oe.STORAGE_KEY}${t}`):null},delete(t,e){kr.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${Oe.STORAGE_KEY}${t}`))}},Yu=30*1e3,kr={checkIfAllowedToTriggerEmail(){const t=dn.get(Oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Yu){const n=Math.ceil((Yu-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=dn.get(Oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Yu)return Math.ceil((Yu-e)/1e3)}return 0},checkIfRequestExists(t){return Kt.NOT_SAFE_RPC_METHODS.includes(t.method)||Kt.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&(t?.match(oE.transactionHash)||t?.match(oE.signedMessage))?Oe.RPC_RESPONSE_TYPE_TX:Oe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return Kt.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var _t;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(_t||(_t={}));var Tg;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Tg||(Tg={}));const Ae=_t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Xi=t=>{switch(typeof t){case"undefined":return Ae.undefined;case"string":return Ae.string;case"number":return isNaN(t)?Ae.nan:Ae.number;case"boolean":return Ae.boolean;case"function":return Ae.function;case"bigint":return Ae.bigint;case"symbol":return Ae.symbol;case"object":return Array.isArray(t)?Ae.array:t===null?Ae.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Ae.promise:typeof Map<"u"&&t instanceof Map?Ae.map:typeof Set<"u"&&t instanceof Set?Ae.set:typeof Date<"u"&&t instanceof Date?Ae.date:Ae.object;default:return Ae.unknown}},he=_t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),uD=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class fs extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,_t.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}fs.create=t=>new fs(t);const jl=(t,e)=>{let n;switch(t.code){case he.invalid_type:t.received===Ae.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case he.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,_t.jsonStringifyReplacer)}`;break;case he.unrecognized_keys:n=`Unrecognized key(s) in object: ${_t.joinValues(t.keys,", ")}`;break;case he.invalid_union:n="Invalid input";break;case he.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${_t.joinValues(t.options)}`;break;case he.invalid_enum_value:n=`Invalid enum value. Expected ${_t.joinValues(t.options)}, received '${t.received}'`;break;case he.invalid_arguments:n="Invalid function arguments";break;case he.invalid_return_type:n="Invalid function return type";break;case he.invalid_date:n="Invalid date";break;case he.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:_t.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case he.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case he.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case he.custom:n="Invalid input";break;case he.invalid_intersection_types:n="Intersection results could not be merged";break;case he.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case he.not_finite:n="Number must be finite";break;default:n=e.defaultError,_t.assertNever(t)}return{message:n}};let lA=jl;function dD(t){lA=t}function oh(){return lA}const ah=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},hD=[];function Ne(t,e){const n=ah({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,oh(),jl].filter(r=>!!r)});t.common.issues.push(n)}class Zn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return Ze;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Zn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ze;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ze=Object.freeze({status:"aborted"}),uA=t=>({status:"dirty",value:t}),ar=t=>({status:"valid",value:t}),Ng=t=>t.status==="aborted",Og=t=>t.status==="dirty",Wl=t=>t.status==="valid",ch=t=>typeof Promise<"u"&&t instanceof Promise;var je;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(je||(je={}));class Fs{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const aE=(t,e)=>{if(Wl(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new fs(t.common.issues);return this._error=n,this._error}}};function tt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class ot{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Xi(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Xi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Zn,ctx:{common:e.parent.common,data:e.data,parsedType:Xi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ch(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xi(e)},i=this._parseSync({data:e,path:s.path,parent:s});return aE(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xi(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(ch(s)?s:Promise.resolve(s));return aE(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:he.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new ms({schema:this,typeName:qe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return hi.create(this,this._def)}nullable(){return da.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ps.create(this,this._def)}promise(){return Ec.create(this,this._def)}or(e){return Vl.create([this,e],this._def)}and(e){return Kl.create(this,e,this._def)}transform(e){return new ms({...tt(this._def),schema:this,typeName:qe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Xl({...tt(this._def),innerType:this,defaultValue:n,typeName:qe.ZodDefault})}brand(){return new hA({typeName:qe.ZodBranded,type:this,...tt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new hh({...tt(this._def),innerType:this,catchValue:n,typeName:qe.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return yu.create(this,e)}readonly(){return ph.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const fD=/^c[^\s-]{8,}$/i,pD=/^[a-z][a-z0-9]*$/,gD=/^[0-9A-HJKMNP-TV-Z]{26}$/,mD=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,yD=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,wD="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let tp;const ED=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,bD=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,vD=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function _D(t,e){return!!((e==="v4"||!e)&&ED.test(t)||(e==="v6"||!e)&&bD.test(t))}class hs extends ot{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ae.string){const i=this._getOrReturnCtx(e);return Ne(i,{code:he.invalid_type,expected:Ae.string,received:i.parsedType}),Ze}const r=new Zn;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?Ne(s,{code:he.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Ne(s,{code:he.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")yD.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"email",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")tp||(tp=new RegExp(wD,"u")),tp.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"emoji",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")mD.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"uuid",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")fD.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"cuid",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")pD.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"cuid2",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")gD.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"ulid",code:he.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Ne(s,{validation:"url",code:he.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"regex",code:he.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?vD(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?_D(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Ne(s,{validation:"ip",code:he.invalid_string,message:i.message}),r.dirty()):_t.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:he.invalid_string,...je.errToObj(r)})}_addCheck(e){return new hs({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...je.errToObj(e)})}url(e){return this._addCheck({kind:"url",...je.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...je.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...je.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...je.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...je.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...je.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...je.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,...je.errToObj(e?.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...je.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...je.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...je.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...je.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...je.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...je.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...je.errToObj(n)})}nonempty(e){return this.min(1,je.errToObj(e))}trim(){return new hs({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new hs({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new hs({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}hs.create=t=>{var e;return new hs({checks:[],typeName:qe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...tt(t)})};function CD(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class yo extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ae.number){const i=this._getOrReturnCtx(e);return Ne(i,{code:he.invalid_type,expected:Ae.number,received:i.parsedType}),Ze}let r;const s=new Zn;for(const i of this._def.checks)i.kind==="int"?_t.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?CD(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.not_finite,message:i.message}),s.dirty()):_t.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,je.toString(n))}gt(e,n){return this.setLimit("min",e,!1,je.toString(n))}lte(e,n){return this.setLimit("max",e,!0,je.toString(n))}lt(e,n){return this.setLimit("max",e,!1,je.toString(n))}setLimit(e,n,r,s){return new yo({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:je.toString(s)}]})}_addCheck(e){return new yo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:je.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:je.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:je.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:je.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:je.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:je.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&_t.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}yo.create=t=>new yo({checks:[],typeName:qe.ZodNumber,coerce:t?.coerce||!1,...tt(t)});class wo extends ot{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Ae.bigint){const i=this._getOrReturnCtx(e);return Ne(i,{code:he.invalid_type,expected:Ae.bigint,received:i.parsedType}),Ze}let r;const s=new Zn;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ne(r,{code:he.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):_t.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,je.toString(n))}gt(e,n){return this.setLimit("min",e,!1,je.toString(n))}lte(e,n){return this.setLimit("max",e,!0,je.toString(n))}lt(e,n){return this.setLimit("max",e,!1,je.toString(n))}setLimit(e,n,r,s){return new wo({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:je.toString(s)}]})}_addCheck(e){return new wo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:je.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:je.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}wo.create=t=>{var e;return new wo({checks:[],typeName:qe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...tt(t)})};class Hl extends ot{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ae.boolean){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.boolean,received:r.parsedType}),Ze}return ar(e.data)}}Hl.create=t=>new Hl({typeName:qe.ZodBoolean,coerce:t?.coerce||!1,...tt(t)});class la extends ot{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ae.date){const i=this._getOrReturnCtx(e);return Ne(i,{code:he.invalid_type,expected:Ae.date,received:i.parsedType}),Ze}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ne(i,{code:he.invalid_date}),Ze}const r=new Zn;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Ne(s,{code:he.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):_t.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new la({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:je.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:je.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}la.create=t=>new la({checks:[],coerce:t?.coerce||!1,typeName:qe.ZodDate,...tt(t)});class lh extends ot{_parse(e){if(this._getType(e)!==Ae.symbol){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.symbol,received:r.parsedType}),Ze}return ar(e.data)}}lh.create=t=>new lh({typeName:qe.ZodSymbol,...tt(t)});class zl extends ot{_parse(e){if(this._getType(e)!==Ae.undefined){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.undefined,received:r.parsedType}),Ze}return ar(e.data)}}zl.create=t=>new zl({typeName:qe.ZodUndefined,...tt(t)});class ql extends ot{_parse(e){if(this._getType(e)!==Ae.null){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.null,received:r.parsedType}),Ze}return ar(e.data)}}ql.create=t=>new ql({typeName:qe.ZodNull,...tt(t)});class wc extends ot{constructor(){super(...arguments),this._any=!0}_parse(e){return ar(e.data)}}wc.create=t=>new wc({typeName:qe.ZodAny,...tt(t)});class oa extends ot{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ar(e.data)}}oa.create=t=>new oa({typeName:qe.ZodUnknown,...tt(t)});class mi extends ot{_parse(e){const n=this._getOrReturnCtx(e);return Ne(n,{code:he.invalid_type,expected:Ae.never,received:n.parsedType}),Ze}}mi.create=t=>new mi({typeName:qe.ZodNever,...tt(t)});class uh extends ot{_parse(e){if(this._getType(e)!==Ae.undefined){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.void,received:r.parsedType}),Ze}return ar(e.data)}}uh.create=t=>new uh({typeName:qe.ZodVoid,...tt(t)});class ps extends ot{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==Ae.array)return Ne(n,{code:he.invalid_type,expected:Ae.array,received:n.parsedType}),Ze;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(Ne(n,{code:o?he.too_big:he.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Ne(n,{code:he.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Ne(n,{code:he.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Fs(n,o,n.path,a)))).then(o=>Zn.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Fs(n,o,n.path,a)));return Zn.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new ps({...this._def,minLength:{value:e,message:je.toString(n)}})}max(e,n){return new ps({...this._def,maxLength:{value:e,message:je.toString(n)}})}length(e,n){return new ps({...this._def,exactLength:{value:e,message:je.toString(n)}})}nonempty(e){return this.min(1,e)}}ps.create=(t,e)=>new ps({type:t,minLength:null,maxLength:null,exactLength:null,typeName:qe.ZodArray,...tt(e)});function Ya(t){if(t instanceof Vt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=hi.create(Ya(r))}return new Vt({...t._def,shape:()=>e})}else return t instanceof ps?new ps({...t._def,type:Ya(t.element)}):t instanceof hi?hi.create(Ya(t.unwrap())):t instanceof da?da.create(Ya(t.unwrap())):t instanceof js?js.create(t.items.map(e=>Ya(e))):t}class Vt extends ot{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=_t.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==Ae.object){const l=this._getOrReturnCtx(e);return Ne(l,{code:he.invalid_type,expected:Ae.object,received:l.parsedType}),Ze}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof mi&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Fs(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof mi){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(Ne(s,{code:he.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Fs(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Zn.mergeObjectSync(r,l)):Zn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return je.errToObj,new Vt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=je.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Vt({...this._def,unknownKeys:"strip"})}passthrough(){return new Vt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Vt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Vt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:qe.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Vt({...this._def,catchall:e})}pick(e){const n={};return _t.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Vt({...this._def,shape:()=>n})}omit(e){const n={};return _t.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Vt({...this._def,shape:()=>n})}deepPartial(){return Ya(this)}partial(e){const n={};return _t.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new Vt({...this._def,shape:()=>n})}required(e){const n={};return _t.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof hi;)i=i._def.innerType;n[r]=i}}),new Vt({...this._def,shape:()=>n})}keyof(){return dA(_t.objectKeys(this.shape))}}Vt.create=(t,e)=>new Vt({shape:()=>t,unknownKeys:"strip",catchall:mi.create(),typeName:qe.ZodObject,...tt(e)});Vt.strictCreate=(t,e)=>new Vt({shape:()=>t,unknownKeys:"strict",catchall:mi.create(),typeName:qe.ZodObject,...tt(e)});Vt.lazycreate=(t,e)=>new Vt({shape:t,unknownKeys:"strip",catchall:mi.create(),typeName:qe.ZodObject,...tt(e)});class Vl extends ot{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new fs(a.ctx.common.issues));return Ne(n,{code:he.invalid_union,unionErrors:o}),Ze}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new fs(c));return Ne(n,{code:he.invalid_union,unionErrors:a}),Ze}}get options(){return this._def.options}}Vl.create=(t,e)=>new Vl({options:t,typeName:qe.ZodUnion,...tt(e)});const Md=t=>t instanceof Yl?Md(t.schema):t instanceof ms?Md(t.innerType()):t instanceof Jl?[t.value]:t instanceof Eo?t.options:t instanceof Zl?Object.keys(t.enum):t instanceof Xl?Md(t._def.innerType):t instanceof zl?[void 0]:t instanceof ql?[null]:null;class Gh extends ot{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ae.object)return Ne(n,{code:he.invalid_type,expected:Ae.object,received:n.parsedType}),Ze;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Ne(n,{code:he.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ze)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=Md(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Gh({typeName:qe.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...tt(r)})}}function Rg(t,e){const n=Xi(t),r=Xi(e);if(t===e)return{valid:!0,data:t};if(n===Ae.object&&r===Ae.object){const s=_t.objectKeys(e),i=_t.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=Rg(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===Ae.array&&r===Ae.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=Rg(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===Ae.date&&r===Ae.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Kl extends ot{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(Ng(i)||Ng(o))return Ze;const a=Rg(i.value,o.value);return a.valid?((Og(i)||Og(o))&&n.dirty(),{status:n.value,value:a.data}):(Ne(r,{code:he.invalid_intersection_types}),Ze)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Kl.create=(t,e,n)=>new Kl({left:t,right:e,typeName:qe.ZodIntersection,...tt(n)});class js extends ot{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ae.array)return Ne(r,{code:he.invalid_type,expected:Ae.array,received:r.parsedType}),Ze;if(r.data.length<this._def.items.length)return Ne(r,{code:he.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ze;!this._def.rest&&r.data.length>this._def.items.length&&(Ne(r,{code:he.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Fs(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Zn.mergeArray(n,o)):Zn.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new js({...this._def,rest:e})}}js.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new js({items:t,typeName:qe.ZodTuple,rest:null,...tt(e)})};class Gl extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ae.object)return Ne(r,{code:he.invalid_type,expected:Ae.object,received:r.parsedType}),Ze;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Fs(r,a,r.path,a)),value:o._parse(new Fs(r,r.data[a],r.path,a))});return r.common.async?Zn.mergeObjectAsync(n,s):Zn.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof ot?new Gl({keyType:e,valueType:n,typeName:qe.ZodRecord,...tt(r)}):new Gl({keyType:hs.create(),valueType:e,typeName:qe.ZodRecord,...tt(n)})}}class dh extends ot{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ae.map)return Ne(r,{code:he.invalid_type,expected:Ae.map,received:r.parsedType}),Ze;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Fs(r,a,r.path,[l,"key"])),value:i._parse(new Fs(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return Ze;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return Ze;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}dh.create=(t,e,n)=>new dh({valueType:e,keyType:t,typeName:qe.ZodMap,...tt(n)});class ua extends ot{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ae.set)return Ne(r,{code:he.invalid_type,expected:Ae.set,received:r.parsedType}),Ze;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Ne(r,{code:he.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Ne(r,{code:he.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return Ze;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Fs(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new ua({...this._def,minSize:{value:e,message:je.toString(n)}})}max(e,n){return new ua({...this._def,maxSize:{value:e,message:je.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}ua.create=(t,e)=>new ua({valueType:t,minSize:null,maxSize:null,typeName:qe.ZodSet,...tt(e)});class ic extends ot{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ae.function)return Ne(n,{code:he.invalid_type,expected:Ae.function,received:n.parsedType}),Ze;function r(a,c){return ah({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,oh(),jl].filter(l=>!!l),issueData:{code:he.invalid_arguments,argumentsError:c}})}function s(a,c){return ah({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,oh(),jl].filter(l=>!!l),issueData:{code:he.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Ec){const a=this;return ar(async function(...c){const l=new fs([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(r(c,f)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(s(d,f)),l})})}else{const a=this;return ar(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new fs([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new fs([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ic({...this._def,args:js.create(e).rest(oa.create())})}returns(e){return new ic({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new ic({args:e||js.create([]).rest(oa.create()),returns:n||oa.create(),typeName:qe.ZodFunction,...tt(r)})}}class Yl extends ot{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Yl.create=(t,e)=>new Yl({getter:t,typeName:qe.ZodLazy,...tt(e)});class Jl extends ot{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ne(n,{received:n.data,code:he.invalid_literal,expected:this._def.value}),Ze}return{status:"valid",value:e.data}}get value(){return this._def.value}}Jl.create=(t,e)=>new Jl({value:t,typeName:qe.ZodLiteral,...tt(e)});function dA(t,e){return new Eo({values:t,typeName:qe.ZodEnum,...tt(e)})}class Eo extends ot{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ne(n,{expected:_t.joinValues(r),received:n.parsedType,code:he.invalid_type}),Ze}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return Ne(n,{received:n.data,code:he.invalid_enum_value,options:r}),Ze}return ar(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Eo.create(e)}exclude(e){return Eo.create(this.options.filter(n=>!e.includes(n)))}}Eo.create=dA;class Zl extends ot{_parse(e){const n=_t.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ae.string&&r.parsedType!==Ae.number){const s=_t.objectValues(n);return Ne(r,{expected:_t.joinValues(s),received:r.parsedType,code:he.invalid_type}),Ze}if(n.indexOf(e.data)===-1){const s=_t.objectValues(n);return Ne(r,{received:r.data,code:he.invalid_enum_value,options:s}),Ze}return ar(e.data)}get enum(){return this._def.values}}Zl.create=(t,e)=>new Zl({values:t,typeName:qe.ZodNativeEnum,...tt(e)});class Ec extends ot{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ae.promise&&n.common.async===!1)return Ne(n,{code:he.invalid_type,expected:Ae.promise,received:n.parsedType}),Ze;const r=n.parsedType===Ae.promise?n.data:Promise.resolve(n.data);return ar(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Ec.create=(t,e)=>new Ec({type:t,typeName:qe.ZodPromise,...tt(e)});class ms extends ot{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===qe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Ne(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ze:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?Ze:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Wl(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Wl(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);_t.assertNever(s)}}ms.create=(t,e,n)=>new ms({schema:t,typeName:qe.ZodEffects,effect:e,...tt(n)});ms.createWithPreprocess=(t,e,n)=>new ms({schema:e,effect:{type:"preprocess",transform:t},typeName:qe.ZodEffects,...tt(n)});class hi extends ot{_parse(e){return this._getType(e)===Ae.undefined?ar(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hi.create=(t,e)=>new hi({innerType:t,typeName:qe.ZodOptional,...tt(e)});class da extends ot{_parse(e){return this._getType(e)===Ae.null?ar(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}da.create=(t,e)=>new da({innerType:t,typeName:qe.ZodNullable,...tt(e)});class Xl extends ot{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Ae.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Xl.create=(t,e)=>new Xl({innerType:t,typeName:qe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...tt(e)});class hh extends ot{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ch(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new fs(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new fs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}hh.create=(t,e)=>new hh({innerType:t,typeName:qe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...tt(e)});class fh extends ot{_parse(e){if(this._getType(e)!==Ae.nan){const r=this._getOrReturnCtx(e);return Ne(r,{code:he.invalid_type,expected:Ae.nan,received:r.parsedType}),Ze}return{status:"valid",value:e.data}}}fh.create=t=>new fh({typeName:qe.ZodNaN,...tt(t)});const AD=Symbol("zod_brand");class hA extends ot{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class yu extends ot{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ze:i.status==="dirty"?(n.dirty(),uA(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ze:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new yu({in:e,out:n,typeName:qe.ZodPipeline})}}class ph extends ot{_parse(e){const n=this._def.innerType._parse(e);return Wl(n)&&(n.value=Object.freeze(n.value)),n}}ph.create=(t,e)=>new ph({innerType:t,typeName:qe.ZodReadonly,...tt(e)});const fA=(t,e={},n)=>t?wc.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):wc.create(),ID={object:Vt.lazycreate};var qe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(qe||(qe={}));const SD=(t,e={message:`Input not instance of ${t.name}`})=>fA(n=>n instanceof t,e),pA=hs.create,gA=yo.create,TD=fh.create,ND=wo.create,mA=Hl.create,OD=la.create,RD=lh.create,PD=zl.create,xD=ql.create,kD=wc.create,DD=oa.create,UD=mi.create,MD=uh.create,LD=ps.create,$D=Vt.create,BD=Vt.strictCreate,FD=Vl.create,jD=Gh.create,WD=Kl.create,HD=js.create,zD=Gl.create,qD=dh.create,VD=ua.create,KD=ic.create,GD=Yl.create,YD=Jl.create,JD=Eo.create,ZD=Zl.create,XD=Ec.create,cE=ms.create,QD=hi.create,eU=da.create,tU=ms.createWithPreprocess,nU=yu.create,rU=()=>pA().optional(),sU=()=>gA().optional(),iU=()=>mA().optional(),oU={string:t=>hs.create({...t,coerce:!0}),number:t=>yo.create({...t,coerce:!0}),boolean:t=>Hl.create({...t,coerce:!0}),bigint:t=>wo.create({...t,coerce:!0}),date:t=>la.create({...t,coerce:!0})},aU=Ze;var v=Object.freeze({__proto__:null,defaultErrorMap:jl,setErrorMap:dD,getErrorMap:oh,makeIssue:ah,EMPTY_PATH:hD,addIssueToContext:Ne,ParseStatus:Zn,INVALID:Ze,DIRTY:uA,OK:ar,isAborted:Ng,isDirty:Og,isValid:Wl,isAsync:ch,get util(){return _t},get objectUtil(){return Tg},ZodParsedType:Ae,getParsedType:Xi,ZodType:ot,ZodString:hs,ZodNumber:yo,ZodBigInt:wo,ZodBoolean:Hl,ZodDate:la,ZodSymbol:lh,ZodUndefined:zl,ZodNull:ql,ZodAny:wc,ZodUnknown:oa,ZodNever:mi,ZodVoid:uh,ZodArray:ps,ZodObject:Vt,ZodUnion:Vl,ZodDiscriminatedUnion:Gh,ZodIntersection:Kl,ZodTuple:js,ZodRecord:Gl,ZodMap:dh,ZodSet:ua,ZodFunction:ic,ZodLazy:Yl,ZodLiteral:Jl,ZodEnum:Eo,ZodNativeEnum:Zl,ZodPromise:Ec,ZodEffects:ms,ZodTransformer:ms,ZodOptional:hi,ZodNullable:da,ZodDefault:Xl,ZodCatch:hh,ZodNaN:fh,BRAND:AD,ZodBranded:hA,ZodPipeline:yu,ZodReadonly:ph,custom:fA,Schema:ot,ZodSchema:ot,late:ID,get ZodFirstPartyTypeKind(){return qe},coerce:oU,any:kD,array:LD,bigint:ND,boolean:mA,date:OD,discriminatedUnion:jD,effect:cE,enum:JD,function:KD,instanceof:SD,intersection:WD,lazy:GD,literal:YD,map:qD,nan:TD,nativeEnum:ZD,never:UD,null:xD,nullable:eU,number:gA,object:$D,oboolean:iU,onumber:sU,optional:QD,ostring:rU,pipeline:nU,preprocess:tU,promise:XD,record:zD,set:VD,strictObject:BD,string:pA,symbol:RD,transformer:cE,tuple:HD,undefined:PD,union:FD,unknown:DD,void:MD,NEVER:aU,ZodIssueCode:he,quotelessJson:uD,ZodError:fs});const Gt=v.object({message:v.string()});function Se(t){return v.literal(Oe[t])}const Yh=v.object({serializedMessage:v.string().optional(),accountAddress:v.string(),chainId:v.string(),notBefore:v.string().optional(),domain:v.string(),uri:v.string(),version:v.string(),nonce:v.string(),statement:v.string().optional(),resources:v.array(v.string()).optional(),requestId:v.string().optional(),issuedAt:v.string().optional(),expirationTime:v.string().optional()});v.object({accessList:v.array(v.string()),blockHash:v.string().nullable(),blockNumber:v.string().nullable(),chainId:v.string().or(v.number()),from:v.string(),gas:v.string(),hash:v.string(),input:v.string().nullable(),maxFeePerGas:v.string(),maxPriorityFeePerGas:v.string(),nonce:v.string(),r:v.string(),s:v.string(),to:v.string(),transactionIndex:v.string().nullable(),type:v.string(),v:v.string(),value:v.string()});const cU=v.object({chainId:v.string().or(v.number()),rpcUrl:v.optional(v.string())}),lU=v.object({email:v.string().email()}),uU=v.object({otp:v.string()}),dU=v.object({uri:v.string(),preferredAccountType:v.optional(v.string()),chainId:v.optional(v.string().or(v.number())),siwxMessage:v.optional(Yh),rpcUrl:v.optional(v.string())}),hU=v.object({chainId:v.optional(v.string().or(v.number())),preferredAccountType:v.optional(v.string()),socialUri:v.optional(v.string()),siwxMessage:v.optional(Yh),rpcUrl:v.optional(v.string())}),fU=v.object({provider:v.enum(["google","github","apple","facebook","x","discord"])}),pU=v.object({email:v.string().email()}),gU=v.object({otp:v.string()}),mU=v.object({otp:v.string()}),yU=v.object({themeMode:v.optional(v.enum(["light","dark"])),themeVariables:v.optional(v.record(v.string(),v.string().or(v.number()))),w3mThemeVariables:v.optional(v.record(v.string(),v.string()))}),wU=v.object({metadata:v.object({name:v.string(),description:v.string(),url:v.string(),icons:v.array(v.string())}).optional(),sdkVersion:v.string().optional(),sdkType:v.string().optional(),projectId:v.string()}),EU=v.object({type:v.string()}),bU=v.object({action:v.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),vU=v.object({url:v.string()}),_U=v.object({userName:v.string()}),CU=v.object({email:v.string().optional().nullable(),address:v.string(),chainId:v.string().or(v.number()),accounts:v.array(v.object({address:v.string(),type:v.enum([Kt.ACCOUNT_TYPES.EOA,Kt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:v.string().optional().nullable(),preferredAccountType:v.optional(v.string()),signature:v.string().optional(),message:v.string().optional(),siwxMessage:v.optional(Yh)}),AU=v.object({action:v.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),IU=v.object({email:v.string().email().optional().nullable(),address:v.string(),chainId:v.string().or(v.number()),smartAccountDeployed:v.optional(v.boolean()),accounts:v.array(v.object({address:v.string(),type:v.enum([Kt.ACCOUNT_TYPES.EOA,Kt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:v.optional(v.string()),signature:v.string().optional(),message:v.string().optional(),siwxMessage:v.optional(Yh)}),SU=v.object({uri:v.string()}),TU=v.object({isConnected:v.boolean()}),NU=v.object({chainId:v.string().or(v.number())}),OU=v.object({chainId:v.string().or(v.number())}),RU=v.object({newEmail:v.string().email()}),PU=v.object({smartAccountEnabledNetworks:v.array(v.number())});v.object({address:v.string(),isDeployed:v.boolean()});const xU=v.object({version:v.string().optional()}),kU=v.object({type:v.string(),address:v.string()}),DU=v.any(),UU=v.object({method:v.literal("eth_accounts")}),MU=v.object({method:v.literal("eth_blockNumber")}),LU=v.object({method:v.literal("eth_call"),params:v.array(v.any())}),$U=v.object({method:v.literal("eth_chainId")}),BU=v.object({method:v.literal("eth_estimateGas"),params:v.array(v.any())}),FU=v.object({method:v.literal("eth_feeHistory"),params:v.array(v.any())}),jU=v.object({method:v.literal("eth_gasPrice")}),WU=v.object({method:v.literal("eth_getAccount"),params:v.array(v.any())}),HU=v.object({method:v.literal("eth_getBalance"),params:v.array(v.any())}),zU=v.object({method:v.literal("eth_getBlockByHash"),params:v.array(v.any())}),qU=v.object({method:v.literal("eth_getBlockByNumber"),params:v.array(v.any())}),VU=v.object({method:v.literal("eth_getBlockReceipts"),params:v.array(v.any())}),KU=v.object({method:v.literal("eth_getBlockTransactionCountByHash"),params:v.array(v.any())}),GU=v.object({method:v.literal("eth_getBlockTransactionCountByNumber"),params:v.array(v.any())}),YU=v.object({method:v.literal("eth_getCode"),params:v.array(v.any())}),JU=v.object({method:v.literal("eth_getFilterChanges"),params:v.array(v.any())}),ZU=v.object({method:v.literal("eth_getFilterLogs"),params:v.array(v.any())}),XU=v.object({method:v.literal("eth_getLogs"),params:v.array(v.any())}),QU=v.object({method:v.literal("eth_getProof"),params:v.array(v.any())}),e3=v.object({method:v.literal("eth_getStorageAt"),params:v.array(v.any())}),t3=v.object({method:v.literal("eth_getTransactionByBlockHashAndIndex"),params:v.array(v.any())}),n3=v.object({method:v.literal("eth_getTransactionByBlockNumberAndIndex"),params:v.array(v.any())}),r3=v.object({method:v.literal("eth_getTransactionByHash"),params:v.array(v.any())}),s3=v.object({method:v.literal("eth_getTransactionCount"),params:v.array(v.any())}),i3=v.object({method:v.literal("eth_getTransactionReceipt"),params:v.array(v.any())}),o3=v.object({method:v.literal("eth_getUncleCountByBlockHash"),params:v.array(v.any())}),a3=v.object({method:v.literal("eth_getUncleCountByBlockNumber"),params:v.array(v.any())}),c3=v.object({method:v.literal("eth_maxPriorityFeePerGas")}),l3=v.object({method:v.literal("eth_newBlockFilter")}),u3=v.object({method:v.literal("eth_newFilter"),params:v.array(v.any())}),d3=v.object({method:v.literal("eth_newPendingTransactionFilter")}),h3=v.object({method:v.literal("eth_sendRawTransaction"),params:v.array(v.any())}),f3=v.object({method:v.literal("eth_syncing"),params:v.array(v.any())}),p3=v.object({method:v.literal("eth_uninstallFilter"),params:v.array(v.any())}),lE=v.object({method:v.literal("personal_sign"),params:v.array(v.any())}),g3=v.object({method:v.literal("eth_signTypedData_v4"),params:v.array(v.any())}),m3=v.object({method:v.literal("eth_sendTransaction"),params:v.array(v.any())}),y3=v.object({method:v.literal("solana_signMessage"),params:v.object({message:v.string(),pubkey:v.string()})}),w3=v.object({method:v.literal("solana_signTransaction"),params:v.object({transaction:v.string()})}),E3=v.object({method:v.literal("solana_signAllTransactions"),params:v.object({transactions:v.array(v.string())})}),b3=v.object({method:v.literal("solana_signAndSendTransaction"),params:v.object({transaction:v.string(),options:v.object({skipPreflight:v.boolean().optional(),preflightCommitment:v.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:v.number().optional(),minContextSlot:v.number().optional()}).optional()})}),v3=v.object({method:v.literal("wallet_sendCalls"),params:v.array(v.object({chainId:v.string().or(v.number()).optional(),from:v.string().optional(),version:v.string().optional(),capabilities:v.any().optional(),calls:v.array(v.object({to:v.string().startsWith("0x"),data:v.string().startsWith("0x").optional(),value:v.string().optional()}))}))}),_3=v.object({method:v.literal("wallet_getCallsStatus"),params:v.array(v.string())}),C3=v.object({method:v.literal("wallet_getCapabilities"),params:v.array(v.string().or(v.number()).optional()).optional()}),A3=v.object({method:v.literal("wallet_grantPermissions"),params:v.array(v.any())}),I3=v.object({method:v.literal("wallet_revokePermissions"),params:v.any()}),S3=v.object({method:v.literal("wallet_getAssets"),params:v.any()}),uE=v.object({token:v.string()}),Te=v.object({id:v.string().optional()}),np={appEvent:Te.extend({type:Se("APP_SWITCH_NETWORK"),payload:cU}).or(Te.extend({type:Se("APP_CONNECT_EMAIL"),payload:lU})).or(Te.extend({type:Se("APP_CONNECT_DEVICE")})).or(Te.extend({type:Se("APP_CONNECT_OTP"),payload:uU})).or(Te.extend({type:Se("APP_CONNECT_SOCIAL"),payload:dU})).or(Te.extend({type:Se("APP_GET_FARCASTER_URI")})).or(Te.extend({type:Se("APP_CONNECT_FARCASTER")})).or(Te.extend({type:Se("APP_GET_USER"),payload:v.optional(hU)})).or(Te.extend({type:Se("APP_GET_SOCIAL_REDIRECT_URI"),payload:fU})).or(Te.extend({type:Se("APP_SIGN_OUT")})).or(Te.extend({type:Se("APP_IS_CONNECTED"),payload:v.optional(uE)})).or(Te.extend({type:Se("APP_GET_CHAIN_ID")})).or(Te.extend({type:Se("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(Te.extend({type:Se("APP_INIT_SMART_ACCOUNT")})).or(Te.extend({type:Se("APP_SET_PREFERRED_ACCOUNT"),payload:EU})).or(Te.extend({type:Se("APP_RPC_REQUEST"),payload:lE.or(S3).or(UU).or(MU).or(LU).or($U).or(BU).or(FU).or(jU).or(WU).or(HU).or(zU).or(qU).or(VU).or(KU).or(GU).or(YU).or(JU).or(ZU).or(XU).or(QU).or(e3).or(t3).or(n3).or(r3).or(s3).or(i3).or(o3).or(a3).or(c3).or(l3).or(u3).or(d3).or(h3).or(f3).or(p3).or(lE).or(g3).or(m3).or(y3).or(w3).or(E3).or(b3).or(_3).or(v3).or(C3).or(A3).or(I3).and(v.object({chainId:v.string().or(v.number()).optional(),chainNamespace:v.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:v.string().optional()}))})).or(Te.extend({type:Se("APP_UPDATE_EMAIL"),payload:pU})).or(Te.extend({type:Se("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:gU})).or(Te.extend({type:Se("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:mU})).or(Te.extend({type:Se("APP_SYNC_THEME"),payload:yU})).or(Te.extend({type:Se("APP_SYNC_DAPP_DATA"),payload:wU})).or(Te.extend({type:Se("APP_RELOAD")})).or(Te.extend({type:Se("APP_RPC_ABORT")})),frameEvent:Te.extend({type:Se("FRAME_SWITCH_NETWORK_ERROR"),payload:Gt}).or(Te.extend({type:Se("FRAME_SWITCH_NETWORK_SUCCESS"),payload:OU})).or(Te.extend({type:Se("FRAME_CONNECT_EMAIL_SUCCESS"),payload:bU})).or(Te.extend({type:Se("FRAME_CONNECT_EMAIL_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:vU})).or(Te.extend({type:Se("FRAME_GET_FARCASTER_URI_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:_U})).or(Te.extend({type:Se("FRAME_CONNECT_FARCASTER_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_CONNECT_OTP_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_CONNECT_OTP_SUCCESS")})).or(Te.extend({type:Se("FRAME_CONNECT_DEVICE_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_CONNECT_DEVICE_SUCCESS")})).or(Te.extend({type:Se("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:CU})).or(Te.extend({type:Se("FRAME_CONNECT_SOCIAL_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_GET_USER_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_GET_USER_SUCCESS"),payload:IU})).or(Te.extend({type:Se("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:SU})).or(Te.extend({type:Se("FRAME_SIGN_OUT_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_SIGN_OUT_SUCCESS")})).or(Te.extend({type:Se("FRAME_IS_CONNECTED_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_IS_CONNECTED_SUCCESS"),payload:TU})).or(Te.extend({type:Se("FRAME_GET_CHAIN_ID_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_GET_CHAIN_ID_SUCCESS"),payload:NU})).or(Te.extend({type:Se("FRAME_RPC_REQUEST_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_RPC_REQUEST_SUCCESS"),payload:DU})).or(Te.extend({type:Se("FRAME_SESSION_UPDATE"),payload:uE})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_SUCCESS"),payload:AU})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:RU})).or(Te.extend({type:Se("FRAME_SYNC_THEME_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_SYNC_THEME_SUCCESS")})).or(Te.extend({type:Se("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(Te.extend({type:Se("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:PU})).or(Te.extend({type:Se("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:kU})).or(Te.extend({type:Se("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_READY"),payload:xU})).or(Te.extend({type:Se("FRAME_RELOAD_ERROR"),payload:Gt})).or(Te.extend({type:Se("FRAME_RELOAD_SUCCESS")}))};function rp(t,e={}){return typeof e?.type=="string"&&e?.type?.includes(t)}function T3({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=cA.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(aD);i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",lD),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r);const o=dn.get("dapp_smart_account_version");return o&&(o==="v6"||o==="v7")&&i.searchParams.set("smartAccountVersion",o),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class N3{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=cA.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){if(!rp(Oe.FRAME_EVENT_KEY,d))return;const h=np.frameEvent.safeParse(d);h.success&&h.data?.id===a&&(c(h.data),window.removeEventListener("message",u))}kr.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{kr.isClient&&window.addEventListener("message",({data:c})=>{if(!rp(Oe.FRAME_EVENT_KEY,c))return;const l=np.frameEvent.safeParse(c);l.success&&a(l.data)})},onAppEvent:a=>{kr.isClient&&window.addEventListener("message",({data:c})=>{if(!rp(Oe.APP_EVENT_KEY,c))return;np.appEvent.safeParse(c).success,a(c)})},postAppEvent:a=>{if(kr.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(kr.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),kr.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=T3({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}var Jh={exports:{}};function O3(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var R3=P3;function P3(t,e,n){var r=n&&n.stringify||O3,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-s,d=-1,h=t&&t.length||0,f=0;f<h;){if(t.charCodeAt(f)===37&&f+1<h){switch(d=d>-1?d:0,t.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<f&&(l+=t.slice(d,f)),l+=Number(e[u]),d=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;d<f&&(l+=t.slice(d,f)),l+=Math.floor(Number(e[u])),d=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<f&&(l+=t.slice(d,f));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",d=f+2,f++;break}if(p==="function"){l+=e[u].name||"<anonymous>",d=f+2,f++;break}l+=r(e[u]),d=f+2,f++;break;case 115:if(u>=c)break;d<f&&(l+=t.slice(d,f)),l+=String(e[u]),d=f+2,f++;break;case 37:d<f&&(l+=t.slice(d,f)),l+="%",d=f+2,f++,u--;break}++u}++f}return d===-1?t:(d<h&&(l+=t.slice(d)),l)}const dE=R3;Jh.exports=yi;const Ql=V3().console||{},x3={mapHttpRequest:Ju,mapHttpResponse:Ju,wrapRequestSerializer:sp,wrapResponseSerializer:sp,wrapErrorSerializer:sp,req:Ju,res:Ju,err:fE,errWithCause:fE};function io(t,e){return t==="silent"?1/0:e.levels.values[t]}const Xm=Symbol("pino.logFuncs"),Pg=Symbol("pino.hierarchy"),k3={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function hE(t,e){const n={logger:e,parent:t[Pg]};e[Pg]=n}function D3(t,e,n){const r={};e.forEach(s=>{r[s]=n[s]?n[s]:Ql[s]||Ql[k3[s]||"log"]||oc}),t[Xm]=r}function U3(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function yi(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||Ql;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=U3(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=Object.keys(t.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(m){n[m]=n}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");const c=t.level||"info",l=Object.create(n);l.log||(l.log=oc),D3(l,a,n),hE({},l),Object.defineProperty(l,"levelVal",{get:d}),Object.defineProperty(l,"level",{get:h,set:f});const u={transmit:e,serialize:s,asObject:t.browser.asObject,asObjectBindingsOnly:t.browser.asObjectBindingsOnly,formatters:t.browser.formatters,levels:a,timestamp:H3(t),messageKey:t.messageKey||"msg",onChild:t.onChild||oc};l.levels=M3(t),l.level=c,l.isLevelEnabled=function(m){return this.levels.values[m]?this.levels.values[m]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=oc,l.serializers=r,l._serialize=s,l._stdErrSerialize=i,l.child=function(...m){return p.call(this,u,...m)},e&&(l._logEvent=xg());function d(){return io(this.level,this)}function h(){return this._level}function f(m){if(m!=="silent"&&!this.levels.values[m])throw Error("unknown level "+m);this._level=m,xo(this,u,l,"error"),xo(this,u,l,"fatal"),xo(this,u,l,"warn"),xo(this,u,l,"info"),xo(this,u,l,"debug"),xo(this,u,l,"trace"),o.forEach(g=>{xo(this,u,l,g)})}function p(m,g,T){if(!g)throw new Error("missing bindings for child Pino");T=T||{},s&&g.serializers&&(T.serializers=g.serializers);const N=T.serializers;if(s&&N){var _=Object.assign({},r,N),O=t.browser.serialize===!0?Object.keys(_):s;delete g.serializers,Qm([g],O,_,this._stdErrSerialize)}function A(k){this._childLevel=(k._childLevel|0)+1,this.bindings=g,_&&(this.serializers=_,this._serialize=O),e&&(this._logEvent=xg([].concat(k._logEvent.bindings,g)))}A.prototype=this;const x=new A(this);return hE(this,x),x.child=function(...k){return p.call(this,m,...k)},x.level=T.level||this.level,m.onChild(x),x}return l}function M3(t){const e=t.customLevels||{},n=Object.assign({},yi.levels.values,e),r=Object.assign({},yi.levels.labels,L3(e));return{values:n,labels:r}}function L3(t){const e={};return Object.keys(t).forEach(function(n){e[t[n]]=n}),e}yi.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};yi.stdSerializers=x3;yi.stdTimeFunctions=Object.assign({},{nullTime:yA,epochTime:wA,unixTime:z3,isoTime:q3});function $3(t){const e=[];t.bindings&&e.push(t.bindings);let n=t[Pg];for(;n.parent;)n=n.parent,n.logger.bindings&&e.push(n.logger.bindings);return e.reverse()}function xo(t,e,n,r){if(Object.defineProperty(t,r,{value:io(t.level,n)>io(r,n)?oc:n[Xm][r],writable:!0,enumerable:!0,configurable:!0}),t[r]===oc){if(!e.transmit)return;const i=e.transmit.level||t.level,o=io(i,n);if(io(r,n)<o)return}t[r]=F3(t,e,n,r);const s=$3(t);s.length!==0&&(t[r]=B3(s,t[r]))}function B3(t,e){return function(){return e.apply(this,[...t,...arguments])}}function F3(t,e,n,r){return function(s){return function(){const o=e.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ql?Ql:this;for(var l=0;l<a.length;l++)a[l]=arguments[l];var u=!1;if(e.serialize&&(Qm(a,this._serialize,this.serializers,this._stdErrSerialize),u=!0),e.asObject||e.formatters?s.call(c,...j3(this,r,a,o,e)):s.apply(c,a),e.transmit){const d=e.transmit.level||t._level,h=io(d,n),f=io(r,n);if(f<h)return;W3(this,{ts:o,methodLevel:r,methodValue:f,transmitValue:n.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:io(t._level,n)},a,u)}}}(t[Xm][r])}function j3(t,e,n,r,s){const{level:i,log:o=d=>d}=s.formatters||{},a=n.slice();let c=a[0];const l={};let u=(t._childLevel|0)+1;if(u<1&&(u=1),r&&(l.time=r),i){const d=i(e,t.levels.values[e]);Object.assign(l,d)}else l.level=t.levels.values[e];if(s.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?dE(a.shift(),a):void 0}else typeof c=="string"&&(c=dE(a.shift(),a));return c!==void 0&&(l[s.messageKey]=c),[o(l)]}}function Qm(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=yi.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s])&&e)for(const i in t[s])e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function W3(t,e,n,r=!1){const s=e.send,i=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=t._logEvent.bindings;r||Qm(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=n.filter(function(u){return l.indexOf(u)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=a,s(o,t._logEvent,c),t._logEvent=xg(l)}function xg(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function fE(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function H3(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?yA:wA}function Ju(){return{}}function sp(t){return t}function oc(){}function yA(){return!1}function wA(){return Date.now()}function z3(){return Math.round(Date.now()/1e3)}function q3(){return new Date(Date.now()).toISOString()}function V3(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}Jh.exports.default=yi;Jh.exports.pino=yi;var Ja=Jh.exports;const EA=_o(Ja),K3=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),G3=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function ha(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return G3(t)}catch{return t}}function wi(t){return typeof t=="string"?t:K3(t)||""}const Y3={level:"info"},Zh="custom_context",ey=1e3*1024;var J3=Object.defineProperty,Z3=(t,e,n)=>e in t?J3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qi=(t,e,n)=>Z3(t,typeof e!="symbol"?e+"":e,n);let X3=class{constructor(e){Qi(this,"nodeValue"),Qi(this,"sizeInBytes"),Qi(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},pE=class{constructor(e){Qi(this,"lengthInNodes"),Qi(this,"sizeInBytes"),Qi(this,"head"),Qi(this,"tail"),Qi(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new X3(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}};var Q3=Object.defineProperty,eM=(t,e,n)=>e in t?Q3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zu=(t,e,n)=>eM(t,typeof e!="symbol"?e+"":e,n);let bA=class{constructor(e,n=ey){Zu(this,"logs"),Zu(this,"level"),Zu(this,"levelValue"),Zu(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Ja.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new pE(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Ja.levels.values.error||n===Ja.levels.values.warn||n===Ja.levels.values.debug||Ja.levels.values.trace}appendToLogs(e){this.logs.append(wi({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new pE(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(wi({extraMetadata:e})),new Blob(n,{type:"application/json"})}};var tM=Object.defineProperty,nM=(t,e,n)=>e in t?tM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rM=(t,e,n)=>nM(t,e+"",n);let sM=class{constructor(e,n=ey){rM(this,"baseChunkLogger"),this.baseChunkLogger=new bA(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}};var iM=Object.defineProperty,oM=(t,e,n)=>e in t?iM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,aM=(t,e,n)=>oM(t,e+"",n);let cM=class{constructor(e,n=ey){aM(this,"baseChunkLogger"),this.baseChunkLogger=new bA(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var lM=Object.defineProperty,uM=Object.defineProperties,dM=Object.getOwnPropertyDescriptors,gE=Object.getOwnPropertySymbols,hM=Object.prototype.hasOwnProperty,fM=Object.prototype.propertyIsEnumerable,mE=(t,e,n)=>e in t?lM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gh=(t,e)=>{for(var n in e||(e={}))hM.call(e,n)&&mE(t,n,e[n]);if(gE)for(var n of gE(e))fM.call(e,n)&&mE(t,n,e[n]);return t},mh=(t,e)=>uM(t,dM(e));function ty(t){return mh(gh({},t),{level:t?.level||Y3.level})}function pM(t,e,n=Zh){return t[n]=e,t}function br(t,e=Zh){return t[e]||""}function gM(t,e,n=Zh){const r=br(t,n);return r.trim()?`${r}/${e}`:e}function vr(t,e,n=Zh){const r=gM(t,e,n),s=t.child({context:r});return pM(s,r,n)}function mM(t){var e,n;const r=new sM((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:EA(mh(gh({},t.opts),{level:"trace",browser:mh(gh({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function yM(t){var e;const n=new cM((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:EA(mh(gh({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function Xh(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?mM(t):yM(t)}class wM{constructor(e){const n=ty({level:cD}),{logger:r,chunkLoggerController:s}=Xh({opts:n});this.logger=vr(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class EM{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c,metadata:l,sdkVersion:u,sdkType:d}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new wM(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const h=this.getRpcUrl(n);this.projectId=e,this.sdkVersion=u,this.sdkType=d,this.metadata=l,this.w3mFrame=new N3({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:h,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,await this.syncDappData({metadata:this.metadata,projectId:this.projectId,sdkVersion:this.sdkVersion,sdkType:this.sdkType}),await this.getSmartAccountEnabledNetworks(),this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!dn.get(Oe.EMAIL_LOGIN_USED_KEY)}getEmail(){return dn.get(Oe.EMAIL)}getUsername(){return dn.get(Oe.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:Oe.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{kr.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:Oe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){try{return this.appEvent({type:Oe.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:Oe.APP_CONNECT_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:Oe.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:Oe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:Oe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){try{const n=await this.appEvent({type:Oe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:Oe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){try{const n=await this.appEvent({type:Oe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){try{return this.appEvent({type:Oe.APP_SYNC_THEME,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){try{return this.appEvent({type:Oe.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:Oe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:Oe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){if(e?.socialUri)try{await this.init();const n=this.getRpcUrl(e.chainId),r=await this.appEvent({type:Oe.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:n}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting social"),n}else try{const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:n,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(n)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async getUser(e){try{await this.init();const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:Oe.APP_GET_USER,payload:{...e,chainId:n,rpcUrl:this.getRpcUrl(n)}});return this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){try{await this.init();const s=this.getRpcUrl(n),i=await this.appEvent({type:Oe.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:s,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(s){throw this.w3mLogger?.logger.error({error:s},"Error connecting social"),s}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:Oe.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:Oe.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const n=this.getRpcUrl(e),r=await this.appEvent({type:Oe.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:n}});return this.setLastUsedChainId(r.chainId),r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error switching network"),n}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const r=setTimeout(()=>{n()},3e3);await this.appEvent({type:Oe.APP_SIGN_OUT}),clearTimeout(r),n()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const n=e;try{if(Kt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",s=this.getActiveCaipNetwork(r)?.id;n.chainNamespace=r,n.chainId=s,n.rpcUrl=this.getRpcUrl(s),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:Oe.APP_RPC_REQUEST,payload:n});return this.rpcSuccessHandler?.(i,n),i}catch(r){throw this.rpcErrorHandler?.(r,n),this.w3mLogger?.logger.error({error:r},"Error requesting"),r}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_IS_CONNECTED_ERROR&&e(),n.type===Oe.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Oe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===Oe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:Kt.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:e,method:n})=>{Kt.SAFE_RPC_METHODS.includes(n)||e.abort(),await this.appEvent({type:Oe.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[Oe.APP_SYNC_DAPP_DATA,Oe.APP_SYNC_THEME,Oe.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[Oe.APP_CONNECT_EMAIL,Oe.APP_CONNECT_DEVICE,Oe.APP_CONNECT_OTP,Oe.APP_CONNECT_SOCIAL,Oe.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{const u=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const f=e;this.openRpcRequests.set(u,{...f.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});const h=(f,p)=>{f.id===u&&(p?.logger.info?.({framEvent:f,id:u},"Received frame response"),this.openRpcRequests.delete(f.id),f.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&c(f.payload),c(void 0)):f.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&l(new Error(f.payload?.message||"An error occurred")),l(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,f=>h(f,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){dn.set(Oe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){dn.set(Oe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&dn.set(Oe.EMAIL,e),dn.set(Oe.EMAIL_LOGIN_USED_KEY,"true"),dn.delete(Oe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){dn.delete(Oe.EMAIL_LOGIN_USED_KEY),dn.delete(Oe.EMAIL),dn.delete(Oe.LAST_USED_CHAIN_KEY),dn.delete(Oe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&dn.set(Oe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=dn.get(Oe.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){dn.set(Oe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=iD.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n);return(e?r.find(i=>String(i.id)===String(e)||i.caipNetworkId===e):r[0])?.rpcUrls.default.http?.[0]}}async function zc(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class wu{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await zc(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await zc(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await zc(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await zc(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await zc(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const kg={getFeatureValue(t,e){const n=e?.[t];return n===void 0?et.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;let e=t;return de.isTelegram()&&(de.isIos()&&(e=e.filter(n=>n!=="google")),de.isMac()&&(e=e.filter(n=>n!=="x")),de.isAndroid()&&(e=e.filter(n=>!["facebook","x"].includes(n)))),de.isMobile()&&(e=e.filter(n=>n!=="facebook")),e},isSocialsEnabled(){return Array.isArray(Z.state.features?.socials)&&Z.state.features?.socials.length>0||Array.isArray(Z.state.remoteFeatures?.socials)&&Z.state.remoteFeatures?.socials.length>0},isEmailEnabled(){return!!(Z.state.features?.email||Z.state.remoteFeatures?.email)}},ke=Rt({features:et.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:et.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1,coinbasePreference:"all"}),Z={state:ke,subscribeKey(t,e){return en(ke,t,e)},setOptions(t){Object.assign(ke,t)},setRemoteFeatures(t){if(!t)return;const e={...ke.remoteFeatures,...t};ke.remoteFeatures=e,ke.remoteFeatures?.socials&&(ke.remoteFeatures.socials=kg.filterSocialsByPlatform(ke.remoteFeatures.socials)),ke.features?.pay&&(ke.remoteFeatures.email=!1,ke.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;ke.features||(ke.features=et.DEFAULT_FEATURES);const e={...ke.features,...t};ke.features=e,ke.features?.pay&&ke.remoteFeatures&&(ke.remoteFeatures.email=!1,ke.remoteFeatures.socials=!1)},setProjectId(t){ke.projectId=t},setCustomRpcUrls(t){ke.customRpcUrls=t},setAllWallets(t){ke.allWallets=t},setIncludeWalletIds(t){ke.includeWalletIds=t},setExcludeWalletIds(t){ke.excludeWalletIds=t},setFeaturedWalletIds(t){ke.featuredWalletIds=t},setTokens(t){ke.tokens=t},setTermsConditionsUrl(t){ke.termsConditionsUrl=t},setPrivacyPolicyUrl(t){ke.privacyPolicyUrl=t},setCustomWallets(t){ke.customWallets=t},setIsSiweEnabled(t){ke.isSiweEnabled=t},setIsUniversalProvider(t){ke.isUniversalProvider=t},setSdkVersion(t){ke.sdkVersion=t},setMetadata(t){ke.metadata=t},setDisableAppend(t){ke.disableAppend=t},setEIP6963Enabled(t){ke.enableEIP6963=t},setDebug(t){ke.debug=t},setEnableWalletGuide(t){ke.enableWalletGuide=t},setEnableAuthLogger(t){ke.enableAuthLogger=t},setEnableWallets(t){ke.enableWallets=t},setPreferUniversalLinks(t){ke.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(et.SIWX_DEFAULTS))t[e]??=n;ke.siwx=t},setConnectMethodsOrder(t){ke.features={...ke.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){ke.features={...ke.features,walletFeaturesOrder:t}},setSocialsOrder(t){ke.remoteFeatures={...ke.remoteFeatures,socials:t}},setCollapseWallets(t){ke.features={...ke.features,collapseWallets:t}},setEnableEmbedded(t){ke.enableEmbedded=t},setAllowUnsupportedChain(t){ke.allowUnsupportedChain=t},setManualWCControl(t){ke.manualWCControl=t},setEnableNetworkSwitch(t){ke.enableNetworkSwitch=t},setEnableMobileFullScreen(t){ke.enableMobileFullScreen=de.isMobile()&&t},setEnableReconnect(t){ke.enableReconnect=t},setCoinbasePreference(t){ke.coinbasePreference=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(ke.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){ke.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return ke.universalProviderConfigOverride},getSnapshot(){return $l(ke)}},Ho=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),ln=Rt({...Ho}),bM={state:ln,subscribeKey(t,e){return en(ln,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=de.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){ln.message=Ho.message,ln.variant=Ho.variant,ln.svg=Ho.svg,ln.open=Ho.open,ln.autoClose=Ho.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Ho.autoClose}){ln.open?(ln.open=!1,setTimeout(()=>{ln.message=t,ln.variant=n,ln.svg=e,ln.open=!0,ln.autoClose=r},150)):(ln.message=t,ln.variant=n,ln.svg=e,ln.open=!0,ln.autoClose=r)}},Wt=bM,vM={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},vA=de.getBlockchainApiUrl(),Xn=Rt({clientId:null,api:new wu({baseUrl:vA,clientId:null}),supportedChains:{http:[],ws:[]}}),Ue={state:Xn,async get(t){const{st:e,sv:n}=Ue.getSdkProperties(),r=Z.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return Xn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=Z.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{Xn.supportedChains.http.length||await Ue.getSupportedNetworks()}catch{return!1}return Xn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await Ue.get({path:"v1/supported-chains"});return Xn.supportedChains=t,t}catch{return Xn.supportedChains}},async fetchIdentity({address:t}){const e=te.getIdentityFromCacheForAddress(t);if(e)return e;const n=await Ue.get({path:`/v1/identity/${t}`,params:{sender:I.state.activeCaipAddress?de.getPlainAddress(I.state.activeCaipAddress):void 0}});return te.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=te.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await Ue.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return te.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async getAddressBalance({caipNetworkId:t,address:e}){return Xn.api.post({path:`/v1?chainId=${t}&projectId=${Z.state.projectId}`,body:{id:"1",jsonrpc:"2.0",method:"getAddressBalance",params:{address:e}}}).then(n=>n.result)},async fetchTokenPrice({addresses:t}){if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=te.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await Xn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:Z.state.projectId},headers:{"Content-Type":"application/json"}});return te.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:n}=Ue.getSdkProperties();if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ue.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Xn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:et.CONVERT_SLIPPAGE_TOLERANCE},projectId:Z.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){const{st:r,sv:s}=Ue.getSdkProperties();if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Ue.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){const{st:r,sv:s}=Ue.getSdkProperties();if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))return Wt.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=te.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ue.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return te.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))return[];const n=I.getAccountData()?.address;return Ue.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Xn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?(await Xn.api.post({path:"/v1/generators/onrampurl",params:{projectId:Z.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ue.get({path:"/v1/onramp/options"})}catch{return vM}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){try{return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?await Xn.api.post({path:"/v1/onramp/quote",params:{projectId:Z.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Ue.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){return await Ue.isNetworkSupported(I.state.activeCaipNetwork?.caipNetworkId)?Xn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:Z.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){Xn.clientId=t,Xn.api=new wu({baseUrl:vA,clientId:t})}},Wr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},_M={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===Wr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Wr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===Wr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Wr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===j.CHAIN.SOLANA&&t===Wr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Wr.COINBASE.url}/dapp?cb_url=${r}`),e===j.CHAIN.BITCOIN&&t===Wr.BINANCE.id&&!("binancew3w"in window)){const s=I.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${s?.id??1}`),a=new URL(Wr.BINANCE.deeplink);a.searchParams.set("appId",Wr.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(Wr.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},CM=Object.freeze({enabled:!0,events:[]}),AM=new wu({baseUrl:de.getAnalyticsUrl(),clientId:null}),IM=5,SM=60*1e3,ki=Rt({...CM}),TM={state:ki,subscribeKey(t,e){return en(ki,t,e)},async sendError(t,e){if(!ki.enabled)return;const n=Date.now();if(ki.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<SM}).length>=IM)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};ki.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=Z.state;await AM.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:de.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){ki.enabled=!0},disable(){ki.enabled=!1},clearEvents(){ki.events=[]}};class fa extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,fa.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,fa):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function yE(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=t?.message||JSON.stringify(t):n=String(t)}catch{n="Unknown error"}const r=t instanceof fa?t:new fa(n,e,t);throw TM.sendError(r,r.category),r}function _r(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return yE(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return yE(a,e)}},n[r]=i}else n[r]=s}),n}const Cr=Rt({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),NM={state:Cr,subscribeNetworkImages(t){return Qt(Cr.networkImages,()=>t(Cr.networkImages))},subscribeKey(t,e){return en(Cr,t,e)},subscribe(t){return Qt(Cr,()=>t(Cr))},setWalletImage(t,e){Cr.walletImages[t]=e},setNetworkImage(t,e){Cr.networkImages[t]=e},setChainImage(t,e){Cr.chainImages[t]=e},setConnectorImage(t,e){Cr.connectorImages={...Cr.connectorImages,[t]:e}},setTokenImage(t,e){Cr.tokenImages[t]=e},setCurrencyImage(t,e){Cr.currencyImages[t]=e}},Pr=_r(NM),wE={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:"",ton:"20f673c0-095e-49b2-07cf-eb5049dcf600"},ip=Rt({networkImagePromises:{}}),_A={async fetchWalletImage(t){if(t)return await _e._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(ip.networkImagePromises[t]||(ip.networkImagePromises[t]=_e._fetchNetworkImage(t)),await ip.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Pr.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return Pr.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return Pr.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Pr.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return Pr.state.connectorImages[t.imageId]},getChainImage(t){return Pr.state.networkImages[wE[t]]},getTokenImage(t){if(t)return Pr.state.tokenImages[t]},getWalletImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=Z.state,s=new URL(`${j.W3M_API_URL}/getWalletImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getAssetImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=Z.state,s=new URL(`${j.W3M_API_URL}/public/getAssetImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getChainNamespaceImageUrl(t){return this.getAssetImageUrl(wE[t])}},OM=de.getAnalyticsUrl(),RM=new wu({baseUrl:OM,clientId:null}),PM=["MODAL_CREATED"],xM=45,EE=1e3*10,Yt=Rt({timestamp:Date.now(),lastFlush:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1,walletImpressions:[]}),ze={state:Yt,subscribe(t){return Qt(Yt,()=>t(Yt))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=Z.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},shouldFlushEvents(){const t=JSON.stringify(Yt.pendingEvents).length/1024>xM,e=Yt.lastFlush+EE<Date.now();return t||e},_setPendingEvent(t){try{let e=I.getAccountData()?.address;if("address"in t.data&&t.data.address&&(e=t.data.address),PM.includes(t.data.event)||typeof window>"u")return;const n=I.getActiveCaipNetwork()?.caipNetworkId;this.state.pendingEvents.push({eventId:de.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:n}}}),Yt.reportedErrors.FORBIDDEN=!1,ze.shouldFlushEvents()&&ze._submitPendingEvents()}catch{}},sendEvent(t){Yt.timestamp=Date.now(),Yt.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(Z.state.features?.analytics||e.includes(t.event))&&ze._setPendingEvent(Yt),this.subscribeToFlushTriggers()},sendWalletImpressionEvent(t){Yt.walletImpressions.push(t)},_transformPendingEventsForBatch(t){try{return t.filter(e=>e.props.event!=="WALLET_IMPRESSION_V2")}catch{return t}},_submitPendingEvents(){if(Yt.lastFlush=Date.now(),!(Yt.pendingEvents.length===0&&Yt.walletImpressions.length===0))try{const t=ze._transformPendingEventsForBatch(Yt.pendingEvents);Yt.walletImpressions.length&&t.push({eventId:de.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:Date.now(),props:{type:"track",event:"WALLET_IMPRESSION_V2",items:[...Yt.walletImpressions]}}),RM.sendBeacon({path:"/batch",params:ze.getSdkProperties(),body:t}),Yt.reportedErrors.FORBIDDEN=!1,Yt.pendingEvents=[],Yt.walletImpressions=[]}catch{Yt.reportedErrors.FORBIDDEN=!0}},subscribeToFlushTriggers(){Yt.subscribedToVisibilityChange||typeof document>"u"||(Yt.subscribedToVisibilityChange=!0,document?.addEventListener?.("visibilitychange",()=>{document.visibilityState==="hidden"&&ze._submitPendingEvents()}),document?.addEventListener?.("freeze",()=>{ze._submitPendingEvents()}),window?.addEventListener?.("pagehide",()=>{ze._submitPendingEvents()}),setInterval(()=>{ze._submitPendingEvents()},EE))}},kM=de.getApiUrl(),Qn=new wu({baseUrl:kM,clientId:null}),DM=40,bE=4,UM=20,Ye=Rt({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[],plan:{tier:"none",hasExceededUsageLimit:!1,limits:{isAboveRpcLimit:!1,isAboveMauLimit:!1}}}),_e={state:Ye,subscribeKey(t,e){return en(Ye,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=Z.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return Z.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${Qn.baseUrl}/getWalletImage/${t}`,n=await Qn.getBlob({path:e,params:_e._getSdkProperties()});Pr.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${Qn.baseUrl}/public/getAssetImage/${t}`,n=await Qn.getBlob({path:e,params:_e._getSdkProperties()});Pr.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${Qn.baseUrl}/public/getAssetImage/${t}`,n=await Qn.getBlob({path:e,params:_e._getSdkProperties()});Pr.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${Qn.baseUrl}/public/getCurrencyImage/${t}`,n=await Qn.getBlob({path:e,params:_e._getSdkProperties()});Pr.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${Qn.baseUrl}/public/getTokenImage/${t}`,n=await Qn.getBlob({path:e,params:_e._getSdkProperties()});Pr.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=de.isMobile()?t?.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(Wr).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await Qn.get({path:"/appkit/v1/config",params:_e._getSdkProperties()})).features},async fetchUsage(){try{const t=await Qn.get({path:"/appkit/v1/project-limits",params:_e._getSdkProperties()}),{tier:e,isAboveMauLimit:n,isAboveRpcLimit:r}=t.planLimits,s=e==="starter",i=n||r;_e.state.plan={tier:e,hasExceededUsageLimit:s&&i,limits:{isAboveRpcLimit:r,isAboveMauLimit:n}}}catch{}},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await Qn.get({path:"/projects/v1/origins",params:_e._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===j.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=j.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=I.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!_A.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>_e._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=re.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>_e._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>_e._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>_e._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];_e._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(Wr).map(o=>o.id));const r=await Qn.get({path:"/getWallets",params:{..._e._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=_e._filterWalletsByPlatform(r?.data);return{data:s||[],count:r?.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=re.state.connectors;if(!t?.length)return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),I.state.activeChain===j.CHAIN.EVM){const s=[...t.flatMap(i=>i.connectors?.map(o=>o.info?.rdns)||[]),...t.map(i=>i.info?.rdns)].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await _e.fetchWallets(e);Ye.explorerWallets=n,re.extendConnectorsWithExplorerWallets(n);const r=I.getRequestedCaipNetworkIds().join(",");Ye.explorerFilteredWallets=n.filter(s=>s.chains?.some(i=>r.includes(i)))},async fetchFeaturedWallets(){const{featuredWalletIds:t}=Z.state;if(t?.length){const e={..._e._getSdkProperties(),page:1,entries:t?.length??bE,include:t},{data:n}=await _e.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>_e._fetchWalletImage(i))),Ye.featured=r,Ye.allFeatured=r}},async fetchRecommendedWallets(){try{Ye.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=Z.state,r=[...e??[],...n??[]].filter(Boolean),s=I.getRequestedCaipNetworkIds().join(","),i={page:1,entries:bE,include:t,exclude:r,chains:s},{data:o,count:a}=await _e.fetchWallets(i),c=te.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>_e._fetchWalletImage(d))),Ye.recommended=o,Ye.allRecommended=o,Ye.count=a??0}catch{}finally{Ye.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=Z.state,s=I.getRequestedCaipNetworkIds().join(","),i=[...Ye.recommended.map(({id:d})=>d),...n??[],...r??[]].filter(Boolean),o={page:t,entries:DM,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:l}=await _e.fetchWallets(o);Ye.mobileFilteredOutWalletsLength=l+(Ye.mobileFilteredOutWalletsLength??0);const u=a.slice(0,UM).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(u.map(d=>_e._fetchWalletImage(d))),Ye.wallets=de.uniqueBy([...Ye.wallets,..._e._filterOutExtensions(a)],"id").filter(d=>d.chains?.some(h=>s.includes(h))),Ye.count=c>Ye.count?c:Ye.count,Ye.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await _e.fetchWallets(e);n&&n.forEach(r=>{Ye.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=Z.state,s=I.getRequestedCaipNetworkIds().join(",");Ye.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await _e.fetchWallets(i);ze.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>_e._fetchWalletImage(c)),de.wait(300)]),Ye.search=_e._filterOutExtensions(o)},initPromise(t,e){const n=Ye.promises[t];return n||(Ye.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&_e.initPromise("connectorImages",_e.fetchConnectorImages),e&&_e.initPromise("featuredWallets",_e.fetchFeaturedWallets),n&&_e.initPromise("recommendedWallets",_e.fetchRecommendedWallets),r&&_e.initPromise("networkImages",_e.fetchNetworkImages),s&&_e.initPromise("walletRanks",_e.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){Z.state.features?.analytics&&_e.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await Qn.get({path:"/getAnalyticsConfig",params:_e._getSdkProperties()});Z.setFeatures({analytics:t})}catch{Z.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){Ye.featured=Ye.allFeatured,Ye.recommended=Ye.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");Ye.featured=Ye.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ye.recommended=Ye.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ye.filteredWallets=Ye.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))},clearFilterByNamespaces(){Ye.filteredWallets=[]},setFilterByNamespace(t){if(!t){Ye.featured=Ye.allFeatured,Ye.recommended=Ye.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");Ye.featured=Ye.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Ye.recommended=Ye.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Ye.filteredWallets=Ye.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))}},MM=["ConnectingExternal","ConnectingMultiChain","ConnectingSocial","ConnectingFarcaster"],It=Rt({view:"Connect",history:["Connect"],transactionStack:[]}),LM={state:It,subscribeKey(t,e){return en(It,t,e)},pushTransactionStack(t){It.transactionStack.push(t)},popTransactionStack(t){const e=It.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n?.();break;case"error":r?.(),Ie.goBack();break;case"cancel":s?.(),Ie.goBack();break}},push(t,e){let n=t,r=e;_e.state.plan.hasExceededUsageLimit&&MM.includes(t)&&(n="UsageExceeded",r=void 0),n!==It.view&&(It.view=n,It.history.push(n),It.data=r)},reset(t,e){It.view=t,It.history=[t],It.data=e},replace(t,e){It.history.at(-1)===t||(It.view=t,It.history[It.history.length-1]=t,It.data=e)},goBack(){const t=I.state.activeCaipAddress,e=Ie.state.view==="ConnectingFarcaster",n=!t&&e;if(It.history.length>1){It.history.pop();const[r]=It.history.slice(-1);r&&(t&&r==="Connect"?It.view="Account":It.view=r)}else at.close();It.data?.wallet&&(It.data.wallet=void 0),It.data?.redirectView&&(It.data.redirectView=void 0),setTimeout(()=>{if(n){I.setAccountProp("farcasterUrl",void 0,I.state.activeChain);const r=re.getAuthConnector();r?.provider?.reload();const s=$l(Z.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(It.history.length>1){It.history=It.history.slice(0,t+1);const[e]=It.history.slice(-1);e&&(It.view=e)}},goBackOrCloseModal(){Ie.state.history.length>1?Ie.goBack():at.close()}},Ie=_r(LM),qs=Rt({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Dg={state:qs,subscribe(t){return Qt(qs,()=>t(qs))},setThemeMode(t){qs.themeMode=t;try{const e=re.getAuthConnector();if(e){const n=Dg.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Fl(n,t)})}}catch{}},setThemeVariables(t){qs.themeVariables={...qs.themeVariables,...t};try{const e=re.getAuthConnector();if(e){const n=Dg.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Fl(qs.themeVariables,qs.themeMode)})}}catch{}},getSnapshot(){return $l(qs)}},pr=_r(Dg),CA=Object.fromEntries(sA.map(t=>[t,void 0])),$M=Object.fromEntries(sA.map(t=>[t,!0])),pt=Rt({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:CA,filterByNamespaceMap:$M}),BM={state:pt,subscribe(t){return Qt(pt,()=>{t(pt)})},subscribeKey(t,e){return en(pt,t,e)},initialize(t){t.forEach(e=>{const n=te.getConnectedConnectorId(e);n&&re.setConnectorId(n,e)})},setActiveConnector(t){t&&(pt.activeConnector=Bl(t))},setConnectors(t){t.filter(s=>!pt.allConnectors.some(i=>i.id===s.id&&re.getConnectorName(i.name)===re.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&pt.allConnectors.push(Bl(s))});const n=re.getEnabledNamespaces(),r=re.getEnabledConnectors(n);pt.connectors=re.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(pt.filterByNamespaceMap).forEach(e=>{pt.filterByNamespaceMap[e]=!1}),t.forEach(e=>{pt.filterByNamespaceMap[e]=!0}),re.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){pt.filterByNamespaceMap[t]=e,re.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=re.getEnabledNamespaces(),e=re.getEnabledConnectors(t),n=re.areAllNamespacesEnabled();pt.connectors=re.mergeMultiChainConnectors(e),n?_e.clearFilterByNamespaces():_e.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(pt.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return pt.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(pt.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=re.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=s?.id===j.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=re.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){if(t.id===j.CONNECTOR_ID.AUTH){const e=t,n=$l(Z.state),r=pr.getSnapshot().themeMode,s=pr.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Fl(s,r)}),re.setConnectors([t])}else re.setConnectors([t])},getAuthConnector(t){const e=t||I.state.activeChain,n=pt.connectors.find(r=>r.id===j.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===e):n},getAnnouncedConnectorRdns(){return pt.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return pt.allConnectors.find(e=>e.id===t)},getConnector({id:t,namespace:e}){const n=e||I.state.activeChain;return pt.allConnectors.filter(i=>i.chain===n).find(i=>i.id===t||i.explorerId===t)},syncIfAuthConnector(t){if(t.id!=="AUTH")return;const e=t,n=$l(Z.state),r=pr.getSnapshot().themeMode,s=pr.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Fl(s,r)})},getConnectorsByNamespace(t){const e=pt.allConnectors.filter(n=>n.chain===t);return re.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return I.checkIfSmartAccountEnabled()&&An(t)===Kt.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=Ie.state.data?.redirectView,n=I.state.activeChain,r=n?re.getConnector({id:t.id,namespace:n}):void 0;_M.handleMobileDeeplinkRedirect(r?.explorerId||t.id,I.state.activeChain),r?Ie.push("ConnectingExternal",{connector:r,wallet:t,redirectView:e}):Ie.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?re.getConnectorsByNamespace(t):re.mergeMultiChainConnectors(pt.allConnectors)},setFilterByNamespace(t){pt.filterByNamespace=t,pt.connectors=re.getConnectors(t),_e.setFilterByNamespace(t)},setConnectorId(t,e){t&&(pt.activeConnectorIds={...pt.activeConnectorIds,[e]:t},te.setConnectedConnectorId(e,t))},removeConnectorId(t){pt.activeConnectorIds={...pt.activeConnectorIds,[t]:void 0},te.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return pt.activeConnectorIds[t]},isConnected(t){return t?!!pt.activeConnectorIds[t]:Object.values(pt.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){pt.activeConnectorIds={...CA}},extendConnectorsWithExplorerWallets(t){pt.allConnectors.forEach(r=>{const s=t.find(i=>i.id===r.id||i.rdns&&i.rdns===r.info?.rdns);s&&(r.explorerWallet=s)});const e=re.getEnabledNamespaces(),n=re.getEnabledConnectors(e);pt.connectors=re.mergeMultiChainConnectors(n)}},re=_r(BM),FM=1e3,qc={checkNamespaceConnectorId(t,e){return re.getConnectorId(t)===e},isSocialProvider(t){return et.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&re.setActiveConnector(e),s?.(de.isMobile()&&t),r){const l=at.subscribeKey("open",u=>{u||(Ie.state.view!==r&&Ie.replace(r),l(),a(new Error("Modal closed")))})}const c=I.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&at.close(),c(),o(pn.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=I.subscribeKey("activeCaipAddress",s=>{s&&(at.close(),r(),e(pn.parseCaipAddress(s)))});ue.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i,o=!1,a=null;const c=e||I.state.activeChain,l=I.subscribeKey("activeCaipAddress",u=>{u&&(n&&at.close(),l())});return new Promise((u,d)=>{async function h(p){if(p.data?.resultUri)if(p.origin===j.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",h,!1);try{const m=re.getAuthConnector(c);if(m&&!o){i&&i.close(),o=!0;const g=p.data.resultUri;ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:t}}),te.setConnectedSocialProvider(t),await ue.connectExternal({id:m.id,type:m.type,socialUri:g},m.chain);const T=I.state.activeCaipAddress;if(!T){d(new Error("Failed to connect"));return}u(pn.parseCaipAddress(T)),ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}})}}catch(m){ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:de.parseError(m)}}),d(new Error("Failed to connect"))}}else ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:"Untrusted Origin"}})}async function f(){if(ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"){r?.();const p=at.subscribeKey("open",g=>{!g&&t==="farcaster"&&(d(new Error("Popup closed")),s?.(),p())}),m=re.getAuthConnector();if(m&&!I.getAccountData(c)?.farcasterUrl)try{const{url:T}=await m.provider.getFarcasterUri();I.setAccountProp("farcasterUrl",T,c)}catch{d(new Error("Failed to connect to farcaster"))}}else{const p=re.getAuthConnector();a=de.returnOpenHref(`${j.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(p){const{uri:m}=await p.provider.getSocialRedirectUri({provider:t});if(a&&m){a.location.href=m,i=a;const g=setInterval(()=>{i?.closed&&!o&&(d(new Error("Popup closed")),clearInterval(g))},1e3);window.addEventListener("message",h,!1)}else a?.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),a?.close()}}}f()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),e){const a=at.subscribeKey("open",c=>{c||(Ie.state.view!==e&&Ie.replace(e),a(),i(new Error("Modal closed")))})}const o=I.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),t&&at.close(),o(),s(pn.parseCaipAddress(a)))})})},async updateEmail(){const t=te.getConnectedConnectorId(I.state.activeChain),e=re.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==j.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await at.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(at.close(),clearInterval(i),o(),r({email:a}))},FM),o=at.subscribeKey("open",a=>{a||(Ie.state.view!=="Connect"&&Ie.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return I.checkIfSmartAccountEnabled()&&An(t)===Kt.ACCOUNT_TYPES.EOA}};function eu(){const t=I.state.activeCaipNetwork?.chainNamespace||"eip155",e=I.state.activeCaipNetwork?.id||1,n=et.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function An(t){return I.getAccountData(t)?.preferredAccountType}function gl(t){return t?I.state.chains.get(t)?.networkState?.caipNetwork:I.state.activeCaipNetwork}const yh={getConnectionStatus(t,e){const n=re.state.activeConnectorIds[e],r=ue.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!Z.state.remoteFeatures?.multiWallet,n=re.state.activeConnectorIds[t],r=ue.getConnections(t),i=(ue.state.recentConnections.get(t)??[]).filter(a=>re.getConnectorById(a.connectorId)),o=yh.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}},onConnectMobile(t){const e=ue.state.wcUri;if(t?.mobile_link&&e)try{ue.setWcError(!1);const{mobile_link:n,link_mode:r,name:s}=t,{redirect:i,redirectUniversalLink:o,href:a}=de.formatNativeUrl(n,e,r),c=i,l=o,u=de.isIframe()?"_top":"_self";ue.setWcLinking({name:s,href:a}),ue.setRecentWallet(t),Z.state.experimental_preferUniversalLinks&&l?de.openHref(l,u):de.openHref(c,u)}catch(n){ze.sendEvent({type:"track",event:"CONNECT_PROXY_ERROR",properties:{message:n instanceof Error?n.message:"Error parsing the deep link",uri:e,mobile_link:t.mobile_link,name:t.name}}),ue.setWcError(!0)}}},La=Rt({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1,connectingWallet:void 0}),Dr={state:La,subscribe(t){return Qt(La,()=>t(La))},subscribeOpen(t){return en(La,"open",t)},set(t){Object.assign(La,{...La,...t})}},jt=Rt({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),jM={state:jt,subscribe(t){return Qt(jt,()=>t(jt))},setLastNetworkInView(t){jt.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");jt.loading=!0;try{const e=await Ue.fetchTransactions({account:t,cursor:jt.next,chainId:I.state.activeCaipNetwork?.caipNetworkId}),n=Ld.filterSpamTransactions(e.data),r=Ld.filterByConnectedChain(n),s=[...jt.transactions,...r];jt.loading=!1,jt.transactions=s,jt.transactionsByYear=Ld.groupTransactionsByYearAndMonth(jt.transactionsByYear,r),jt.empty=s.length===0,jt.next=e.next?e.next:void 0}catch{const n=I.state.activeChain;ze.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:Z.state.projectId,cursor:jt.next,isSmartAccount:An(n)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT}}),Wt.showError("Failed to fetch transactions"),jt.loading=!1,jt.empty=!0,jt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers?.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=I.state.activeCaipNetwork?.caipNetworkId;return t.filter(r=>r.metadata.chain===e)},clearCursor(){jt.next=void 0},resetTransactions(){jt.transactions=[],jt.transactionsByYear={},jt.lastNetworkInView=void 0,jt.loading=!1,jt.empty=!1,jt.next=void 0}},Ld=_r(jM,"API_ERROR"),dt=Rt({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,wcFetchingUri:!1,buffering:!1,status:"disconnected"});let ko;const WM={state:dt,subscribe(t){return Qt(dt,()=>t(dt))},subscribeKey(t,e){return en(dt,t,e)},_getClient(){return dt._client},setClient(t){dt._client=Bl(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);ue.syncStorageConnections(e)},syncStorageConnections(t){const e=te.getConnections(),n=t??Array.from(I.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(dt.recentConnections);i.set(r,s),dt.recentConnections=i}},getConnections(t){return t?dt.connections.get(t)??[]:[]},hasAnyConnection(t){const e=ue.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){dt.wcFetchingUri=!0;const e=de.isTelegram()||de.isSafari()&&de.isIos();if(t==="always"||t==="auto"&&e){if(ko){await ko,ko=void 0;return}if(!de.isPairingExpired(dt?.wcPairingExpiry)){const n=dt.wcUri;dt.wcUri=n;return}ko=ue._getClient()?.connectWalletConnect?.().catch(()=>{}),ue.state.status="connecting",await ko,ko=void 0,dt.wcPairingExpiry=void 0,ue.state.status="connected"}else await ue._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,n=!0){const r=await ue._getClient()?.connectExternal?.(t);n&&I.setActiveNamespace(e);const s=re.state.allConnectors.find(o=>o.id===t?.id),i=t.type==="AUTH"?"email":"browser";return ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:i,name:s?.name||"Unknown",view:Ie.state.view,walletRank:s?.explorerWallet?.order}}),r},async reconnectExternal(t){await ue._getClient()?.reconnectExternal?.(t);const e=t.chain||I.state.activeChain;e&&re.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;at.setLoading(!0,I.state.activeChain);const n=re.getAuthConnector();n&&(I.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),te.setPreferredAccountTypes(Object.entries(I.state.chains).reduce((r,[s,i])=>{const o=s,a=An(o);return a!==void 0&&(r[o]=a),r},{})),await ue.reconnectExternal(n),at.setLoading(!1,I.state.activeChain),ze.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:I.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return ue._getClient()?.signMessage(t)},parseUnits(t,e){return ue._getClient()?.parseUnits(t,e)},formatUnits(t,e){return ue._getClient()?.formatUnits(t,e)},updateBalance(t){return ue._getClient()?.updateBalance(t)},async sendTransaction(t){return ue._getClient()?.sendTransaction(t)},async getCapabilities(t){return ue._getClient()?.getCapabilities(t)},async grantPermissions(t){return ue._getClient()?.grantPermissions(t)},async walletGetAssets(t){return ue._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return ue._getClient()?.estimateGas(t)},async writeContract(t){return ue._getClient()?.writeContract(t)},async getEnsAddress(t){return ue._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return ue._getClient()?.getEnsAvatar(t)},checkInstalled(t){return ue._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){dt.wcUri=void 0,dt.wcPairingExpiry=void 0,dt.wcLinking=void 0,dt.recentWallet=void 0,dt.wcFetchingUri=!1,dt.status="disconnected",Ld.resetTransactions(),te.deleteWalletConnectDeepLink(),te.deleteRecentWallet(),Dr.set({connectingWallet:void 0})},resetUri(){dt.wcUri=void 0,dt.wcPairingExpiry=void 0,ko=void 0,dt.wcFetchingUri=!1,Dr.set({connectingWallet:void 0})},finalizeWcConnection(t){const{wcLinking:e,recentWallet:n}=ue.state;e&&te.setWalletConnectDeepLink(e),n&&te.setAppKitRecent(n),t&&ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:Ie.state.data?.wallet?.name||"Unknown",view:Ie.state.view,walletRank:n?.order}})},setWcBasic(t){dt.wcBasic=t},setUri(t){dt.wcUri=t,dt.wcFetchingUri=!1,dt.wcPairingExpiry=de.getPairingExpiry()},setWcLinking(t){dt.wcLinking=t},setWcError(t){dt.wcError=t,dt.wcFetchingUri=!1,dt.buffering=!1},setRecentWallet(t){dt.recentWallet=t},setBuffering(t){dt.buffering=t},setStatus(t){dt.status=t},setIsSwitchingConnection(t){dt.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){try{await ue._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:n})}catch(r){throw new fa("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},async disconnectConnector({id:t,namespace:e}){try{await ue._getClient()?.disconnectConnector({id:t,namespace:e})}catch(n){throw new fa("Failed to disconnect connector","INTERNAL_SDK_ERROR",n)}},setConnections(t,e){const n=new Map(dt.connections);n.set(e,t),dt.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){const r=I.getAccountData(e)?.user?.accounts?.find(i=>i.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&qc.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await ue.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=re.getConnectorById(t.connectorId),s=t.connectorId===j.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)n&&await ue.handleAuthAccountSwitch({address:n,namespace:e});else return(await ue.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e))?.address;return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){const s=re.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===j.CONNECTOR_ID.AUTH,a=t.connectorId===j.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&qc.isSocialProvider(i)){const{address:l}=await qc.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){at.open({view:"ConnectingFarcaster"})},onConnect(){Ie.replace("ProfileWallets")}});c=l}else{const{address:l}=await qc.connectEmail({closeModalOnConnect:r,onOpen(){at.open({view:"EmailLogin"})},onConnect(){Ie.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await qc.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){const d=u?"AllWallets":"ConnectingWalletConnect";at.state.open?Ie.push(d):at.open({view:d})},onConnect(){Ie.replace("ProfileWallets")}});c=l}else{const l=await ue.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);l&&(c=l.address)}return o&&n&&await ue.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=I.getAccountData(n)?.caipAddress;if(o){const{address:c}=pn.parseCaipAddress(o);i=c}const a=yh.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await ue.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await ue.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},ue=_r(WM),op={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return b_(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let ap;async function vE(){if(!ap){const{createPublicClient:t,http:e,defineChain:n}=await hn(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./injective-sdk-yGcRIHv8.js").then(o=>o.bz);return{createPublicClient:r,http:s,defineChain:i}},__vite__mapDeps([0,1,2]));ap={createPublicClient:t,http:e,defineChain:n}}return ap}const Ug={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await vE(),{chainId:n}=pn.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await vE(),r=Z.state.projectId,s=await Ug.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(Ug.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},Qh={async getMyTokensWithBalance(t){const e=I.getAccountData()?.address,n=I.state.activeCaipNetwork,r=re.getConnectorId("eip155")===j.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=te.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===j.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await Ue.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){try{const n=op.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await ue.getCapabilities(t))?.[n]?.assetDiscovery?.supported)return null;const s=await ue.walletGetAssets({account:t,chainFilter:[n]});if(!op.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>op.createBalance(a,e.caipNetworkId));return te.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await Ug.createViemPublicClient(n),{address:s}=pn.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:Uu},{address:e,functionName:"symbol",args:[],abi:Uu},{address:e,functionName:"balanceOf",args:[s],abi:Uu},{address:e,functionName:"decimals",args:[],abi:Uu}]});return{name:i,symbol:o,decimals:c,balance:a&&c?b_(a,c):"0"}}},cp={adapters:{}},AA={state:cp,initialize(t){cp.adapters={...t}},get(t){return cp.adapters[t]}},wh={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0,ton:void 0},cr=Rt({providers:{...wh},providerIds:{...wh}}),yt={state:cr,subscribeKey(t,e){return en(cr,t,e)},subscribe(t){return Qt(cr,()=>{t(cr)})},subscribeProviders(t){return Qt(cr.providers,()=>t(cr.providers))},setProvider(t,e){t&&e&&(cr.providers[t]=Bl(e))},getProvider(t){if(t)return cr.providers[t]},setProviderId(t,e){e&&(cr.providerIds[t]=e)},getProviderId(t){if(t)return cr.providerIds[t]},reset(){cr.providers={...wh},cr.providerIds={...wh}},resetChain(t){cr.providers[t]=void 0,cr.providerIds[t]=void 0}},Za={async getTokenList(t){return(await Ue.fetchSwapTokens({chainId:t}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=I.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await ue?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await Ue.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await Ue.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&n&&r){const i=ue.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await Qh.getMyTokensWithBalance(t);return I.setAccountProp("tokenBalance",e,I.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:eu(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]},async handleSwapError(t){try{const e=t?.cause;return e?.json&&(await e.json())?.reasons?.[0]?.description?.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},gt=Rt({tokenBalances:[],loading:!1}),HM={state:gt,subscribe(t){return Qt(gt,()=>t(gt))},subscribeKey(t,e){return en(gt,t,e)},setToken(t){t&&(gt.token=Bl(t))},setTokenAmount(t){gt.sendTokenAmount=t},setReceiverAddress(t){gt.receiverAddress=t},setReceiverProfileImageUrl(t){gt.receiverProfileImageUrl=t},setReceiverProfileName(t){gt.receiverProfileName=t},setNetworkBalanceInUsd(t){gt.networkBalanceInUSD=t},setLoading(t){gt.loading=t},getSdkEventProperties(t){return{message:de.parseError(t),isSmartAccount:An(I.state.activeChain)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,token:gt.token?.symbol||"",amount:gt.sendTokenAmount??0,network:I.state.activeCaipNetwork?.caipNetworkId||""}},async sendToken(){try{switch(st.setLoading(!0),I.state.activeCaipNetwork?.chainNamespace){case"eip155":await st.sendEvmToken();return;case"solana":await st.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(t){throw xs.isUserRejectedRequestError(t)?new Zm(t):t}finally{st.setLoading(!1)}},async sendEvmToken(){const t=I.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=An(t);if(!st.state.sendTokenAmount||!st.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!st.state.token)throw new Error("A token is required");if(st.state.token?.address){ze.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,token:st.state.token.address,amount:st.state.sendTokenAmount,network:I.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await st.sendERC20Token({receiverAddress:st.state.receiverAddress,tokenAddress:st.state.token.address,sendTokenAmount:st.state.sendTokenAmount,decimals:st.state.token.quantity.decimals});n&&(gt.hash=n)}else{ze.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,token:st.state.token.symbol||"",amount:st.state.sendTokenAmount,network:I.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await st.sendNativeToken({receiverAddress:st.state.receiverAddress,sendTokenAmount:st.state.sendTokenAmount,decimals:st.state.token.quantity.decimals});n&&(gt.hash=n)}},async fetchTokenBalance(t){gt.loading=!0;const e=I.state.activeChain,n=I.state.activeCaipNetwork?.caipNetworkId,r=I.state.activeCaipNetwork?.chainNamespace,s=I.getAccountData(e)?.caipAddress??I.state.activeCaipAddress,i=s?de.getPlainAddress(s):void 0;if(gt.lastRetry&&!de.isAllowedRetry(gt.lastRetry,30*et.ONE_SEC_MS))return gt.loading=!1,[];try{if(i&&n&&r){const o=await Qh.getMyTokensWithBalance();return gt.tokenBalances=o,gt.lastRetry=void 0,o}}catch(o){gt.lastRetry=Date.now(),t?.(o),Wt.showError("Token Balance Unavailable")}finally{gt.loading=!1}return[]},fetchNetworkBalance(){if(gt.tokenBalances.length===0)return;const t=Za.mapBalancesToSwapTokens(gt.tokenBalances);if(!t)return;const e=t.find(n=>n.address===eu());e&&(gt.networkBalanceInUSD=e?Jt.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){Ie.pushTransactionStack({});const e=t.receiverAddress,n=I.getAccountData()?.address,r=ue.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await ue.sendTransaction({chainNamespace:j.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return ze.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:An("eip155")===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,token:st.state.token?.symbol||"",amount:t.sendTokenAmount,network:I.state.activeCaipNetwork?.caipNetworkId||"",hash:i||""}}),ue._getClient()?.updateBalance("eip155"),st.resetSend(),{hash:i}},async sendERC20Token(t){Ie.pushTransactionStack({onSuccess(){Ie.replace("Account")}});const e=ue.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=I.getAccountData()?.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=de.getPlainAddress(t.tokenAddress);if(!r)throw new Error("SendController:sendERC20Token - tokenAddress is required");const s=await ue.writeContract({fromAddress:n,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:nD.getERC20Abi(r),chainNamespace:j.CHAIN.EVM});return ze.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:An("eip155")===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,token:st.state.token?.symbol||"",amount:t.sendTokenAmount,network:I.state.activeCaipNetwork?.caipNetworkId||"",hash:s||""}}),st.resetSend(),{hash:s}}return{hash:void 0}},async sendSolanaToken(){if(!st.state.sendTokenAmount||!st.state.receiverAddress)throw new Error("An amount and receiver address are required");Ie.pushTransactionStack({onSuccess(){Ie.replace("Account")}});let t;st.state.token&&st.state.token.address!==et.SOLANA_NATIVE_TOKEN_ADDRESS&&(de.isCaipAddress(st.state.token.address)?t=de.getPlainAddress(st.state.token.address):t=st.state.token.address);const e=await ue.sendTransaction({chainNamespace:"solana",tokenMint:t,to:st.state.receiverAddress,value:st.state.sendTokenAmount});e&&(gt.hash=e),ue._getClient()?.updateBalance("solana"),ze.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:!1,token:st.state.token?.symbol||"",amount:st.state.sendTokenAmount,network:I.state.activeCaipNetwork?.caipNetworkId||"",hash:e||""}}),st.resetSend()},resetSend(){gt.token=void 0,gt.sendTokenAmount=void 0,gt.receiverAddress=void 0,gt.receiverProfileImageUrl=void 0,gt.receiverProfileName=void 0,gt.loading=!1,gt.tokenBalances=[]}},st=_r(HM),lp={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Xu={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},we=Rt({chains:Uk(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{connectionControllerClient:void 0},isSwitchingNamespace:!1}),IA={state:we,subscribe(t){return Qt(we,()=>{t(we)})},subscribeKey(t,e){return en(we,t,e)},subscribeAccountStateProp(t,e,n){const r=n||we.activeChain;return r?en(we.chains.get(r)?.accountState||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return Qt(we.chains,()=>{const s=n||we.activeChain;if(s){const i=we.chains.get(s)?.[t];r!==i&&(r=i,e(i))}})},initialize(t,e,n){const{chainId:r,namespace:s}=te.getActiveNetworkProps(),i=e?.find(u=>u.id.toString()===r?.toString()),a=t.find(u=>u?.namespace===s)||t?.[0],c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=Z.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(t?.length===0||!a)&&(we.noAdapters=!0),we.noAdapters||(we.activeChain=a?.namespace,we.activeCaipNetwork=i,I.setChainNetworkData(a?.namespace,{caipNetwork:i}),we.activeChain&&Dr.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(p=>p.chainNamespace===u),h=te.getPreferredAccountTypes()||{},f={...Z.state.defaultAccountTypes,...h};I.state.chains.set(u,{namespace:u,networkState:Rt({...Xu,caipNetwork:d?.[0]}),accountState:Rt({...lp,preferredAccountType:f[u]}),caipNetworks:d??[],...n}),I.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){if(we.activeChain===t){const e=Array.from(we.chains.entries()).find(([n])=>n!==t);if(e){const n=e[1]?.caipNetworks?.[0];n&&I.setActiveCaipNetwork(n)}}we.chains.delete(t)},addAdapter(t,{connectionControllerClient:e},n){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");we.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Xu,caipNetwork:n[0]},accountState:{...lp},caipNetworks:n,connectionControllerClient:e}),I.setRequestedCaipNetworks(n?.filter(r=>r.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=we.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];e.caipNetworks?.find(r=>r.id===t.id)||n.push(t),we.chains.set(t.chainNamespace,{...e,caipNetworks:n}),I.setRequestedCaipNetworks(n,t.chainNamespace),re.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const n=we.chains.get(t);if(n){const r=we.activeCaipNetwork?.id===e,s=[...n.caipNetworks?.filter(i=>i.id!==e)||[]];r&&n?.caipNetworks?.[0]&&I.setActiveCaipNetwork(n.caipNetworks[0]),we.chains.set(t,{...n,caipNetworks:s}),I.setRequestedCaipNetworks(s||[],t),s.length===0&&re.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=we.chains.get(t);n&&(n.networkState={...n.networkState||Xu,...e},we.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=we.chains.get(t);if(r){const s={...r.accountState||lp,...e};we.chains.set(t,{...r,accountState:s}),(we.chains.size===1||we.activeChain===t)&&e.caipAddress&&(we.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=we.chains.get(t);if(n){const r={...n.networkState||Xu,...e};we.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){I.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){we.activeChain=t;const e=t?we.chains.get(t):void 0,n=e?.networkState?.caipNetwork;n?.id&&t&&(we.activeCaipAddress=e?.accountState?.caipAddress,we.activeCaipNetwork=n,I.setChainNetworkData(t,{caipNetwork:n}),te.setActiveCaipNetworkId(n?.caipNetworkId),Dr.set({activeChain:t,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;const e=we.activeChain===t.chainNamespace;e||I.setIsSwitchingNamespace(!0);const n=we.chains.get(t.chainNamespace);we.activeChain=t.chainNamespace,we.activeCaipNetwork=t,I.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=n?.accountState?.address;if(r)we.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&we.activeCaipAddress){const{address:i}=pn.parseCaipAddress(we.activeCaipAddress);r=i,we.activeCaipAddress=`${t.caipNetworkId}:${r}`}else we.activeCaipAddress=void 0;I.setChainAccountData(t.chainNamespace,{address:r,caipAddress:we.activeCaipAddress}),st.resetSend(),Dr.set({activeChain:we.activeChain,selectedNetworkId:we.activeCaipNetwork?.caipNetworkId}),te.setActiveCaipNetworkId(t.caipNetworkId),!I.checkIfSupportedNetwork(t.chainNamespace)&&Z.state.enableNetworkSwitch&&!Z.state.allowUnsupportedChain&&!ue.state.wcBasic&&I.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=we.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==I.state.activeChain,n=I.getNetworkData(t)?.caipNetwork,r=I.getCaipNetworkByNamespace(t,n?.id);e&&r&&await I.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){const n=I.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=yt.getProviderId(we.activeChain)==="AUTH",s=I.getAccountData(n)?.address,i=j.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t.chainNamespace);try{if(s&&t.chainNamespace===n||r&&i){const o=AA.get(t.chainNamespace);if(!o)throw new Error("Adapter not found");await o.switchNetwork({caipNetwork:t})}I.setActiveCaipNetwork(t)}catch(o){if(e)throw o}ze.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})},getConnectionControllerClient(t){const e=t||we.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=we.chains.get(e);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){const n=we.chains.get(e)?.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=we.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=e?.networkState||{};return de.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return we.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=I.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){I.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=I.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));re.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return we.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=I.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){return t?we.chains.get(t)?.networkState?.caipNetwork:we.activeCaipNetwork},getActiveCaipAddress(){return we.activeCaipAddress},getApprovedCaipNetworkIds(t){return we.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},setApprovedCaipNetworksData(t,e){I.setAdapterNetworkState(t,e)},checkIfSupportedNetwork(t,e){const n=e||we.activeCaipNetwork?.caipNetworkId,r=I.getRequestedCaipNetworks(t);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(t){return we.activeChain?I.getRequestedCaipNetworks(we.activeChain)?.some(n=>n.id===t):!0},checkIfSmartAccountEnabled(){const t=rA.caipNetworkIdToNumber(we.activeCaipNetwork?.caipNetworkId);return!we.activeChain||!t?!1:!!(dn.get(Oe.SMART_ACCOUNT_ENABLED_NETWORKS)?.split(",")||[])?.includes(t.toString())},showUnsupportedChainUI(){at.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=we.activeCaipNetwork;return!!(t?.chainNamespace&&et.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){I.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=I.state.chains.get(e)?.accountState?.preferredAccountType,r=Z.state.defaultAccountTypes[e];we.activeCaipAddress=void 0,I.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),re.removeConnectorId(e)},setIsSwitchingNamespace(t){we.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(we.chains.forEach(n=>{j.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&t.push(n.namespace)}),t.length>0){const n=t[0];return e=n?we.chains.get(n)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||we.activeChain;if(e)return I.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||we.activeChain;if(e)return I.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const n=I.state.chains.get(t),r=n?.caipNetworks?.find(s=>s.id.toString()===e?.toString());return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=re.state.filterByNamespace;return(t?[we.chains.get(t)]:Array.from(we.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?I.getRequestedCaipNetworks(t):I.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return IA.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){we.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return we.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){const e=I.getAccountData();if(!e)return[];const n=I.state.activeCaipNetwork?.caipNetworkId,r=I.state.activeCaipNetwork?.chainNamespace,s=I.state.activeCaipAddress,i=s?de.getPlainAddress(s):void 0;if(I.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!de.isAllowedRetry(e.lastRetry,30*et.ONE_SEC_MS))return I.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const o=await Qh.getMyTokensWithBalance();return I.setAccountProp("tokenBalance",o,r),I.setAccountProp("lastRetry",void 0,r),I.setAccountProp("balanceLoading",!1,r),o}}catch(o){I.setAccountProp("lastRetry",Date.now(),r),t?.(o),Wt.showError("Token Balance Unavailable")}finally{I.setAccountProp("balanceLoading",!1,r)}return[]},isCaipNetworkDisabled(t){const e=t.chainNamespace,n=!!I.getAccountData(e)?.caipAddress,r=I.getAllApprovedCaipNetworkIds(),s=I.getNetworkProp("supportsAllNetworks",e)!==!1,i=re.getConnectorId(e),o=re.getAuthConnector(),a=i===j.CONNECTOR_ID.AUTH&&o;return!n||s||a?!1:!r?.includes(t.caipNetworkId)}},I=_r(IA),zM={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=I.state.activeCaipNetwork,r=I.state.activeChain,s=Ie.state.data;if(t.id===n?.id)return;const o=!!I.getAccountData(r)?.address,a=!!I.getAccountData(t.chainNamespace)?.address,c=t.chainNamespace!==r,u=re.getConnectorId(r)===j.CONNECTOR_ID.AUTH,d=j.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(h=>h===t.chainNamespace);e||u&&d?Ie.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?Ie.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):Ie.push("SwitchNetwork",{...s,network:t})}},lr=Rt({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),qM={state:lr,subscribe(t){return Qt(lr,()=>t(lr))},subscribeKey(t,e){return en(lr,t,e)},async open(t){const e=t?.namespace,n=I.state.activeChain,r=e&&e!==n,s=I.getAccountData(t?.namespace)?.caipAddress,i=I.state.noAdapters;if(ue.state.wcBasic?_e.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await _e.prefetch(),re.setFilterByNamespace(t?.namespace),at.setLoading(!0,e),e&&r){const o=I.getNetworkData(e)?.caipNetwork||I.getRequestedCaipNetworks(e)[0];o&&(i?(await I.switchActiveNetwork(o),Ie.push("ConnectingWalletConnectBasic")):zM.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else Z.state.manualWCControl||i&&!s?de.isMobile()?Ie.reset("AllWallets"):Ie.reset("ConnectingWalletConnectBasic"):t?.view?Ie.reset(t.view,t.data):s?Ie.reset("Account"):Ie.reset("Connect");lr.open=!0,Dr.set({open:!0}),ze.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=Z.state.enableEmbedded,e=!!I.state.activeCaipAddress;lr.open&&ze.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),lr.open=!1,Ie.reset("Connect"),at.clearLoading(),t?e?Ie.replace("Account"):Ie.push("Connect"):Dr.set({open:!1}),ue.resetUri()},setLoading(t,e){e&&lr.loadingNamespaceMap.set(e,t),lr.loading=t,Dr.set({loading:t})},clearLoading(){lr.loadingNamespaceMap.clear(),lr.loading=!1,Dr.set({loading:!1})},shake(){lr.shake||(lr.shake=!0,setTimeout(()=>{lr.shake=!1},500))}},at=_r(qM),bl={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Mg={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},VM={providers:aA,selectedProvider:null,error:null,purchaseCurrency:bl,paymentCurrency:Mg,purchaseCurrencies:[bl],paymentCurrencies:[],quotesLoading:!1},mt=Rt(VM),KM={state:mt,subscribe(t){return Qt(mt,()=>t(mt))},subscribeKey(t,e){return en(mt,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=I.state.activeChain,n=e===j.CHAIN.SOLANA?"SOL":"USDC",r=e?I.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",sD),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",Z.state.projectId),mt.selectedProvider={...t,url:s.toString()}}else mt.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=aA.filter(r=>e.includes(r.name));mt.providers=n}else mt.providers=[]},setPurchaseCurrency(t){mt.purchaseCurrency=t},setPaymentCurrency(t){mt.paymentCurrency=t},setPurchaseAmount(t){Lg.state.purchaseAmount=t},setPaymentAmount(t){Lg.state.paymentAmount=t},async getAvailableCurrencies(){const t=await Ue.getOnrampOptions();mt.purchaseCurrencies=t.purchaseCurrencies,mt.paymentCurrencies=t.paymentCurrencies,mt.paymentCurrency=t.paymentCurrencies[0]||Mg,mt.purchaseCurrency=t.purchaseCurrencies[0]||bl,await _e.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await _e.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){mt.quotesLoading=!0;try{const t=await Ue.getOnrampQuote({purchaseCurrency:mt.purchaseCurrency,paymentCurrency:mt.paymentCurrency,amount:mt.paymentAmount?.toString()||"0",network:mt.purchaseCurrency?.symbol});return mt.quotesLoading=!1,mt.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return mt.error=t.message,mt.quotesLoading=!1,null}finally{mt.quotesLoading=!1}},resetState(){mt.selectedProvider=null,mt.error=null,mt.purchaseCurrency=bl,mt.paymentCurrency=Mg,mt.purchaseCurrencies=[bl],mt.paymentCurrencies=[],mt.paymentAmount=void 0,mt.purchaseAmount=void 0,mt.quotesLoading=!1}},Lg=_r(KM);var Qu={exports:{}},_E;function SA(){if(_E)return Qu.exports;_E=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(A,x,k){return Function.prototype.apply.call(A,x,k)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:n=function(A){return Object.getOwnPropertyNames(A)};function r(O){}var s=Number.isNaN||function(A){return A!==A};function i(){i.init.call(this)}Qu.exports=i,Qu.exports.once=T,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(O){if(typeof O!="number"||O<0||s(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");o=O}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||s(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function c(O){return O._maxListeners===void 0?i.defaultMaxListeners:O._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(A){for(var x=[],k=1;k<arguments.length;k++)x.push(arguments[k]);var L=A==="error",M=this._events;if(M!==void 0)L=L&&M.error===void 0;else if(!L)return!1;if(L){var z;if(x.length>0&&(z=x[0]),z instanceof Error)throw z;var J=new Error("Unhandled error."+(z?" ("+z.message+")":""));throw J.context=z,J}var H=M[A];if(H===void 0)return!1;if(typeof H=="function")e(H,this,x);else for(var F=H.length,P=p(H,F),k=0;k<F;++k)e(P[k],this,x);return!0};function l(O,A,x,k){var L,M,z;if(a(x),M=O._events,M===void 0?(M=O._events=Object.create(null),O._eventsCount=0):(M.newListener!==void 0&&(O.emit("newListener",A,x.listener?x.listener:x),M=O._events),z=M[A]),z===void 0)z=M[A]=x,++O._eventsCount;else if(typeof z=="function"?z=M[A]=k?[x,z]:[z,x]:k?z.unshift(x):z.push(x),L=c(O),L>0&&z.length>L&&!z.warned){z.warned=!0;var J=new Error("Possible EventEmitter memory leak detected. "+z.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");J.name="MaxListenersExceededWarning",J.emitter=O,J.type=A,J.count=z.length}return O}i.prototype.addListener=function(A,x){return l(this,A,x,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(A,x){return l(this,A,x,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(O,A,x){var k={fired:!1,wrapFn:void 0,target:O,type:A,listener:x},L=u.bind(k);return L.listener=x,k.wrapFn=L,L}i.prototype.once=function(A,x){return a(x),this.on(A,d(this,A,x)),this},i.prototype.prependOnceListener=function(A,x){return a(x),this.prependListener(A,d(this,A,x)),this},i.prototype.removeListener=function(A,x){var k,L,M,z,J;if(a(x),L=this._events,L===void 0)return this;if(k=L[A],k===void 0)return this;if(k===x||k.listener===x)--this._eventsCount===0?this._events=Object.create(null):(delete L[A],L.removeListener&&this.emit("removeListener",A,k.listener||x));else if(typeof k!="function"){for(M=-1,z=k.length-1;z>=0;z--)if(k[z]===x||k[z].listener===x){J=k[z].listener,M=z;break}if(M<0)return this;M===0?k.shift():m(k,M),k.length===1&&(L[A]=k[0]),L.removeListener!==void 0&&this.emit("removeListener",A,J||x)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(A){var x,k,L;if(k=this._events,k===void 0)return this;if(k.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):k[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete k[A]),this;if(arguments.length===0){var M=Object.keys(k),z;for(L=0;L<M.length;++L)z=M[L],z!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(x=k[A],typeof x=="function")this.removeListener(A,x);else if(x!==void 0)for(L=x.length-1;L>=0;L--)this.removeListener(A,x[L]);return this};function h(O,A,x){var k=O._events;if(k===void 0)return[];var L=k[A];return L===void 0?[]:typeof L=="function"?x?[L.listener||L]:[L]:x?g(L):p(L,L.length)}i.prototype.listeners=function(A){return h(this,A,!0)},i.prototype.rawListeners=function(A){return h(this,A,!1)},i.listenerCount=function(O,A){return typeof O.listenerCount=="function"?O.listenerCount(A):f.call(O,A)},i.prototype.listenerCount=f;function f(O){var A=this._events;if(A!==void 0){var x=A[O];if(typeof x=="function")return 1;if(x!==void 0)return x.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function p(O,A){for(var x=new Array(A),k=0;k<A;++k)x[k]=O[k];return x}function m(O,A){for(;A+1<O.length;A++)O[A]=O[A+1];O.pop()}function g(O){for(var A=new Array(O.length),x=0;x<A.length;++x)A[x]=O[x].listener||O[x];return A}function T(O,A){return new Promise(function(x,k){function L(z){O.removeListener(A,M),k(z)}function M(){typeof O.removeListener=="function"&&O.removeListener("error",L),x([].slice.call(arguments))}_(O,A,M,{once:!0}),A!=="error"&&N(O,L,{once:!0})})}function N(O,A,x){typeof O.on=="function"&&_(O,"error",A,x)}function _(O,A,x,k){if(typeof O.on=="function")k.once?O.once(A,x):O.on(A,x);else if(typeof O.addEventListener=="function")O.addEventListener(A,function L(M){k.once&&O.removeEventListener(A,L),x(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}return Qu.exports}var Jr=SA();const ny=_o(Jr);var ge={};var $g=function(t,e){return $g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},$g(t,e)};function GM(t,e){$g(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Bg=function(){return Bg=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Bg.apply(this,arguments)};function YM(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function JM(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function ZM(t,e){return function(n,r){e(n,r,t)}}function XM(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function QM(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function eL(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function tL(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function nL(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Fg(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function TA(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function rL(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(TA(arguments[e]));return t}function sL(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function tu(t){return this instanceof tu?(this.v=t,this):new tu(t)}function iL(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(f){return new Promise(function(p,m){i.push([h,f,p,m])>1||a(h,f)})})}function a(h,f){try{c(r[h](f))}catch(p){d(i[0][3],p)}}function c(h){h.value instanceof tu?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function oL(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:tu(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function aL(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Fg=="function"?Fg(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function cL(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function lL(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function uL(t){return t&&t.__esModule?t:{default:t}}function dL(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function hL(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const fL=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Bg},__asyncDelegator:oL,__asyncGenerator:iL,__asyncValues:aL,__await:tu,__awaiter:QM,__classPrivateFieldGet:dL,__classPrivateFieldSet:hL,__createBinding:tL,__decorate:JM,__exportStar:nL,__extends:GM,__generator:eL,__importDefault:uL,__importStar:lL,__makeTemplateObject:cL,__metadata:XM,__param:ZM,__read:TA,__rest:YM,__spread:rL,__spreadArrays:sL,__values:Fg},Symbol.toStringTag,{value:"Module"})),Eu=__(fL);var up={},Vc={},CE;function pL(){if(CE)return Vc;CE=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Vc.delay=t,Vc}var Do={},dp={},Uo={},AE;function gL(){return AE||(AE=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.ONE_THOUSAND=Uo.ONE_HUNDRED=void 0,Uo.ONE_HUNDRED=100,Uo.ONE_THOUSAND=1e3),Uo}var hp={},IE;function mL(){return IE||(IE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(hp)),hp}var SE;function NA(){return SE||(SE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Eu;e.__exportStar(gL(),t),e.__exportStar(mL(),t)}(dp)),dp}var TE;function yL(){if(TE)return Do;TE=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.fromMiliseconds=Do.toMiliseconds=void 0;const t=NA();function e(r){return r*t.ONE_THOUSAND}Do.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return Do.fromMiliseconds=n,Do}var NE;function wL(){return NE||(NE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Eu;e.__exportStar(pL(),t),e.__exportStar(yL(),t)}(up)),up}var $a={},OE;function EL(){if(OE)return $a;OE=1,Object.defineProperty($a,"__esModule",{value:!0}),$a.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return $a.Watch=t,$a.default=t,$a}var fp={},Kc={},RE;function bL(){if(RE)return Kc;RE=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.IWatch=void 0;class t{}return Kc.IWatch=t,Kc}var PE;function vL(){return PE||(PE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Eu.__exportStar(bL(),t)}(fp)),fp}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Eu;e.__exportStar(wL(),t),e.__exportStar(EL(),t),e.__exportStar(vL(),t),e.__exportStar(NA(),t)})(ge);class Aa{}let _L=class extends Aa{constructor(e){super()}};const xE=ge.FIVE_SECONDS,Ia={pulse:"heartbeat_pulse"};let CL=class OA extends _L{constructor(e){super(e),this.events=new Jr.EventEmitter,this.interval=xE,this.interval=e?.interval||xE}static async init(e){const n=new OA(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),ge.toMiliseconds(this.interval))}pulse(){this.events.emit(Ia.pulse)}};const AL=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,IL=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,SL=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function TL(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){return}return e}function ed(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!SL.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(AL.test(t)||IL.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,TL)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function NL(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function yn(t,...e){try{return NL(t(...e))}catch(n){return Promise.reject(n)}}function OL(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function RL(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function $d(t){if(OL(t))return String(t);if(RL(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return $d(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const jg="base64:";function PL(t){return typeof t=="string"?t:jg+DL(t)}function xL(t){return typeof t!="string"||!t.startsWith(jg)?t:kL(t.slice(jg.length))}function kL(t){return globalThis.Buffer?lt.Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function DL(t){return globalThis.Buffer?lt.Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function hr(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function UL(...t){return hr(t.join(":"))}function td(t){return t=hr(t),t?t+":":""}function ML(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function LL(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const $L="memory",BL=()=>{const t=new Map;return{name:$L,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function FL(t={}){const e={mounts:{"":t.driver||BL()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=hr(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await kE(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,f=p=>{let m=h.get(p.base);return m||(m={driver:p.driver,base:p.base,items:[]},h.set(p.base,m)),m};for(const p of l){const m=typeof p=="string",g=hr(m?p:p.key),T=m?void 0:p.value,N=m||!p.options?u:{...u,...p.options},_=n(g);f(_).items.push({key:g,value:T,relativeKey:_.relativeKey,options:N})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=hr(l);const{relativeKey:d,driver:h}=n(l);return yn(h.hasItem,d,u)},getItem(l,u={}){l=hr(l);const{relativeKey:d,driver:h}=n(l);return yn(h.getItem,d,u).then(f=>ed(f))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?yn(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(f=>({key:UL(d.base,f.key),value:ed(f.value)}))):Promise.all(d.items.map(h=>yn(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:ed(f)})))))},getItemRaw(l,u={}){l=hr(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?yn(h.getItemRaw,d,u):yn(h.getItem,d,u).then(f=>xL(f))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=hr(l);const{relativeKey:h,driver:f}=n(l);f.setItem&&(await yn(f.setItem,h,$d(u),d),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return yn(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:$d(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>yn(d.driver.setItem,h.relativeKey,$d(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=hr(l);const{relativeKey:h,driver:f}=n(l);if(f.setItemRaw)await yn(f.setItemRaw,h,u,d);else if(f.setItem)await yn(f.setItem,h,PL(u),d);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=hr(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await yn(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await yn(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=hr(l);const{relativeKey:d,driver:h}=n(l),f=Object.create(null);if(h.getMeta&&Object.assign(f,await yn(h.getMeta,d,u)),!u.nativeOnly){const p=await yn(h.getItem,d+"$",u).then(m=>ed(m));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=td(l);const d=r(l,!0);let h=[];const f=[];let p=!0;for(const g of d){g.driver.flags?.maxDepth||(p=!1);const T=await yn(g.driver.getKeys,g.relativeBase,u);for(const N of T){const _=g.mountpoint+hr(N);h.some(O=>_.startsWith(O))||f.push(_)}h=[g.mountpoint,...h.filter(N=>!N.startsWith(g.mountpoint))]}const m=u.maxDepth!==void 0&&!p;return f.filter(g=>(!m||ML(g,u.maxDepth))&&LL(g,l))},async clear(l,u={}){l=td(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return yn(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(f=>d.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>DE(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=td(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(kE(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=td(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await DE(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=hr(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=hr(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function kE(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function DE(t){typeof t.dispose=="function"&&await yn(t.dispose)}function Sa(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function RA(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Sa(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let pp;function bu(){return pp||(pp=RA("keyval-store","keyval")),pp}function UE(t,e=bu()){return e("readonly",n=>Sa(n.get(t)))}function jL(t,e,n=bu()){return n("readwrite",r=>(r.put(e,t),Sa(r.transaction)))}function WL(t,e=bu()){return e("readwrite",n=>(n.delete(t),Sa(n.transaction)))}function HL(t=bu()){return t("readwrite",e=>(e.clear(),Sa(e.transaction)))}function zL(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Sa(t.transaction)}function qL(t=bu()){return t("readonly",e=>{if(e.getAllKeys)return Sa(e.getAllKeys());const n=[];return zL(e,r=>n.push(r.key)).then(()=>n)})}const VL="idb-keyval";var KL=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=RA(t.dbName,t.storeName)),{name:VL,options:t,async hasItem(s){return!(typeof await UE(n(s),r)>"u")},async getItem(s){return await UE(n(s),r)??null},setItem(s,i){return jL(n(s),i,r)},removeItem(s){return WL(n(s),r)},getKeys(){return qL(r)},clear(){return HL(r)}}};const GL="WALLET_CONNECT_V2_INDEXED_DB",YL="keyvaluestorage";let JL=class{constructor(){this.indexedDb=FL({driver:KL({dbName:GL,storeName:YL})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,wi(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var gp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof $e<"u"?$e:typeof self<"u"?self:{},Bd={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof gp<"u"&&gp.localStorage?Bd.exports=gp.localStorage:typeof window<"u"&&window.localStorage?Bd.exports=window.localStorage:Bd.exports=new e})();function ZL(t){var e;return[t[0],ha((e=t[1])!=null?e:"")]}let XL=class{constructor(){this.localStorage=Bd.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ZL)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return ha(n)}async setItem(e,n){this.localStorage.setItem(e,wi(n))}async removeItem(e){this.localStorage.removeItem(e)}};const QL="wc_storage_version",ME=1,e$=async(t,e,n)=>{const r=QL,s=await e.getItem(r);if(s&&s>=ME){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,ME),n(e),t$(t,o)},t$=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let n$=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new XL;this.storage=e;try{const n=new JL;e$(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var r$=Object.defineProperty,s$=(t,e,n)=>e in t?r$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,LE=(t,e,n)=>s$(t,typeof e!="symbol"?e+"":e,n);let i$=class extends Aa{constructor(e){super(),this.opts=e,LE(this,"protocol","wc"),LE(this,"version",2)}};var o$=Object.defineProperty,a$=(t,e,n)=>e in t?o$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,c$=(t,e,n)=>a$(t,e+"",n);let l$=class extends Aa{constructor(e,n){super(),this.core=e,this.logger=n,c$(this,"records",new Map)}},u$=class{constructor(e,n){this.logger=e,this.core=n}},d$=class extends Aa{constructor(e,n){super(),this.relayer=e,this.logger=n}},h$=class extends Aa{constructor(e){super()}},f$=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},p$=class extends Aa{constructor(e,n){super(),this.relayer=e,this.logger=n}},g$=class extends Aa{constructor(e,n){super(),this.core=e,this.logger=n}},m$=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},y$=class{constructor(e,n){this.projectId=e,this.logger=n}},w$=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var E$=Object.defineProperty,b$=(t,e,n)=>e in t?E$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$E=(t,e,n)=>b$(t,typeof e!="symbol"?e+"":e,n);let v$=class{constructor(e){this.opts=e,$E(this,"protocol","wc"),$E(this,"version",2)}},_$=class{constructor(e){this.client=e}};function C$(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function PA(t,...e){if(!C$(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function BE(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function A$(t,e){PA(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Ba=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const mp=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function I$(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function xA(t){return typeof t=="string"&&(t=I$(t)),PA(t),t}let S$=class{clone(){return this._cloneInto()}};function T$(t){const e=r=>t().update(xA(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function kA(t=32){if(Ba&&typeof Ba.getRandomValues=="function")return Ba.getRandomValues(new Uint8Array(t));if(Ba&&typeof Ba.randomBytes=="function")return Ba.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function N$(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let O$=class extends S${constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=mp(this.buffer)}update(e){BE(this);const{view:n,buffer:r,blockLen:s}=this;e=xA(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=mp(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){BE(this),A$(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;N$(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=mp(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const nd=BigInt(2**32-1),Wg=BigInt(32);function DA(t,e=!1){return e?{h:Number(t&nd),l:Number(t>>Wg&nd)}:{h:Number(t>>Wg&nd)|0,l:Number(t&nd)|0}}function R$(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=DA(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const P$=(t,e)=>BigInt(t>>>0)<<Wg|BigInt(e>>>0),x$=(t,e,n)=>t>>>n,k$=(t,e,n)=>t<<32-n|e>>>n,D$=(t,e,n)=>t>>>n|e<<32-n,U$=(t,e,n)=>t<<32-n|e>>>n,M$=(t,e,n)=>t<<64-n|e>>>n-32,L$=(t,e,n)=>t>>>n-32|e<<64-n,$$=(t,e)=>e,B$=(t,e)=>t,F$=(t,e,n)=>t<<n|e>>>32-n,j$=(t,e,n)=>e<<n|t>>>32-n,W$=(t,e,n)=>e<<n-32|t>>>64-n,H$=(t,e,n)=>t<<n-32|e>>>64-n;function z$(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const q$=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),V$=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,K$=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),G$=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,Y$=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),J$=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,rt={fromBig:DA,split:R$,toBig:P$,shrSH:x$,shrSL:k$,rotrSH:D$,rotrSL:U$,rotrBH:M$,rotrBL:L$,rotr32H:$$,rotr32L:B$,rotlSH:F$,rotlSL:j$,rotlBH:W$,rotlBL:H$,add:z$,add3L:q$,add3H:V$,add4L:K$,add4H:G$,add5H:J$,add5L:Y$},[Z$,X$]=rt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Di=new Uint32Array(80),Ui=new Uint32Array(80);let Q$=class extends O${constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:m,Hl:g}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=g|0}process(e,n){for(let _=0;_<16;_++,n+=4)Di[_]=e.getUint32(n),Ui[_]=e.getUint32(n+=4);for(let _=16;_<80;_++){const O=Di[_-15]|0,A=Ui[_-15]|0,x=rt.rotrSH(O,A,1)^rt.rotrSH(O,A,8)^rt.shrSH(O,A,7),k=rt.rotrSL(O,A,1)^rt.rotrSL(O,A,8)^rt.shrSL(O,A,7),L=Di[_-2]|0,M=Ui[_-2]|0,z=rt.rotrSH(L,M,19)^rt.rotrBH(L,M,61)^rt.shrSH(L,M,6),J=rt.rotrSL(L,M,19)^rt.rotrBL(L,M,61)^rt.shrSL(L,M,6),H=rt.add4L(k,J,Ui[_-7],Ui[_-16]),F=rt.add4H(H,x,z,Di[_-7],Di[_-16]);Di[_]=F|0,Ui[_]=H|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:m,Gl:g,Hh:T,Hl:N}=this;for(let _=0;_<80;_++){const O=rt.rotrSH(d,h,14)^rt.rotrSH(d,h,18)^rt.rotrBH(d,h,41),A=rt.rotrSL(d,h,14)^rt.rotrSL(d,h,18)^rt.rotrBL(d,h,41),x=d&f^~d&m,k=h&p^~h&g,L=rt.add5L(N,A,k,X$[_],Ui[_]),M=rt.add5H(L,T,O,x,Z$[_],Di[_]),z=L|0,J=rt.rotrSH(r,s,28)^rt.rotrBH(r,s,34)^rt.rotrBH(r,s,39),H=rt.rotrSL(r,s,28)^rt.rotrBL(r,s,34)^rt.rotrBL(r,s,39),F=r&i^r&a^i&a,P=s&o^s&c^o&c;T=m|0,N=g|0,m=f|0,g=p|0,f=d|0,p=h|0,{h:d,l:h}=rt.add(l|0,u|0,M|0,z|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const w=rt.add3L(z,H,P);r=rt.add3H(w,M,J,F),s=w|0}({h:r,l:s}=rt.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=rt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=rt.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=rt.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=rt.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=rt.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:g}=rt.add(this.Gh|0,this.Gl|0,m|0,g|0),{h:T,l:N}=rt.add(this.Hh|0,this.Hl|0,T|0,N|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,m,g,T,N)}roundClean(){Di.fill(0),Ui.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const e8=T$(()=>new Q$);const ry=BigInt(0),UA=BigInt(1),t8=BigInt(2);function sy(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function iy(t){if(!sy(t))throw new Error("Uint8Array expected")}function yp(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const n8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function oy(t){iy(t);let e="";for(let n=0;n<t.length;n++)e+=n8[t[n]];return e}function MA(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ry:BigInt("0x"+t)}const Vs={_0:48,_9:57,A:65,F:70,a:97,f:102};function FE(t){if(t>=Vs._0&&t<=Vs._9)return t-Vs._0;if(t>=Vs.A&&t<=Vs.F)return t-(Vs.A-10);if(t>=Vs.a&&t<=Vs.f)return t-(Vs.a-10)}function LA(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=FE(t.charCodeAt(i)),a=FE(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function r8(t){return MA(oy(t))}function Fd(t){return iy(t),MA(oy(Uint8Array.from(t).reverse()))}function $A(t,e){return LA(t.toString(16).padStart(e*2,"0"))}function Hg(t,e){return $A(t,e).reverse()}function Ks(t,e,n){let r;if(typeof e=="string")try{r=LA(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(sy(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function jE(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];iy(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const wp=t=>typeof t=="bigint"&&ry<=t;function s8(t,e,n){return wp(t)&&wp(e)&&wp(n)&&e<=t&&t<n}function Gc(t,e,n,r){if(!s8(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function i8(t){let e;for(e=0;t>ry;t>>=UA,e+=1);return e}const o8=t=>(t8<<BigInt(t-1))-UA,a8={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||sy(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ay(t,e,n={}){const r=(s,i,o)=>{const a=a8[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function WE(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const In=BigInt(0),Xt=BigInt(1),Vo=BigInt(2),c8=BigInt(3),zg=BigInt(4),HE=BigInt(5),zE=BigInt(8);function fn(t,e){const n=t%e;return n>=In?n:e+n}function l8(t,e,n){if(e<In)throw new Error("invalid exponent, negatives unsupported");if(n<=In)throw new Error("invalid modulus");if(n===Xt)return In;let r=Xt;for(;e>In;)e&Xt&&(r=r*t%n),t=t*t%n,e>>=Xt;return r}function Cs(t,e,n){let r=t;for(;e-- >In;)r*=r,r%=n;return r}function qE(t,e){if(t===In)throw new Error("invert: expected non-zero number");if(e<=In)throw new Error("invert: expected positive modulus, got "+e);let n=fn(t,e),r=e,s=In,i=Xt;for(;n!==In;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Xt)throw new Error("invert: does not exist");return fn(s,e)}function u8(t){const e=(t-Xt)/Vo;let n,r,s;for(n=t-Xt,r=0;n%Vo===In;n/=Vo,r++);for(s=Vo;s<t&&l8(s,e,t)!==t-Xt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+Xt)/zg;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+Xt)/Vo;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(l,Xt<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function d8(t){if(t%zg===c8){const e=(t+Xt)/zg;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%zE===HE){const e=(t-HE)/zE;return function(n,r){const s=n.mul(r,Vo),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,Vo),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return u8(t)}const h8=(t,e)=>(fn(t,e)&Xt)===Xt,f8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function p8(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=f8.reduce((r,s)=>(r[s]="function",r),e);return ay(t,n)}function g8(t,e,n){if(n<In)throw new Error("invalid exponent, negatives unsupported");if(n===In)return t.ONE;if(n===Xt)return e;let r=t.ONE,s=e;for(;n>In;)n&Xt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Xt;return r}function m8(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function BA(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function FA(t,e,n=!1,r={}){if(t<=In)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=BA(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:o8(s),ZERO:In,ONE:Xt,create:c=>fn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return In<=c&&c<t},is0:c=>c===In,isOdd:c=>(c&Xt)===Xt,neg:c=>fn(-c,t),eql:(c,l)=>c===l,sqr:c=>fn(c*c,t),add:(c,l)=>fn(c+l,t),sub:(c,l)=>fn(c-l,t),mul:(c,l)=>fn(c*l,t),pow:(c,l)=>g8(a,c,l),div:(c,l)=>fn(c*qE(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>qE(c,t),sqrt:r.sqrt||(c=>(o||(o=d8(t)),o(a,c))),invertBatch:c=>m8(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Hg(c,i):$A(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Fd(c):r8(c)}});return Object.freeze(a)}const VE=BigInt(0),rd=BigInt(1);function Ep(t,e){const n=e.negate();return t?n:e}function jA(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function bp(t,e){jA(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function y8(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function w8(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const vp=new WeakMap,WA=new WeakMap;function _p(t){return WA.get(t)||1}function E8(t,e){return{constTimeNegate:Ep,hasPrecomputes(n){return _p(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>VE;)r&rd&&(s=s.add(i)),i=i.double(),r>>=rd;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=bp(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=bp(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=rd);const m=f,g=f+Math.abs(p)-1,T=h%2!==0,N=p<0;p===0?c=c.add(Ep(T,r[m])):a=a.add(Ep(N,r[g]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=bp(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===VE)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=rd),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=vp.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&vp.set(r,s(i))),i},wNAFCached(n,r,s){const i=_p(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=_p(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){jA(r,e),WA.set(n,r),vp.delete(n)}}}function b8(t,e,n,r){if(y8(n,t),w8(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=i8(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],m=Number(p>>BigInt(d)&BigInt(a));c[m]=c[m].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function v8(t){return p8(t.Fp),ay(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...BA(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Xr=BigInt(0),ur=BigInt(1),sd=BigInt(2),_8=BigInt(8),C8={zip215:!0};function A8(t){const e=v8(t);return ay(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function I8(t){const e=A8(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=sd<<BigInt(a*8)-ur,u=n.create,d=FA(e.n,e.nBitLength),h=e.uvRatio||((w,E)=>{try{return{isValid:!0,value:n.sqrt(w*n.inv(E))}}catch{return{isValid:!1,value:Xr}}}),f=e.adjustScalarBytes||(w=>w),p=e.domain||((w,E,R)=>{if(yp("phflag",R),E.length||R)throw new Error("Contexts/pre-hash are not supported");return w});function m(w,E){Gc("coordinate "+w,E,Xr,l)}function g(w){if(!(w instanceof _))throw new Error("ExtendedPoint expected")}const T=WE((w,E)=>{const{ex:R,ey:b,ez:y}=w,C=w.is0();E==null&&(E=C?_8:n.inv(y));const $=u(R*E),B=u(b*E),G=u(y*E);if(C)return{x:Xr,y:ur};if(G!==ur)throw new Error("invZ was invalid");return{x:$,y:B}}),N=WE(w=>{const{a:E,d:R}=e;if(w.is0())throw new Error("bad point: ZERO");const{ex:b,ey:y,ez:C,et:$}=w,B=u(b*b),G=u(y*y),Y=u(C*C),Q=u(Y*Y),ye=u(B*E),be=u(Y*u(ye+G)),De=u(Q+u(R*u(B*G)));if(be!==De)throw new Error("bad point: equation left != right (1)");const ve=u(b*y),Be=u(C*$);if(ve!==Be)throw new Error("bad point: equation left != right (2)");return!0});class _{constructor(E,R,b,y){this.ex=E,this.ey=R,this.ez=b,this.et=y,m("x",E),m("y",R),m("z",b),m("t",y),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(E){if(E instanceof _)throw new Error("extended point not allowed");const{x:R,y:b}=E||{};return m("x",R),m("y",b),new _(R,b,ur,u(R*b))}static normalizeZ(E){const R=n.invertBatch(E.map(b=>b.ez));return E.map((b,y)=>b.toAffine(R[y])).map(_.fromAffine)}static msm(E,R){return b8(_,d,E,R)}_setWindowSize(E){x.setWindowSize(this,E)}assertValidity(){N(this)}equals(E){g(E);const{ex:R,ey:b,ez:y}=this,{ex:C,ey:$,ez:B}=E,G=u(R*B),Y=u(C*y),Q=u(b*B),ye=u($*y);return G===Y&&Q===ye}is0(){return this.equals(_.ZERO)}negate(){return new _(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:E}=e,{ex:R,ey:b,ez:y}=this,C=u(R*R),$=u(b*b),B=u(sd*u(y*y)),G=u(E*C),Y=R+b,Q=u(u(Y*Y)-C-$),ye=G+$,be=ye-B,De=G-$,ve=u(Q*be),Be=u(ye*De),ct=u(Q*De),Ct=u(be*ye);return new _(ve,Be,Ct,ct)}add(E){g(E);const{a:R,d:b}=e,{ex:y,ey:C,ez:$,et:B}=this,{ex:G,ey:Y,ez:Q,et:ye}=E;if(R===BigInt(-1)){const vi=u((C-y)*(Y+G)),_i=u((C+y)*(Y-G)),Hs=u(_i-vi);if(Hs===Xr)return this.double();const To=u($*sd*ye),No=u(B*sd*Q),Oo=No+To,X=_i+vi,ae=No-To,Re=u(Oo*Hs),Xe=u(X*ae),Tn=u(Oo*ae),Ci=u(Hs*X);return new _(Re,Xe,Ci,Tn)}const be=u(y*G),De=u(C*Y),ve=u(B*b*ye),Be=u($*Q),ct=u((y+C)*(G+Y)-be-De),Ct=Be-ve,$t=Be+ve,tn=u(De-R*be),Sn=u(ct*Ct),Bc=u($t*tn),Ra=u(ct*tn),bi=u(Ct*$t);return new _(Sn,Bc,bi,Ra)}subtract(E){return this.add(E.negate())}wNAF(E){return x.wNAFCached(this,E,_.normalizeZ)}multiply(E){const R=E;Gc("scalar",R,ur,r);const{p:b,f:y}=this.wNAF(R);return _.normalizeZ([b,y])[0]}multiplyUnsafe(E,R=_.ZERO){const b=E;return Gc("scalar",b,Xr,r),b===Xr?A:this.is0()||b===ur?this:x.wNAFCachedUnsafe(this,b,_.normalizeZ,R)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,r).is0()}toAffine(E){return T(this,E)}clearCofactor(){const{h:E}=e;return E===ur?this:this.multiplyUnsafe(E)}static fromHex(E,R=!1){const{d:b,a:y}=e,C=n.BYTES;E=Ks("pointHex",E,C),yp("zip215",R);const $=E.slice(),B=E[C-1];$[C-1]=B&-129;const G=Fd($),Y=R?l:n.ORDER;Gc("pointHex.y",G,Xr,Y);const Q=u(G*G),ye=u(Q-ur),be=u(b*Q-y);let{isValid:De,value:ve}=h(ye,be);if(!De)throw new Error("Point.fromHex: invalid y coordinate");const Be=(ve&ur)===ur,ct=(B&128)!==0;if(!R&&ve===Xr&&ct)throw new Error("Point.fromHex: x=0 and x_0=1");return ct!==Be&&(ve=u(-ve)),_.fromAffine({x:ve,y:G})}static fromPrivateKey(E){return M(E).point}toRawBytes(){const{x:E,y:R}=this.toAffine(),b=Hg(R,n.BYTES);return b[b.length-1]|=E&ur?128:0,b}toHex(){return oy(this.toRawBytes())}}_.BASE=new _(e.Gx,e.Gy,ur,u(e.Gx*e.Gy)),_.ZERO=new _(Xr,ur,ur,Xr);const{BASE:O,ZERO:A}=_,x=E8(_,a*8);function k(w){return fn(w,r)}function L(w){return k(Fd(w))}function M(w){const E=n.BYTES;w=Ks("private key",w,E);const R=Ks("hashed private key",i(w),2*E),b=f(R.slice(0,E)),y=R.slice(E,2*E),C=L(b),$=O.multiply(C),B=$.toRawBytes();return{head:b,prefix:y,scalar:C,point:$,pointBytes:B}}function z(w){return M(w).pointBytes}function J(w=new Uint8Array,...E){const R=jE(...E);return L(i(p(R,Ks("context",w),!!s)))}function H(w,E,R={}){w=Ks("message",w),s&&(w=s(w));const{prefix:b,scalar:y,pointBytes:C}=M(E),$=J(R.context,b,w),B=O.multiply($).toRawBytes(),G=J(R.context,B,C,w),Y=k($+G*y);Gc("signature.s",Y,Xr,r);const Q=jE(B,Hg(Y,n.BYTES));return Ks("result",Q,n.BYTES*2)}const F=C8;function P(w,E,R,b=F){const{context:y,zip215:C}=b,$=n.BYTES;w=Ks("signature",w,2*$),E=Ks("message",E),R=Ks("publicKey",R,$),C!==void 0&&yp("zip215",C),s&&(E=s(E));const B=Fd(w.slice($,2*$));let G,Y,Q;try{G=_.fromHex(R,C),Y=_.fromHex(w.slice(0,$),C),Q=O.multiplyUnsafe(B)}catch{return!1}if(!C&&G.isSmallOrder())return!1;const ye=J(y,Y.toRawBytes(),G.toRawBytes(),E);return Y.add(G.multiplyUnsafe(ye)).subtract(Q).clearCofactor().equals(_.ZERO)}return O._setWindowSize(8),{CURVE:e,getPublicKey:z,sign:H,verify:P,ExtendedPoint:_,utils:{getExtendedPublicKey:M,randomPrivateKey:()=>o(n.BYTES),precompute(w=8,E=_.BASE){return E._setWindowSize(w),E.multiply(BigInt(3)),E}}}}BigInt(0),BigInt(1);const cy=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),KE=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const S8=BigInt(1),GE=BigInt(2);BigInt(3);const T8=BigInt(5),N8=BigInt(8);function O8(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=cy,o=t*t%i*t%i,a=Cs(o,GE,i)*o%i,c=Cs(a,S8,i)*t%i,l=Cs(c,T8,i)*c%i,u=Cs(l,e,i)*l%i,d=Cs(u,n,i)*u%i,h=Cs(d,r,i)*d%i,f=Cs(h,s,i)*h%i,p=Cs(f,s,i)*h%i,m=Cs(p,e,i)*l%i;return{pow_p_5_8:Cs(m,GE,i)*t%i,b2:o}}function R8(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function P8(t,e){const n=cy,r=fn(e*e*e,n),s=fn(r*r*e,n),i=O8(t*s).pow_p_5_8;let o=fn(t*r*i,n);const a=fn(e*o*o,n),c=o,l=fn(o*KE,n),u=a===t,d=a===fn(-t,n),h=a===fn(-t*KE,n);return u&&(o=c),(d||h)&&(o=l),h8(o,n)&&(o=fn(-o,n)),{isValid:u||d,value:o}}const x8=FA(cy,void 0,!0),k8={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:x8,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:N8,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:e8,randomBytes:kA,adjustScalarBytes:R8,uvRatio:P8},HA=I8(k8),D8="EdDSA",U8="JWT",Eh=".",ef="base64url",zA="utf8",qA="utf8",M8=":",L8="did",$8="key",YE="base58btc",B8="z",F8="K36",j8=32;function ly(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function VA(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ly(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function KA(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=VA(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return ly(n)}function W8(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,g=0,T=0,N=p.length;T!==N&&p[T]===0;)T++,m++;for(var _=(N-T)*u+1>>>0,O=new Uint8Array(_);T!==N;){for(var A=p[T],x=0,k=_-1;(A!==0||x<g)&&k!==-1;k--,x++)A+=256*O[k]>>>0,O[k]=A%a>>>0,A=A/a>>>0;if(A!==0)throw new Error("Non-zero carry");g=x,T++}for(var L=_-g;L!==_&&O[L]===0;)L++;for(var M=c.repeat(m);L<_;++L)M+=t.charAt(O[L]);return M}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var g=0,T=0;p[m]===c;)g++,m++;for(var N=(p.length-m)*l+1>>>0,_=new Uint8Array(N);p[m];){var O=n[p.charCodeAt(m)];if(O===255)return;for(var A=0,x=N-1;(O!==0||A<T)&&x!==-1;x--,A++)O+=a*_[x]>>>0,_[x]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");T=A,m++}if(p[m]!==" "){for(var k=N-T;k!==N&&_[k]===0;)k++;for(var L=new Uint8Array(g+(N-k)),M=g;k!==N;)L[M++]=_[k++];return L}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var H8=W8,z8=H8;const GA=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},q8=t=>new TextEncoder().encode(t),V8=t=>new TextDecoder().decode(t);let K8=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},G8=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return YA(this,e)}},Y8=class{constructor(e){this.decoders=e}or(e){return YA(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const YA=(t,e)=>new Y8({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let J8=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new K8(e,n,r),this.decoder=new G8(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const tf=({name:t,prefix:e,encode:n,decode:r})=>new J8(t,e,n,r),vu=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=z8(n,e);return tf({prefix:t,name:e,encode:r,decode:i=>GA(s(i))})},Z8=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},X8=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Un=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>tf({prefix:e,name:t,encode(s){return X8(s,r,n)},decode(s){return Z8(s,r,n,t)}}),Q8=tf({prefix:"\0",name:"identity",encode:t=>V8(t),decode:t=>q8(t)});var e5=Object.freeze({__proto__:null,identity:Q8});const t5=Un({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var n5=Object.freeze({__proto__:null,base2:t5});const r5=Un({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var s5=Object.freeze({__proto__:null,base8:r5});const i5=vu({prefix:"9",name:"base10",alphabet:"0123456789"});var o5=Object.freeze({__proto__:null,base10:i5});const a5=Un({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),c5=Un({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var l5=Object.freeze({__proto__:null,base16:a5,base16upper:c5});const u5=Un({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),d5=Un({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),h5=Un({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),f5=Un({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p5=Un({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g5=Un({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),m5=Un({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),y5=Un({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),w5=Un({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var E5=Object.freeze({__proto__:null,base32:u5,base32upper:d5,base32pad:h5,base32padupper:f5,base32hex:p5,base32hexupper:g5,base32hexpad:m5,base32hexpadupper:y5,base32z:w5});const b5=vu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),v5=vu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _5=Object.freeze({__proto__:null,base36:b5,base36upper:v5});const C5=vu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),A5=vu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var I5=Object.freeze({__proto__:null,base58btc:C5,base58flickr:A5});const S5=Un({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),T5=Un({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),N5=Un({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),O5=Un({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var R5=Object.freeze({__proto__:null,base64:S5,base64pad:T5,base64url:N5,base64urlpad:O5});const JA=Array.from(""),P5=JA.reduce((t,e,n)=>(t[n]=e,t),[]),x5=JA.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function k5(t){return t.reduce((e,n)=>(e+=P5[n],e),"")}function D5(t){const e=[];for(const n of t){const r=x5[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const U5=tf({prefix:"",name:"base256emoji",encode:k5,decode:D5});var M5=Object.freeze({__proto__:null,base256emoji:U5}),L5=ZA,JE=128,$5=-128,B5=Math.pow(2,31);function ZA(t,e,n){e=e||[],n=n||0;for(var r=n;t>=B5;)e[n++]=t&255|JE,t/=128;for(;t&$5;)e[n++]=t&255|JE,t>>>=7;return e[n]=t|0,ZA.bytes=n-r+1,e}var F5=qg,j5=128,ZE=127;function qg(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw qg.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&ZE)<<s:(o&ZE)*Math.pow(2,s),s+=7}while(o>=j5);return qg.bytes=i-r,n}var W5=Math.pow(2,7),H5=Math.pow(2,14),z5=Math.pow(2,21),q5=Math.pow(2,28),V5=Math.pow(2,35),K5=Math.pow(2,42),G5=Math.pow(2,49),Y5=Math.pow(2,56),J5=Math.pow(2,63),Z5=function(t){return t<W5?1:t<H5?2:t<z5?3:t<q5?4:t<V5?5:t<K5?6:t<G5?7:t<Y5?8:t<J5?9:10},X5={encode:L5,decode:F5,encodingLength:Z5},XA=X5;const XE=(t,e,n=0)=>(XA.encode(t,e,n),e),QE=t=>XA.encodingLength(t),Vg=(t,e)=>{const n=e.byteLength,r=QE(t),s=r+QE(n),i=new Uint8Array(s+n);return XE(t,i,0),XE(n,i,r),i.set(e,s),new Q5(t,n,e,i)};let Q5=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const QA=({name:t,code:e,encode:n})=>new e4(t,e,n);let e4=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Vg(this.code,n):n.then(r=>Vg(this.code,r))}else throw Error("Unknown type, must be binary type")}};const eI=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),t4=QA({name:"sha2-256",code:18,encode:eI("SHA-256")}),n4=QA({name:"sha2-512",code:19,encode:eI("SHA-512")});var r4=Object.freeze({__proto__:null,sha256:t4,sha512:n4});const tI=0,s4="identity",nI=GA,i4=t=>Vg(tI,nI(t)),o4={code:tI,name:s4,encode:nI,digest:i4};var a4=Object.freeze({__proto__:null,identity:o4});new TextEncoder,new TextDecoder;const eb={...e5,...n5,...s5,...o5,...l5,...E5,..._5,...I5,...R5,...M5};({...r4,...a4});function rI(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const tb=rI("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Cp=rI("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=VA(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),sI={utf8:tb,"utf-8":tb,hex:eb.base16,latin1:Cp,ascii:Cp,binary:Cp,...eb};function nf(t,e="utf8"){const n=sI[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function xc(t,e="utf8"){const n=sI[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ly(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function nb(t){return ha(nf(xc(t,ef),zA))}function bh(t){return nf(xc(wi(t),zA),ef)}function iI(t){const e=xc(F8,YE),n=B8+nf(KA([e,t]),YE);return[L8,$8,n].join(M8)}function c4(t){return nf(t,ef)}function l4(t){return xc(t,ef)}function u4(t){return xc([bh(t.header),bh(t.payload)].join(Eh),qA)}function d4(t){return[bh(t.header),bh(t.payload),c4(t.signature)].join(Eh)}function Kg(t){const e=t.split(Eh),n=nb(e[0]),r=nb(e[1]),s=l4(e[2]),i=xc(e.slice(0,2).join(Eh),qA);return{header:n,payload:r,signature:s,data:i}}function rb(t=kA(j8)){const e=HA.getPublicKey(t);return{secretKey:KA([t,e]),publicKey:e}}async function h4(t,e,n,r,s=ge.fromMiliseconds(Date.now())){const i={alg:D8,typ:U8},o=iI(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=u4({header:i,payload:c}),u=HA.sign(l,r.secretKey.slice(0,32));return d4({header:i,payload:c,signature:u})}var sb=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},f4=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),p4=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=Ft.platform}return t}(),g4=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),m4=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),y4=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),w4=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,E4=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ib=3,b4=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",w4]],ob=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function v4(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new y4:typeof navigator<"u"?C4(navigator.userAgent):I4()}function _4(t){return t!==""&&b4.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function C4(t){var e=_4(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new m4;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<ib&&(s=sb(sb([],s,!0),S4(ib-s.length),!0)):s=[];var i=s.join("."),o=A4(t),a=E4.exec(t);return a&&a[1]?new g4(n,i,o,a[1]):new f4(n,i,o)}function A4(t){for(var e=0,n=ob.length;e<n;e++){var r=ob[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function I4(){var t=typeof Ft<"u"&&Ft.version;return t?new p4(Ft.version.slice(1)):null}function S4(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.getLocalStorage=Ut.getLocalStorageOrThrow=Ut.getCrypto=Ut.getCryptoOrThrow=oI=Ut.getLocation=Ut.getLocationOrThrow=uy=Ut.getNavigator=Ut.getNavigatorOrThrow=pa=Ut.getDocument=Ut.getDocumentOrThrow=Ut.getFromWindowOrThrow=Ut.getFromWindow=void 0;function Ta(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ut.getFromWindow=Ta;function kc(t){const e=Ta(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ut.getFromWindowOrThrow=kc;function T4(){return kc("document")}Ut.getDocumentOrThrow=T4;function N4(){return Ta("document")}var pa=Ut.getDocument=N4;function O4(){return kc("navigator")}Ut.getNavigatorOrThrow=O4;function R4(){return Ta("navigator")}var uy=Ut.getNavigator=R4;function P4(){return kc("location")}Ut.getLocationOrThrow=P4;function x4(){return Ta("location")}var oI=Ut.getLocation=x4;function k4(){return kc("crypto")}Ut.getCryptoOrThrow=k4;function D4(){return Ta("crypto")}Ut.getCrypto=D4;function U4(){return kc("localStorage")}Ut.getLocalStorageOrThrow=U4;function M4(){return Ta("localStorage")}Ut.getLocalStorage=M4;var dy={};Object.defineProperty(dy,"__esModule",{value:!0});var aI=dy.getWindowMetadata=void 0;const ab=Ut;function L4(){let t,e;try{t=ab.getDocumentOrThrow(),e=ab.getLocationOrThrow()}catch{return null}function n(){const d=t.getElementsByTagName("link"),h=[];for(let f=0;f<d.length;f++){const p=d[f],m=p.getAttribute("rel");if(m&&m.toLowerCase().indexOf("icon")>-1){const g=p.getAttribute("href");if(g)if(g.toLowerCase().indexOf("https:")===-1&&g.toLowerCase().indexOf("http:")===-1&&g.indexOf("//")!==0){let T=e.protocol+"//"+e.host;if(g.indexOf("/")===0)T+=g;else{const N=e.pathname.split("/");N.pop();const _=N.join("/");T+=_+"/"+g}h.push(T)}else if(g.indexOf("//")===0){const T=e.protocol+g;h.push(T)}else h.push(g)}}return h}function r(...d){const h=t.getElementsByTagName("meta");for(let f=0;f<h.length;f++){const p=h[f],m=["itemprop","property","name"].map(g=>p.getAttribute(g)).filter(g=>g?d.includes(g):!1);if(m.length&&m){const g=p.getAttribute("content");if(g)return g}}return""}function s(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=n();return{description:a,url:c,icons:l,name:o}}aI=dy.getWindowMetadata=L4;const $4="0.1.1";function B4(){return $4}class zt extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof zt){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof zt&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${B4()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return cI(this,e)}}function cI(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?cI(t.cause,e):e?null:t}function F4(t,e){if(db(t)>e)throw new a6({givenSize:db(t),maxSize:e})}const Gs={zero:48,nine:57,A:65,F:70,a:97,f:102};function cb(t){if(t>=Gs.zero&&t<=Gs.nine)return t-Gs.zero;if(t>=Gs.A&&t<=Gs.F)return t-(Gs.A-10);if(t>=Gs.a&&t<=Gs.f)return t-(Gs.a-10)}function j4(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new c6({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function lI(t,e){if(bo(t)>e)throw new Z4({givenSize:bo(t),maxSize:e})}function W4(t,e){if(typeof e=="number"&&e>0&&e>bo(t)-1)throw new hI({offset:e,position:"start",size:bo(t)})}function H4(t,e,n){if(typeof e=="number"&&typeof n=="number"&&bo(t)!==n-e)throw new hI({offset:n,position:"end",size:bo(t)})}function uI(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new X4({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const z4="#__bigint";function hy(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+z4:s,n)}const q4=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function V4(t,e={}){const{strict:n=!1}=e;if(!t)throw new lb(t);if(typeof t!="string")throw new lb(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new ub(t);if(!t.startsWith("0x"))throw new ub(t)}function K4(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function fy(t){return t instanceof Uint8Array?vh(t):Array.isArray(t)?vh(new Uint8Array(t)):t}function vh(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=q4[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(lI(r,e.size),dI(r,e.size)):r}function Ap(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new J4({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?G4(c,r):c}function G4(t,e){return uI(t,{dir:"left",size:e})}function dI(t,e){return uI(t,{dir:"right",size:e})}function ii(t,e,n,r={}){const{strict:s}=r;W4(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&H4(i,e,n),i}function bo(t){return Math.ceil((t.length-2)/2)}function Y4(t,e={}){const{strict:n=!1}=e;try{return V4(t,{strict:n}),!0}catch{return!1}}class J4 extends zt{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class lb extends zt{constructor(e){super(`Value \`${typeof e=="object"?hy(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class ub extends zt{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let Z4=class extends zt{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class hI extends zt{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let X4=class extends zt{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const Q4=new TextEncoder;function e6(t){if(!(t instanceof Uint8Array)){if(!t)throw new id(t);if(typeof t!="object")throw new id(t);if(!("BYTES_PER_ELEMENT"in t))throw new id(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new id(t)}}function t6(t){return t instanceof Uint8Array?t:typeof t=="string"?r6(t):n6(t)}function n6(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function r6(t,e={}){const{size:n}=e;let r=t;n&&(lI(t,n),r=dI(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=cb(s.charCodeAt(c++)),u=cb(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new zt(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function s6(t,e={}){const{size:n}=e,r=Q4.encode(t);return typeof n=="number"?(F4(r,n),i6(r,n)):r}function i6(t,e){return j4(t,{dir:"right",size:e})}function db(t){return t.length}function o6(t){try{return e6(t),!0}catch{return!1}}class id extends zt{constructor(e){super(`Value \`${typeof e=="object"?hy(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class a6 extends zt{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class c6 extends zt{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function fI(t,e={}){const{as:n=typeof t=="string"?"Hex":"Bytes"}=e,r=nN(t6(t));return n==="Bytes"?r:vh(r)}class l6 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const u6={checksum:new l6(8192)},Ip=u6.checksum;function pI(t,e={}){const{compressed:n}=e,{prefix:r,x:s,y:i}=t;if(n===!1||typeof s=="bigint"&&typeof i=="bigint"){if(r!==4)throw new hb({prefix:r,cause:new m6});return}if(n===!0||typeof s=="bigint"&&typeof i>"u"){if(r!==3&&r!==2)throw new hb({prefix:r,cause:new g6});return}throw new p6({publicKey:t})}function d6(t){const e=(()=>{if(Y4(t))return gI(t);if(o6(t))return h6(t);const{prefix:n,x:r,y:s}=t;return typeof r=="bigint"&&typeof s=="bigint"?{prefix:n??4,x:r,y:s}:{prefix:n,x:r}})();return pI(e),e}function h6(t){return gI(vh(t))}function gI(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new y6({publicKey:t});if(t.length===130){const r=BigInt(ii(t,0,32)),s=BigInt(ii(t,32,64));return{prefix:4,x:r,y:s}}if(t.length===132){const r=Number(ii(t,0,1)),s=BigInt(ii(t,1,33)),i=BigInt(ii(t,33,65));return{prefix:r,x:s,y:i}}const e=Number(ii(t,0,1)),n=BigInt(ii(t,1,33));return{prefix:e,x:n}}function f6(t,e={}){pI(t);const{prefix:n,x:r,y:s}=t,{includePrefix:i=!0}=e;return K4(i?Ap(n,{size:1}):"0x",Ap(r,{size:32}),typeof s=="bigint"?Ap(s,{size:32}):"0x")}class p6 extends zt{constructor({publicKey:e}){super(`Value \`${hy(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class hb extends zt{constructor({prefix:e,cause:n}){super(`Prefix "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class g6 extends zt{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class m6 extends zt{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let y6=class extends zt{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${bo(fy(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const w6=/^0x[a-fA-F0-9]{40}$/;function mI(t,e={}){const{strict:n=!0}=e;if(!w6.test(t))throw new fb({address:t,cause:new v6});if(n){if(t.toLowerCase()===t)return;if(yI(t)!==t)throw new fb({address:t,cause:new _6})}}function yI(t){if(Ip.has(t))return Ip.get(t);mI(t,{strict:!1});const e=t.substring(2).toLowerCase(),n=fI(s6(e),{as:"Bytes"}),r=e.split("");for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&r[i]&&(r[i]=r[i].toUpperCase()),(n[i>>1]&15)>=8&&r[i+1]&&(r[i+1]=r[i+1].toUpperCase());const s=`0x${r.join("")}`;return Ip.set(t,s),s}function E6(t,e={}){const{checksum:n=!1}=e;return mI(t),n?yI(t):t}function b6(t,e={}){const n=fI(`0x${f6(t).slice(4)}`).substring(26);return E6(`0x${n}`,e)}class fb extends zt{constructor({address:e,cause:n}){super(`Address "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class v6 extends zt{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class _6 extends zt{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}function C6(t){if(t.length!==130&&t.length!==132)throw new I6({signature:t});const e=BigInt(ii(t,0,32)),n=BigInt(ii(t,32,64)),r=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return A6(s)}catch{throw new S6({value:s})}})();return typeof r>"u"?{r:e,s:n}:{r:e,s:n,yParity:r}}function A6(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new T6({value:t})}class I6 extends zt{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${bo(fy(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class S6 extends zt{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class T6 extends zt{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}function N6(t){return b6(O6(t))}function O6(t){const{payload:e,signature:n}=t,{r,s,yParity:i}=n,a=new rN.Signature(BigInt(r),BigInt(s)).addRecoveryBit(i).recoverPublicKey(fy(e).substring(2));return d6(a)}var wI={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var m=n?n+l:l;if(!this._events[m])return!1;var g=this._events[m],T=arguments.length,N,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),T){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,h),!0;case 5:return g.fn.call(g.context,u,d,h,f),!0;case 6:return g.fn.call(g.context,u,d,h,f,p),!0}for(_=1,N=new Array(T-1);_<T;_++)N[_-1]=arguments[_];g.fn.apply(g.context,N)}else{var O=g.length,A;for(_=0;_<O;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),T){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,d);break;case 4:g[_].fn.call(g[_].context,u,d,h);break;default:if(!N)for(A=1,N=new Array(T-1);A<T;A++)N[A-1]=arguments[A];g[_].fn.apply(g[_].context,N)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=n?n+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var m=0,g=[],T=p.length;m<T;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(wI);var R6=wI.exports;const LX=_o(R6);function P6(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function x6(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const k6=new TextEncoder,D6=50;function U6(t,e,n){k6.encodeInto(t,e.subarray(n))}function M6(t,e,n){t.length>D6?U6(t,e,n):x6(t,e,n)}const L6=4096;function EI(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=L6&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const $6=new TextDecoder,B6=200;function F6(t,e,n){const r=t.subarray(e,e+n);return $6.decode(r)}function j6(t,e,n){return n>B6?F6(t,e,n):EI(t,e,n)}class od{constructor(e,n){this.type=e,this.data=n}}class Nr extends Error{constructor(e){super(e);const n=Object.create(Nr.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Nr.name})}}const Yc=4294967295;function W6(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function bI(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function vI(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function H6(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const z6=-1,q6=4294967296-1,V6=17179869184-1;function K6({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=V6)if(e===0&&t<=q6){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),bI(r,4,t),n}}function G6(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function Y6(t){if(t instanceof Date){const e=G6(t);return K6(e)}else return null}function J6(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=vI(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Nr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function Z6(t){const e=J6(t);return new Date(e.sec*1e3+e.nsec/1e6)}const X6={type:z6,encode:Y6,decode:Z6};class _h{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(X6)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new od(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new od(o,i)}}}return e instanceof od?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new od(n,e)}}_h.defaultCodec=new _h;function Q6(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Gg(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Q6(t)?new Uint8Array(t):Uint8Array.from(t)}const eB=100,tB=2048;let nB=class _I{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??_h.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??eB,this.initialBufferSize=e?.initialBufferSize??tB,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new _I({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=P6(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),M6(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=Gg(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),W6(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),bI(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function rB(t,e){return new nB(e).encodeSharedRef(t)}function Sp(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const sB=16,iB=16;class oB{constructor(e=sB,n=iB){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=EI(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const Yg="array",vl="map_key",CI="map_value",aB=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Nr("The type of key must be string or number but "+typeof t)};class cB{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Yg,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=vl,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Yg){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===vl||e.type===CI){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Jc=-1,py=new DataView(new ArrayBuffer(0)),lB=new Uint8Array(py.buffer);try{py.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const pb=new RangeError("Insufficient data"),uB=new oB;let dB=class AI{constructor(e){this.totalPos=0,this.pos=0,this.view=py,this.bytes=lB,this.headByte=Jc,this.stack=new cB,this.entered=!1,this.extensionCodec=e?.extensionCodec??_h.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??Yc,this.maxBinLength=e?.maxBinLength??Yc,this.maxArrayLength=e?.maxArrayLength??Yc,this.maxMapLength=e?.maxMapLength??Yc,this.maxExtLength=e?.maxExtLength??Yc,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:uB,this.mapKeyConverter=e?.mapKeyConverter??aB}clone(){return new AI({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Jc,this.stack.reset()}setBuffer(e){const n=Gg(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===Jc&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=Gg(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Sp(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Nr(`Unrecognized type byte: ${Sp(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===Yg)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===vl){if(n==="__proto__")throw new Nr("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=CI;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=vl;continue e}}return n}}readHeadByte(){return this.headByte===Jc&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Jc}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Nr(`Unrecognized array type byte: ${Sp(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Nr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Nr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new Nr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw pb;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,r,e):s=j6(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===vl:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Nr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw pb;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new Nr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=H6(this.view,this.pos);return this.pos+=8,e}readI64(){const e=vI(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function hB(t,e){return new dB(e).decode(t)}function gy(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function II(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gy(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function _l(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=II(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return gy(n)}function fB(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,g=0,T=0,N=p.length;T!==N&&p[T]===0;)T++,m++;for(var _=(N-T)*u+1>>>0,O=new Uint8Array(_);T!==N;){for(var A=p[T],x=0,k=_-1;(A!==0||x<g)&&k!==-1;k--,x++)A+=256*O[k]>>>0,O[k]=A%a>>>0,A=A/a>>>0;if(A!==0)throw new Error("Non-zero carry");g=x,T++}for(var L=_-g;L!==_&&O[L]===0;)L++;for(var M=c.repeat(m);L<_;++L)M+=t.charAt(O[L]);return M}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var g=0,T=0;p[m]===c;)g++,m++;for(var N=(p.length-m)*l+1>>>0,_=new Uint8Array(N);p[m];){var O=n[p.charCodeAt(m)];if(O===255)return;for(var A=0,x=N-1;(O!==0||A<T)&&x!==-1;x--,A++)O+=a*_[x]>>>0,_[x]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");T=A,m++}if(p[m]!==" "){for(var k=N-T;k!==N&&_[k]===0;)k++;for(var L=new Uint8Array(g+(N-k)),M=g;k!==N;)L[M++]=_[k++];return L}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var pB=fB,gB=pB;const mB=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},yB=t=>new TextEncoder().encode(t),wB=t=>new TextDecoder().decode(t);class EB{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bB{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return SI(this,e)}}class vB{constructor(e){this.decoders=e}or(e){return SI(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const SI=(t,e)=>new vB({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class _B{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new EB(e,n,r),this.decoder=new bB(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const rf=({name:t,prefix:e,encode:n,decode:r})=>new _B(t,e,n,r),_u=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=gB(n,e);return rf({prefix:t,name:e,encode:r,decode:i=>mB(s(i))})},CB=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},AB=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Mn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>rf({prefix:e,name:t,encode(s){return AB(s,r,n)},decode(s){return CB(s,r,n,t)}}),IB=rf({prefix:"\0",name:"identity",encode:t=>wB(t),decode:t=>yB(t)}),SB=Object.freeze(Object.defineProperty({__proto__:null,identity:IB},Symbol.toStringTag,{value:"Module"})),TB=Mn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),NB=Object.freeze(Object.defineProperty({__proto__:null,base2:TB},Symbol.toStringTag,{value:"Module"})),OB=Mn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),RB=Object.freeze(Object.defineProperty({__proto__:null,base8:OB},Symbol.toStringTag,{value:"Module"})),PB=_u({prefix:"9",name:"base10",alphabet:"0123456789"}),xB=Object.freeze(Object.defineProperty({__proto__:null,base10:PB},Symbol.toStringTag,{value:"Module"})),kB=Mn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),DB=Mn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),UB=Object.freeze(Object.defineProperty({__proto__:null,base16:kB,base16upper:DB},Symbol.toStringTag,{value:"Module"})),MB=Mn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),LB=Mn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$B=Mn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),BB=Mn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),FB=Mn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jB=Mn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),WB=Mn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),HB=Mn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zB=Mn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qB=Object.freeze(Object.defineProperty({__proto__:null,base32:MB,base32hex:FB,base32hexpad:WB,base32hexpadupper:HB,base32hexupper:jB,base32pad:$B,base32padupper:BB,base32upper:LB,base32z:zB},Symbol.toStringTag,{value:"Module"})),VB=_u({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KB=_u({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),GB=Object.freeze(Object.defineProperty({__proto__:null,base36:VB,base36upper:KB},Symbol.toStringTag,{value:"Module"})),YB=_u({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),JB=_u({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ZB=Object.freeze(Object.defineProperty({__proto__:null,base58btc:YB,base58flickr:JB},Symbol.toStringTag,{value:"Module"})),XB=Mn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),QB=Mn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),eF=Mn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tF=Mn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),nF=Object.freeze(Object.defineProperty({__proto__:null,base64:XB,base64pad:QB,base64url:eF,base64urlpad:tF},Symbol.toStringTag,{value:"Module"})),TI=Array.from(""),rF=TI.reduce((t,e,n)=>(t[n]=e,t),[]),sF=TI.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function iF(t){return t.reduce((e,n)=>(e+=rF[n],e),"")}function oF(t){const e=[];for(const n of t){const r=sF[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const aF=rf({prefix:"",name:"base256emoji",encode:iF,decode:oF}),cF=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:aF},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const gb={...SB,...NB,...RB,...xB,...UB,...qB,...GB,...ZB,...nF,...cF};function NI(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const mb=NI("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Tp=NI("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=II(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),OI={utf8:mb,"utf-8":mb,hex:gb.base16,latin1:Tp,ascii:Tp,binary:Tp,...gb};function Kr(t,e="utf8"){const n=OI[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gy(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Er(t,e="utf8"){const n=OI[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const lF={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},uF="Input must be an string, Buffer or Uint8Array";function dF(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(uF);return e}function hF(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function ad(t){return(4294967296+t).toString(16).substring(1)}function fF(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=ad(e[s]).toUpperCase(),r+=" ",r+=ad(e[s+1]).toUpperCase();else if(n===64)r+=ad(e[s+1]).toUpperCase(),r+=ad(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}}function pF(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;r=new Date().getTime();for(let o=0;o<n;o++){const a=t(s),c=new Date().getTime(),l=c-r;r=c}}var RI={normalizeInput:dF,toHex:hF,debugPrint:fF,testSpeed:pF};const jd=RI;function cd(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function yb(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function PI(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Mi(t,e,n,r,s,i){const o=ml[s],a=ml[s+1],c=ml[i],l=ml[i+1];cd(Qe,t,e),yb(Qe,t,o,a);let u=Qe[r]^Qe[t],d=Qe[r+1]^Qe[t+1];Qe[r]=d,Qe[r+1]=u,cd(Qe,n,r),u=Qe[e]^Qe[n],d=Qe[e+1]^Qe[n+1],Qe[e]=u>>>24^d<<8,Qe[e+1]=d>>>24^u<<8,cd(Qe,t,e),yb(Qe,t,c,l),u=Qe[r]^Qe[t],d=Qe[r+1]^Qe[t+1],Qe[r]=u>>>16^d<<16,Qe[r+1]=d>>>16^u<<16,cd(Qe,n,r),u=Qe[e]^Qe[n],d=Qe[e+1]^Qe[n+1],Qe[e]=d>>>31^u<<1,Qe[e+1]=u>>>31^d<<1}const xI=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),gF=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Fn=new Uint8Array(gF.map(function(t){return t*2})),Qe=new Uint32Array(32),ml=new Uint32Array(32);function kI(t,e){let n=0;for(n=0;n<16;n++)Qe[n]=t.h[n],Qe[n+16]=xI[n];for(Qe[24]=Qe[24]^t.t,Qe[25]=Qe[25]^t.t/4294967296,e&&(Qe[28]=~Qe[28],Qe[29]=~Qe[29]),n=0;n<32;n++)ml[n]=PI(t.b,4*n);for(n=0;n<12;n++)Mi(0,8,16,24,Fn[n*16+0],Fn[n*16+1]),Mi(2,10,18,26,Fn[n*16+2],Fn[n*16+3]),Mi(4,12,20,28,Fn[n*16+4],Fn[n*16+5]),Mi(6,14,22,30,Fn[n*16+6],Fn[n*16+7]),Mi(0,10,20,30,Fn[n*16+8],Fn[n*16+9]),Mi(2,12,22,24,Fn[n*16+10],Fn[n*16+11]),Mi(4,14,16,26,Fn[n*16+12],Fn[n*16+13]),Mi(6,8,18,28,Fn[n*16+14],Fn[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^Qe[n]^Qe[n+16]}const Li=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function DI(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Li.fill(0),Li[0]=t,e&&(Li[1]=e.length),Li[2]=1,Li[3]=1,n&&Li.set(n,32),r&&Li.set(r,48);for(let i=0;i<16;i++)s.h[i]=xI[i]^PI(Li,i*4);return e&&(my(s,e),s.c=128),s}function my(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,kI(t,!1),t.c=0),t.b[t.c++]=e[n]}function UI(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;kI(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function MI(t,e,n,r,s){n=n||64,t=jd.normalizeInput(t),r&&(r=jd.normalizeInput(r)),s&&(s=jd.normalizeInput(s));const i=DI(n,e,r,s);return my(i,t),UI(i)}function mF(t,e,n,r,s){const i=MI(t,e,n,r,s);return jd.toHex(i)}var yF={blake2b:MI,blake2bHex:mF,blake2bInit:DI,blake2bUpdate:my,blake2bFinal:UI};const LI=RI;function wF(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function $i(t,e,n,r,s,i){bt[t]=bt[t]+bt[e]+s,bt[r]=ld(bt[r]^bt[t],16),bt[n]=bt[n]+bt[r],bt[e]=ld(bt[e]^bt[n],12),bt[t]=bt[t]+bt[e]+i,bt[r]=ld(bt[r]^bt[t],8),bt[n]=bt[n]+bt[r],bt[e]=ld(bt[e]^bt[n],7)}function ld(t,e){return t>>>e^t<<32-e}const $I=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),jn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),bt=new Uint32Array(16),Nn=new Uint32Array(16);function BI(t,e){let n=0;for(n=0;n<8;n++)bt[n]=t.h[n],bt[n+8]=$I[n];for(bt[12]^=t.t,bt[13]^=t.t/4294967296,e&&(bt[14]=~bt[14]),n=0;n<16;n++)Nn[n]=wF(t.b,4*n);for(n=0;n<10;n++)$i(0,4,8,12,Nn[jn[n*16+0]],Nn[jn[n*16+1]]),$i(1,5,9,13,Nn[jn[n*16+2]],Nn[jn[n*16+3]]),$i(2,6,10,14,Nn[jn[n*16+4]],Nn[jn[n*16+5]]),$i(3,7,11,15,Nn[jn[n*16+6]],Nn[jn[n*16+7]]),$i(0,5,10,15,Nn[jn[n*16+8]],Nn[jn[n*16+9]]),$i(1,6,11,12,Nn[jn[n*16+10]],Nn[jn[n*16+11]]),$i(2,7,8,13,Nn[jn[n*16+12]],Nn[jn[n*16+13]]),$i(3,4,9,14,Nn[jn[n*16+14]],Nn[jn[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=bt[n]^bt[n+8]}function FI(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array($I),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(yy(r,e),r.c=64),r}function yy(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,BI(t,!1),t.c=0),t.b[t.c++]=e[n]}function jI(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;BI(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function WI(t,e,n){n=n||32,t=LI.normalizeInput(t);const r=FI(n,e);return yy(r,t),jI(r)}function EF(t,e,n){const r=WI(t,e,n);return LI.toHex(r)}var bF={blake2s:WI,blake2sHex:EF,blake2sInit:FI,blake2sUpdate:yy,blake2sFinal:jI};const Zc=yF,Xc=bF;var vF={blake2b:Zc.blake2b,blake2bHex:Zc.blake2bHex,blake2bInit:Zc.blake2bInit,blake2bUpdate:Zc.blake2bUpdate,blake2bFinal:Zc.blake2bFinal,blake2s:Xc.blake2s,blake2sHex:Xc.blake2sHex,blake2sInit:Xc.blake2sInit,blake2sUpdate:Xc.blake2sUpdate,blake2sFinal:Xc.blake2sFinal},_F={};const CF=":";function fi(t){const[e,n]=t.split(CF);return{namespace:e,reference:n}}function HI(t,e){return t.includes(":")?[t]:e.chains||[]}var AF=Object.defineProperty,IF=Object.defineProperties,SF=Object.getOwnPropertyDescriptors,wb=Object.getOwnPropertySymbols,TF=Object.prototype.hasOwnProperty,NF=Object.prototype.propertyIsEnumerable,Jg=(t,e,n)=>e in t?AF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Eb=(t,e)=>{for(var n in e||(e={}))TF.call(e,n)&&Jg(t,n,e[n]);if(wb)for(var n of wb(e))NF.call(e,n)&&Jg(t,n,e[n]);return t},OF=(t,e)=>IF(t,SF(e)),bb=(t,e,n)=>Jg(t,typeof e!="symbol"?e+"":e,n);const RF="ReactNative",Ur={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},PF="js";function Ch(){return typeof Ft<"u"&&typeof Ft.versions<"u"&&typeof Ft.versions.node<"u"}function Io(){return!pa()&&!!uy()&&navigator.product===RF}function xF(){return Io()&&typeof $e<"u"&&typeof($e==null?void 0:$e.Platform)<"u"&&($e==null?void 0:$e.Platform.OS)==="android"}function kF(){return Io()&&typeof $e<"u"&&typeof($e==null?void 0:$e.Platform)<"u"&&($e==null?void 0:$e.Platform.OS)==="ios"}function Dc(){return!Ch()&&!!uy()&&!!pa()}function Cu(){return Io()?Ur.reactNative:Ch()?Ur.node:Dc()?Ur.browser:Ur.unknown}function vb(){var t;try{return Io()&&typeof $e<"u"&&typeof($e==null?void 0:$e.Application)<"u"?(t=$e.Application)==null?void 0:t.applicationId:void 0}catch{return}}function DF(t,e){const n=new URLSearchParams(t);return Object.entries(e).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!=null&&n.set(r,String(s))}),n.toString()}function UF(t){var e,n;const r=zI();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(t.url=r.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),OF(Eb(Eb({},r),t),{url:t?.url||r.url,name:t?.name||r.name,description:t?.description||r.description,icons:(n=t?.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch{return t||r}}function zI(){return aI()||{name:"",description:"",url:"",icons:[""]}}function MF(){if(Cu()===Ur.reactNative&&typeof $e<"u"&&typeof($e==null?void 0:$e.Platform)<"u"){const{OS:n,Version:r}=$e.Platform;return[n,r].join("-")}const t=v4();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function LF(){var t;const e=Cu();return e===Ur.browser?[e,((t=oI())==null?void 0:t.host)||"unknown"].join(":"):e}function qI(t,e,n){const r=MF(),s=LF();return[[t,e].join("-"),[PF,n].join("-"),r,s].join("/")}function $F({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=qI(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=DF(l[1]||"",d);return l[0]+"?"+h}function Jo(t,e){return t.filter(n=>e.includes(n)).length===t.length}function Zg(t){return Object.fromEntries(t.entries())}function Xg(t){return new Map(Object.entries(t))}function zo(t=ge.FIVE_MINUTES,e){const n=ge.toMiliseconds(t||ge.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function Ds(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function VI(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function BF(t){return VI("topic",t)}function FF(t){return VI("id",t)}function KI(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function sn(t,e){return ge.fromMiliseconds(Date.now()+ge.toMiliseconds(t))}function Ps(t){return Date.now()>=ge.toMiliseconds(t)}function Tt(t,e){return`${t}${e?`:${e}`:""}`}function Ls(t=[],e=[]){return[...new Set([...t,...e])]}async function jF({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=WF(i,t,e),a=Cu();if(a===Ur.browser){if(!((r=pa())!=null&&r.hasFocus()))return;HF(o)}else a===Ur.reactNative&&typeof($e==null?void 0:$e.Linking)<"u"&&await $e.Linking.openURL(o)}catch{}}function WF(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${KF(r,!0)}`}else s=`${s}/wc?${r}`;return s}function HF(t){let e="_self";VF()?e="_top":(qF()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function zF(t,e){let n="";try{if(Dc()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch{}return n}function _b(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function Cb(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function wy(){return typeof Ft<"u"&&_F.IS_VITEST==="true"}function qF(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function VF(){try{return window.self!==window.top}catch{return!1}}function KF(t,e=!1){const n=lt.Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function GI(t){return lt.Buffer.from(t,"base64").toString("utf-8")}function GF(t){return new Promise(e=>setTimeout(e,t))}let YF=class{constructor({limit:e}){bb(this,"limit"),bb(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const ud=BigInt(2**32-1),Ab=BigInt(32);function YI(t,e=!1){return e?{h:Number(t&ud),l:Number(t>>Ab&ud)}:{h:Number(t>>Ab&ud)|0,l:Number(t&ud)|0}}function JI(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=YI(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Ib=(t,e,n)=>t>>>n,Sb=(t,e,n)=>t<<32-n|e>>>n,Gi=(t,e,n)=>t>>>n|e<<32-n,Yi=(t,e,n)=>t<<32-n|e>>>n,yl=(t,e,n)=>t<<64-n|e>>>n-32,wl=(t,e,n)=>t>>>n-32|e<<64-n,JF=(t,e)=>e,ZF=(t,e)=>t,XF=(t,e,n)=>t<<n|e>>>32-n,QF=(t,e,n)=>e<<n|t>>>32-n,ej=(t,e,n)=>e<<n-32|t>>>64-n,tj=(t,e,n)=>t<<n-32|e>>>64-n;function is(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Ey=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),by=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,nj=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),rj=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,sj=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),ij=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Fa=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function sf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ei(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ys(t,...e){if(!sf(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function of(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ei(t.outputLen),Ei(t.blockLen)}function vo(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function vy(t,e){ys(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function nu(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Yr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Np(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function As(t,e){return t<<32-e|t>>>e}const ZI=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function XI(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const ti=ZI?t=>t:t=>XI(t);function oj(t){for(let e=0;e<t.length;e++)t[e]=XI(t[e]);return t}const Ji=ZI?t=>t:oj,QI=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",aj=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ac(t){if(ys(t),QI)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=aj[t[n]];return e}const Ys={_0:48,_9:57,A:65,F:70,a:97,f:102};function Tb(t){if(t>=Ys._0&&t<=Ys._9)return t-Ys._0;if(t>=Ys.A&&t<=Ys.F)return t-(Ys.A-10);if(t>=Ys.a&&t<=Ys.f)return t-(Ys.a-10)}function Ah(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(QI)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Tb(t.charCodeAt(i)),a=Tb(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function eS(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function gs(t){return typeof t=="string"&&(t=eS(t)),ys(t),t}function eo(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];ys(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let af=class{};function Au(t){const e=r=>t().update(gs(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function cj(t){const e=(r,s)=>t(s).update(gs(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Na(t=32){if(Fa&&typeof Fa.getRandomValues=="function")return Fa.getRandomValues(new Uint8Array(t));if(Fa&&typeof Fa.randomBytes=="function")return Uint8Array.from(Fa.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const lj=BigInt(0),Qc=BigInt(1),uj=BigInt(2),dj=BigInt(7),hj=BigInt(256),fj=BigInt(113),tS=[],nS=[],rS=[];for(let t=0,e=Qc,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],tS.push(2*(5*r+n)),nS.push((t+1)*(t+2)/2%64);let s=lj;for(let i=0;i<7;i++)e=(e<<Qc^(e>>dj)*fj)%hj,e&uj&&(s^=Qc<<(Qc<<BigInt(i))-Qc);rS.push(s)}const sS=JI(rS,!0),pj=sS[0],gj=sS[1],Nb=(t,e,n)=>n>32?ej(t,e,n):XF(t,e,n),Ob=(t,e,n)=>n>32?tj(t,e,n):QF(t,e,n);function mj(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Nb(l,u,1)^n[a],h=Ob(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=nS[o],c=Nb(s,i,a),l=Ob(s,i,a),u=tS[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=pj[r],t[1]^=gj[r]}Yr(n)}let yj=class iS extends af{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Ei(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=nu(this.state)}clone(){return this._cloneInto()}keccak(){Ji(this.state32),mj(this.state32,this.rounds),Ji(this.state32),this.posOut=0,this.pos=0}update(e){vo(this),e=gs(e),ys(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){vo(this,!1),ys(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ei(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(vy(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Yr(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new iS(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const wj=(t,e,n)=>Au(()=>new yj(e,t,n)),Ej=wj(1,136,256/8);function bj(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function vj(t,e,n){return t&e^~t&n}function _j(t,e,n){return t&e^t&n^e&n}let oS=class extends af{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Np(this.buffer)}update(e){vo(this),e=gs(e),ys(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Np(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){vo(this),vy(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Yr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;bj(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Np(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Bi=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wn=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Hn=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Cj=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Fi=new Uint32Array(64);class Aj extends oS{constructor(e=32){super(64,e,8,!1),this.A=Bi[0]|0,this.B=Bi[1]|0,this.C=Bi[2]|0,this.D=Bi[3]|0,this.E=Bi[4]|0,this.F=Bi[5]|0,this.G=Bi[6]|0,this.H=Bi[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Fi[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Fi[d-15],f=Fi[d-2],p=As(h,7)^As(h,18)^h>>>3,m=As(f,17)^As(f,19)^f>>>10;Fi[d]=m+Fi[d-7]+p+Fi[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=As(a,6)^As(a,11)^As(a,25),f=u+h+vj(a,c,l)+Cj[d]+Fi[d]|0,p=(As(r,2)^As(r,13)^As(r,22))+_j(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Yr(Fi)}destroy(){this.set(0,0,0,0,0,0,0,0),Yr(this.buffer)}}const aS=JI(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ij=aS[0],Sj=aS[1],ji=new Uint32Array(80),Wi=new Uint32Array(80);let _y=class extends oS{constructor(e=64){super(128,e,16,!1),this.Ah=Hn[0]|0,this.Al=Hn[1]|0,this.Bh=Hn[2]|0,this.Bl=Hn[3]|0,this.Ch=Hn[4]|0,this.Cl=Hn[5]|0,this.Dh=Hn[6]|0,this.Dl=Hn[7]|0,this.Eh=Hn[8]|0,this.El=Hn[9]|0,this.Fh=Hn[10]|0,this.Fl=Hn[11]|0,this.Gh=Hn[12]|0,this.Gl=Hn[13]|0,this.Hh=Hn[14]|0,this.Hl=Hn[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:m,Hl:g}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=g|0}process(e,n){for(let _=0;_<16;_++,n+=4)ji[_]=e.getUint32(n),Wi[_]=e.getUint32(n+=4);for(let _=16;_<80;_++){const O=ji[_-15]|0,A=Wi[_-15]|0,x=Gi(O,A,1)^Gi(O,A,8)^Ib(O,A,7),k=Yi(O,A,1)^Yi(O,A,8)^Sb(O,A,7),L=ji[_-2]|0,M=Wi[_-2]|0,z=Gi(L,M,19)^yl(L,M,61)^Ib(L,M,6),J=Yi(L,M,19)^wl(L,M,61)^Sb(L,M,6),H=nj(k,J,Wi[_-7],Wi[_-16]),F=rj(H,x,z,ji[_-7],ji[_-16]);ji[_]=F|0,Wi[_]=H|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:m,Gl:g,Hh:T,Hl:N}=this;for(let _=0;_<80;_++){const O=Gi(d,h,14)^Gi(d,h,18)^yl(d,h,41),A=Yi(d,h,14)^Yi(d,h,18)^wl(d,h,41),x=d&f^~d&m,k=h&p^~h&g,L=sj(N,A,k,Sj[_],Wi[_]),M=ij(L,T,O,x,Ij[_],ji[_]),z=L|0,J=Gi(r,s,28)^yl(r,s,34)^yl(r,s,39),H=Yi(r,s,28)^wl(r,s,34)^wl(r,s,39),F=r&i^r&a^i&a,P=s&o^s&c^o&c;T=m|0,N=g|0,m=f|0,g=p|0,f=d|0,p=h|0,{h:d,l:h}=is(l|0,u|0,M|0,z|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const w=Ey(z,H,P);r=by(w,M,J,F),s=w|0}({h:r,l:s}=is(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=is(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=is(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=is(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=is(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=is(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:g}=is(this.Gh|0,this.Gl|0,m|0,g|0),{h:T,l:N}=is(this.Hh|0,this.Hl|0,T|0,N|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,m,g,T,N)}roundClean(){Yr(ji,Wi)}destroy(){Yr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class Tj extends _y{constructor(){super(48),this.Ah=Wn[0]|0,this.Al=Wn[1]|0,this.Bh=Wn[2]|0,this.Bl=Wn[3]|0,this.Ch=Wn[4]|0,this.Cl=Wn[5]|0,this.Dh=Wn[6]|0,this.Dl=Wn[7]|0,this.Eh=Wn[8]|0,this.El=Wn[9]|0,this.Fh=Wn[10]|0,this.Fl=Wn[11]|0,this.Gh=Wn[12]|0,this.Gl=Wn[13]|0,this.Hh=Wn[14]|0,this.Hl=Wn[15]|0}}const zn=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class Nj extends _y{constructor(){super(32),this.Ah=zn[0]|0,this.Al=zn[1]|0,this.Bh=zn[2]|0,this.Bl=zn[3]|0,this.Ch=zn[4]|0,this.Cl=zn[5]|0,this.Dh=zn[6]|0,this.Dl=zn[7]|0,this.Eh=zn[8]|0,this.El=zn[9]|0,this.Fh=zn[10]|0,this.Fl=zn[11]|0,this.Gh=zn[12]|0,this.Gl=zn[13]|0,this.Hh=zn[14]|0,this.Hl=zn[15]|0}}const cf=Au(()=>new Aj),Oj=Au(()=>new _y),Rj=Au(()=>new Tj),Pj=Au(()=>new Nj),xj=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),un=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Ee=new Uint32Array(32);function Hi(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Ee[2*t],l=Ee[2*t+1],u=Ee[2*e],d=Ee[2*e+1],h=Ee[2*n],f=Ee[2*n+1],p=Ee[2*r],m=Ee[2*r+1],g=Ey(c,u,o);l=by(g,l,d,a),c=g|0,{Dh:m,Dl:p}={Dh:m^l,Dl:p^c},{Dh:m,Dl:p}={Dh:JF(m,p),Dl:ZF(m)},{h:f,l:h}=is(f,h,m,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Gi(d,u,24),Bl:Yi(d,u,24)},Ee[2*t]=c,Ee[2*t+1]=l,Ee[2*e]=u,Ee[2*e+1]=d,Ee[2*n]=h,Ee[2*n+1]=f,Ee[2*r]=p,Ee[2*r+1]=m}function zi(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Ee[2*t],l=Ee[2*t+1],u=Ee[2*e],d=Ee[2*e+1],h=Ee[2*n],f=Ee[2*n+1],p=Ee[2*r],m=Ee[2*r+1],g=Ey(c,u,o);l=by(g,l,d,a),c=g|0,{Dh:m,Dl:p}={Dh:m^l,Dl:p^c},{Dh:m,Dl:p}={Dh:Gi(m,p,16),Dl:Yi(m,p,16)},{h:f,l:h}=is(f,h,m,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:yl(d,u,63),Bl:wl(d,u,63)},Ee[2*t]=c,Ee[2*t+1]=l,Ee[2*e]=u,Ee[2*e+1]=d,Ee[2*n]=h,Ee[2*n+1]=f,Ee[2*r]=p,Ee[2*r+1]=m}function kj(t,e={},n,r,s){if(Ei(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class Dj extends af{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Ei(e),Ei(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=nu(this.buffer)}update(e){vo(this),e=gs(e),ys(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(Ji(s),this.compress(s,0,!1),Ji(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Ji(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Ji(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){vo(this),vy(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Yr(this.buffer.subarray(n)),Ji(r),this.compress(r,0,!0),Ji(r);const s=nu(e);this.get().forEach((i,o)=>s[o]=ti(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class Uj extends Dj{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=un[0]|0,this.v0h=un[1]|0,this.v1l=un[2]|0,this.v1h=un[3]|0,this.v2l=un[4]|0,this.v2h=un[5]|0,this.v3l=un[6]|0,this.v3h=un[7]|0,this.v4l=un[8]|0,this.v4h=un[9]|0,this.v5l=un[10]|0,this.v5h=un[11]|0,this.v6l=un[12]|0,this.v6h=un[13]|0,this.v7l=un[14]|0,this.v7h=un[15]|0,kj(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=gs(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=gs(i);const a=nu(i);this.v4l^=ti(a[0]),this.v4h^=ti(a[1]),this.v5l^=ti(a[2]),this.v5h^=ti(a[3])}if(s!==void 0){s=gs(s);const a=nu(s);this.v6l^=ti(a[0]),this.v6h^=ti(a[1]),this.v7l^=ti(a[2]),this.v7h^=ti(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:m,v7h:g}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,m,g){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=m|0,this.v7h=g|0}compress(e,n,r){this.get().forEach((c,l)=>Ee[l]=c),Ee.set(un,16);let{h:s,l:i}=YI(BigInt(this.length));Ee[24]=un[8]^i,Ee[25]=un[9]^s,r&&(Ee[28]=~Ee[28],Ee[29]=~Ee[29]);let o=0;const a=xj;for(let c=0;c<12;c++)Hi(0,4,8,12,e,n+2*a[o++]),zi(0,4,8,12,e,n+2*a[o++]),Hi(1,5,9,13,e,n+2*a[o++]),zi(1,5,9,13,e,n+2*a[o++]),Hi(2,6,10,14,e,n+2*a[o++]),zi(2,6,10,14,e,n+2*a[o++]),Hi(3,7,11,15,e,n+2*a[o++]),zi(3,7,11,15,e,n+2*a[o++]),Hi(0,5,10,15,e,n+2*a[o++]),zi(0,5,10,15,e,n+2*a[o++]),Hi(1,6,11,12,e,n+2*a[o++]),zi(1,6,11,12,e,n+2*a[o++]),Hi(2,7,8,13,e,n+2*a[o++]),zi(2,7,8,13,e,n+2*a[o++]),Hi(3,4,9,14,e,n+2*a[o++]),zi(3,4,9,14,e,n+2*a[o++]);this.v0l^=Ee[0]^Ee[16],this.v0h^=Ee[1]^Ee[17],this.v1l^=Ee[2]^Ee[18],this.v1h^=Ee[3]^Ee[19],this.v2l^=Ee[4]^Ee[20],this.v2h^=Ee[5]^Ee[21],this.v3l^=Ee[6]^Ee[22],this.v3h^=Ee[7]^Ee[23],this.v4l^=Ee[8]^Ee[24],this.v4h^=Ee[9]^Ee[25],this.v5l^=Ee[10]^Ee[26],this.v5h^=Ee[11]^Ee[27],this.v6l^=Ee[12]^Ee[28],this.v6h^=Ee[13]^Ee[29],this.v7l^=Ee[14]^Ee[30],this.v7h^=Ee[15]^Ee[31],Yr(Ee)}destroy(){this.destroyed=!0,Yr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Mj=cj(t=>new Uj(t)),Lj="https://rpc.walletconnect.org/v1";function cS(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+lt.Buffer.from(Ej(n)).toString("hex")}async function $j(t,e,n,r,s,i){switch(n.t){case"eip191":return await Bj(t,e,n.s);case"eip1271":return await Fj(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}function Bj(t,e,n){const r=C6(n);return N6({payload:cS(e),signature:r}).toLowerCase()===t.toLowerCase()}async function Fj(t,e,n,r,s,i){const o=fi(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:cS(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${i||Lj}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:jj(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch{return!1}}function jj(){return Date.now()+Math.floor(Math.random()*1e3)}function Wj(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=lt.Buffer.from(t,"base64").slice(1,65);return Nc.encode(i)}function Hj(t){const e=new Uint8Array(lt.Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=Mj(r,{dkLen:32});return Nc.encode(s)}function Rb(t){const e=new Uint8Array(cf(zj(t)));return Nc.encode(e)}function zj(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Pb(t){const e=lt.Buffer.from(t,"base64"),n=hB(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=rB(n),s=lt.Buffer.from("TX"),i=lt.Buffer.concat([s,lt.Buffer.from(r)]),o=Pj(i);return sN.encode(o).replace(/=+$/,"")}function Op(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),lt.Buffer.from(e)}function qj(t){const e=lt.Buffer.from(t.signed.bodyBytes,"base64"),n=lt.Buffer.from(t.signed.authInfoBytes,"base64"),r=lt.Buffer.from(t.signature.signature,"base64"),s=[];s.push(lt.Buffer.from([10])),s.push(Op(e.length)),s.push(e),s.push(lt.Buffer.from([18])),s.push(Op(n.length)),s.push(n),s.push(lt.Buffer.from([26])),s.push(Op(r.length)),s.push(r);const i=lt.Buffer.concat(s),o=cf(i);return lt.Buffer.from(o).toString("hex").toUpperCase()}function Vj(t){var e,n;const r=[];try{if(typeof t=="string")return r.push(t),r;if(typeof t!="object")return r;t!=null&&t.id&&r.push(t.id);const s=(n=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:n.transactionHashes;s&&r.push(...s)}catch{}return r}var Kj=Object.defineProperty,Gj=Object.defineProperties,Yj=Object.getOwnPropertyDescriptors,xb=Object.getOwnPropertySymbols,Jj=Object.prototype.hasOwnProperty,Zj=Object.prototype.propertyIsEnumerable,kb=(t,e,n)=>e in t?Kj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xj=(t,e)=>{for(var n in e||(e={}))Jj.call(e,n)&&kb(t,n,e[n]);if(xb)for(var n of xb(e))Zj.call(e,n)&&kb(t,n,e[n]);return t},Qj=(t,e)=>Gj(t,Yj(e));const lS="did:pkh:",e9={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},t9=t=>t?e9[t]||t:"",lf=t=>t?.split(":"),n9=t=>{const e=t&&lf(t);if(e)return t.includes(lS)?e[3]:e[1]},r9=t=>{const e=t&&lf(t);if(e)return t.includes(lS)?e[2]:e[0]},Qg=t=>{const e=t&&lf(t);if(e)return e[2]+":"+e[3]},Ih=t=>{const e=t&&lf(t);if(e)return e.pop()};async function Db(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=uS(s,s.iss),o=Ih(s.iss);return await $j(o,i,r,Qg(s.iss),n)}const uS=(t,e)=>{const n=r9(e);if(!n)throw new Error("Invalid issuer: "+e);const r=`${t.domain} wants you to sign in with your ${t9(n)} account:`,s=Ih(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${n9(e)}`,l=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,d=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,f=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,m=Wd(t.resources);if(m){const g=ru(m);i=h9(i,g)}return[r,s,"",i,"",o,a,c,l,u,d,h,f,p].filter(g=>g!=null).join(`
`)};function s9(t){return lt.Buffer.from(JSON.stringify(t)).toString("base64")}function i9(t){return JSON.parse(lt.Buffer.from(t,"base64").toString("utf-8"))}function ga(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function o9(t,e,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:a9(e,n,r)}}}function a9(t,e,n={}){e=e?.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function dS(t){return ga(t),`urn:recap:${s9(t).replace(/=/g,"")}`}function ru(t){const e=i9(t.replace("urn:recap:",""));return ga(e),e}function c9(t,e,n){const r=o9(t,e,n);return dS(r)}function l9(t){return t&&t.includes("urn:recap:")}function u9(t,e){const n=ru(t),r=ru(e),s=d9(n,r);return dS(s)}function d9(t,e){ga(t),ga(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=Qj(Xj({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function h9(t="",e){ga(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function Ub(t){var e;const n=ru(t);ga(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function Mb(t){const e=ru(t);ga(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function Wd(t){if(!t)return;const e=t?.[t.length-1];return l9(e)?e:void 0}function hS(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function em(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Rp(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function mr(t,...e){if(!hS(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Lb(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function f9(t,e){mr(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function uo(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function bc(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function p9(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const g9=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function m9(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function tm(t){if(typeof t=="string")t=m9(t);else if(hS(t))t=nm(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function y9(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function w9(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const E9=(t,e)=>{function n(r,...s){if(mr(r),!g9)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?mr(l):mr(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&mr(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");mr(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,mr(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(mr(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function $b(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!v9(e))throw new Error("invalid output, must be aligned");return e}function Bb(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function b9(t,e,n){em(n);const r=new Uint8Array(16),s=p9(r);return Bb(s,0,BigInt(e),n),Bb(s,8,BigInt(t),n),r}function v9(t){return t.byteOffset%4===0}function nm(t){return Uint8Array.from(t)}const fS=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),_9=fS("expand 16-byte k"),C9=fS("expand 32-byte k"),A9=uo(_9),I9=uo(C9);function wt(t,e){return t<<e|t>>>32-e}function rm(t){return t.byteOffset%4===0}const dd=64,S9=16,pS=2**32-1,Fb=new Uint32Array;function T9(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(dd),u=uo(l),d=rm(s)&&rm(i),h=d?uo(s):Fb,f=d?uo(i):Fb;for(let p=0;p<c;o++){if(t(e,n,r,u,o,a),o>=pS)throw new Error("arx: counter overflow");const m=Math.min(dd,c-p);if(d&&m===dd){const g=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let T=0,N;T<S9;T++)N=g+T,f[N]=h[N]^u[T];p+=dd;continue}for(let g=0,T;g<m;g++)T=p+g,i[T]=s[T]^l[g];p+=m}}function N9(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=y9({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Rp(s),Rp(o),em(i),em(n),(a,c,l,u,d=0)=>{mr(a),mr(c),mr(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),mr(u),Rp(d),d<0||d>=pS)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let p=a.length,m,g;if(p===32)f.push(m=nm(a)),g=I9;else if(p===16&&n)m=new Uint8Array(32),m.set(a),m.set(a,16),g=A9,f.push(m);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);rm(c)||f.push(c=nm(c));const T=uo(m);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(g,T,uo(c.subarray(0,16)),T),c=c.subarray(16)}const N=16-s;if(N!==c.length)throw new Error(`arx: nonce must be ${N} or 16 bytes`);if(N!==12){const O=new Uint8Array(12);O.set(c,i?0:12-c.length),c=O,f.push(c)}const _=uo(c);return T9(t,g,T,_,l,u,d,o),bc(...f),u}}const On=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class O9{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=tm(e),mr(e,32);const n=On(e,0),r=On(e,2),s=On(e,4),i=On(e,6),o=On(e,8),a=On(e,10),c=On(e,12),l=On(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=On(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],m=o[8],g=o[9],T=On(e,n+0),N=On(e,n+2),_=On(e,n+4),O=On(e,n+6),A=On(e,n+8),x=On(e,n+10),k=On(e,n+12),L=On(e,n+14);let M=i[0]+(T&8191),z=i[1]+((T>>>13|N<<3)&8191),J=i[2]+((N>>>10|_<<6)&8191),H=i[3]+((_>>>7|O<<9)&8191),F=i[4]+((O>>>4|A<<12)&8191),P=i[5]+(A>>>1&8191),w=i[6]+((A>>>14|x<<2)&8191),E=i[7]+((x>>>11|k<<5)&8191),R=i[8]+((k>>>8|L<<8)&8191),b=i[9]+(L>>>5|s),y=0,C=y+M*a+z*(5*g)+J*(5*m)+H*(5*p)+F*(5*f);y=C>>>13,C&=8191,C+=P*(5*h)+w*(5*d)+E*(5*u)+R*(5*l)+b*(5*c),y+=C>>>13,C&=8191;let $=y+M*c+z*a+J*(5*g)+H*(5*m)+F*(5*p);y=$>>>13,$&=8191,$+=P*(5*f)+w*(5*h)+E*(5*d)+R*(5*u)+b*(5*l),y+=$>>>13,$&=8191;let B=y+M*l+z*c+J*a+H*(5*g)+F*(5*m);y=B>>>13,B&=8191,B+=P*(5*p)+w*(5*f)+E*(5*h)+R*(5*d)+b*(5*u),y+=B>>>13,B&=8191;let G=y+M*u+z*l+J*c+H*a+F*(5*g);y=G>>>13,G&=8191,G+=P*(5*m)+w*(5*p)+E*(5*f)+R*(5*h)+b*(5*d),y+=G>>>13,G&=8191;let Y=y+M*d+z*u+J*l+H*c+F*a;y=Y>>>13,Y&=8191,Y+=P*(5*g)+w*(5*m)+E*(5*p)+R*(5*f)+b*(5*h),y+=Y>>>13,Y&=8191;let Q=y+M*h+z*d+J*u+H*l+F*c;y=Q>>>13,Q&=8191,Q+=P*a+w*(5*g)+E*(5*m)+R*(5*p)+b*(5*f),y+=Q>>>13,Q&=8191;let ye=y+M*f+z*h+J*d+H*u+F*l;y=ye>>>13,ye&=8191,ye+=P*c+w*a+E*(5*g)+R*(5*m)+b*(5*p),y+=ye>>>13,ye&=8191;let be=y+M*p+z*f+J*h+H*d+F*u;y=be>>>13,be&=8191,be+=P*l+w*c+E*a+R*(5*g)+b*(5*m),y+=be>>>13,be&=8191;let De=y+M*m+z*p+J*f+H*h+F*d;y=De>>>13,De&=8191,De+=P*u+w*l+E*c+R*a+b*(5*g),y+=De>>>13,De&=8191;let ve=y+M*g+z*m+J*p+H*f+F*h;y=ve>>>13,ve&=8191,ve+=P*d+w*u+E*l+R*c+b*a,y+=ve>>>13,ve&=8191,y=(y<<2)+y|0,y=y+C|0,C=y&8191,y=y>>>13,$+=y,i[0]=C,i[1]=$,i[2]=B,i[3]=G,i[4]=Y,i[5]=Q,i[6]=ye,i[7]=be,i[8]=De,i[9]=ve}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;bc(r)}update(e){Lb(this),e=tm(e),mr(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){bc(this.h,this.r,this.buffer,this.pad)}digestInto(e){Lb(this),f9(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function R9(t){const e=(r,s)=>t(s).update(tm(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const P9=R9(t=>new O9(t));function x9(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],m=e[5],g=e[6],T=e[7],N=s,_=n[0],O=n[1],A=n[2],x=o,k=a,L=c,M=l,z=u,J=d,H=h,F=f,P=p,w=m,E=g,R=T,b=N,y=_,C=O,$=A;for(let G=0;G<i;G+=2)x=x+z|0,b=wt(b^x,16),P=P+b|0,z=wt(z^P,12),x=x+z|0,b=wt(b^x,8),P=P+b|0,z=wt(z^P,7),k=k+J|0,y=wt(y^k,16),w=w+y|0,J=wt(J^w,12),k=k+J|0,y=wt(y^k,8),w=w+y|0,J=wt(J^w,7),L=L+H|0,C=wt(C^L,16),E=E+C|0,H=wt(H^E,12),L=L+H|0,C=wt(C^L,8),E=E+C|0,H=wt(H^E,7),M=M+F|0,$=wt($^M,16),R=R+$|0,F=wt(F^R,12),M=M+F|0,$=wt($^M,8),R=R+$|0,F=wt(F^R,7),x=x+J|0,$=wt($^x,16),E=E+$|0,J=wt(J^E,12),x=x+J|0,$=wt($^x,8),E=E+$|0,J=wt(J^E,7),k=k+H|0,b=wt(b^k,16),R=R+b|0,H=wt(H^R,12),k=k+H|0,b=wt(b^k,8),R=R+b|0,H=wt(H^R,7),L=L+F|0,y=wt(y^L,16),P=P+y|0,F=wt(F^P,12),L=L+F|0,y=wt(y^L,8),P=P+y|0,F=wt(F^P,7),M=M+z|0,C=wt(C^M,16),w=w+C|0,z=wt(z^w,12),M=M+z|0,C=wt(C^M,8),w=w+C|0,z=wt(z^w,7);let B=0;r[B++]=o+x|0,r[B++]=a+k|0,r[B++]=c+L|0,r[B++]=l+M|0,r[B++]=u+z|0,r[B++]=d+J|0,r[B++]=h+H|0,r[B++]=f+F|0,r[B++]=p+P|0,r[B++]=m+w|0,r[B++]=g+E|0,r[B++]=T+R|0,r[B++]=N+b|0,r[B++]=_+y|0,r[B++]=O+C|0,r[B++]=A+$|0}const k9=N9(x9,{counterRight:!1,counterLength:4,allowShortKeys:!1}),D9=new Uint8Array(16),jb=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(D9.subarray(n))},U9=new Uint8Array(32);function Wb(t,e,n,r,s){const i=t(e,n,U9),o=P9.create(i);s&&jb(o,s),jb(o,r);const a=b9(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return bc(i,a),c}const M9=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=$b(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=Wb(t,e,n,a,r);return i.set(c,o),bc(c),i},decrypt(s,i){i=$b(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Wb(t,e,n,o,r);if(!w9(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),bc(c),i}}),gS=E9({blockSize:64,nonceLength:12,tagLength:16},M9(k9));let mS=class extends af{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,of(e);const r=gs(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Yr(i)}update(e){return vo(this),this.iHash.update(e),this}digestInto(e){vo(this),ys(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const uf=(t,e,n)=>new mS(t,e).update(n).digest();uf.create=(t,e)=>new mS(t,e);function L9(t,e,n){return of(t),n===void 0&&(n=new Uint8Array(t.outputLen)),uf(t,gs(n),gs(e))}const Pp=Uint8Array.from([0]),Hb=Uint8Array.of();function $9(t,e,n,r=32){of(t),Ei(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=Hb);const o=new Uint8Array(i*s),a=uf.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Pp[0]=u+1,c.update(u===0?Hb:l).update(n).update(Pp).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Yr(l,Pp),o.slice(0,r)}const B9=(t,e,n,r,s)=>$9(t,L9(t,e,n),r,s),df=cf,Cy=BigInt(0),sm=BigInt(1);function Sh(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function Zo(t,e,n=""){const r=sf(t),s=t?.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,a=i?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function hd(t){const e=t.toString(16);return e.length&1?"0"+e:e}function yS(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Cy:BigInt("0x"+t)}function hf(t){return yS(ac(t))}function Th(t){return ys(t),yS(ac(Uint8Array.from(t).reverse()))}function Ay(t,e){return Ah(t.toString(16).padStart(e*2,"0"))}function Iy(t,e){return Ay(t,e).reverse()}function Gn(t,e,n){let r;if(typeof e=="string")try{r=Ah(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(sf(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const xp=t=>typeof t=="bigint"&&Cy<=t;function F9(t,e,n){return xp(t)&&xp(e)&&xp(n)&&e<=t&&t<n}function im(t,e,n,r){if(!F9(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function wS(t){let e;for(e=0;t>Cy;t>>=sm,e+=1);return e}const Iu=t=>(sm<<BigInt(t))-sm;function j9(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){i=l();const p=i.slice();f.push(p),h+=i.length}return eo(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function ff(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function zb(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const wr=BigInt(0),ir=BigInt(1),Xo=BigInt(2),ES=BigInt(3),bS=BigInt(4),vS=BigInt(5),W9=BigInt(7),_S=BigInt(8),H9=BigInt(9),CS=BigInt(16);function Or(t,e){const n=t%e;return n>=wr?n:e+n}function ss(t,e,n){let r=t;for(;e-- >wr;)r*=r,r%=n;return r}function qb(t,e){if(t===wr)throw new Error("invert: expected non-zero number");if(e<=wr)throw new Error("invert: expected positive modulus, got "+e);let n=Or(t,e),r=e,s=wr,i=ir;for(;n!==wr;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ir)throw new Error("invert: does not exist");return Or(s,e)}function Sy(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function AS(t,e){const n=(t.ORDER+ir)/bS,r=t.pow(e,n);return Sy(t,r,e),r}function z9(t,e){const n=(t.ORDER-vS)/_S,r=t.mul(e,Xo),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Xo),s),a=t.mul(i,t.sub(o,t.ONE));return Sy(t,a,e),a}function q9(t){const e=So(t),n=IS(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+W9)/CS;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,r);const d=a.mul(l,s),h=a.mul(l,i),f=a.eql(a.sqr(u),c),p=a.eql(a.sqr(d),c);l=a.cmov(l,u,f),u=a.cmov(h,d,p);const m=a.eql(a.sqr(u),c),g=a.cmov(l,u,m);return Sy(a,g,c),g}}function IS(t){if(t<ES)throw new Error("sqrt is not defined for small field");let e=t-ir,n=0;for(;e%Xo===wr;)e/=Xo,n++;let r=Xo;const s=So(t);for(;Vb(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return AS;let i=s.pow(r,e);const o=(e+ir)/Xo;return function(a,c){if(a.is0(c))return c;if(Vb(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");const m=ir<<BigInt(l-f-1),g=a.pow(u,m);l=f,u=a.sqr(g),d=a.mul(d,u),h=a.mul(h,g)}return h}}function V9(t){return t%bS===ES?AS:t%_S===vS?z9:t%CS===H9?q9(t):IS(t)}const K9=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function G9(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=K9.reduce((r,s)=>(r[s]="function",r),e);return ff(t,n),t}function Y9(t,e,n){if(n<wr)throw new Error("invalid exponent, negatives unsupported");if(n===wr)return t.ONE;if(n===ir)return e;let r=t.ONE,s=e;for(;n>wr;)n&ir&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ir;return r}function SS(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function Vb(t,e){const n=(t.ORDER-ir)/Xo,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function TS(t,e){e!==void 0&&Ei(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function So(t,e,n=!1,r={}){if(t<=wr)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=e;h.BITS&&(s=h.BITS),h.sqrt&&(i=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:c,nByteLength:l}=TS(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:t,isLE:n,BITS:c,BYTES:l,MASK:Iu(c),ZERO:wr,ONE:ir,allowedLengths:a,create:h=>Or(h,t),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return wr<=h&&h<t},is0:h=>h===wr,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&ir)===ir,neg:h=>Or(-h,t),eql:(h,f)=>h===f,sqr:h=>Or(h*h,t),add:(h,f)=>Or(h+f,t),sub:(h,f)=>Or(h-f,t),mul:(h,f)=>Or(h*f,t),pow:(h,f)=>Y9(d,h,f),div:(h,f)=>Or(h*qb(f,t),t),sqrN:h=>h*h,addN:(h,f)=>h+f,subN:(h,f)=>h-f,mulN:(h,f)=>h*f,inv:h=>qb(h,t),sqrt:i||(h=>(u||(u=V9(t)),u(d,h))),toBytes:h=>n?Iy(h,l):Ay(h,l),fromBytes:(h,f=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const m=new Uint8Array(l);m.set(h,n?0:m.length-h.length),h=m}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let p=n?Th(h):hf(h);if(o&&(p=Or(p,t)),!f&&!d.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:h=>SS(d,h),cmov:(h,f,p)=>p?f:h});return Object.freeze(d)}function NS(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function OS(t){const e=NS(t);return e+Math.ceil(e/2)}function J9(t,e,n=!1){const r=t.length,s=NS(e),i=OS(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Th(t):hf(t),a=Or(o,e-ir)+ir;return n?Iy(a,s):Ay(a,s)}const vc=BigInt(0),Qo=BigInt(1);function Nh(t,e){const n=e.negate();return t?n:e}function kp(t,e){const n=SS(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function RS(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Dp(t,e){RS(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Iu(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function Kb(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Qo);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function Z9(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function X9(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Up=new WeakMap,PS=new WeakMap;function Mp(t){return PS.get(t)||1}function Gb(t){if(t!==vc)throw new Error("invalid wNAF")}class Q9{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>vc;)n&Qo&&(r=r.add(s)),s=s.double(),n>>=Qo;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=Dp(n,this.bits),i=[];let o=e,a=o;for(let c=0;c<r;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=Dp(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:f}=Kb(r,a,o);r=c,u?i=i.add(Nh(h,n[f])):s=s.add(Nh(d,n[l]))}return Gb(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=Dp(e,this.bits);for(let o=0;o<i.windows&&r!==vc;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=Kb(r,o,i);if(r=a,!l){const d=n[c];s=s.add(u?d.negate():d)}}return Gb(r),s}getPrecomputes(e,n,r){let s=Up.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),Up.set(n,s))),s}cached(e,n,r){const s=Mp(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=Mp(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){RS(n,this.bits),PS.set(e,n),Up.delete(e)}hasCache(e){return Mp(e)!==1}}function e7(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>vc||r>vc;)n&Qo&&(i=i.add(s)),r&Qo&&(o=o.add(s)),s=s.double(),n>>=Qo,r>>=Qo;return{p1:i,p2:o}}function t7(t,e,n,r){Z9(n,t),X9(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=wS(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Iu(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let m=0;m<i;m++){const g=r[m],T=Number(g>>BigInt(f)&l);u[T]=u[T].add(n[m])}let p=o;for(let m=u.length-1,g=o;m>0;m--)g=g.add(u[m]),p=p.add(g);if(h=h.add(p),f!==0)for(let m=0;m<c;m++)h=h.double()}return h}function Yb(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return G9(e),e}else return So(t,{isLE:n})}function n7(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>vc))throw new Error(`CURVE.${a} must be positive bigint`)}const s=Yb(e.p,n.Fp,r),i=Yb(e.n,n.Fn,r),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),eS("HashToScalar-");const el=BigInt(0),ja=BigInt(1),fd=BigInt(2);function r7(t){return ff(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function s7(t){const e=r7(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||Na,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?fd**BigInt(254):fd**BigInt(447),p=a?BigInt(8)*fd**BigInt(251)-ja:BigInt(4)*fd**BigInt(445)-ja,m=f+p+ja,g=H=>Or(H,n),T=N(d);function N(H){return Iy(g(H),u)}function _(H){const F=Gn("u coordinate",H,u);return a&&(F[31]&=127),g(Th(F))}function O(H){return Th(s(Gn("scalar",H,u)))}function A(H,F){const P=L(_(F),O(H));if(P===el)throw new Error("invalid private or public key received");return N(P)}function x(H){return A(H,T)}function k(H,F,P){const w=g(H*(F-P));return F=g(F-w),P=g(P+w),{x_2:F,x_3:P}}function L(H,F){im("u",H,el,n),im("scalar",F,f,m);const P=F,w=H;let E=ja,R=el,b=H,y=ja,C=el;for(let B=BigInt(l-1);B>=el;B--){const G=P>>B&ja;C^=G,{x_2:E,x_3:b}=k(C,E,b),{x_2:R,x_3:y}=k(C,R,y),C=G;const Y=E+R,Q=g(Y*Y),ye=E-R,be=g(ye*ye),De=Q-be,ve=b+y,Be=b-y,ct=g(Be*Y),Ct=g(ve*ye),$t=ct+Ct,tn=ct-Ct;b=g($t*$t),y=g(w*g(tn*tn)),E=g(Q*be),R=g(De*(Q+g(h*De)))}({x_2:E,x_3:b}=k(C,E,b)),{x_2:R,x_3:y}=k(C,R,y);const $=i(R);return g(E*$)}const M={secretKey:u,publicKey:u,seed:u},z=(H=c(u))=>(ys(H,M.seed),H);function J(H){const F=z(H);return{secretKey:F,publicKey:x(F)}}return{keygen:J,getSharedSecret:(H,F)=>A(H,F),getPublicKey:H=>x(H),scalarMult:A,scalarMultBase:x,utils:{randomSecretKey:z,randomPrivateKey:z},GuBytes:T.slice(),lengths:M}}const i7=BigInt(1),Jb=BigInt(2),o7=BigInt(3),a7=BigInt(5);BigInt(8);const xS=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),c7={p:xS,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function l7(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=xS,o=t*t%i*t%i,a=ss(o,Jb,i)*o%i,c=ss(a,i7,i)*t%i,l=ss(c,a7,i)*c%i,u=ss(l,e,i)*l%i,d=ss(u,n,i)*u%i,h=ss(d,r,i)*d%i,f=ss(h,s,i)*h%i,p=ss(f,s,i)*h%i,m=ss(p,e,i)*l%i;return{pow_p_5_8:ss(m,Jb,i)*t%i,b2:o}}function u7(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const d7=So(c7.p,{isLE:!0}),om=(()=>{const t=d7.ORDER;return s7({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=l7(e);return Or(ss(n,o7,t)*r,t)},adjustScalarBytes:u7})})(),Zb=(t,e)=>(t+(t>=0?e:-e)/kS)/e;function h7(t,e,n){const[[r,s],[i,o]]=e,a=Zb(o*t,n),c=Zb(-s*t,n);let l=t-a*r-c*i,u=-a*s-c*o;const d=l<ui,h=u<ui;d&&(l=-l),h&&(u=-u);const f=Iu(Math.ceil(wS(n)/2))+cc;if(l<ui||l>=f||u<ui||u>=f)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}function am(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Lp(t,e){const n={};for(let r of Object.keys(e))n[r]=t[r]===void 0?e[r]:t[r];return Sh(n.lowS,"lowS"),Sh(n.prehash,"prehash"),n.format!==void 0&&am(n.format),n}class f7 extends Error{constructor(e=""){super(e)}}const ci={Err:f7,_tlv:{encode:(t,e)=>{const{Err:n}=ci;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=hd(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?hd(s.length/2|128):"";return hd(t)+i+s+e},decode(t,e){const{Err:n}=ci;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=ci;if(t<ui)throw new e("integer: negative integers are not allowed");let n=hd(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=ci;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return hf(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=ci,s=Gn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=ci,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},ui=BigInt(0),cc=BigInt(1),kS=BigInt(2),pd=BigInt(3),p7=BigInt(4);function ec(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=Gn("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function g7(t,e={}){const n=n7("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:a}=i;ff(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=US(r,s);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(H,F,P){const{x:w,y:E}=F.toAffine(),R=r.toBytes(w);if(Sh(P,"isCompressed"),P){u();const b=!r.isOdd(E);return eo(DS(b),R)}else return eo(Uint8Array.of(4),R,r.toBytes(E))}function h(H){Zo(H,void 0,"Point");const{publicKey:F,publicKeyUncompressed:P}=l,w=H.length,E=H[0],R=H.subarray(1);if(w===F&&(E===2||E===3)){const b=r.fromBytes(R);if(!r.isValid(b))throw new Error("bad point: is not on curve, wrong x");const y=m(b);let C;try{C=r.sqrt(y)}catch(B){const G=B instanceof Error?": "+B.message:"";throw new Error("bad point: is not on curve, sqrt error"+G)}u();const $=r.isOdd(C);return(E&1)===1!==$&&(C=r.neg(C)),{x:b,y:C}}else if(w===P&&E===4){const b=r.BYTES,y=r.fromBytes(R.subarray(0,b)),C=r.fromBytes(R.subarray(b,b*2));if(!g(y,C))throw new Error("bad point: is not on curve");return{x:y,y:C}}else throw new Error(`bad point: got length ${w}, expected compressed=${F} or uncompressed=${P}`)}const f=e.toBytes||d,p=e.fromBytes||h;function m(H){const F=r.sqr(H),P=r.mul(F,H);return r.add(r.add(P,r.mul(H,i.a)),i.b)}function g(H,F){const P=r.sqr(F),w=m(H);return r.eql(P,w)}if(!g(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const T=r.mul(r.pow(i.a,pd),p7),N=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(T,N)))throw new Error("bad curve params: a or b");function _(H,F,P=!1){if(!r.isValid(F)||P&&r.is0(F))throw new Error(`bad point coordinate ${H}`);return F}function O(H){if(!(H instanceof M))throw new Error("ProjectivePoint expected")}function A(H){if(!c||!c.basises)throw new Error("no endo");return h7(H,c.basises,s.ORDER)}const x=zb((H,F)=>{const{X:P,Y:w,Z:E}=H;if(r.eql(E,r.ONE))return{x:P,y:w};const R=H.is0();F==null&&(F=R?r.ONE:r.inv(E));const b=r.mul(P,F),y=r.mul(w,F),C=r.mul(E,F);if(R)return{x:r.ZERO,y:r.ZERO};if(!r.eql(C,r.ONE))throw new Error("invZ was invalid");return{x:b,y}}),k=zb(H=>{if(H.is0()){if(e.allowInfinityPoint&&!r.is0(H.Y))return;throw new Error("bad point: ZERO")}const{x:F,y:P}=H.toAffine();if(!r.isValid(F)||!r.isValid(P))throw new Error("bad point: x or y not field elements");if(!g(F,P))throw new Error("bad point: equation left != right");if(!H.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function L(H,F,P,w,E){return P=new M(r.mul(P.X,H),P.Y,P.Z),F=Nh(w,F),P=Nh(E,P),F.add(P)}class M{constructor(F,P,w){this.X=_("x",F),this.Y=_("y",P,!0),this.Z=_("z",w),Object.freeze(this)}static CURVE(){return i}static fromAffine(F){const{x:P,y:w}=F||{};if(!F||!r.isValid(P)||!r.isValid(w))throw new Error("invalid affine point");if(F instanceof M)throw new Error("projective point not allowed");return r.is0(P)&&r.is0(w)?M.ZERO:new M(P,w,r.ONE)}static fromBytes(F){const P=M.fromAffine(p(Zo(F,void 0,"point")));return P.assertValidity(),P}static fromHex(F){return M.fromBytes(Gn("pointHex",F))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(F=8,P=!0){return J.createCache(this,F),P||this.multiply(pd),this}assertValidity(){k(this)}hasEvenY(){const{y:F}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(F)}equals(F){O(F);const{X:P,Y:w,Z:E}=this,{X:R,Y:b,Z:y}=F,C=r.eql(r.mul(P,y),r.mul(R,E)),$=r.eql(r.mul(w,y),r.mul(b,E));return C&&$}negate(){return new M(this.X,r.neg(this.Y),this.Z)}double(){const{a:F,b:P}=i,w=r.mul(P,pd),{X:E,Y:R,Z:b}=this;let y=r.ZERO,C=r.ZERO,$=r.ZERO,B=r.mul(E,E),G=r.mul(R,R),Y=r.mul(b,b),Q=r.mul(E,R);return Q=r.add(Q,Q),$=r.mul(E,b),$=r.add($,$),y=r.mul(F,$),C=r.mul(w,Y),C=r.add(y,C),y=r.sub(G,C),C=r.add(G,C),C=r.mul(y,C),y=r.mul(Q,y),$=r.mul(w,$),Y=r.mul(F,Y),Q=r.sub(B,Y),Q=r.mul(F,Q),Q=r.add(Q,$),$=r.add(B,B),B=r.add($,B),B=r.add(B,Y),B=r.mul(B,Q),C=r.add(C,B),Y=r.mul(R,b),Y=r.add(Y,Y),B=r.mul(Y,Q),y=r.sub(y,B),$=r.mul(Y,G),$=r.add($,$),$=r.add($,$),new M(y,C,$)}add(F){O(F);const{X:P,Y:w,Z:E}=this,{X:R,Y:b,Z:y}=F;let C=r.ZERO,$=r.ZERO,B=r.ZERO;const G=i.a,Y=r.mul(i.b,pd);let Q=r.mul(P,R),ye=r.mul(w,b),be=r.mul(E,y),De=r.add(P,w),ve=r.add(R,b);De=r.mul(De,ve),ve=r.add(Q,ye),De=r.sub(De,ve),ve=r.add(P,E);let Be=r.add(R,y);return ve=r.mul(ve,Be),Be=r.add(Q,be),ve=r.sub(ve,Be),Be=r.add(w,E),C=r.add(b,y),Be=r.mul(Be,C),C=r.add(ye,be),Be=r.sub(Be,C),B=r.mul(G,ve),C=r.mul(Y,be),B=r.add(C,B),C=r.sub(ye,B),B=r.add(ye,B),$=r.mul(C,B),ye=r.add(Q,Q),ye=r.add(ye,Q),be=r.mul(G,be),ve=r.mul(Y,ve),ye=r.add(ye,be),be=r.sub(Q,be),be=r.mul(G,be),ve=r.add(ve,be),Q=r.mul(ye,ve),$=r.add($,Q),Q=r.mul(Be,ve),C=r.mul(De,C),C=r.sub(C,Q),Q=r.mul(De,ye),B=r.mul(Be,B),B=r.add(B,Q),new M(C,$,B)}subtract(F){return this.add(F.negate())}is0(){return this.equals(M.ZERO)}multiply(F){const{endo:P}=e;if(!s.isValidNot0(F))throw new Error("invalid scalar: out of range");let w,E;const R=b=>J.cached(this,b,y=>kp(M,y));if(P){const{k1neg:b,k1:y,k2neg:C,k2:$}=A(F),{p:B,f:G}=R(y),{p:Y,f:Q}=R($);E=G.add(Q),w=L(P.beta,B,Y,b,C)}else{const{p:b,f:y}=R(F);w=b,E=y}return kp(M,[w,E])[0]}multiplyUnsafe(F){const{endo:P}=e,w=this;if(!s.isValid(F))throw new Error("invalid scalar: out of range");if(F===ui||w.is0())return M.ZERO;if(F===cc)return w;if(J.hasCache(this))return this.multiply(F);if(P){const{k1neg:E,k1:R,k2neg:b,k2:y}=A(F),{p1:C,p2:$}=e7(M,w,R,y);return L(P.beta,C,$,E,b)}else return J.unsafe(w,F)}multiplyAndAddUnsafe(F,P,w){const E=this.multiplyUnsafe(P).add(F.multiplyUnsafe(w));return E.is0()?void 0:E}toAffine(F){return x(this,F)}isTorsionFree(){const{isTorsionFree:F}=e;return o===cc?!0:F?F(M,this):J.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:F}=e;return o===cc?this:F?F(M,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(F=!0){return Sh(F,"isCompressed"),this.assertValidity(),f(M,this,F)}toHex(F=!0){return ac(this.toBytes(F))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(F=!0){return this.toBytes(F)}_setWindowSize(F){this.precompute(F)}static normalizeZ(F){return kp(M,F)}static msm(F,P){return t7(M,s,F,P)}static fromPrivateKey(F){return M.BASE.multiply(ec(s,F))}}M.BASE=new M(i.Gx,i.Gy,r.ONE),M.ZERO=new M(r.ZERO,r.ONE,r.ZERO),M.Fp=r,M.Fn=s;const z=s.BITS,J=new Q9(M,e.endo?Math.ceil(z/2):z);return M.BASE.precompute(8),M}function DS(t){return Uint8Array.of(t?2:3)}function US(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function m7(t,e={}){const{Fn:n}=t,r=e.randomBytes||Na,s=Object.assign(US(t.Fp,n),{seed:OS(n.ORDER)});function i(h){try{return!!ec(n,h)}catch{return!1}}function o(h,f){const{publicKey:p,publicKeyUncompressed:m}=s;try{const g=h.length;return f===!0&&g!==p||f===!1&&g!==m?!1:!!t.fromBytes(h)}catch{return!1}}function a(h=r(s.seed)){return J9(Zo(h,s.seed,"seed"),n.ORDER)}function c(h,f=!0){return t.BASE.multiply(ec(n,h)).toBytes(f)}function l(h){const f=a(h);return{secretKey:f,publicKey:c(f)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof t)return!0;const{secretKey:f,publicKey:p,publicKeyUncompressed:m}=s;if(n.allowedLengths||f===p)return;const g=Gn("key",h).length;return g===p||g===m}function d(h,f,p=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(f)===!1)throw new Error("second arg must be public key");const m=ec(n,h);return t.fromHex(f).multiply(m).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>ec(n,h),precompute(h=8,f=t.BASE){return f.precompute(h,!1)}},lengths:s})}function y7(t,e,n={}){of(e),ff(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||Na,s=n.hmac||((P,...w)=>uf(e,P,eo(...w))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f}=m7(t,n),p={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},m="compact";function g(P){const w=a>>cc;return P>w}function T(P,w){if(!o.isValidNot0(w))throw new Error(`invalid signature ${P}: out of range 1..Point.Fn.ORDER`);return w}function N(P,w){am(w);const E=f.signature,R=w==="compact"?E:w==="recovered"?E+1:void 0;return Zo(P,R,`${w} signature`)}class _{constructor(w,E,R){this.r=T("r",w),this.s=T("s",E),R!=null&&(this.recovery=R),Object.freeze(this)}static fromBytes(w,E=m){N(w,E);let R;if(E==="der"){const{r:$,s:B}=ci.toSig(Zo(w));return new _($,B)}E==="recovered"&&(R=w[0],E="compact",w=w.subarray(1));const b=o.BYTES,y=w.subarray(0,b),C=w.subarray(b,b*2);return new _(o.fromBytes(y),o.fromBytes(C),R)}static fromHex(w,E){return this.fromBytes(Ah(w),E)}addRecoveryBit(w){return new _(this.r,this.s,w)}recoverPublicKey(w){const E=i.ORDER,{r:R,s:b,recovery:y}=this;if(y==null||![0,1,2,3].includes(y))throw new Error("recovery id invalid");if(a*kS<E&&y>1)throw new Error("recovery id is ambiguous for h>1 curve");const C=y===2||y===3?R+a:R;if(!i.isValid(C))throw new Error("recovery id 2 or 3 invalid");const $=i.toBytes(C),B=t.fromBytes(eo(DS((y&1)===0),$)),G=o.inv(C),Y=A(Gn("msgHash",w)),Q=o.create(-Y*G),ye=o.create(b*G),be=t.BASE.multiplyUnsafe(Q).add(B.multiplyUnsafe(ye));if(be.is0())throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return g(this.s)}toBytes(w=m){if(am(w),w==="der")return Ah(ci.hexFromSig(this));const E=o.toBytes(this.r),R=o.toBytes(this.s);if(w==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return eo(Uint8Array.of(this.recovery),E,R)}return eo(E,R)}toHex(w){return ac(this.toBytes(w))}assertValidity(){}static fromCompact(w){return _.fromBytes(Gn("sig",w),"compact")}static fromDER(w){return _.fromBytes(Gn("sig",w),"der")}normalizeS(){return this.hasHighS()?new _(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return ac(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return ac(this.toBytes("compact"))}}const O=n.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const w=hf(P),E=P.length*8-c;return E>0?w>>BigInt(E):w},A=n.bits2int_modN||function(P){return o.create(O(P))},x=Iu(c);function k(P){return im("num < 2^"+c,P,ui,x),o.toBytes(P)}function L(P,w){return Zo(P,void 0,"message"),w?Zo(e(P),void 0,"prehashed message"):P}function M(P,w,E){if(["recovered","canonical"].some(ye=>ye in E))throw new Error("sign() legacy options not supported");const{lowS:R,prehash:b,extraEntropy:y}=Lp(E,p);P=L(P,b);const C=A(P),$=ec(o,w),B=[k($),k(C)];if(y!=null&&y!==!1){const ye=y===!0?r(f.secretKey):y;B.push(Gn("extraEntropy",ye))}const G=eo(...B),Y=C;function Q(ye){const be=O(ye);if(!o.isValidNot0(be))return;const De=o.inv(be),ve=t.BASE.multiply(be).toAffine(),Be=o.create(ve.x);if(Be===ui)return;const ct=o.create(De*o.create(Y+Be*$));if(ct===ui)return;let Ct=(ve.x===Be?0:2)|Number(ve.y&cc),$t=ct;return R&&g(ct)&&($t=o.neg(ct),Ct^=1),new _(Be,$t,Ct)}return{seed:G,k2sig:Q}}function z(P,w,E={}){P=Gn("message",P);const{seed:R,k2sig:b}=M(P,w,E);return j9(e.outputLen,o.BYTES,s)(R,b)}function J(P){let w;const E=typeof P=="string"||sf(P),R=!E&&P!==null&&typeof P=="object"&&typeof P.r=="bigint"&&typeof P.s=="bigint";if(!E&&!R)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(R)w=new _(P.r,P.s);else if(E){try{w=_.fromBytes(Gn("sig",P),"der")}catch(b){if(!(b instanceof ci.Err))throw b}if(!w)try{w=_.fromBytes(Gn("sig",P),"compact")}catch{return!1}}return w||!1}function H(P,w,E,R={}){const{lowS:b,prehash:y,format:C}=Lp(R,p);if(E=Gn("publicKey",E),w=L(Gn("message",w),y),"strict"in R)throw new Error("options.strict was renamed to lowS");const $=C===void 0?J(P):_.fromBytes(Gn("sig",P),C);if($===!1)return!1;try{const B=t.fromBytes(E);if(b&&$.hasHighS())return!1;const{r:G,s:Y}=$,Q=A(w),ye=o.inv(Y),be=o.create(Q*ye),De=o.create(G*ye),ve=t.BASE.multiplyUnsafe(be).add(B.multiplyUnsafe(De));return ve.is0()?!1:o.create(ve.x)===G}catch{return!1}}function F(P,w,E={}){const{prehash:R}=Lp(E,p);return w=L(w,R),_.fromBytes(P,"recovered").recoverPublicKey(w).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:f,Point:t,sign:z,verify:H,recoverPublicKey:F,Signature:_,hash:e})}function w7(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=So(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function E7(t){const{CURVE:e,curveOpts:n}=w7(t),r={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,hash:t.hash,ecdsaOpts:r}}function b7(t,e){const n=e.Point;return Object.assign({},e,{ProjectivePoint:n,CURVE:Object.assign({},t,TS(n.Fn.ORDER,n.Fn.BITS))})}function v7(t){const{CURVE:e,curveOpts:n,hash:r,ecdsaOpts:s}=E7(t),i=g7(e,n),o=y7(i,r,s);return b7(t,o)}function cm(t,e){const n=r=>v7({...t,hash:r});return{...n(e),create:n}}const MS={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},LS={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},$S={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},_7=So(MS.p),C7=So(LS.p),A7=So($S.p),I7=cm({...MS,Fp:_7,lowS:!1},cf);cm({...LS,Fp:C7,lowS:!1},Rj),cm({...$S,Fp:A7,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Oj);const S7=I7,BS="base10",or="base16",yr="base64pad",to="base64url",Su="utf8",FS=0,pi=1,Tu=2,T7=0,Xb=1,Cl=12,Ty=32;function N7(){const t=om.utils.randomPrivateKey(),e=om.getPublicKey(t);return{privateKey:Er(t,or),publicKey:Er(e,or)}}function lm(){const t=Na(Ty);return Er(t,or)}function O7(t,e){const n=om.getSharedSecret(Kr(t,or),Kr(e,or)),r=B9(df,n,void 0,void 0,Ty);return Er(r,or)}function Hd(t){const e=df(Kr(t,or));return Er(e,or)}function zr(t){const e=df(Kr(t,Su));return Er(e,or)}function jS(t){return Kr(`${t}`,BS)}function ma(t){return Number(Er(t,BS))}function WS(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function HS(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function R7(t){const e=jS(typeof t.type<"u"?t.type:FS);if(ma(e)===pi&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Kr(t.senderPublicKey,or):void 0,r=typeof t.iv<"u"?Kr(t.iv,or):Na(Cl),s=Kr(t.symKey,or),i=gS(s,r).encrypt(Kr(t.message,Su)),o=zS({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===to?WS(o):o}function P7(t){const e=Kr(t.symKey,or),{sealed:n,iv:r}=su({encoded:t.encoded,encoding:t.encoding}),s=gS(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return Er(s,Su)}function x7(t,e){const n=jS(Tu),r=Na(Cl),s=Kr(t,Su),i=zS({type:n,sealed:s,iv:r});return e===to?WS(i):i}function k7(t,e){const{sealed:n}=su({encoded:t,encoding:e});return Er(n,Su)}function zS(t){if(ma(t.type)===Tu)return Er(_l([t.type,t.sealed]),yr);if(ma(t.type)===pi){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Er(_l([t.type,t.senderPublicKey,t.iv,t.sealed]),yr)}return Er(_l([t.type,t.iv,t.sealed]),yr)}function su(t){const e=(t.encoding||yr)===to?HS(t.encoded):t.encoded,n=Kr(e,yr),r=n.slice(T7,Xb),s=Xb;if(ma(r)===pi){const c=s+Ty,l=c+Cl,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(ma(r)===Tu){const c=n.slice(s),l=Na(Cl);return{type:r,sealed:c,iv:l}}const i=s+Cl,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function D7(t,e){const n=su({encoded:t,encoding:e?.encoding});return qS({type:ma(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Er(n.senderPublicKey,or):void 0,receiverPublicKey:e?.receiverPublicKey})}function qS(t){const e=t?.type||FS;if(e===pi){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Qb(t){return t.type===pi&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function e0(t){return t.type===Tu}function U7(t){const e=lt.Buffer.from(t.x,"base64"),n=lt.Buffer.from(t.y,"base64");return _l([new Uint8Array([4]),e,n])}function M7(t,e){const[n,r,s]=t.split("."),i=lt.Buffer.from(HS(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=df(c),u=U7(e);if(!S7.verify(_l([o,a]),l,u))throw new Error("Invalid signature");return Kg(t).payload}const L7="irn";function Oh(t){return t?.relay||{protocol:L7}}function tc(t){const e=lF[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var $7=Object.defineProperty,B7=Object.defineProperties,F7=Object.getOwnPropertyDescriptors,t0=Object.getOwnPropertySymbols,j7=Object.prototype.hasOwnProperty,W7=Object.prototype.propertyIsEnumerable,n0=(t,e,n)=>e in t?$7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$p=(t,e)=>{for(var n in e||(e={}))j7.call(e,n)&&n0(t,n,e[n]);if(t0)for(var n of t0(e))W7.call(e,n)&&n0(t,n,e[n]);return t},H7=(t,e)=>B7(t,F7(e));function z7(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function r0(t){if(!t.includes("wc:")){const l=GI(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:q7(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:z7(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function q7(t){return t.startsWith("//")?t.substring(2):t}function V7(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function s0(t){const e=new URLSearchParams,n=$p($p(H7($p({},V7(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(n).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!==void 0&&e.append(r,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function gd(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var K7=Object.defineProperty,G7=Object.defineProperties,Y7=Object.getOwnPropertyDescriptors,i0=Object.getOwnPropertySymbols,J7=Object.prototype.hasOwnProperty,Z7=Object.prototype.propertyIsEnumerable,o0=(t,e,n)=>e in t?K7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X7=(t,e)=>{for(var n in e||(e={}))J7.call(e,n)&&o0(t,n,e[n]);if(i0)for(var n of i0(e))Z7.call(e,n)&&o0(t,n,e[n]);return t},Q7=(t,e)=>G7(t,Y7(e));function Uc(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function VS(t){const e=[];return Object.values(t).forEach(n=>{e.push(...Uc(n.accounts))}),[...new Set(e)]}function eW(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.methods)}),[...new Set(e)]}function tW(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.events)}),[...new Set(e)]}function nW(t,e){const n=[];return Object.values(t).forEach(r=>{Uc(r.accounts).includes(e)&&n.push(...r.methods)}),n}function rW(t,e){const n=[];return Object.values(t).forEach(r=>{Uc(r.accounts).includes(e)&&n.push(...r.events)}),n}function pf(t){return t.includes(":")}function nc(t){return pf(t)?t.split(":")[0]:t}function a0(t){var e,n,r;const s={};if(!$s(t))return s;for(const[i,o]of Object.entries(t)){const a=pf(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=nc(i);s[u]=Q7(X7({},s[u]),{chains:Ls(a,(e=s[u])==null?void 0:e.chains),methods:Ls(c,(n=s[u])==null?void 0:n.methods),events:Ls(l,(r=s[u])==null?void 0:r.events)})}return s}function sW(t){const e={};return t?.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function c0(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=sW(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=Ls(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function iW(t,e){var n,r,s,i,o,a;const c=a0(t),l=a0(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Ls((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:Ls((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Ls((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const oW={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},aW={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function me(t,e){const{message:n,code:r}=aW[t];return{message:e?`${n} ${e}`:n,code:r}}function Ht(t,e){const{message:n,code:r}=oW[t];return{message:e?`${n} ${e}`:n,code:r}}function gi(t,e){return!!Array.isArray(t)}function $s(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function vn(t){return typeof t>"u"}function cn(t,e){return e&&vn(t)?!0:typeof t=="string"&&!!t.trim().length}function Ny(t,e){return typeof t=="number"&&!isNaN(t)}function cW(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Jo(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=Uc(a),d=n[o];(!Jo(HI(o,d),u)||!Jo(d.methods,c)||!Jo(d.events,l))&&(i=!1)}),i):!1}function Rh(t){return cn(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function lW(t){if(cn(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&Rh(n)}}return!1}function uW(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(cn(t,!1)){if(e(t))return!0;const n=GI(t);return e(n)}}catch{}return!1}function dW(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function hW(t){return t?.topic}function fW(t,e){let n=null;return cn(t?.publicKey,!1)||(n=me("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function l0(t){let e=!0;return gi(t)?t.length&&(e=t.every(n=>cn(n,!1))):e=!1,e}function pW(t,e,n){let r=null;return gi(e)&&e.length?e.forEach(s=>{r||Rh(s)||(r=Ht("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Rh(t)||(r=Ht("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function gW(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=pW(s,HI(s,i),`${e} ${n}`);o&&(r=o)}),r}function mW(t,e){let n=null;return gi(t)?t.forEach(r=>{n||lW(r)||(n=Ht("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=Ht("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function yW(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=mW(r?.accounts,`${e} namespace`);s&&(n=s)}),n}function wW(t,e){let n=null;return l0(t?.methods)?l0(t?.events)||(n=Ht("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=Ht("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function KS(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=wW(r,`${e}, namespace`);s&&(n=s)}),n}function EW(t,e,n){let r=null;if(t&&$s(t)){const s=KS(t,e);s&&(r=s);const i=gW(t,e,n);i&&(r=i)}else r=me("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Bp(t,e){let n=null;if(t&&$s(t)){const r=KS(t,e);r&&(n=r);const s=yW(t,e);s&&(n=s)}else n=me("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function GS(t){return cn(t.protocol,!0)}function bW(t,e){let n=!1;return t?t&&gi(t)&&t.length&&t.forEach(r=>{n=GS(r)}):n=!0,n}function vW(t){return typeof t=="number"}function fr(t){return typeof t<"u"&&typeof t!==null}function _W(t){return!(!t||typeof t!="object"||!t.code||!Ny(t.code)||!t.message||!cn(t.message,!1))}function CW(t){return!(vn(t)||!cn(t.method,!1))}function AW(t){return!(vn(t)||vn(t.result)&&vn(t.error)||!Ny(t.id)||!cn(t.jsonrpc,!1))}function IW(t){return!(vn(t)||!cn(t.name,!1))}function u0(t,e){return!(!Rh(e)||!VS(t).includes(e))}function SW(t,e,n){return cn(n,!1)?nW(t,e).includes(n):!1}function TW(t,e,n){return cn(n,!1)?rW(t,e).includes(n):!1}function d0(t,e,n){let r=null;const s=NW(t),i=OW(e),o=Object.keys(s),a=Object.keys(i),c=h0(Object.keys(t)),l=h0(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=me("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Jo(o,a)||(r=me("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=Uc(e[d].accounts);h.includes(d)||(r=me("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Jo(s[d].methods,i[d].methods)?Jo(s[d].events,i[d].events)||(r=me("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=me("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function NW(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function h0(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function OW(t){const e={};return Object.keys(t).forEach(n=>{n.includes(":")?e[n]=t[n]:Uc(t[n].accounts)?.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}),e}function RW(t,e){return Ny(t)&&t<=e.max&&t>=e.min}function f0(){const t=Cu();return new Promise(e=>{switch(t){case Ur.browser:e(PW());break;case Ur.reactNative:e(xW());break;case Ur.node:e(kW());break;default:e(!0)}})}function PW(){return Dc()&&navigator?.onLine}async function xW(){return Io()&&typeof $e<"u"&&$e!=null&&$e.NetInfo?(await($e==null?void 0:$e.NetInfo.fetch()))?.isConnected:!0}function kW(){return!0}function DW(t){switch(Cu()){case Ur.browser:UW(t);break;case Ur.reactNative:MW(t);break}}function UW(t){!Io()&&Dc()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function MW(t){Io()&&typeof $e<"u"&&$e!=null&&$e.NetInfo&&$e?.NetInfo.addEventListener(e=>t(e?.isConnected))}function LW(){var t;return Dc()&&pa()?((t=pa())==null?void 0:t.visibilityState)==="visible":!0}const Fp={};class tl{static get(e){return Fp[e]}static set(e,n){Fp[e]=n}static delete(e){delete Fp[e]}}function $W(t){const e=Nc.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function BW({publicKey:t,signature:e,payload:n}){var r;const s=um(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=WW(n.address),a=n.era==="00"?new Uint8Array([0]):um(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${jW(n.tip)}`),d=zW(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),f=HW(h.length+1);return new Uint8Array([...f,i,...h])}function FW(t){const e=um(t),n=vF.blake2b(e,void 0,32);return"0x"+lt.Buffer.from(n).toString("hex")}function um(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function jW(t){return t.startsWith("0x")?t.slice(2):t}function WW(t){const e=Nc.decode(t)[0];return e===42?0:e===60?2:1}function HW(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function zW(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function qW(t){const e=Uint8Array.from(lt.Buffer.from(t.signature,"hex")),n=$W(t.transaction.address),r=BW({publicKey:n,signature:e,payload:t.transaction}),s=lt.Buffer.from(r).toString("hex");return FW(s)}function Oy({logger:t,name:e}){const n=typeof t=="string"?Xh({opts:{level:t,name:e}}).logger:t;return n.level=typeof t=="string"?t:t.level,n}const VW="PARSE_ERROR",KW="INVALID_REQUEST",GW="METHOD_NOT_FOUND",YW="INVALID_PARAMS",YS="INTERNAL_ERROR",Ry="SERVER_ERROR",JW=[-32700,-32600,-32601,-32602,-32603],Al={[VW]:{code:-32700,message:"Parse error"},[KW]:{code:-32600,message:"Invalid Request"},[GW]:{code:-32601,message:"Method not found"},[YW]:{code:-32602,message:"Invalid params"},[YS]:{code:-32603,message:"Internal error"},[Ry]:{code:-32e3,message:"Server error"}},JS=Ry;function ZW(t){return JW.includes(t)}function p0(t){return Object.keys(Al).includes(t)?Al[t]:Al[JS]}function XW(t){const e=Object.values(Al).find(n=>n.code===t);return e||Al[JS]}function ZS(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var XS={},Js={},g0;function QW(){if(g0)return Js;g0=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.isBrowserCryptoAvailable=Js.getSubtleCrypto=Js.getBrowerCrypto=void 0;function t(){return(it===null||it===void 0?void 0:it.crypto)||(it===null||it===void 0?void 0:it.msCrypto)||{}}Js.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Js.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Js.isBrowserCryptoAvailable=n,Js}var Zs={},m0;function eH(){if(m0)return Zs;m0=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.isBrowser=Zs.isNode=Zs.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Zs.isReactNative=t;function e(){return typeof Ft<"u"&&typeof Ft.versions<"u"&&typeof Ft.versions.node<"u"}Zs.isNode=e;function n(){return!t()&&!e()}return Zs.isBrowser=n,Zs}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Eu;e.__exportStar(QW(),t),e.__exportStar(eH(),t)})(XS);function Os(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function oo(t=6){return BigInt(Os(t))}function ls(t,e,n){return{id:n||Os(),jsonrpc:"2.0",method:t,params:e}}function iu(t,e){return{id:t,jsonrpc:"2.0",result:e}}function gf(t,e,n){return{id:t,jsonrpc:"2.0",error:tH(e)}}function tH(t,e){return typeof t>"u"?p0(YS):(typeof t=="string"&&(t=Object.assign(Object.assign({},p0(Ry)),{message:t})),ZW(t.code)&&(t=XW(t.code)),t)}let nH=class{},rH=class extends nH{constructor(){super()}},sH=class extends rH{constructor(e){super()}};const iH="^https?:",oH="^wss?:";function aH(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function QS(t,e){const n=aH(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function y0(t){return QS(t,iH)}function w0(t){return QS(t,oH)}function cH(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function eT(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Py(t){return eT(t)&&"method"in t}function mf(t){return eT(t)&&(Rs(t)||qr(t))}function Rs(t){return"result"in t}function qr(t){return"error"in t}let xy=class extends sH{constructor(e){super(e),this.events=new Jr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(ls(e.method,e.params||[],e.id||oo().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{qr(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),mf(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const lH=()=>typeof WebSocket<"u"?WebSocket:typeof $e<"u"&&typeof $e.WebSocket<"u"?$e.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),uH=()=>typeof WebSocket<"u"||typeof $e<"u"&&typeof $e.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",E0=t=>t.split("?")[0],b0=10,dH=lH();let hH=class{constructor(e){if(this.url=e,this.events=new Jr.EventEmitter,this.registering=!1,!w0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(wi(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!w0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=XS.isReactNative()?void 0:{rejectUnauthorized:!cH(e)},i=new dH(e,[],s);uH()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?ha(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=gf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return ZS(e,E0(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>b0&&this.events.setMaxListeners(b0)}emitError(e){const n=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${E0(this.url)}`));return this.events.emit("register_error",n),n}};var fH={};const tT="wc",nT=2,dm="core",Ws=`${tT}@2:${dm}:`,pH={logger:"error"},gH={database:":memory:"},mH="crypto",v0="client_ed25519_seed",yH=ge.ONE_DAY,wH="keychain",EH="0.3",bH="messages",vH="0.3",_H=ge.SIX_HOURS,CH="publisher",rT="irn",AH="error",sT="wss://relay.walletconnect.org",IH="relayer",an={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},SH="_subscription",$r={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},TH=.1,hm="2.23.0",Bt={link_mode:"link_mode",relay:"relay"},zd={inbound:"inbound",outbound:"outbound"},NH="0.3",OH="WALLETCONNECT_CLIENT_ID",_0="WALLETCONNECT_LINK_MODE_APPS",Tr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},RH="subscription",PH="0.3",xH="pairing",kH="0.3",nl={wc_pairingDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:0},res:{ttl:ge.ONE_DAY,prompt:!1,tag:0}}},Ko={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},DH="history",UH="0.3",MH="expirer",Hr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},LH="0.3",$H="verify-api",BH="https://verify.walletconnect.com",iT="https://verify.walletconnect.org",Il=iT,FH=`${Il}/v3`,jH=[BH,iT],WH="echo",HH="https://echo.walletconnect.com",Ns={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ni={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},es={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Mo={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Lo={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},rl={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},zH=.1,qH="event-client",VH=86400,KH="https://pulse.walletconnect.org/batch";function GH(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,g=0,T=0,N=p.length;T!==N&&p[T]===0;)T++,m++;for(var _=(N-T)*u+1>>>0,O=new Uint8Array(_);T!==N;){for(var A=p[T],x=0,k=_-1;(A!==0||x<g)&&k!==-1;k--,x++)A+=256*O[k]>>>0,O[k]=A%a>>>0,A=A/a>>>0;if(A!==0)throw new Error("Non-zero carry");g=x,T++}for(var L=_-g;L!==_&&O[L]===0;)L++;for(var M=c.repeat(m);L<_;++L)M+=t.charAt(O[L]);return M}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var g=0,T=0;p[m]===c;)g++,m++;for(var N=(p.length-m)*l+1>>>0,_=new Uint8Array(N);p[m];){var O=n[p.charCodeAt(m)];if(O===255)return;for(var A=0,x=N-1;(O!==0||A<T)&&x!==-1;x--,A++)O+=a*_[x]>>>0,_[x]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");T=A,m++}if(p[m]!==" "){for(var k=N-T;k!==N&&_[k]===0;)k++;for(var L=new Uint8Array(g+(N-k)),M=g;k!==N;)L[M++]=_[k++];return L}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var YH=GH,JH=YH;const oT=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ZH=t=>new TextEncoder().encode(t),XH=t=>new TextDecoder().decode(t);class QH{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ez{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return aT(this,e)}}class tz{constructor(e){this.decoders=e}or(e){return aT(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const aT=(t,e)=>new tz({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class nz{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new QH(e,n,r),this.decoder=new ez(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yf=({name:t,prefix:e,encode:n,decode:r})=>new nz(t,e,n,r),Nu=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=JH(n,e);return yf({prefix:t,name:e,encode:r,decode:i=>oT(s(i))})},rz=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},sz=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ln=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>yf({prefix:e,name:t,encode(s){return sz(s,r,n)},decode(s){return rz(s,r,n,t)}}),iz=yf({prefix:"\0",name:"identity",encode:t=>XH(t),decode:t=>ZH(t)});var oz=Object.freeze({__proto__:null,identity:iz});const az=Ln({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cz=Object.freeze({__proto__:null,base2:az});const lz=Ln({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var uz=Object.freeze({__proto__:null,base8:lz});const dz=Nu({prefix:"9",name:"base10",alphabet:"0123456789"});var hz=Object.freeze({__proto__:null,base10:dz});const fz=Ln({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pz=Ln({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var gz=Object.freeze({__proto__:null,base16:fz,base16upper:pz});const mz=Ln({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yz=Ln({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wz=Ln({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ez=Ln({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bz=Ln({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vz=Ln({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_z=Ln({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cz=Ln({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Az=Ln({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Iz=Object.freeze({__proto__:null,base32:mz,base32upper:yz,base32pad:wz,base32padupper:Ez,base32hex:bz,base32hexupper:vz,base32hexpad:_z,base32hexpadupper:Cz,base32z:Az});const Sz=Nu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tz=Nu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nz=Object.freeze({__proto__:null,base36:Sz,base36upper:Tz});const Oz=Nu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Rz=Nu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Pz=Object.freeze({__proto__:null,base58btc:Oz,base58flickr:Rz});const xz=Ln({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kz=Ln({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Dz=Ln({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Uz=Ln({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Mz=Object.freeze({__proto__:null,base64:xz,base64pad:kz,base64url:Dz,base64urlpad:Uz});const cT=Array.from(""),Lz=cT.reduce((t,e,n)=>(t[n]=e,t),[]),$z=cT.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Bz(t){return t.reduce((e,n)=>(e+=Lz[n],e),"")}function Fz(t){const e=[];for(const n of t){const r=$z[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const jz=yf({prefix:"",name:"base256emoji",encode:Bz,decode:Fz});var Wz=Object.freeze({__proto__:null,base256emoji:jz}),Hz=lT,C0=128,zz=-128,qz=Math.pow(2,31);function lT(t,e,n){e=e||[],n=n||0;for(var r=n;t>=qz;)e[n++]=t&255|C0,t/=128;for(;t&zz;)e[n++]=t&255|C0,t>>>=7;return e[n]=t|0,lT.bytes=n-r+1,e}var Vz=fm,Kz=128,A0=127;function fm(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw fm.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&A0)<<s:(o&A0)*Math.pow(2,s),s+=7}while(o>=Kz);return fm.bytes=i-r,n}var Gz=Math.pow(2,7),Yz=Math.pow(2,14),Jz=Math.pow(2,21),Zz=Math.pow(2,28),Xz=Math.pow(2,35),Qz=Math.pow(2,42),eq=Math.pow(2,49),tq=Math.pow(2,56),nq=Math.pow(2,63),rq=function(t){return t<Gz?1:t<Yz?2:t<Jz?3:t<Zz?4:t<Xz?5:t<Qz?6:t<eq?7:t<tq?8:t<nq?9:10},sq={encode:Hz,decode:Vz,encodingLength:rq},uT=sq;const I0=(t,e,n=0)=>(uT.encode(t,e,n),e),S0=t=>uT.encodingLength(t),pm=(t,e)=>{const n=e.byteLength,r=S0(t),s=r+S0(n),i=new Uint8Array(s+n);return I0(t,i,0),I0(n,i,r),i.set(e,s),new iq(t,n,e,i)};class iq{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const dT=({name:t,code:e,encode:n})=>new oq(t,e,n);class oq{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?pm(this.code,n):n.then(r=>pm(this.code,r))}else throw Error("Unknown type, must be binary type")}}const hT=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),aq=dT({name:"sha2-256",code:18,encode:hT("SHA-256")}),cq=dT({name:"sha2-512",code:19,encode:hT("SHA-512")});var lq=Object.freeze({__proto__:null,sha256:aq,sha512:cq});const fT=0,uq="identity",pT=oT,dq=t=>pm(fT,pT(t)),hq={code:fT,name:uq,encode:pT,digest:dq};var fq=Object.freeze({__proto__:null,identity:hq});new TextEncoder,new TextDecoder;const T0={...oz,...cz,...uz,...hz,...gz,...Iz,...Nz,...Pz,...Mz,...Wz};({...lq,...fq});function gT(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function pq(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gT(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function mT(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const N0=mT("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),jp=mT("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=pq(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),gq={utf8:N0,"utf-8":N0,hex:T0.base16,latin1:jp,ascii:jp,binary:jp,...T0};function mq(t,e="utf8"){const n=gq[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gT(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var yq=Object.defineProperty,wq=(t,e,n)=>e in t?yq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Is=(t,e,n)=>wq(t,typeof e!="symbol"?e+"":e,n);class Eq{constructor(e,n){this.core=e,this.logger=n,Is(this,"keychain",new Map),Is(this,"name",wH),Is(this,"version",EH),Is(this,"initialized",!1),Is(this,"storagePrefix",Ws),Is(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Is(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Is(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),Is(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=me("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),Is(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=vr(n,this.name)}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Zg(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xg(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var bq=Object.defineProperty,vq=(t,e,n)=>e in t?bq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gn=(t,e,n)=>vq(t,typeof e!="symbol"?e+"":e,n);class _q{constructor(e,n,r){this.core=e,this.logger=n,gn(this,"name",mH),gn(this,"keychain"),gn(this,"randomSessionIdentifier",lm()),gn(this,"initialized",!1),gn(this,"clientId"),gn(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),gn(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),gn(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=rb(s),o=iI(i.publicKey);return this.clientId=o,o}),gn(this,"generateKeyPair",()=>{this.isInitialized();const s=N7();return this.setPrivateKey(s.publicKey,s.privateKey)}),gn(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=rb(i),a=this.randomSessionIdentifier;return await h4(a,s,yH,o)}),gn(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=O7(a,i);return this.setSymKey(c,o)}),gn(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Hd(s);return await this.keychain.set(o,s),o}),gn(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),gn(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),gn(this,"encode",async(s,i,o)=>{this.isInitialized();const a=qS(o),c=wi(i);if(e0(a))return x7(c,o?.encoding);if(Qb(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return R7({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),gn(this,"decode",async(s,i,o)=>{this.isInitialized();const a=D7(i,o);if(e0(a)){const c=k7(i,o?.encoding);return ha(c)}if(Qb(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=P7({symKey:c,encoded:i,encoding:o?.encoding});return ha(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),gn(this,"getPayloadType",(s,i=yr)=>{const o=su({encoded:s,encoding:i});return ma(o.type)}),gn(this,"getPayloadSenderPublicKey",(s,i=yr)=>{const o=su({encoded:s,encoding:i});return o.senderPublicKey?Er(o.senderPublicKey,or):void 0}),this.core=e,this.logger=vr(n,this.name),this.keychain=r||new Eq(this.core,this.logger)}get context(){return br(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(v0)}catch{e=lm(),await this.keychain.set(v0,e)}return mq(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Cq=Object.defineProperty,Aq=Object.defineProperties,Iq=Object.getOwnPropertyDescriptors,O0=Object.getOwnPropertySymbols,Sq=Object.prototype.hasOwnProperty,Tq=Object.prototype.propertyIsEnumerable,gm=(t,e,n)=>e in t?Cq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nq=(t,e)=>{for(var n in e||(e={}))Sq.call(e,n)&&gm(t,n,e[n]);if(O0)for(var n of O0(e))Tq.call(e,n)&&gm(t,n,e[n]);return t},Oq=(t,e)=>Aq(t,Iq(e)),Ar=(t,e,n)=>gm(t,typeof e!="symbol"?e+"":e,n);class Rq extends u${constructor(e,n){super(e,n),this.logger=e,this.core=n,Ar(this,"messages",new Map),Ar(this,"messagesWithoutClientAck",new Map),Ar(this,"name",bH),Ar(this,"version",vH),Ar(this,"initialized",!1),Ar(this,"storagePrefix",Ws),Ar(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Ar(this,"set",async(r,s,i)=>{this.isInitialized();const o=zr(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===zd.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,Oq(Nq({},c),{[o]:s}))}return await this.persist(),o}),Ar(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Ar(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Ar(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=zr(s);return typeof i[o]<"u"}),Ar(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=zr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Ar(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=vr(e,this.name),this.core=n}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Zg(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Zg(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xg(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Xg(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Pq=Object.defineProperty,xq=Object.defineProperties,kq=Object.getOwnPropertyDescriptors,R0=Object.getOwnPropertySymbols,Dq=Object.prototype.hasOwnProperty,Uq=Object.prototype.propertyIsEnumerable,mm=(t,e,n)=>e in t?Pq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wa=(t,e)=>{for(var n in e||(e={}))Dq.call(e,n)&&mm(t,n,e[n]);if(R0)for(var n of R0(e))Uq.call(e,n)&&mm(t,n,e[n]);return t},P0=(t,e)=>xq(t,kq(e)),Br=(t,e,n)=>mm(t,typeof e!="symbol"?e+"":e,n);class Mq extends d${constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Br(this,"events",new Jr.EventEmitter),Br(this,"name",CH),Br(this,"queue",new Map),Br(this,"publishTimeout",ge.toMiliseconds(ge.ONE_MINUTE)),Br(this,"initialPublishTimeout",ge.toMiliseconds(ge.ONE_SECOND*15)),Br(this,"needsTransportRestart",!1),Br(this,"publish",async(r,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const d=i?.ttl||_H,h=i?.prompt||!1,f=i?.tag||0,p=i?.id||oo().toString(),m=tc(Oh().protocol),g={id:p,method:i?.publishMethod||m.publish,params:Wa({topic:r,message:s,ttl:d,prompt:h,tag:f,attestation:i?.attestation},i?.tvf)},T=`Failed to publish payload, please try again. id:${p} tag:${f}`;try{vn((o=g.params)==null?void 0:o.prompt)&&((a=g.params)==null||delete a.prompt),vn((c=g.params)==null?void 0:c.tag)&&((l=g.params)==null||delete l.tag);const N=new Promise(async _=>{const O=({id:x})=>{var k;((k=g.id)==null?void 0:k.toString())===x.toString()&&(this.removeRequestFromQueue(x),this.relayer.events.removeListener(an.publish,O),_())};this.relayer.events.on(an.publish,O);const A=Ds(new Promise((x,k)=>{this.rpcPublish(g,i).then(x).catch(L=>{this.logger.warn(L,L?.message),k(L)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${f}`);try{await A,this.events.removeListener(an.publish,O)}catch(x){this.queue.set(p,{request:g,opts:i,attempt:1}),this.logger.warn(x,x?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:s,opts:i}}),await Ds(N,this.publishTimeout,T)}catch(N){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(N),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw N}finally{this.queue.delete(p)}}),Br(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:l,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:f,prompt:p,tag:m,ttl:g=ge.FIVE_MINUTES}=u,T=u.id||oo().toString(),N=tc(Oh().protocol),_=f||N.publish,O={id:T,method:_,params:Wa(P0(Wa({},l),{ttl:g,prompt:p,tag:m,attestation:d}),h)},A=`Failed to publish custom payload, please try again. id:${T} tag:${m}`;try{vn((s=O.params)==null?void 0:s.prompt)&&((i=O.params)==null||delete i.prompt),vn((o=O.params)==null?void 0:o.tag)&&((a=O.params)==null||delete a.tag);const x=new Promise(async k=>{const L=({id:z})=>{var J;((J=O.id)==null?void 0:J.toString())===z.toString()&&(this.removeRequestFromQueue(z),this.relayer.events.removeListener(an.publish,L),k())};this.relayer.events.on(an.publish,L);const M=Ds(new Promise((z,J)=>{this.rpcPublish(O,u).then(z).catch(H=>{this.logger.warn(H,H?.message),J(H)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${_} id:${T} tag:${m}`);try{await M,this.events.removeListener(an.publish,L)}catch(z){this.queue.set(T,{request:O,opts:u,attempt:1}),this.logger.warn(z,z?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:T,payload:l,opts:u}}),await Ds(x,this.publishTimeout,A)}catch(x){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(x),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw x}finally{this.queue.delete(T)}}),Br(this,"on",(r,s)=>{this.events.on(r,s)}),Br(this,"once",(r,s)=>{this.events.once(r,s)}),Br(this,"off",(r,s)=>{this.events.off(r,s)}),Br(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=vr(n,this.name),this.registerEventListeners()}get context(){return br(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(an.publish,Wa(Wa({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,P0(Wa({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ia.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(an.connection_stalled);return}this.checkQueue()}),this.relayer.on(an.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Lq=Object.defineProperty,$q=(t,e,n)=>e in t?Lq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ha=(t,e,n)=>$q(t,typeof e!="symbol"?e+"":e,n);class Bq{constructor(){Ha(this,"map",new Map),Ha(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),Ha(this,"get",e=>this.map.get(e)||[]),Ha(this,"exists",(e,n)=>this.get(e).includes(n)),Ha(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Ha(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Fq=Object.defineProperty,jq=Object.defineProperties,Wq=Object.getOwnPropertyDescriptors,x0=Object.getOwnPropertySymbols,Hq=Object.prototype.hasOwnProperty,zq=Object.prototype.propertyIsEnumerable,ym=(t,e,n)=>e in t?Fq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sl=(t,e)=>{for(var n in e||(e={}))Hq.call(e,n)&&ym(t,n,e[n]);if(x0)for(var n of x0(e))zq.call(e,n)&&ym(t,n,e[n]);return t},Wp=(t,e)=>jq(t,Wq(e)),xt=(t,e,n)=>ym(t,typeof e!="symbol"?e+"":e,n);class qq extends p${constructor(e,n){super(e,n),this.relayer=e,this.logger=n,xt(this,"subscriptions",new Map),xt(this,"topicMap",new Bq),xt(this,"events",new Jr.EventEmitter),xt(this,"name",RH),xt(this,"version",PH),xt(this,"pending",new Map),xt(this,"cached",[]),xt(this,"initialized",!1),xt(this,"storagePrefix",Ws),xt(this,"subscribeTimeout",ge.toMiliseconds(ge.ONE_MINUTE)),xt(this,"initialSubscribeTimeout",ge.toMiliseconds(ge.ONE_SECOND*15)),xt(this,"clientId"),xt(this,"batchSubscribeTopicsLimit",500),xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),xt(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=Oh(s),a={topic:r,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),xt(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),xt(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),xt(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),xt(this,"on",(r,s)=>{this.events.on(r,s)}),xt(this,"once",(r,s)=>{this.events.once(r,s)}),xt(this,"off",(r,s)=>{this.events.off(r,s)}),xt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),xt(this,"start",async()=>{await this.onConnect()}),xt(this,"stop",async()=>{await this.onDisconnect()}),xt(this,"restart",async()=>{await this.restore(),await this.onRestart()}),xt(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),xt(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Ia.pulse,async()=>{await this.checkPending()}),this.events.on(Tr.created,async r=>{const s=Tr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Tr.deleted,async r=>{const s=Tr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=vr(n,this.name),this.clientId=""}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=Oh(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=Ht("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r?.internal)!=null&&s.skipSubscribe)return o;(!r||r?.transportType===Bt.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:tc(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r?.internal)==null?void 0:i.throwOnFailedPublish;try{if(r?.transportType===Bt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},ge.toMiliseconds(ge.ONE_SECOND)),o;const l=new Promise(async d=>{const h=f=>{f.topic===e&&(this.events.removeListener(Tr.created,h),d(f.id))};this.events.on(Tr.created,h);try{const f=await Ds(new Promise((p,m)=>{this.relayer.request(a).catch(g=>{this.logger.warn(g,g?.message),m(g)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Tr.created,h),d(f)}catch{}}),u=await Ds(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(an.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:tc(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Ds(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(an.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:tc(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await Ds(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(an.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:tc(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,Wp(sl({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,sl({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,sl({},n)),this.topicMap.set(n.topic,e),this.events.emit(Tr.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Tr.deleted,Wp(sl({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Tr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Tr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>Wp(sl({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await GF(ge.toMiliseconds(ge.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return zr(e+await this.getClientId())}}var Vq=Object.defineProperty,k0=Object.getOwnPropertySymbols,Kq=Object.prototype.hasOwnProperty,Gq=Object.prototype.propertyIsEnumerable,wm=(t,e,n)=>e in t?Vq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D0=(t,e)=>{for(var n in e||(e={}))Kq.call(e,n)&&wm(t,n,e[n]);if(k0)for(var n of k0(e))Gq.call(e,n)&&wm(t,n,e[n]);return t},Et=(t,e,n)=>wm(t,typeof e!="symbol"?e+"":e,n);class Yq extends h${constructor(e){var n;super(e),Et(this,"protocol","wc"),Et(this,"version",2),Et(this,"core"),Et(this,"logger"),Et(this,"events",new Jr.EventEmitter),Et(this,"provider"),Et(this,"messages"),Et(this,"subscriber"),Et(this,"publisher"),Et(this,"name",IH),Et(this,"transportExplicitlyClosed",!1),Et(this,"initialized",!1),Et(this,"connectionAttemptInProgress",!1),Et(this,"relayUrl"),Et(this,"projectId"),Et(this,"packageName"),Et(this,"bundleId"),Et(this,"hasExperiencedNetworkDisruption",!1),Et(this,"pingTimeout"),Et(this,"heartBeatTimeout",ge.toMiliseconds(ge.THIRTY_SECONDS+ge.FIVE_SECONDS)),Et(this,"reconnectTimeout"),Et(this,"connectPromise"),Et(this,"reconnectInProgress",!1),Et(this,"requestsInFlight",[]),Et(this,"connectTimeout",ge.toMiliseconds(ge.ONE_SECOND*15)),Et(this,"request",async r=>{var s,i;this.logger.debug("Publishing Request Payload");const o=r.id||oo().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(s=r.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),Et(this,"resetPingTimeout",()=>{Ch()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),Et(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Et(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(an.connect)}),Et(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Et(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(an.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Et(this,"registerProviderListeners",()=>{this.provider.on($r.payload,this.onPayloadHandler),this.provider.on($r.connect,this.onConnectHandler),this.provider.on($r.disconnect,this.onDisconnectHandler),this.provider.on($r.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=Oy({logger:(n=e.logger)!=null?n:AH,name:this.name}),this.messages=new Rq(this.logger,e.core),this.subscriber=new qq(this,this.logger),this.publisher=new Mq(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||sT,xF()?this.packageName=vb():kF()&&(this.bundleId=vb()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return br(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:Bt.relay},zd.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Tr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Tr.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,D0({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Ds(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await f0())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=sn(ge.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(an.message,e),await this.recordMessageEvent(e,zd.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once($r.disconnect,i),await Ds(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off($r.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once($r.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off($r.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,ge.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(Ch())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new xy(new hH($F({sdkVersion:hm,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Py(e)){if(!e.method.endsWith(SH))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Bt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(D0({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else mf(e)&&this.events.emit(an.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,zd.inbound),this.events.emit(an.message,e))}async acknowledgePayload(e){const n=iu(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off($r.payload,this.onPayloadHandler),this.provider.off($r.connect,this.onConnectHandler),this.provider.off($r.disconnect,this.onDisconnectHandler),this.provider.off($r.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await f0();DW(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Ia.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&LW())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(an.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},ge.toMiliseconds(TH)))))}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Jq(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function U0(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function M0(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Zq="[object RegExp]",Xq="[object String]",Qq="[object Number]",eV="[object Boolean]",L0="[object Arguments]",tV="[object Symbol]",nV="[object Date]",rV="[object Map]",sV="[object Set]",iV="[object Array]",oV="[object Function]",aV="[object ArrayBuffer]",Hp="[object Object]",cV="[object Error]",lV="[object DataView]",uV="[object Uint8Array]",dV="[object Uint8ClampedArray]",hV="[object Uint16Array]",fV="[object Uint32Array]",pV="[object BigUint64Array]",gV="[object Int8Array]",mV="[object Int16Array]",yV="[object Int32Array]",wV="[object BigInt64Array]",EV="[object Float32Array]",bV="[object Float64Array]";function vV(){}function $0(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function _V(t,e,n){return El(t,e,void 0,void 0,void 0,void 0,n)}function El(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Sl(t,e,i,o)}return Sl(t,e,i,o)}function Sl(t,e,n,r){if(Object.is(t,e))return!0;let s=M0(t),i=M0(e);if(s===L0&&(s=Hp),i===L0&&(i=Hp),s!==i)return!1;switch(s){case Xq:return t.toString()===e.toString();case Qq:{const c=t.valueOf(),l=e.valueOf();return Jq(c,l)}case eV:case nV:case tV:return Object.is(t.valueOf(),e.valueOf());case Zq:return t.source===e.source&&t.flags===e.flags;case oV:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case rV:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!El(l,e.get(c),c,t,e,n,r))return!1;return!0}case sV:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(f=>El(d,f,void 0,t,e,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case iV:case uV:case dV:case hV:case fV:case pV:case gV:case mV:case yV:case wV:case EV:case bV:{if(typeof lt.Buffer<"u"&&lt.Buffer.isBuffer(t)!==lt.Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!El(t[c],e[c],c,t,e,n,r))return!1;return!0}case aV:return t.byteLength!==e.byteLength?!1:Sl(new Uint8Array(t),new Uint8Array(e),n,r);case lV:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Sl(new Uint8Array(t),new Uint8Array(e),n,r);case cV:return t.name===e.name&&t.message===e.message;case Hp:{if(!(Sl(t.constructor,e.constructor,n,r)||$0(t)&&$0(e)))return!1;const c=[...Object.keys(t),...U0(t)],l=[...Object.keys(e),...U0(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!El(h,f,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function CV(t,e){return _V(t,e,vV)}var AV=Object.defineProperty,B0=Object.getOwnPropertySymbols,IV=Object.prototype.hasOwnProperty,SV=Object.prototype.propertyIsEnumerable,Em=(t,e,n)=>e in t?AV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,F0=(t,e)=>{for(var n in e||(e={}))IV.call(e,n)&&Em(t,n,e[n]);if(B0)for(var n of B0(e))SV.call(e,n)&&Em(t,n,e[n]);return t},dr=(t,e,n)=>Em(t,typeof e!="symbol"?e+"":e,n);class Oa extends f${constructor(e,n,r,s=Ws,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,dr(this,"map",new Map),dr(this,"version",NH),dr(this,"cached",[]),dr(this,"initialized",!1),dr(this,"getKey"),dr(this,"storagePrefix",Ws),dr(this,"recentlyDeleted",[]),dr(this,"recentlyDeletedLimit",200),dr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!vn(o)?this.map.set(this.getKey(o),o):dW(o)?this.map.set(o.id,o):hW(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),dr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),dr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),dr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>CV(a[c],o[c]))):this.values)),dr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=F0(F0({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),dr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=vr(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=me("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var TV=Object.defineProperty,NV=(t,e,n)=>e in t?TV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ht=(t,e,n)=>NV(t,typeof e!="symbol"?e+"":e,n);class OV{constructor(e,n){this.core=e,this.logger=n,ht(this,"name",xH),ht(this,"version",kH),ht(this,"events",new ny),ht(this,"pairings"),ht(this,"initialized",!1),ht(this,"storagePrefix",Ws),ht(this,"ignoredPayloadTypes",[pi]),ht(this,"registeredMethods",[]),ht(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ht(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ht(this,"create",async r=>{this.isInitialized();const s=lm(),i=await this.core.crypto.setSymKey(s),o=sn(ge.FIVE_MINUTES),a={protocol:rT},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=s0({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(Ko.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType,internal:r?.internal}),{topic:i,uri:l}}),ht(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[Ns.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=r0(r.uri);s.props.properties.topic=i,s.addTrace(Ns.pairing_uri_validation_success),s.addTrace(Ns.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Ns.existing_pairing),u.active)throw s.setError(ni.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Ns.pairing_not_expired)}const d=c||sn(ge.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(Ns.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Ko.create,h),s.addTrace(Ns.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Ns.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(ni.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(ni.subscribe_pairing_topic_failure),f}return s.addTrace(Ns.subscribe_pairing_topic_success),h}),ht(this,"activate",async({topic:r})=>{this.isInitialized();const s=sn(ge.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),ht(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=zo();this.events.once(Tt("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ht(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),ht(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),ht(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ht(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Ht("USER_DISCONNECTED")),await this.deletePairing(s))}),ht(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return s0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ht(this,"sendRequest",async(r,s,i)=>{const o=ls(s,i),a=await this.core.crypto.encode(r,o),c=nl[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ht(this,"sendResult",async(r,s,i)=>{const o=iu(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=nl[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ht(this,"sendError",async(r,s,i)=>{const o=gf(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=nl[c]?nl[c].res:nl.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ht(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Ht("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),ht(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Ps(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),ht(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ht(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ht(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Ko.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ht(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Rs(s)?this.events.emit(Tt("pairing_ping",i),{}):qr(s)&&this.events.emit(Tt("pairing_ping",i),{error:s.error})},500)}),ht(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Ko.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ht(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Ht("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),ht(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Ht("WC_METHOD_UNSUPPORTED",r))}),ht(this,"isValidPair",(r,s)=>{var i;if(!fr(r)){const{message:a}=me("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(ni.malformed_pairing_uri),new Error(a)}if(!uW(r.uri)){const{message:a}=me("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(ni.malformed_pairing_uri),new Error(a)}const o=r0(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=me("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(ni.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=me("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(ni.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&ge.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(ni.pairing_expired);const{message:a}=me("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ht(this,"isValidPing",async r=>{if(!fr(r)){const{message:i}=me("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ht(this,"isValidDisconnect",async r=>{if(!fr(r)){const{message:i}=me("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ht(this,"isValidPairingTopic",async r=>{if(!cn(r,!1)){const{message:s}=me("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=me("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Ps(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=me("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=vr(n,this.name),this.pairings=new Oa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return br(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(an.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==Bt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Py(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):mf(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Hr.expired,async e=>{const{topic:n}=KI(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Ko.expire,{topic:n}))})}}var RV=Object.defineProperty,PV=(t,e,n)=>e in t?RV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Rn=(t,e,n)=>PV(t,typeof e!="symbol"?e+"":e,n);class xV extends l${constructor(e,n){super(e,n),this.core=e,this.logger=n,Rn(this,"records",new Map),Rn(this,"events",new Jr.EventEmitter),Rn(this,"name",DH),Rn(this,"version",UH),Rn(this,"cached",[]),Rn(this,"initialized",!1),Rn(this,"storagePrefix",Ws),Rn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Rn(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:sn(ge.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Qr.created,o)}),Rn(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=qr(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Qr.updated,s))}),Rn(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Rn(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Qr.deleted,i)}}),this.persist()}),Rn(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Rn(this,"on",(r,s)=>{this.events.on(r,s)}),Rn(this,"once",(r,s)=>{this.events.once(r,s)}),Rn(this,"off",(r,s)=>{this.events.off(r,s)}),Rn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=vr(n,this.name)}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:ls(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Qr.created,e=>{const n=Qr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Qr.updated,e=>{const n=Qr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Qr.deleted,e=>{const n=Qr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Ia.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{ge.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Qr.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var kV=Object.defineProperty,DV=(t,e,n)=>e in t?kV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qn=(t,e,n)=>DV(t,typeof e!="symbol"?e+"":e,n);class UV extends g${constructor(e,n){super(e,n),this.core=e,this.logger=n,qn(this,"expirations",new Map),qn(this,"events",new Jr.EventEmitter),qn(this,"name",MH),qn(this,"version",LH),qn(this,"cached",[]),qn(this,"initialized",!1),qn(this,"storagePrefix",Ws),qn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),qn(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),qn(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Hr.created,{target:i,expiration:o})}),qn(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),qn(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Hr.deleted,{target:s,expiration:i})}}),qn(this,"on",(r,s)=>{this.events.on(r,s)}),qn(this,"once",(r,s)=>{this.events.once(r,s)}),qn(this,"off",(r,s)=>{this.events.off(r,s)}),qn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=vr(n,this.name)}get context(){return br(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return BF(e);if(typeof e=="number")return FF(e);const{message:n}=me("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Hr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=me("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=me("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;ge.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(Hr.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Ia.pulse,()=>this.checkExpirations()),this.events.on(Hr.created,e=>{const n=Hr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Hr.expired,e=>{const n=Hr.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Hr.deleted,e=>{const n=Hr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}}var MV=Object.defineProperty,LV=(t,e,n)=>e in t?MV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rn=(t,e,n)=>LV(t,typeof e!="symbol"?e+"":e,n);class $V extends m${constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,rn(this,"name",$H),rn(this,"abortController"),rn(this,"isDevEnv"),rn(this,"verifyUrlV3",FH),rn(this,"storagePrefix",Ws),rn(this,"version",nT),rn(this,"publicKey"),rn(this,"fetchPromise"),rn(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&ge.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),rn(this,"register",async s=>{if(!Dc()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=pa(),u=this.startAbortTimer(ge.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",g),l.body.removeChild(m),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const m=l.createElement("iframe");m.src=c,m.style.display="none",m.addEventListener("error",p,{signal:this.abortController.signal});const g=T=>{if(T.data&&typeof T.data=="string")try{const N=JSON.parse(T.data);if(N.type==="verify_attestation"){if(Kg(N.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(m),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",g),h(N.attestation===null?"":N.attestation)}}catch(N){this.logger.warn(N)}};l.body.appendChild(m),window.addEventListener("message",g,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),rn(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Kg(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),rn(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(ge.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),rn(this,"getVerifyUrl",s=>{let i=s||Il;return jH.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Il}`),i=Il),i}),rn(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(ge.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),rn(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),rn(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),rn(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),rn(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),rn(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),rn(this,"validateAttestation",(s,i)=>{const o=M7(s,i.publicKey),a={hasExpired:ge.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=vr(n,this.name),this.abortController=new AbortController,this.isDevEnv=wy(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return br(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ge.toMiliseconds(e))}}var BV=Object.defineProperty,FV=(t,e,n)=>e in t?BV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,j0=(t,e,n)=>FV(t,typeof e!="symbol"?e+"":e,n);class jV extends y${constructor(e,n){super(e,n),this.projectId=e,this.logger=n,j0(this,"context",WH),j0(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${HH}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=vr(n,this.context)}}var WV=Object.defineProperty,W0=Object.getOwnPropertySymbols,HV=Object.prototype.hasOwnProperty,zV=Object.prototype.propertyIsEnumerable,bm=(t,e,n)=>e in t?WV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,il=(t,e)=>{for(var n in e||(e={}))HV.call(e,n)&&bm(t,n,e[n]);if(W0)for(var n of W0(e))zV.call(e,n)&&bm(t,n,e[n]);return t},mn=(t,e,n)=>bm(t,typeof e!="symbol"?e+"":e,n);class qV extends w${constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,mn(this,"context",qH),mn(this,"storagePrefix",Ws),mn(this,"storageVersion",zH),mn(this,"events",new Map),mn(this,"shouldPersist",!1),mn(this,"init",async()=>{if(!wy())try{const s={eventId:Cb(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:qI(this.core.relayer.protocol,this.core.relayer.version,hm)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),mn(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Cb(),u=this.core.projectId||"",d=Date.now(),h=il({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),mn(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return il(il({},a),this.setMethods(a.eventId))}),mn(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),mn(this,"setEventListeners",()=>{this.core.heartbeat.on(Ia.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{ge.fromMiliseconds(Date.now())-ge.fromMiliseconds(s.timestamp)>VH&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),mn(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),mn(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),mn(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),mn(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),mn(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,il(il({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),mn(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),mn(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${KH}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${hm}${i}`,{method:"POST",body:JSON.stringify(s)})}),mn(this,"getAppDomain",()=>zI().url),this.logger=vr(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var VV=Object.defineProperty,H0=Object.getOwnPropertySymbols,KV=Object.prototype.hasOwnProperty,GV=Object.prototype.propertyIsEnumerable,vm=(t,e,n)=>e in t?VV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,z0=(t,e)=>{for(var n in e||(e={}))KV.call(e,n)&&vm(t,n,e[n]);if(H0)for(var n of H0(e))GV.call(e,n)&&vm(t,n,e[n]);return t},kt=(t,e,n)=>vm(t,typeof e!="symbol"?e+"":e,n);let YV=class yT extends i${constructor(e){var n;super(e),kt(this,"protocol",tT),kt(this,"version",nT),kt(this,"name",dm),kt(this,"relayUrl"),kt(this,"projectId"),kt(this,"customStoragePrefix"),kt(this,"events",new Jr.EventEmitter),kt(this,"logger"),kt(this,"heartbeat"),kt(this,"relayer"),kt(this,"crypto"),kt(this,"storage"),kt(this,"history"),kt(this,"expirer"),kt(this,"pairing"),kt(this,"verify"),kt(this,"echoClient"),kt(this,"linkModeSupportedApps"),kt(this,"eventClient"),kt(this,"initialized",!1),kt(this,"logChunkController"),kt(this,"on",(a,c)=>this.events.on(a,c)),kt(this,"once",(a,c)=>this.events.once(a,c)),kt(this,"off",(a,c)=>this.events.off(a,c)),kt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),kt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Bt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch{}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||sT,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=ty({level:typeof e?.logger=="string"&&e.logger?e.logger:pH.logger,name:dm}),{logger:i,chunkLoggerController:o}=Xh({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=vr(i,this.name),this.heartbeat=new CL,this.crypto=new _q(this,this.logger,e?.keychain),this.history=new xV(this,this.logger),this.expirer=new UV(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new n$(z0(z0({},gH),e?.storageOptions)),this.relayer=new Yq({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new OV(this,this.logger),this.verify=new $V(this,this.logger,this.storage),this.echoClient=new jV(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new qV(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new yT(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(OH,r),n}get context(){return br(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(_0,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(_0)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1,globalThis[n]}catch{return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch{}}isGlobalCoreDisabled(){try{return typeof Ft<"u"&&fH.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const JV=YV,wT="wc",ET=2,bT="client",ky=`${wT}@${ET}:${bT}:`,zp={name:bT,logger:"error"},q0="WALLETCONNECT_DEEPLINK_CHOICE",ZV="proposal",V0="Proposal expired",XV="session",za=ge.SEVEN_DAYS,QV="engine",Pn={wc_sessionPropose:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1114},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:ge.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:ge.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1119}}},qp={min:ge.FIVE_MINUTES,max:ge.SEVEN_DAYS},Ss={idle:"IDLE",active:"ACTIVE"},eK={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},tK="request",nK=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],rK="wc",sK="auth",iK="authKeys",oK="pairingTopics",aK="requests",wf=`${rK}@${1.5}:${sK}:`,qd=`${wf}:PUB_KEY`;var cK=Object.defineProperty,lK=Object.defineProperties,uK=Object.getOwnPropertyDescriptors,K0=Object.getOwnPropertySymbols,dK=Object.prototype.hasOwnProperty,hK=Object.prototype.propertyIsEnumerable,_m=(t,e,n)=>e in t?cK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,At=(t,e)=>{for(var n in e||(e={}))dK.call(e,n)&&_m(t,n,e[n]);if(K0)for(var n of K0(e))hK.call(e,n)&&_m(t,n,e[n]);return t},xn=(t,e)=>lK(t,uK(e)),ne=(t,e,n)=>_m(t,typeof e!="symbol"?e+"":e,n);class fK extends _${constructor(e){super(e),ne(this,"name",QV),ne(this,"events",new ny),ne(this,"initialized",!1),ne(this,"requestQueue",{state:Ss.idle,queue:[]}),ne(this,"sessionRequestQueue",{state:Ss.idle,queue:[]}),ne(this,"emittedSessionRequests",new YF({limit:500})),ne(this,"requestQueueDelay",ge.ONE_SECOND),ne(this,"expectedPairingMethodMap",new Map),ne(this,"recentlyDeletedMap",new Map),ne(this,"recentlyDeletedLimit",200),ne(this,"relayMessageCache",[]),ne(this,"pendingSessions",new Map),ne(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Pn)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay)))}),ne(this,"connect",async n=>{var r;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=xn(At({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=iW(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:d,walletPay:h}=s,f=((r=d?.[0])==null?void 0:r.ttl)||Pn.wc_sessionPropose.req.ttl||ge.FIVE_MINUTES;this.validateRequestExpiry(f);let p=i,m,g=!1;try{if(p){const M=this.client.core.pairing.pairings.get(p);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),g=M.active}}catch(M){throw this.client.logger.error(`connect() -> pairing.get(${p}) failed`),M}if(!p||!g){const{topic:M,uri:z}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});p=M,m=z}if(!p){const{message:M}=me("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(M)}const T=await this.client.core.crypto.generateKeyPair(),N=sn(f),_=At(xn(At(At({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:rT}],proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:N,pairingTopic:p},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Os()}),(d||h)&&{requests:{authentication:d?.map(M=>{const{domain:z,chains:J,nonce:H,uri:F,exp:P,nbf:w,type:E,statement:R,requestId:b,resources:y,signatureTypes:C}=M;return{domain:z,chains:J,nonce:H,type:E??"caip122",aud:F,version:"1",iat:new Date().toISOString(),exp:P,nbf:w,statement:R,requestId:b,resources:y,signatureTypes:C}}),walletPay:h}}),O=Tt("session_connect",_.id),{reject:A,resolve:x,done:k}=zo(f,V0),L=({id:M})=>{M===_.id&&(this.client.events.off("proposal_expire",L),this.pendingSessions.delete(_.id),this.events.emit(O,{error:{message:V0,code:0}}))};return this.client.events.on("proposal_expire",L),this.events.once(O,({error:M,session:z})=>{this.client.events.off("proposal_expire",L),M?A(M):z&&x(z)}),await this.setProposal(_.id,_),await this.sendProposeSession({proposal:_,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:_.id}}}).catch(M=>{throw this.deleteProposal(_.id),M}),{uri:m,approval:k}}),ne(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),ne(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[es.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(z){throw o.setError(Mo.no_internet_connection),z}try{await this.isValidProposalId(n?.id)}catch(z){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(Mo.proposal_not_found),z}try{await this.isValidApprove(n)}catch(z){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Mo.session_approve_namespace_validation_failure),z}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:f}=n,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:m,proposer:g,requiredNamespaces:T,optionalNamespaces:N}=p;let _=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:m});_||(_=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:es.session_approve_started,properties:{topic:m,trace:[es.session_approve_started,es.session_namespaces_validation_success]}}));const O=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,x=await this.client.core.crypto.generateSharedKey(O,A),k=xn(At(At(At({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:O,metadata:this.client.metadata},expiry:sn(za)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{proposalRequestsResponses:f}),L=Bt.relay;_.addTrace(es.subscribing_session_topic);try{await this.client.core.relayer.subscribe(x,{transportType:L,internal:{skipSubscribe:!0}})}catch(z){throw _.setError(Mo.subscribe_session_topic_failure),z}_.addTrace(es.subscribe_session_topic_success);const M=xn(At({},k),{topic:x,requiredNamespaces:T,optionalNamespaces:N,pairingTopic:m,acknowledged:!1,self:k.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:O,transportType:Bt.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(x,M),_.addTrace(es.store_session);try{await this.sendApproveSession({sessionTopic:x,proposal:p,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:O},sessionSettleRequest:k,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:At({correlationId:a},this.getTVFApproveParams(M))}}),_.addTrace(es.session_approve_publish_success)}catch(z){throw this.client.logger.error(z),this.client.session.delete(x,Ht("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(x),z}return this.client.core.eventClient.deleteEvent({eventId:_.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(x,sn(za)),{topic:x,acknowledged:()=>Promise.resolve(this.client.session.get(x))}}),ne(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Pn.wc_sessionPropose.reject}),await this.deleteProposal(r)}),ne(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=zo(ge.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Os(),l=oo().toString(),u=this.client.session.get(r).namespaces;return this.events.once(Tt("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),ne(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=Os(),{done:i,resolve:o,reject:a}=zo(ge.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(Tt("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,sn(za)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),ne(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(g){throw this.client.logger.error("request() -> isValidRequest() failed"),g}const{chainId:r,request:s,topic:i,expiry:o=Pn.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===Bt.relay&&await this.confirmOnlineStateOrThrow();const c=Os(),l=oo().toString(),{done:u,resolve:d,reject:h}=zo(o,"Request expired. Please try again.");this.events.once(Tt("session_request",c),({error:g,result:T})=>{g?h(g):d(T)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:xn(At({},s),{expiryTimestamp:sn(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(g=>h(g)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const m={request:xn(At({},s),{expiryTimestamp:sn(o)}),chainId:r};return await Promise.all([new Promise(async g=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:m,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,m)}).catch(T=>h(T)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),g()}),new Promise(async g=>{var T;if(!((T=a.sessionConfig)!=null&&T.disableDeepLink)){const N=await zF(this.client.core.storage,q0);await jF({id:c,topic:i,wcDeepLink:N})}g()}),u()]).then(g=>g[2])}),ne(this,"respond",async n=>{var r,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:n?.topic||((s=(r=n?.response)==null?void 0:r.id)==null?void 0:s.toString()),trace:[es.session_request_response_started]}});try{await this.isValidRespond(n)}catch(d){throw i.addTrace(d?.message),i.setError(Mo.session_request_response_validation_failure),d}i.addTrace(es.session_request_response_validation_success);const{topic:o,response:a}=n,{id:c}=a,l=this.client.session.get(o);l.transportType===Bt.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(es.session_request_response_publish_started),Rs(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):qr(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(n)}catch(d){throw i.addTrace(d?.message),i.setError(Mo.session_request_response_publish_failure),d}}),ne(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Os(),i=oo().toString(),{done:o,resolve:a,reject:c}=zo(ge.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(Tt("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),ne(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=oo().toString(),a=Os();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),ne(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:Ht("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=me("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),ne(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>cW(r,n)))),ne(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),ne(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Bt.link_mode:Bt.relay;o===Bt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:m=[],expiry:g}=n,T=[...n.resources||[]],{topic:N,uri:_}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:N,uri:_}});const O=await this.client.core.crypto.generateKeyPair(),A=Hd(O);if(await Promise.all([this.client.auth.authKeys.set(qd,{responseTopic:A,publicKey:O}),this.client.auth.pairingTopics.set(A,{topic:A,pairingTopic:N})]),await this.client.core.relayer.subscribe(A,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${N}`),m.length>0){const{namespace:y}=fi(a[0]);let C=c9(y,"request",m);Wd(T)&&(C=u9(C,T.pop())),T.push(C)}const x=g&&g>Pn.wc_sessionAuthenticate.req.ttl?g:Pn.wc_sessionAuthenticate.req.ttl,k={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:T},requester:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:sn(x)},L={eip155:{chains:a,methods:[...new Set(["personal_sign",...m])],events:["chainChanged","accountsChanged"]}},M={requiredNamespaces:{},optionalNamespaces:L,relays:[{protocol:"irn"}],pairingTopic:N,proposer:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:sn(Pn.wc_sessionPropose.req.ttl),id:Os()},{done:z,resolve:J,reject:H}=zo(x,"Request expired"),F=Os(),P=Tt("session_connect",M.id),w=Tt("session_request",F),E=async({error:y,session:C})=>{this.events.off(w,R),y?H(y):C&&J({session:C})},R=async y=>{var C,$,B;if(await this.deletePendingAuthRequest(F,{message:"fulfilled",code:0}),y.error){const ve=Ht("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return y.error.code===ve.code?void 0:(this.events.off(P,E),H(y.error.message))}await this.deleteProposal(M.id),this.events.off(P,E);const{cacaos:G,responder:Y}=y.result,Q=[],ye=[];for(const ve of G){await Db({cacao:ve,projectId:this.client.core.projectId})||(this.client.logger.error(ve,"Signature verification failed"),H(Ht("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Be}=ve,ct=Wd(Be.resources),Ct=[Qg(Be.iss)],$t=Ih(Be.iss);if(ct){const tn=Ub(ct),Sn=Mb(ct);Q.push(...tn),Ct.push(...Sn)}for(const tn of Ct)ye.push(`${tn}:${$t}`)}const be=await this.client.core.crypto.generateSharedKey(O,Y.publicKey);let De;Q.length>0&&(De={topic:be,acknowledged:!0,self:{publicKey:O,metadata:this.client.metadata},peer:Y,controller:Y.publicKey,expiry:sn(za),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:N,namespaces:c0([...new Set(Q)],[...new Set(ye)]),transportType:o},await this.client.core.relayer.subscribe(be,{transportType:o}),await this.client.session.set(be,De),N&&await this.client.core.pairing.updateMetadata({topic:N,metadata:Y.metadata}),De=this.client.session.get(be)),(C=this.client.metadata.redirect)!=null&&C.linkMode&&($=Y.metadata.redirect)!=null&&$.linkMode&&(B=Y.metadata.redirect)!=null&&B.universal&&r&&(this.client.core.addLinkModeSupportedApp(Y.metadata.redirect.universal),this.client.session.update(be,{transportType:Bt.link_mode})),J({auths:G,session:De})};this.events.once(P,E),this.events.once(w,R);let b;try{if(i){const y=ls("wc_sessionAuthenticate",k,F);this.client.core.history.set(N,y);const C=await this.client.core.crypto.encode("",y,{type:Tu,encoding:to});b=gd(r,N,C)}else await Promise.all([this.sendRequest({topic:N,method:"wc_sessionAuthenticate",params:k,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:F}),this.sendRequest({topic:N,method:"wc_sessionPropose",params:M,expiry:Pn.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:M.id})])}catch(y){throw this.events.off(P,E),this.events.off(w,R),y}return await this.setProposal(M.id,M),await this.setAuthRequest(F,{request:xn(At({},k),{verifyContext:{}}),pairingTopic:N,transportType:o}),{uri:b??_,response:z}}),ne(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Lo.authenticated_session_approve_started]}});try{this.isInitialized()}catch(g){throw i.setError(rl.no_internet_connection),g}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(rl.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Bt.relay;a===Bt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Hd(c),d={type:pi,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(const g of s){if(!await Db({cacao:g,projectId:this.client.core.projectId})){i.setError(rl.invalid_cacao);const A=Ht("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:A,encodeOpts:d}),new Error(A.message)}i.addTrace(Lo.cacaos_verified);const{p:T}=g,N=Wd(T.resources),_=[Qg(T.iss)],O=Ih(T.iss);if(N){const A=Ub(N),x=Mb(N);h.push(...A),_.push(...x)}for(const A of _)f.push(`${A}:${O}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Lo.create_authenticated_session_topic);let m;if(h?.length>0){m={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:sn(za),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:c0([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(Lo.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(g){throw i.setError(rl.subscribe_authenticated_session_topic_failure),g}i.addTrace(Lo.subscribe_authenticated_session_topic_success),await this.client.session.set(p,m),i.addTrace(Lo.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Lo.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(g){throw i.setError(rl.authenticated_session_approve_publish_failure),g}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:m}}),ne(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Bt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Hd(o),l={type:pi,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Pn.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),ne(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return uS(r,s)}),ne(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),ne(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),ne(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Ht("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(q0).catch(l=>this.client.logger.warn(l)),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Ss.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===s).map(l=>this.deletePendingSessionRequest(l.id,Ht("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),ne(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(Mo.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,Ht("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),ne(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=Ss.idle,this.client.events.emit("session_request_expire",{id:n}))}),ne(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),ne(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),ne(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,sn(Pn.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),ne(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Bt.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),ne(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||sn(Pn.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),ne(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=n,f=ls(s,i,c);let p;const m=!!u;try{const N=m?to:yr;p=await this.client.core.crypto.encode(r,f,{encoding:N})}catch(N){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),N}let g;if(nK.includes(s)){const N=zr(JSON.stringify(f)),_=zr(p);g=await this.client.core.verify.register({id:_,decryptedId:N})}const T=At(At({},Pn[s].req),h);if(T.attestation=g,o&&(T.ttl=o),a&&(T.id=a),this.client.core.history.set(r,f),m){const N=gd(u,r,p);await $e.Linking.openURL(N,this.client.name)}else T.tvf=xn(At({},d),{correlationId:f.id}),l?(T.internal=xn(At({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,T)):this.client.core.relayer.publish(r,p,T).catch(N=>this.client.logger.error(N));return f.id}),ne(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=ls("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:yr}),a=zr(JSON.stringify(i)),c=zr(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:xn(At({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),ne(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,c=iu(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:yr}),u=ls("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,u,{encoding:yr});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:xn(At({},a),{publishMethod:"wc_approveSession"})})}),ne(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=iu(r,i);let u;const d=c&&typeof($e==null?void 0:$e.Linking)<"u";try{const p=d?to:yr;u=await this.client.core.crypto.encode(s,l,xn(At({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,r);const p=h.request;try{f=this.getTVFParams(r,p.params,i)}catch(m){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${m?.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=gd(c,s,u);await $e.Linking.openURL(p,this.client.name)}else{const p=h.request.method,m=Pn[p].res;m.tvf=xn(At({},f),{correlationId:r}),o?(m.internal=xn(At({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,m)):this.client.core.relayer.publish(s,u,m).catch(g=>this.client.logger.error(g))}await this.client.core.history.resolve(l)}),ne(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=gf(r,i);let u;const d=c&&typeof($e==null?void 0:$e.Linking)<"u";try{const f=d?to:yr;u=await this.client.core.crypto.encode(s,l,xn(At({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(d){const f=gd(c,s,u);await $e.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||Pn[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),ne(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Ps(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ps(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),ne(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),ne(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),ne(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Ss.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ss.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Ss.idle}),ne(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),ne(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),ne(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=me("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),ne(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),ne(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&l?.setError(ni.proposal_listener_not_found),this.isValidConnect(At({},s.params));const u=a.expiryTimestamp||sn(Pn.wc_sessionPropose.req.ttl),d=At({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:zr(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(Ns.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Pn.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),ne(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(Rs(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(qr(r)){await this.deleteProposal(i);const o=Tt("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),ne(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:f}=r.params,p=[...this.pendingSessions.values()].find(T=>T.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const m=this.client.proposal.get(p.proposalId),g=xn(At(At(At({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Bt.relay,authentication:f?.authentication,walletPayResult:f?.walletPay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Tt("session_connect",p.proposalId),{session:g})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),ne(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;Rs(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Tt("session_approve",s),{})):qr(r)&&(await this.client.session.delete(n,Ht("USER_DISCONNECTED")),this.events.emit(Tt("session_approve",s),{error:r.error}))}),ne(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=tl.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:Ht("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(At({topic:n},s));try{tl.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw tl.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),ne(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),ne(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=Tt("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rs(r)?this.events.emit(Tt("session_update",s),{}):qr(r)&&this.events.emit(Tt("session_update",s),{error:r.error})}),ne(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,sn(za)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),ne(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=Tt("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rs(r)?this.events.emit(Tt("session_extend",s),{}):qr(r)&&this.events.emit(Tt("session_extend",s),{error:r.error})}),ne(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),ne(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=Tt("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Rs(r)?this.events.emit(Tt("session_ping",s),{}):qr(r)&&this.events.emit(Tt("session_ping",s),{error:r.error})},500)}),ne(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{await this.isValidDisconnect({topic:n,reason:r.params}),this.cleanupPendingSentRequestsForTopic({topic:n,error:Ht("USER_DISCONNECTED")}),await this.deleteSession({topic:n,id:s})}catch(i){this.client.logger.error(i)}}),ne(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(At({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:zr(JSON.stringify(ls("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),m={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(m),u===Bt.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(m):(this.addSessionRequestToSessionRequestQueue(m),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),ne(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=Tt("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Rs(r)?this.events.emit(Tt("session_request",s),{result:r.result}):qr(r)&&this.events.emit(Tt("session_request",s),{error:r.error})}),ne(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=tl.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(At({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),tl.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),ne(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),Rs(r)?this.events.emit(Tt("session_request",s),{result:r.result}):qr(r)&&this.events.emit(Tt("session_request",s),{error:r.error})}),ne(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:zr(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===Bt.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:pi,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Pn.wc_sessionAuthenticate.autoReject,appLink:h})}}),ne(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),ne(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ss.idle,this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay))}),ne(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(Tt("session_request",i.request.id),{error:r})})}),ne(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ss.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),ne(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=Ss.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),ne(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:ls("wc_sessionPropose",xn(At({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),ne(this,"isValidConnect",async n=>{if(!fr(n)){const{message:l}=me("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(vn(r)||await this.isValidPairingTopic(r),!bW(c)){const{message:l}=me("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!vn(s)&&$s(s)!==0&&(["fatal","error","silent"].includes(this.client.logger.level)||this.client.logger.warn("requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces"),this.validateNamespaces(s,"requiredNamespaces")),i&&!vn(i)&&$s(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!vn(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!vn(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),ne(this,"validateNamespaces",(n,r)=>{const s=EW(n,"connect()",r);if(s)throw new Error(s.message)}),ne(this,"isValidApprove",async n=>{if(!fr(n))throw new Error(me("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Bp(s,"approve()");if(l)throw new Error(l.message);const u=d0(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!cn(i,!0)){const{message:d}=me("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!vn(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!vn(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),ne(this,"isValidReject",async n=>{if(!fr(n)){const{message:i}=me("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!_W(s)){const{message:i}=me("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),ne(this,"isValidSessionSettleRequest",n=>{if(!fr(n)){const{message:l}=me("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!GS(r)){const{message:l}=me("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=fW(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Bp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ps(o)){const{message:l}=me("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),ne(this,"isValidUpdate",async n=>{if(!fr(n)){const{message:c}=me("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Bp(s,"update()");if(o)throw new Error(o.message);const a=d0(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),ne(this,"isValidExtend",async n=>{if(!fr(n)){const{message:s}=me("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),ne(this,"isValidRequest",async n=>{if(!fr(n)){const{message:c}=me("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!u0(a,i)){const{message:c}=me("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!CW(s)){const{message:c}=me("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!SW(a,i,s.method)){const{message:c}=me("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),ne(this,"isValidRespond",async n=>{var r;if(!fr(n)){const{message:a}=me("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(a)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(a){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),a}if(!AW(i)){const{message:a}=me("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=me("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),ne(this,"isValidPing",async n=>{if(!fr(n)){const{message:s}=me("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),ne(this,"isValidEmit",async n=>{if(!fr(n)){const{message:a}=me("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!u0(o,i)){const{message:a}=me("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!IW(s)){const{message:a}=me("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!TW(o,i,s.name)){const{message:a}=me("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),ne(this,"isValidDisconnect",async n=>{if(!fr(n)){const{message:s}=me("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),ne(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!cn(s,!1))throw new Error("uri is required parameter");if(!cn(i,!1))throw new Error("domain is required parameter");if(!cn(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>fi(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=fi(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),ne(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Il,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Bt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),ne(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=me("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),ne(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),ne(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),ne(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=me("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),ne(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==Bt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof($e==null?void 0:$e.Linking)<"u"}),ne(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),ne(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=_b(n,"topic")||"",s=decodeURIComponent(_b(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Bt.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),ne(this,"registerLinkModeListeners",async()=>{var n;if(wy()||Io()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=$e==null?void 0:$e.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),ne(this,"getTVFApproveParams",n=>{try{const r=VS(n.namespaces),s=eW(n.namespaces),i=tW(n.namespaces),o=n.sessionProperties,a=n.scopedProperties;return{approvedChains:r,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(r){return this.client.logger.warn(r,"Error getting TVF approve params"),{}}}),ne(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),ne(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),ne(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=eK[i];if(i==="sui_signTransaction")return[Hj(r.transactionBytes)];if(i==="near_signTransaction")return[Rb(r)];if(i==="near_signTransactions")return r.map(c=>Rb(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[qW({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return gi(r)?r.map(c=>Pb(c)):[Pb(r)];if(i==="cosmos_signDirect")return[qj(r)];if(i==="wallet_sendCalls")return Vj(r);if(typeof r=="string")return[r];const a=r[o.key];if(gi(a))return i==="solana_signAllTransactions"?a.map(c=>Wj(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=me("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(an.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(qd)?this.client.auth.authKeys.get(qd):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Bt.link_mode?to:yr});Py(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:zr(r)})):mf(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${r}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Hr.expired,async e=>{const{topic:n,id:r}=KI(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,me("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,me("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ko.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Ko.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!cn(e,!1)){const{message:n}=me("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=me("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(Ps(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=me("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!cn(e,!1)){const{message:n}=me("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=me("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(Ps(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=me("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=me("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(cn(e,!1)){const{message:n}=me("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=me("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!vW(e)){const{message:n}=me("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=me("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(Ps(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=me("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}validateRequestExpiry(e){if(e&&!RW(e,qp)){const{message:n}=me("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${qp.min} and ${qp.max}`);throw new Error(n)}}}class pK extends Oa{constructor(e,n){super(e,n,ZV,ky),this.core=e,this.logger=n}}let gK=class extends Oa{constructor(e,n){super(e,n,XV,ky),this.core=e,this.logger=n}};class mK extends Oa{constructor(e,n){super(e,n,tK,ky,r=>r.id),this.core=e,this.logger=n}}class yK extends Oa{constructor(e,n){super(e,n,iK,wf,()=>qd),this.core=e,this.logger=n}}class wK extends Oa{constructor(e,n){super(e,n,oK,wf),this.core=e,this.logger=n}}class EK extends Oa{constructor(e,n){super(e,n,aK,wf,r=>r.id),this.core=e,this.logger=n}}var bK=Object.defineProperty,vK=(t,e,n)=>e in t?bK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vp=(t,e,n)=>vK(t,typeof e!="symbol"?e+"":e,n);class _K{constructor(e,n){this.core=e,this.logger=n,Vp(this,"authKeys"),Vp(this,"pairingTopics"),Vp(this,"requests"),this.authKeys=new yK(this.core,this.logger),this.pairingTopics=new wK(this.core,this.logger),this.requests=new EK(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var CK=Object.defineProperty,AK=(t,e,n)=>e in t?CK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ft=(t,e,n)=>AK(t,typeof e!="symbol"?e+"":e,n);class Dy extends v${constructor(e){super(e),ft(this,"protocol",wT),ft(this,"version",ET),ft(this,"name",zp.name),ft(this,"metadata"),ft(this,"core"),ft(this,"logger"),ft(this,"events",new Jr.EventEmitter),ft(this,"engine"),ft(this,"session"),ft(this,"proposal"),ft(this,"pendingRequest"),ft(this,"auth"),ft(this,"signConfig"),ft(this,"on",(r,s)=>this.events.on(r,s)),ft(this,"once",(r,s)=>this.events.once(r,s)),ft(this,"off",(r,s)=>this.events.off(r,s)),ft(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),ft(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),ft(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),ft(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),ft(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),ft(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||zp.name,this.metadata=UF(e?.metadata),this.signConfig=e?.signConfig;const n=Oy({logger:e?.logger||zp.logger,name:this.name});this.logger=n,this.core=e?.core||new JV(e),this.session=new gK(this.core,this.logger),this.proposal=new pK(this.core,this.logger),this.pendingRequest=new mK(this.core,this.logger),this.engine=new fK(this),this.auth=new _K(this.core,this.logger)}static async init(e){const n=new Dy(e);return await n.initialize(),n}get context(){return br(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const IK=Dy;var SK=Object.defineProperty,TK=Object.defineProperties,NK=Object.getOwnPropertyDescriptors,G0=Object.getOwnPropertySymbols,OK=Object.prototype.hasOwnProperty,RK=Object.prototype.propertyIsEnumerable,Y0=(t,e,n)=>e in t?SK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,J0=(t,e)=>{for(var n in e||(e={}))OK.call(e,n)&&Y0(t,n,e[n]);if(G0)for(var n of G0(e))RK.call(e,n)&&Y0(t,n,e[n]);return t},Z0=(t,e)=>TK(t,NK(e));const PK={Accept:"application/json","Content-Type":"application/json"},xK="POST",X0={headers:PK,method:xK},Q0=10;let vT=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new Jr.EventEmitter,this.isAvailable=!1,this.registering=!1,!y0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=wi(e),r=await(await _w(this.url,Z0(J0({},X0),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!y0(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=wi({id:1,jsonrpc:"2.0",method:"test",params:[]});await _w(e,Z0(J0({},X0),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?ha(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=gf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return ZS(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Q0&&this.events.setMaxListeners(Q0)}};function Uy(t){return t==null||typeof t!="object"&&typeof t!="function"}function _T(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function CT(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const kK="[object RegExp]",AT="[object String]",IT="[object Number]",ST="[object Boolean]",TT="[object Arguments]",DK="[object Symbol]",UK="[object Date]",MK="[object Map]",LK="[object Set]",$K="[object Array]",BK="[object ArrayBuffer]",FK="[object Object]",jK="[object DataView]",WK="[object Uint8Array]",HK="[object Uint8ClampedArray]",zK="[object Uint16Array]",qK="[object Uint32Array]",VK="[object Int8Array]",KK="[object Int16Array]",GK="[object Int32Array]",YK="[object Float32Array]",JK="[object Float64Array]";function My(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ZK(t,e){return rc(t,void 0,t,new Map,e)}function rc(t,e,n,r=new Map,s=void 0){const i=s?.(t,e,n,r);if(i!=null)return i;if(Uy(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=rc(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,rc(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(rc(a,void 0,n,r,s));return o}if(typeof lt.Buffer<"u"&&lt.Buffer.isBuffer(t))return t.subarray();if(My(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=rc(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Go(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Go(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Go(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Go(o,t,n,r,s),o}if(typeof t=="object"&&XK(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Go(o,t,n,r,s),o}return t}function Go(t,e,n=t,r,s){const i=[...Object.keys(e),..._T(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=rc(e[a],a,n,r,s))}}function XK(t){switch(CT(t)){case TT:case $K:case BK:case jK:case ST:case UK:case YK:case JK:case VK:case KK:case GK:case MK:case IT:case FK:case kK:case LK:case AT:case DK:case WK:case HK:case zK:case qK:return!0;default:return!1}}function QK(t,e){return ZK(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case IT:case AT:case ST:{const o=new t.constructor(t?.valueOf());return Go(o,t),o}case TT:{const o={};return Go(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function ev(t){return QK(t)}function tv(t){return t!==null&&typeof t=="object"&&CT(t)==="[object Arguments]"}function nv(t){return typeof t=="object"&&t!==null}function eG(){}function tG(t){return My(t)}function nG(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function rG(t){if(Uy(t))return t;if(Array.isArray(t)||My(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function sG(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=Cm(s,o,r,new Map)}return s}function Cm(t,e,n,r){if(Uy(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return rG(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),..._T(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(tv(a)&&(a={...a}),tv(c)&&(c={...c}),typeof lt.Buffer<"u"&&lt.Buffer.isBuffer(a)&&(a=ev(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];u[f]=c[f]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||nv(c)&&nv(a)?t[o]=Cm(c,a,n,r):c==null&&nG(a)?t[o]=Cm({},a,n,r):c==null&&tG(a)?t[o]=ev(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function iG(t,...e){return sG(t,...e,eG)}const rv="error",oG="wss://relay.walletconnect.org",aG="wc",NT="universal_provider",md=`${aG}@2:${NT}:`,OT="https://rpc.walletconnect.org/v1/",RT="generic",cG=`${OT}bundler`,lc="call_status",lG=86400,Ly={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var uG=Object.defineProperty,dG=Object.defineProperties,hG=Object.getOwnPropertyDescriptors,sv=Object.getOwnPropertySymbols,fG=Object.prototype.hasOwnProperty,pG=Object.prototype.propertyIsEnumerable,iv=(t,e,n)=>e in t?uG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yd=(t,e)=>{for(var n in e||(e={}))fG.call(e,n)&&iv(t,n,e[n]);if(sv)for(var n of sv(e))pG.call(e,n)&&iv(t,n,e[n]);return t},gG=(t,e)=>dG(t,hG(e));function PT(t,e,n){var r;const s=fi(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${OT}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function mG(t){return t.includes(":")?t.split(":")[1]:t}function xT(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function yG(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function ov(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function wd(t={},e={}){const n=ov(av(t)),r=ov(av(e));return iG(n,r)}function av(t){var e,n,r,s,i;const o={};if(!$s(t))return o;for(const[a,c]of Object.entries(t)){const l=pf(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=nc(a);o[f]=gG(yd(yd({},o[f]),c),{chains:Ls(l,(e=o[f])==null?void 0:e.chains),methods:Ls(u,(n=o[f])==null?void 0:n.methods),events:Ls(d,(r=o[f])==null?void 0:r.events)}),($s(h)||$s(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=yd(yd({},h),(i=o[f])==null?void 0:i.rpcMap))}return o}function cv(t){return t.includes(":")?t.split(":")[2]:t}function lv(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=pf(n)?[n]:r.chains?r.chains:xT(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function Kp(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function wG(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const kT={},uc=t=>kT[t],Gp=(t,e)=>{kT[t]=e};var EG=Object.defineProperty,uv=Object.getOwnPropertySymbols,bG=Object.prototype.hasOwnProperty,vG=Object.prototype.propertyIsEnumerable,dv=(t,e,n)=>e in t?EG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hv=(t,e)=>{for(var n in e||(e={}))bG.call(e,n)&&dv(t,n,e[n]);if(uv)for(var n of uv(e))vG.call(e,n)&&dv(t,n,e[n]);return t};const fv="eip155",_G=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],CG=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,Yp=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,pv=t=>Object.keys(t).filter(e=>_G.includes(e)).reduce((e,n)=>(e[n]=AG(t[n]),e),{}),AG=t=>typeof t=="string"&&wG(t)?JSON.parse(t):t,IG=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!$s(s)&&!$s(r))return;const o=pv(r);for(const a of n){const c=CG(a);if(!c)continue;i[Yp(c)]=o;const l=s?.[`${fv}:${c}`];if(l){const u=l?.[`${fv}:${c}:${e}`];i[Yp(c)]=hv(hv({},i[Yp(c)]),pv(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var SG=Object.defineProperty,TG=(t,e,n)=>e in t?SG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,NG=(t,e,n)=>TG(t,e+"",n);let Jp;class $y{constructor(e){NG(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,n){return await this.storage.setItem(e,n)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return Jp||(Jp=new $y(e)),Jp}}var OG=Object.defineProperty,RG=Object.defineProperties,PG=Object.getOwnPropertyDescriptors,gv=Object.getOwnPropertySymbols,xG=Object.prototype.hasOwnProperty,kG=Object.prototype.propertyIsEnumerable,mv=(t,e,n)=>e in t?OG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,DG=(t,e)=>{for(var n in e||(e={}))xG.call(e,n)&&mv(t,n,e[n]);if(gv)for(var n of gv(e))kG.call(e,n)&&mv(t,n,e[n]);return t},UG=(t,e)=>RG(t,PG(e));async function MG(t,e){const n=fi(t.result.capabilities.caip345.caip2),r=t.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(r.map(d=>LG(n.reference,d,e))),i=s.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);s.filter(d=>d.status==="rejected").forEach(d=>{});const o=!i.length||i.some(d=>!d),a=i.every(d=>d?.status==="0x1"),c=i.every(d=>d?.status==="0x0"),l=i.some(d=>d?.status==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:i,status:u}}async function LG(t,e,n){return await n(parseInt(t)).request(ls("eth_getTransactionReceipt",[e]))}async function $G({sendCalls:t,storage:e}){const n=await e.getItem(lc);await e.setItem(lc,UG(DG({},n),{[t.result.id]:{request:t.request,result:t.result,expiry:sn(lG)}}))}async function BG({resultId:t,storage:e}){const n=await e.getItem(lc);if(n){delete n[t],await e.setItem(lc,n);for(const r in n)Ps(n[r].expiry)&&delete n[r];await e.setItem(lc,n)}}async function FG({resultId:t,storage:e}){const n=await e.getItem(lc),r=n?.[t];if(r&&!Ps(r.expiry))return r;await BG({resultId:t,storage:e})}var jG=Object.defineProperty,WG=Object.defineProperties,HG=Object.getOwnPropertyDescriptors,yv=Object.getOwnPropertySymbols,zG=Object.prototype.hasOwnProperty,qG=Object.prototype.propertyIsEnumerable,Am=(t,e,n)=>e in t?jG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zp=(t,e)=>{for(var n in e||(e={}))zG.call(e,n)&&Am(t,n,e[n]);if(yv)for(var n of yv(e))qG.call(e,n)&&Am(t,n,e[n]);return t},Xp=(t,e)=>WG(t,HG(e)),$o=(t,e,n)=>Am(t,typeof e!="symbol"?e+"":e,n);class VG{constructor(e){$o(this,"name","eip155"),$o(this,"client"),$o(this,"chainId"),$o(this,"namespace"),$o(this,"httpProviders"),$o(this,"events"),$o(this,"storage"),this.namespace=e.namespace,this.events=uc("events"),this.client=uc("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=$y.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n);const r=this.chainId;this.chainId=parseInt(e),this.events.emit(Ly.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||PT(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new xy(new vT(r,uc("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(mG(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(e){const n=e||this.chainId;return this.httpProviders[n]||(this.httpProviders=Xp(Zp({},this.httpProviders),{[n]:this.createHttpProvider(n)}),this.httpProviders[n])}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let f;try{f=IG(l,a,c)}catch{}if(f)return f;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Xp(Zp({},l.sessionProperties||{}),{capabilities:Xp(Zp({},u||{}),{[d]:p})})})}catch{}return p}async getCallStatus(e){var n,r,s;const i=this.client.session.get(e.topic),o=(n=i.sessionProperties)==null?void 0:n.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch{}}const a=(r=i.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch{}const c=await FG({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await MG(c,this.getHttpProvider.bind(this))}catch{}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ls("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${cG}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}async sendCalls(e){var n,r,s;const i=await this.client.request(e),o=(n=e.request.params)==null?void 0:n[0],a=i?.id,c=i?.capabilities||{},l=(r=c?.caip345)==null?void 0:r.caip2,u=(s=c?.caip345)==null?void 0:s.transactionHashes;return!a||!l||!(u!=null&&u.length)||await $G({sendCalls:{request:o,result:i},storage:this.storage}),i}}var KG=Object.defineProperty,GG=(t,e,n)=>e in t?KG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qa=(t,e,n)=>GG(t,typeof e!="symbol"?e+"":e,n);class YG{constructor(e){qa(this,"name",RT),qa(this,"client"),qa(this,"httpProviders"),qa(this,"events"),qa(this,"namespace"),qa(this,"chainId"),this.namespace=e.namespace,this.events=uc("events"),this.client=uc("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n);const r=this.chainId;this.chainId=e,this.events.emit(Ly.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return fi(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{var i,o;const a=fi(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(s,c)}),r}getHttpProvider(e){const n=fi(e).reference,r=this.httpProviders[n];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||PT(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new xy(new vT(r,uc("disableProviderPing")))}}var JG=Object.defineProperty,ZG=Object.defineProperties,XG=Object.getOwnPropertyDescriptors,wv=Object.getOwnPropertySymbols,QG=Object.prototype.hasOwnProperty,eY=Object.prototype.propertyIsEnumerable,Im=(t,e,n)=>e in t?JG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ol=(t,e)=>{for(var n in e||(e={}))QG.call(e,n)&&Im(t,n,e[n]);if(wv)for(var n of wv(e))eY.call(e,n)&&Im(t,n,e[n]);return t},Ed=(t,e)=>ZG(t,XG(e)),Ir=(t,e,n)=>Im(t,typeof e!="symbol"?e+"":e,n);let tY=class DT{constructor(e){Ir(this,"client"),Ir(this,"namespaces"),Ir(this,"optionalNamespaces"),Ir(this,"sessionProperties"),Ir(this,"scopedProperties"),Ir(this,"events",new ny),Ir(this,"rpcProviders",{}),Ir(this,"session"),Ir(this,"providerOpts"),Ir(this,"logger"),Ir(this,"uri"),Ir(this,"disableProviderPing",!1),Ir(this,"connectParams");var n,r;this.providerOpts=e,this.logger=Oy({logger:(n=e.logger)!=null?n:rv,name:(r=this.providerOpts.name)!=null?r:NT}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const n=new DT(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ol({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,iu(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ht("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=lv(this.session.namespaces);this.namespaces=wd(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){var n,r;const{uri:s,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(n=this.connectParams)==null?void 0:n.authentication,walletPay:(r=this.connectParams)==null?void 0:r.walletPay});s&&(this.uri=s,this.events.emit("display_uri",s));const o=await i();this.session=o;const a=lv(o.namespaces);return this.namespaces=wd(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!gi(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn(n,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await IK.init({core:this.providerOpts.core,logger:this.providerOpts.logger||rv,relayUrl:this.providerOpts.relayUrl||oG,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>nc(n)))];Gp("client",this.client),Gp("events",this.events),Gp("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=yG(n,this.session);if(r?.length===0)return;const s=xT(r),i=wd(this.namespaces,this.optionalNamespaces),o=Ed(ol({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new VG({namespace:o});break;default:this.rpcProviders[n]=new YG({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&gi(o)&&this.events.emit("accountsChanged",o.map(cv))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=nc(o),l=Kp(o)!==Kp(a)?`${c}:${Kp(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Ed(ol({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ed(ol({},Ht("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Ly.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(Ed(ol({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[RT]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=wd(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>nc(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=nc(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:n,internal:r=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),r?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:n})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:n,previousCaipChainId:r}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(cv);if(!gi(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${md}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${md}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${md}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(md)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn(n,"Failed to cleanup storage")}}};const Ev=2147483648,nY={convertEVMChainIdToCoinType(t){if(t>=Ev)throw new Error("Invalid chainId");return(Ev|t)>>>0}},Fr=Rt({suggestions:[],loading:!1}),rY={state:Fr,subscribe(t){return Qt(Fr,()=>t(Fr))},subscribeKey(t,e){return en(Fr,t,e)},async resolveName(t){try{return await Ue.lookupEnsName(t)}catch(e){const n=e;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await Ue.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Fr.loading=!0,Fr.suggestions=[];const e=await Ue.getEnsNameSuggestions(t);return Fr.suggestions=e.suggestions||[],Fr.suggestions}catch(e){const n=Tl.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{Fr.loading=!1}},async getNamesForAddress(t){try{if(!I.state.activeCaipNetwork)return[];const n=te.getEnsFromCacheForAddress(t);if(n)return n;const r=await Ue.reverseLookupEnsName({address:t});return te.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Tl.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=I.state.activeCaipNetwork,n=I.getAccountData(e?.chainNamespace)?.address,r=re.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");Fr.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Ie.pushTransactionStack({onCancel(){Ie.replace("RegisterAccountName")}});const i=await ue.signMessage(s);Fr.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=nY.convertEVMChainIdToCoinType(Number(o));await Ue.registerEnsName({coinType:a,address:n,signature:i,message:s}),I.setAccountProp("profileName",t,e.chainNamespace),te.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),Ie.replace("RegisterAccountNameSuccess")}catch(s){const i=Tl.parseEnsApiError(s,`Error registering name ${t}`);throw Ie.replace("RegisterAccountName"),new Error(i)}finally{Fr.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},Tl=_r(rY);function Sm(t){try{return new URL(t)}catch{return null}}function sY(t){const e=t.split("/"),n=e.length>0&&e[0]!==void 0?e[0]:"",r=n.lastIndexOf(":");return r===-1?{host:n}:{host:n.slice(0,r),port:n.slice(r+1)}}function iY(t){const e=t.indexOf("://");if(e===-1)return null;const n=t.slice(0,e),r=e+3;let s=t.indexOf("/",r);s===-1&&(s=t.length);const i=t.slice(r,s),o=i.lastIndexOf(":");return o===-1?{scheme:n,host:i}:{scheme:n,host:i.slice(0,o),port:i.slice(o+1)}}function oY(t,e){if(e.includes("://")){const o=Sm(e);return o?o.origin===t:!1}const{host:n,port:r}=sY(e),s=t.indexOf("://");if(s!==-1){const o=s+3;let a=t.indexOf("/",o);a===-1&&(a=t.length);const c=t.slice(o,a);if(r!==void 0)return`${n}:${r}`===c;const l=c.split(":")[0];return n===l}const i=Sm(t);return i?r!==void 0?n===i.hostname&&r===(i.port||void 0):n===i.hostname:!1}function aY(t,e,n){let r=n,s;const i=r.indexOf("://");i!==-1&&(s=r.slice(0,i),r=r.slice(i+3));const o=r.indexOf("/");o!==-1&&(r=r.slice(0,o));let a=r,c;const l=a.lastIndexOf(":");l!==-1&&(c=a.slice(l+1),a=a.slice(0,l));const u=a.split(".");for(const m of u)if(m.includes("*")&&m!=="*")return!1;const d=t.protocol.replace(/:$/u,"");if(s&&s!==d||c!==void 0&&c!=="*"&&c!==t.port)return!1;const h=iY(e),p=(h?h.host:t.hostname).split(".");if(u.length!==p.length)return!1;for(let m=u.length-1;m>=0;m-=1){const g=u[m],T=p[m];if(g!=="*"&&g!==T)return!1}return!0}const cY={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Bs={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return cY[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":u.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":u.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{const e=await Tl.resolveName(t);return(e?.addresses?Object.values(e.addresses):[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===Bs.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===Bs.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){const r=[...e,...n];if(e.length===0)return!0;const s=Sm(t);if(!s)return r.some(i=>!i.includes("*")&&i===t);if(s.hostname==="localhost"||s.hostname==="127.0.0.1")return!0;for(const i of r)if(i.includes("*")){if(aY(s,t,i))return!0}else if(oY(t,i))return!0;return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=Bs.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{try{const c=t.session?.namespaces?.[e]?.accounts||[],l=t.rpcProviders?.[e]?.getDefaultChain(),u=a.map(d=>{const h=c.find(m=>m.includes(`${e}:${l}:${d}`));if(!h)return;const{chainId:f,chainNamespace:p}=pn.parseCaipAddress(h);return{address:d,chainId:f,chainNamespace:p}}).filter(d=>d!==void 0);u.length>0&&s(u)}catch{}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const n=new Set,r=t?.session?.namespaces?.[e]?.accounts?.map(s=>pn.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}},lY=[j.CONNECTOR_ID.AUTH,j.CONNECTOR_ID.WALLET_CONNECT];class UT{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>I.getCaipNetworks(n),this.getConnectorId=n=>re.getConnectorId(n),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());e&&r&&this.addConnection({connectorId:j.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:j.CONNECTOR_ID.AUTH,type:"AUTH",name:j.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>n.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){I.setAccountProp("status",e,n)}on(e,n){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw Bs.isUserRejectedRequestError(n)?new Zm(n):n}}async switchNetwork(e){const{caipNetwork:n}=e,r=yt.getProviderId(n.chainNamespace),s=yt.getProvider(n.chainNamespace);if(!s)throw new Error("Provider not found");if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(r==="AUTH"){const i=re.getAuthConnector()?.provider;if(!i)throw new Error("Auth provider not found");const o=An(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n.id==="walletConnect");if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=de.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=de.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){if(e.length>0){const{address:s}=de.getAccount(e[0]),i=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&this.getConnectorId(j.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:e.map(o=>{const{address:a}=de.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),this.getConnectorId(j.CHAIN.EVM)?.toLowerCase()===e.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){const r=typeof e=="string"&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),s=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),this.getConnectorId(j.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(lY.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[n]=e.accounts;this.emit("accountChanged",{address:n?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>l.connectorId.toLowerCase()===n.toLowerCase());if(!o)return null;const a=s.find(l=>l.id.toLowerCase()===o.connectorId.toLowerCase()),c=e?o.accounts.find(l=>l.address.toLowerCase()===e.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){const[o]=i.accounts,a=s.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}}let Bo=null;const nr={getSIWX(){return Z.state.siwx},async initializeIfEnabled(t=I.getActiveCaipAddress()){const e=Z.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(I.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(Z.state.remoteFeatures?.emailCapture){const o=I.getAccountData(n)?.user;await at.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(Bo&&await Bo,(await e.getSessions(`${n}:${r}`,s)).length)return;await at.open({view:"SIWXSignMessage"})}catch(i){ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await ue._getClient()?.disconnect().catch(console.error),Ie.reset("Connect"),Wt.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(t=I.getActiveCaipAddress()){if(!Z.state.siwx||!t)return!0;const{chainNamespace:n,chainId:r,address:s}=pn.parseCaipAddress(t),i=`${n}:${r}`;return(await nr.getSessions({address:s,caipNetworkId:i})).length>0},async requestSignMessage(){const t=Z.state.siwx,e=de.getPlainAddress(I.getActiveCaipAddress()),n=gl();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");try{const r=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),s=r.toString();let i="";t.signMessage?i=await t.signMessage({message:s,chainId:n.caipNetworkId,accountAddress:e}):(re.getConnectorId(n.chainNamespace)===j.CONNECTOR_ID.AUTH&&Ie.pushTransactionStack({}),i=await ue.signMessage(s)||""),await t.addSession({data:r,message:s,signature:i}),I.setLastConnectedSIWECaipNetwork(n),at.close(),ze.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(r){(!at.state.open||Ie.state.view==="ApproveTransaction")&&await at.open({view:"SIWXSignMessage"}),Wt.showError("Error signing message"),ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(r)})}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const n=I.getLastConnectedSIWECaipNetwork();if(n){const r=await t?.getSessions(n?.caipNetworkId,de.getPlainAddress(I.getActiveCaipAddress())||"");r&&r.length>0?await I.switchActiveNetwork(n):await ue.disconnect()}else await ue.disconnect()}else at.close();at.close(),ze.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch{}},async getAllSessions(){const t=this.getSIWX(),e=I.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await t?.getSessions(r.caipNetworkId,de.getPlainAddress(I.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(t){const e=Z.state.siwx;let n=t?.address;if(!n){const s=I.getActiveCaipAddress();n=de.getPlainAddress(s)}let r=t?.caipNetworkId;return r||(r=I.getActiveCaipNetwork()?.caipNetworkId),e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=Ie.state.view==="ApproveTransaction",n=Ie.state.view==="SIWXSignMessage";if(e||n)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=nr.getSIWX(),o=gl();if(!i||!s.includes(j.CHAIN.EVM)||Z.state.remoteFeatures?.emailCapture){const d=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:l,preferredAccountType:r});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await nr.addEmbeddedWalletSession(l,u.message,u.signature),I.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(Bo)return Bo;const r=nr.getSIWX();return r?(Bo=r.addSession({data:t,message:e,signature:n}).finally(()=>{Bo=null}),Bo):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){const r=nr.getSIWX(),s=gl(),i=new Set(e.map(l=>l.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:gl()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(l=>l!==o.chainId)]});Wt.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(I.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){const l=a.auths.map(u=>{const d=t.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud??"",version:u.p.version||o.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:d,signature:u.s.s,cacao:u}});try{await r.setSessions(l),s&&I.setLastConnectedSIWECaipNetwork(s),ze.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:nr.getSIWXEventProperties()})}catch(u){throw ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:nr.getSIWXEventProperties(u)}),await t.disconnect().catch(console.error),u}finally{Wt.hide()}}return!0},getSIWXEventProperties(t){const e=I.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:I.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:An(e)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?de.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}};class MT{constructor({provider:e,namespace:n}){this.id=j.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=I.getCaipNetworks.bind(I),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=Z.state.universalProviderConfigOverride,s=Bs.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return nr.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:uY})}}const uY=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],Ki={getGasPriceInEther(t,e){const n=e*t;return Number(n)/1e18},getGasPriceInUSD(t,e,n){const r=Ki.getGasPriceInEther(e,n);return Jt.bigNumber(t).times(r).toNumber()},getPriceImpact({sourceTokenAmount:t,sourceTokenPriceInUSD:e,toTokenPriceInUSD:n,toTokenAmount:r}){const s=Jt.bigNumber(t).times(e),i=Jt.bigNumber(r).times(n);return s.minus(i).div(s).times(100).toNumber()},getMaxSlippage(t,e){const n=Jt.bigNumber(t).div(100);return Jt.multiply(e,n).toNumber()},getProviderFee(t,e=.0085){return Jt.bigNumber(t).times(e).toString()},isInsufficientNetworkTokenForGas(t,e){const n=e||"0";return Jt.bigNumber(t).eq(0)?!0:Jt.bigNumber(Jt.bigNumber(n)).gt(t)},isInsufficientSourceTokenForSwap(t,e,n){const r=n?.find(i=>i.address===e)?.quantity?.numeric;return Jt.bigNumber(r||"0").lt(t)}},ts=Rt({message:"",variant:"info",open:!1}),dY={state:ts,subscribeKey(t,e){return en(ts,t,e)},open(t,e){const{debug:n}=Z.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(ts.message=s,ts.variant=e,ts.open=!0)},warn(t,e,n){ts.open=!0,ts.message=t,ts.variant="warning"},close(){ts.open=!1,ts.message="",ts.variant="info"}},kn=_r(dY),bv=15e4,hY=6,Vn={initializing:!1,initialized:!1,loadingPrices:!1,loadingQuote:!1,loadingApprovalTransaction:!1,loadingBuildTransaction:!1,loadingTransaction:!1,switchingTokens:!1,fetchError:!1,approvalTransaction:void 0,swapTransaction:void 0,transactionError:void 0,sourceToken:void 0,sourceTokenAmount:"",sourceTokenPriceInUSD:0,toToken:void 0,toTokenAmount:"",toTokenPriceInUSD:0,networkPrice:"0",networkBalanceInUSD:"0",networkTokenSymbol:"",inputError:void 0,slippage:et.CONVERT_SLIPPAGE_TOLERANCE,tokens:void 0,popularTokens:void 0,suggestedTokens:void 0,foundTokens:void 0,myTokensWithBalance:void 0,tokensPriceMap:{},gasFee:"0",gasPriceInUSD:0,priceImpact:void 0,maxSlippage:void 0,providerFee:void 0},K=Rt({...Vn}),Vd={state:K,subscribe(t){return Qt(K,()=>t(K))},subscribeKey(t,e){return en(K,t,e)},getParams(){const t=I.state.activeChain,e=I.getAccountData(t)?.caipAddress??I.state.activeCaipAddress,n=de.getPlainAddress(e),r=eu(),s=re.getConnectorId(I.state.activeChain);if(!n)throw new Error("No address found to swap the tokens from.");const i=!K.toToken?.address||!K.toToken?.decimals,o=!K.sourceToken?.address||!K.sourceToken?.decimals||!Jt.bigNumber(K.sourceTokenAmount).gt(0),a=!K.sourceTokenAmount;return{networkAddress:r,fromAddress:n,fromCaipAddress:e,sourceTokenAddress:K.sourceToken?.address,toTokenAddress:K.toToken?.address,toTokenAmount:K.toTokenAmount,toTokenDecimals:K.toToken?.decimals,sourceTokenAmount:K.sourceTokenAmount,sourceTokenDecimals:K.sourceToken?.decimals,invalidToToken:i,invalidSourceToken:o,invalidSourceTokenAmount:a,availableToSwap:e&&!i&&!o&&!a,isAuthConnector:s===j.CONNECTOR_ID.AUTH}},async setSourceToken(t){if(!t){K.sourceToken=t,K.sourceTokenAmount="",K.sourceTokenPriceInUSD=0;return}K.sourceToken=t,await He.setTokenPrice(t.address,"sourceToken")},setSourceTokenAmount(t){K.sourceTokenAmount=t},async setToToken(t){if(!t){K.toToken=t,K.toTokenAmount="",K.toTokenPriceInUSD=0;return}K.toToken=t,await He.setTokenPrice(t.address,"toToken")},setToTokenAmount(t){K.toTokenAmount=t?Jt.toFixed(t,hY):""},async setTokenPrice(t,e){let n=K.tokensPriceMap[t]||0;n||(K.loadingPrices=!0,n=await He.getAddressPrice(t)),e==="sourceToken"?K.sourceTokenPriceInUSD=n:e==="toToken"&&(K.toTokenPriceInUSD=n),K.loadingPrices&&(K.loadingPrices=!1),He.getParams().availableToSwap&&!K.switchingTokens&&He.swapTokens()},async switchTokens(){if(!(K.initializing||!K.initialized||K.switchingTokens)){K.switchingTokens=!0;try{const t=K.toToken?{...K.toToken}:void 0,e=K.sourceToken?{...K.sourceToken}:void 0,n=t&&K.toTokenAmount===""?"1":K.toTokenAmount;He.setSourceTokenAmount(n),He.setToTokenAmount(""),await He.setSourceToken(t),await He.setToToken(e),K.switchingTokens=!1,He.swapTokens()}catch(t){throw K.switchingTokens=!1,t}}},resetState(){K.myTokensWithBalance=Vn.myTokensWithBalance,K.tokensPriceMap=Vn.tokensPriceMap,K.initialized=Vn.initialized,K.initializing=Vn.initializing,K.switchingTokens=Vn.switchingTokens,K.sourceToken=Vn.sourceToken,K.sourceTokenAmount=Vn.sourceTokenAmount,K.sourceTokenPriceInUSD=Vn.sourceTokenPriceInUSD,K.toToken=Vn.toToken,K.toTokenAmount=Vn.toTokenAmount,K.toTokenPriceInUSD=Vn.toTokenPriceInUSD,K.networkPrice=Vn.networkPrice,K.networkTokenSymbol=Vn.networkTokenSymbol,K.networkBalanceInUSD=Vn.networkBalanceInUSD,K.inputError=Vn.inputError},resetValues(){const{networkAddress:t}=He.getParams(),e=K.tokens?.find(n=>n.address===t);He.setSourceToken(e),He.setToToken(void 0)},getApprovalLoadingState(){return K.loadingApprovalTransaction},clearError(){K.transactionError=void 0},async initializeState(){if(!K.initializing){if(K.initializing=!0,!K.initialized)try{await He.fetchTokens(),K.initialized=!0}catch{K.initialized=!1,Wt.showError("Failed to initialize swap"),Ie.goBack()}K.initializing=!1}},async fetchTokens(){const{networkAddress:t}=He.getParams();await He.getNetworkTokenPrice(),await He.getMyTokensWithBalance();const e=K.myTokensWithBalance?.find(n=>n.address===t);e&&(K.networkTokenSymbol=e.symbol,He.setSourceToken(e),He.setSourceTokenAmount("0"))},async getTokenList(){const t=I.state.activeCaipNetwork?.caipNetworkId;if(!(K.caipNetworkId===t&&K.tokens))try{K.tokensLoading=!0;const e=await Za.getTokenList(t);K.tokens=e,K.caipNetworkId=t,K.popularTokens=e.sort((o,a)=>o.symbol<a.symbol?-1:o.symbol>a.symbol?1:0);const r=(t&&et.SUGGESTED_TOKENS_BY_CHAIN?.[t]||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o),i=(et.SWAP_SUGGESTED_TOKENS||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o).filter(o=>!r.some(a=>a.address===o.address));K.suggestedTokens=[...r,...i]}catch{K.tokens=[],K.popularTokens=[],K.suggestedTokens=[]}finally{K.tokensLoading=!1}},async getAddressPrice(t){const e=K.tokensPriceMap[t];if(e)return e;const r=(await Ue.fetchTokenPrice({addresses:[t]}))?.fungibles||[],i=[...K.tokens||[],...K.myTokensWithBalance||[]]?.find(c=>c.address===t)?.symbol,o=r.find(c=>c.symbol.toLowerCase()===i?.toLowerCase())?.price||0,a=parseFloat(o.toString());return K.tokensPriceMap[t]=a,a},async getNetworkTokenPrice(){const{networkAddress:t}=He.getParams(),n=(await Ue.fetchTokenPrice({addresses:[t]}).catch(()=>(Wt.showError("Failed to fetch network token price"),{fungibles:[]}))).fungibles?.[0],r=n?.price.toString()||"0";K.tokensPriceMap[t]=parseFloat(r),K.networkTokenSymbol=n?.symbol||"",K.networkPrice=r},async getMyTokensWithBalance(t){const e=await Qh.getMyTokensWithBalance(t),n=Za.mapBalancesToSwapTokens(e);n&&(await He.getInitialGasPrice(),He.setBalances(n))},setBalances(t){const{networkAddress:e}=He.getParams(),n=I.state.activeCaipNetwork;if(!n)return;const r=t.find(s=>s.address===e);t.forEach(s=>{K.tokensPriceMap[s.address]=s.price||0}),K.myTokensWithBalance=t.filter(s=>s.address.startsWith(n.caipNetworkId)),K.networkBalanceInUSD=r?Jt.multiply(r.quantity.numeric,r.price).toString():"0"},async getInitialGasPrice(){const t=await Za.fetchGasPrice();if(!t)return{gasPrice:null,gasPriceInUSD:null};switch(I.state?.activeCaipNetwork?.chainNamespace){case j.CHAIN.SOLANA:return K.gasFee=t.standard??"0",K.gasPriceInUSD=Jt.multiply(t.standard,K.networkPrice).div(1e9).toNumber(),{gasPrice:BigInt(K.gasFee),gasPriceInUSD:Number(K.gasPriceInUSD)};case j.CHAIN.EVM:default:const e=t.standard??"0",n=BigInt(e),r=BigInt(bv),s=Ki.getGasPriceInUSD(K.networkPrice,r,n);return K.gasFee=e,K.gasPriceInUSD=s,{gasPrice:n,gasPriceInUSD:s}}},async swapTokens(){const t=I.getAccountData()?.address,e=K.sourceToken,n=K.toToken,r=Jt.bigNumber(K.sourceTokenAmount).gt(0);if(r||He.setToTokenAmount(""),!n||!e||K.loadingPrices||!r||!t)return;K.loadingQuote=!0;const s=Jt.bigNumber(K.sourceTokenAmount).times(10**e.decimals).round(0);try{const i=await Ue.fetchSwapQuote({userAddress:t,from:e.address,to:n.address,gasPrice:K.gasFee,amount:s.toString()});K.loadingQuote=!1;const o=i?.quotes?.[0]?.toAmount;if(!o){kn.open({displayMessage:"Incorrect amount",debugMessage:"Please enter a valid amount"},"error");return}const a=Jt.bigNumber(o).div(10**n.decimals).toString();He.setToTokenAmount(a),He.hasInsufficientToken(K.sourceTokenAmount,e.address)?K.inputError="Insufficient balance":(K.inputError=void 0,He.setTransactionDetails())}catch(i){const o=await Za.handleSwapError(i);K.loadingQuote=!1,K.inputError=o||"Insufficient balance"}},async getTransaction(){const{fromCaipAddress:t,availableToSwap:e}=He.getParams(),n=K.sourceToken,r=K.toToken;if(!(!t||!e||!n||!r||K.loadingQuote))try{K.loadingBuildTransaction=!0;const s=await Za.fetchSwapAllowance({userAddress:t,tokenAddress:n.address,sourceTokenAmount:K.sourceTokenAmount,sourceTokenDecimals:n.decimals});let i;return s?i=await He.createSwapTransaction():i=await He.createAllowanceTransaction(),K.loadingBuildTransaction=!1,K.fetchError=!1,i}catch{Ie.goBack(),Wt.showError("Failed to check allowance"),K.loadingBuildTransaction=!1,K.approvalTransaction=void 0,K.swapTransaction=void 0,K.fetchError=!0;return}},async createAllowanceTransaction(){const{fromCaipAddress:t,sourceTokenAddress:e,toTokenAddress:n}=He.getParams();if(!(!t||!n)){if(!e)throw new Error("createAllowanceTransaction - No source token address found.");try{const r=await Ue.generateApproveCalldata({from:e,to:n,userAddress:t}),s=de.getPlainAddress(r.tx.from);if(!s)throw new Error("SwapController:createAllowanceTransaction - address is required");const i={data:r.tx.data,to:s,gasPrice:BigInt(r.tx.eip155.gasPrice),value:BigInt(r.tx.value),toAmount:K.toTokenAmount};return K.swapTransaction=void 0,K.approvalTransaction={data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount},{data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount}}catch{Ie.goBack(),Wt.showError("Failed to create approval transaction"),K.approvalTransaction=void 0,K.swapTransaction=void 0,K.fetchError=!0;return}}},async createSwapTransaction(){const{networkAddress:t,fromCaipAddress:e,sourceTokenAmount:n}=He.getParams(),r=K.sourceToken,s=K.toToken;if(!e||!n||!r||!s)return;const i=ue.parseUnits(n,r.decimals)?.toString();try{const o=await Ue.generateSwapCalldata({userAddress:e,from:r.address,to:s.address,amount:i,disableEstimate:!0}),a=r.address===t,c=BigInt(o.tx.eip155.gas),l=BigInt(o.tx.eip155.gasPrice),u=de.getPlainAddress(o.tx.to);if(!u)throw new Error("SwapController:createSwapTransaction - address is required");const d={data:o.tx.data,to:u,gas:c,gasPrice:l,value:BigInt(a?i??"0":"0"),toAmount:K.toTokenAmount};return K.gasPriceInUSD=Ki.getGasPriceInUSD(K.networkPrice,c,l),K.approvalTransaction=void 0,K.swapTransaction=d,d}catch{Ie.goBack(),Wt.showError("Failed to create transaction"),K.approvalTransaction=void 0,K.swapTransaction=void 0,K.fetchError=!0;return}},onEmbeddedWalletApprovalSuccess(){Wt.showLoading("Approve limit increase in your wallet"),Ie.replace("SwapPreview")},async sendTransactionForApproval(t){const{fromAddress:e,isAuthConnector:n}=He.getParams();K.loadingApprovalTransaction=!0,n?Ie.pushTransactionStack({onSuccess:He.onEmbeddedWalletApprovalSuccess}):Wt.showLoading("Approve limit increase in your wallet");try{await ue.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:j.CHAIN.EVM}),await He.swapTokens(),await He.getTransaction(),K.approvalTransaction=void 0,K.loadingApprovalTransaction=!1}catch(s){const i=s;K.transactionError=i?.displayMessage,K.loadingApprovalTransaction=!1,Wt.showError(i?.displayMessage||"Transaction error"),ze.sendEvent({type:"track",event:"SWAP_APPROVAL_ERROR",properties:{message:i?.displayMessage||i?.message||"Unknown",network:I.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:He.state.sourceToken?.symbol||"",swapToToken:He.state.toToken?.symbol||"",swapFromAmount:He.state.sourceTokenAmount||"",swapToAmount:He.state.toTokenAmount||"",isSmartAccount:An(j.CHAIN.EVM)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT}})}},async sendTransactionForSwap(t){if(!t)return;const{fromAddress:e,toTokenAmount:n,isAuthConnector:r}=He.getParams();K.loadingTransaction=!0;const s=`Swapping ${K.sourceToken?.symbol} to ${Jt.formatNumberToLocalString(n,3)} ${K.toToken?.symbol}`,i=`Swapped ${K.sourceToken?.symbol} to ${Jt.formatNumberToLocalString(n,3)} ${K.toToken?.symbol}`;r?Ie.pushTransactionStack({onSuccess(){Ie.replace("Account"),Wt.showLoading(s),Vd.resetState()}}):Wt.showLoading("Confirm transaction in your wallet");try{const o=[K.sourceToken?.address,K.toToken?.address].join(","),a=await ue.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:j.CHAIN.EVM});return K.loadingTransaction=!1,Wt.showSuccess(i),ze.sendEvent({type:"track",event:"SWAP_SUCCESS",properties:{network:I.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:He.state.sourceToken?.symbol||"",swapToToken:He.state.toToken?.symbol||"",swapFromAmount:He.state.sourceTokenAmount||"",swapToAmount:He.state.toTokenAmount||"",isSmartAccount:An(j.CHAIN.EVM)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT}}),Vd.resetState(),r||Ie.replace("Account"),Vd.getMyTokensWithBalance(o),a}catch(o){const a=o;K.transactionError=a?.displayMessage,K.loadingTransaction=!1,Wt.showError(a?.displayMessage||"Transaction error"),ze.sendEvent({type:"track",event:"SWAP_ERROR",properties:{message:a?.displayMessage||a?.message||"Unknown",network:I.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:He.state.sourceToken?.symbol||"",swapToToken:He.state.toToken?.symbol||"",swapFromAmount:He.state.sourceTokenAmount||"",swapToAmount:He.state.toTokenAmount||"",isSmartAccount:An(j.CHAIN.EVM)===Kt.ACCOUNT_TYPES.SMART_ACCOUNT}});return}},hasInsufficientToken(t,e){return Ki.isInsufficientSourceTokenForSwap(t,e,K.myTokensWithBalance)},setTransactionDetails(){const{toTokenAddress:t,toTokenDecimals:e}=He.getParams();!t||!e||(K.gasPriceInUSD=Ki.getGasPriceInUSD(K.networkPrice,BigInt(K.gasFee),BigInt(bv)),K.priceImpact=Ki.getPriceImpact({sourceTokenAmount:K.sourceTokenAmount,sourceTokenPriceInUSD:K.sourceTokenPriceInUSD,toTokenPriceInUSD:K.toTokenPriceInUSD,toTokenAmount:K.toTokenAmount}),K.maxSlippage=Ki.getMaxSlippage(K.slippage,K.toTokenAmount),K.providerFee=Ki.getProviderFee(K.sourceTokenAmount))}},He=_r(Vd),ns=Rt({message:"",open:!1,triggerRect:{width:0,height:0,top:0,left:0},variant:"shade"}),fY={state:ns,subscribe(t){return Qt(ns,()=>t(ns))},subscribeKey(t,e){return en(ns,t,e)},showTooltip({message:t,triggerRect:e,variant:n}){ns.open=!0,ns.message=t,ns.triggerRect=e,ns.variant=n},hide(){ns.open=!1,ns.message="",ns.triggerRect={width:0,height:0,top:0,left:0}}},JX=_r(fY),al=Rt({isLegalCheckboxChecked:!1}),ZX={state:al,subscribe(t){return Qt(al,()=>t(al))},subscribeKey(t,e){return en(al,t,e)},setIsLegalCheckboxChecked(t){al.isLegalCheckboxChecked=t}},pY={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class gY extends Error{}function mY(){const{sdkType:t,sdkVersion:e,projectId:n}=Z.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function By(t,e){const n=mY(),{projectId:r}=Z.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new gY(o.error.message);return o}async function yY(t){return(await By("reown_getExchanges",t)).result}async function wY(t){return(await By("reown_getExchangePayUrl",t)).result}async function EY(t){return(await By("reown_getExchangeBuyStatus",t)).result}function vv(t,e){const{chainNamespace:n,chainId:r}=pn.parseCaipNetworkId(t),s=pY[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const bY={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},vY={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},LT={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},_Y={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},CY={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},AY={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},IY={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},SY={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},TY={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},NY={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},OY={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},RY={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},PY={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},xY={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},kY={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},DY={ethereumETH:bY,baseETH:vY,baseUSDC:LT,baseSepoliaETH:CY,ethereumUSDC:AY,arbitrumUSDC:IY,polygonUSDC:SY,solanaUSDC:TY,ethereumUSDT:NY,optimismUSDT:OY,arbitrumUSDT:RY,polygonUSDT:PY,solanaUSDT:xY,solanaSOL:kY};function UY(t){return Object.values(DY).filter(e=>e.network===t)}const MY=0,$T={paymentAsset:null,amount:null,tokenAmount:0,priceLoading:!1,error:null,exchanges:[],isLoading:!1,currentPayment:void 0,isPaymentInProgress:!1,paymentId:"",assets:[]},Fe=Rt($T),Fo={state:Fe,subscribe(t){return Qt(Fe,()=>t(Fe))},subscribeKey(t,e){return en(Fe,t,e)},resetState(){Object.assign(Fe,{...$T})},async getAssetsForNetwork(t){const e=UY(t),n=await Fo.getAssetsImageAndPrice(e),r=e.map(s=>{const i=s.asset==="native"?eu():`${s.network}:${s.asset}`,o=n.find(a=>a.fungibles?.[0]?.address?.toLowerCase()===i.toLowerCase());return{...s,price:o?.fungibles?.[0]?.price||1,metadata:{...s.metadata,iconUrl:o?.fungibles?.[0]?.iconUrl}}});return Fe.assets=r,r},async getAssetsImageAndPrice(t){const e=t.map(r=>r.asset==="native"?eu():`${r.network}:${r.asset}`);return await Promise.all(e.map(r=>Ue.fetchTokenPrice({addresses:[r]})))},getTokenAmount(){if(!Fe?.paymentAsset?.price)throw new Error("Cannot get token price");const t=Jt.bigNumber(Fe.amount??0).round(8),e=Jt.bigNumber(Fe.paymentAsset.price).round(8);return t.div(e).round(8).toNumber()},setAmount(t){Fe.amount=t,Fe.paymentAsset?.price&&(Fe.tokenAmount=Fo.getTokenAmount())},setPaymentAsset(t){Fe.paymentAsset=t},isPayWithExchangeEnabled(){return Z.state.remoteFeatures?.payWithExchange},isPayWithExchangeSupported(){return Fo.isPayWithExchangeEnabled()&&I.state.activeCaipNetwork&&et.PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES.includes(I.state.activeCaipNetwork.chainNamespace)},async fetchExchanges(){try{const t=Fo.isPayWithExchangeSupported();if(!Fe.paymentAsset||!t){Fe.exchanges=[],Fe.isLoading=!1;return}Fe.isLoading=!0;const e=await yY({page:MY,asset:vv(Fe.paymentAsset.network,Fe.paymentAsset.asset),amount:Fe.amount?.toString()??"0"});Fe.exchanges=e.exchanges.slice(0,2)}catch{throw Wt.showError("Unable to get exchanges"),new Error("Unable to get exchanges")}finally{Fe.isLoading=!1}},async getPayUrl(t,e){try{const n=Number(e.amount),r=await wY({exchangeId:t,asset:vv(e.network,e.asset),amount:n.toString(),recipient:`${e.network}:${e.recipient}`});return ze.sendEvent({type:"track",event:"PAY_EXCHANGE_SELECTED",properties:{exchange:{id:t},configuration:{network:e.network,asset:e.asset,recipient:e.recipient,amount:n},currentPayment:{type:"exchange",exchangeId:t},source:"fund-from-exchange",headless:!1}}),r}catch(n){throw n instanceof Error&&n.message.includes("is not supported")?new Error("Asset not supported"):new Error(n.message)}},async handlePayWithExchange(t){try{const e=I.getAccountData()?.address;if(!e)throw new Error("No account connected");if(!Fe.paymentAsset)throw new Error("No payment asset selected");const n=de.returnOpenHref("","popupWindow","scrollbar=yes,width=480,height=720");if(!n)throw new Error("Could not create popup window");Fe.isPaymentInProgress=!0,Fe.paymentId=crypto.randomUUID(),Fe.currentPayment={type:"exchange",exchangeId:t};const{network:r,asset:s}=Fe.paymentAsset,i={network:r,asset:s,amount:Fe.tokenAmount,recipient:e},o=await Fo.getPayUrl(t,i);if(!o){try{n.close()}catch{}throw new Error("Unable to initiate payment")}Fe.currentPayment.sessionId=o.sessionId,Fe.currentPayment.status="IN_PROGRESS",Fe.currentPayment.exchangeId=t,n.location.href=o.url}catch{Fe.error="Unable to initiate payment",Wt.showError(Fe.error)}},async waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r=20}){const s=await Fo.getBuyStatus(t,e,n);if(s.status==="SUCCESS"||s.status==="FAILED")return s;if(r===0)throw new Error("Unable to get deposit status");return await new Promise(i=>{setTimeout(i,5e3)}),Fo.waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r-1})},async getBuyStatus(t,e,n){try{if(!Fe.currentPayment)throw new Error("No current payment");const r=await EY({sessionId:e,exchangeId:t});if(Fe.currentPayment.status=r.status,r.status==="SUCCESS"||r.status==="FAILED"){const s=I.getAccountData()?.address;Fe.currentPayment.result=r.txHash,Fe.isPaymentInProgress=!1,ze.sendEvent({type:"track",event:r.status==="SUCCESS"?"PAY_SUCCESS":"PAY_ERROR",properties:{message:r.status==="FAILED"?de.parseError(Fe.error):void 0,source:"fund-from-exchange",paymentId:n,configuration:{network:Fe.paymentAsset?.network||"",asset:Fe.paymentAsset?.asset||"",recipient:s||"",amount:Fe.amount??0},currentPayment:{type:"exchange",exchangeId:Fe.currentPayment?.exchangeId,sessionId:Fe.currentPayment?.sessionId,result:r.txHash}}})}return r}catch{return{status:"UNKNOWN",txHash:""}}},reset(){Fe.currentPayment=void 0,Fe.isPaymentInProgress=!1,Fe.paymentId="",Fe.paymentAsset=null,Fe.amount=0,Fe.tokenAmount=0,Fe.priceLoading=!1,Fe.error=null,Fe.exchanges=[],Fe.isLoading=!1}},Vr={getConnectorsByType(t,e,n){const{customWallets:r}=Z.state,s=te.getRecentWallets(),i=ao.filterOutDuplicateWallets(e),o=ao.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,n=!!e&&_e.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),r=!!t.name&&_e.state.excludedWallets.some(s=>XC.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!de.isMobile()||de.isMobile()&&!e&&!ue.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(I.state.chains.values()).some(n=>re.getConnectorId(n.namespace)===j.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=Z.state.features?.connectorTypeOrder??[]}){const u=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(p=>p.isEnabled),d=new Set(u.map(p=>p.type)),h=c.filter(p=>d.has(p)).map(p=>({type:p,isEnabled:!0})),f=u.filter(({type:p})=>!h.some(({type:g})=>g===p));return Array.from(new Set([...h,...f].map(({type:p})=>p)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!de.isMobile())return{accounts:[],chainId:void 0};if(t.id===j.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,n]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:e,chainId:n}}catch{return{accounts:[],chainId:void 0}}},getFilteredCustomWallets(t){const e=te.getRecentWallets(),n=re.state.connectors.map(o=>o.info?.rdns).filter(Boolean),r=e.map(o=>o.rdns).filter(Boolean),s=n.concat(r);if(s.includes("io.metamask.mobile")&&de.isMobile()){const o=s.indexOf("io.metamask.mobile");s[o]="io.metamask"}return t.filter(o=>!s.includes(String(o?.rdns)))},hasWalletConnector(t){return re.state.connectors.some(e=>e.id===t.id||e.name===t.name)},isWalletCompatibleWithCurrentChain(t){const e=I.state.activeChain;return e&&t.chains?t.chains.some(n=>{const r=n.split(":")[0];return e===r}):!0},getFilteredRecentWallets(){return te.getRecentWallets().filter(n=>!ao.isExcluded(n)).filter(n=>!this.hasWalletConnector(n)).filter(n=>this.isWalletCompatibleWithCurrentChain(n))},getCappedRecommendedWallets(t){const{connectors:e}=re.state,{customWallets:n,featuredWalletIds:r}=Z.state,s=e.find(N=>N.id==="walletConnect"),i=e.filter(N=>N.type==="INJECTED"||N.type==="ANNOUNCED"||N.type==="MULTI_CHAIN");if(!s&&!i.length&&!n?.length)return[];const o=kg.isEmailEnabled(),a=kg.isSocialsEnabled(),c=i.filter(N=>N.name!=="Browser Wallet"&&N.name!=="WalletConnect"),l=r?.length||0,u=n?.length||0,d=c.length||0,h=o?1:0,f=a?1:0,p=l+u+d+h+f,g=Math.max(0,4-p);return g<=0?[]:ao.filterOutDuplicateWallets(t).slice(0,g)},processConnectorsByType(t,e=!0){const n=Vr.sortConnectorsByExplorerWallet([...t]);return e?n.filter(Vr.showConnector):n},connectorList(){const t=Vr.getConnectorsByType(re.state.connectors,_e.state.recommended,_e.state.featured),e=this.processConnectorsByType(t.announced.filter(f=>f.id!=="walletConnect")),n=this.processConnectorsByType(t.injected),r=this.processConnectorsByType(t.multiChain.filter(f=>f.name!=="WalletConnect"),!1),s=t.custom,i=t.recent,o=this.processConnectorsByType(t.external.filter(f=>f.id!==j.CONNECTOR_ID.COINBASE_SDK&&f.id!==j.CONNECTOR_ID.BASE_ACCOUNT)),a=t.recommended,c=t.featured,l=Vr.getConnectorTypeOrder({custom:s,recent:i,announced:e,injected:n,multiChain:r,recommended:a,featured:c,external:o}),u=re.state.connectors.find(f=>f.id==="walletConnect"),d=de.isMobile(),h=[];for(const f of l)switch(f){case"walletConnect":{!d&&u&&h.push({kind:"connector",subtype:"walletConnect",connector:u});break}case"recent":{Vr.getFilteredRecentWallets().forEach(m=>h.push({kind:"wallet",subtype:"recent",wallet:m}));break}case"injected":{r.forEach(p=>h.push({kind:"connector",subtype:"multiChain",connector:p})),e.forEach(p=>h.push({kind:"connector",subtype:"announced",connector:p})),n.forEach(p=>h.push({kind:"connector",subtype:"injected",connector:p}));break}case"featured":{c.forEach(p=>h.push({kind:"wallet",subtype:"featured",wallet:p}));break}case"custom":{Vr.getFilteredCustomWallets(s??[]).forEach(m=>h.push({kind:"wallet",subtype:"custom",wallet:m}));break}case"external":{o.forEach(p=>h.push({kind:"connector",subtype:"external",connector:p}));break}case"recommended":{Vr.getCappedRecommendedWallets(a).forEach(m=>h.push({kind:"wallet",subtype:"recommended",wallet:m}));break}default:}return h},hasInjectedConnectors(){return re.state.connectors.filter(t=>(t.type==="INJECTED"||t.type==="ANNOUNCED"||t.type==="MULTI_CHAIN")&&t.name!=="Browser Wallet"&&t.name!=="WalletConnect").length}},ao={filterOutDuplicatesByRDNS(t){const e=Z.state.enableEIP6963?re.state.connectors:[],n=te.getRecentWallets(),r=e.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&de.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=re.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"||a.type==="MULTI_CHAIN"),n=te.getRecentWallets(),r=e.map(a=>a.explorerId||a.explorerWallet?.id||a.id),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=re.state,{featuredWalletIds:n}=Z.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const n=t?.connectMethodsOrder||Z.state.features?.connectMethodsOrder,r=e||re.state.connectors;if(n)return n;const{injected:s,announced:i}=Vr.getConnectorsByType(r,_e.state.recommended,_e.state.featured),o=s.filter(Vr.showConnector),a=i.filter(Vr.showConnector);return o.length||a.length?["wallet","email","social"]:et.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&_e.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&_e.state.excludedWallets.some(r=>XC.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))},filterWalletsByWcSupport(t){return ue.state.wcBasic?t.filter(e=>e.supports_wc):de.isMobile()?t.filter(e=>e.supports_wc||et.MANDATORY_WALLET_IDS_ON_MOBILE.includes(e.id)):t},getWalletConnectWallets(t){const e=[..._e.state.featured,..._e.state.recommended];_e.state.filteredWallets?.length>0?e.push(..._e.state.filteredWallets):e.push(...t);const n=de.uniqueBy(e,"id"),r=ao.markWalletsAsInstalled(n),s=ao.filterWalletsByWcSupport(r);return ao.markWalletsWithDisplayIndex(s)}},XX={isUnsupportedChainView(){return Ie.state.view==="UnsupportedChain"||Ie.state.view==="SwitchNetwork"&&Ie.state.history.includes("UnsupportedChain")},async safeClose(){if(this.isUnsupportedChainView()){at.shake();return}if(await nr.isSIWXCloseDisabled()){at.shake();return}(Ie.state.view==="DataCapture"||Ie.state.view==="DataCaptureOtpConfirm")&&ue.disconnect(),at.close()}},tr={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:j.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},BT={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700","-239":"20f673c0-095e-49b2-07cf-eb5049dcf600","-3":"20f673c0-095e-49b2-07cf-eb5049dcf600"}},di={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${tr.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=I.state.activeChain;return j.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>re.getConnectorId(e)===j.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return j.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?j.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=te.getConnections()[e]??[];return{hasDisconnected:te.isConnectorDisconnected(t,e),hasConnected:r.some(s=>di.isLowerCaseMatch(s.connectorId,t))}}},LY=new AbortController,Kn={EmbeddedWalletAbortController:LY,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${pl()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com. [PID: ${Z.state.projectId}]`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},FT={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:LT.asset,84532:_Y.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(FT.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},$Y={createLogger(t,e="error"){const n=ty({level:e}),{logger:r}=Xh({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},BY="rpc.walletconnect.org";function _v(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const Qp=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Xa={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===BY}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:j.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${j.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){const r=t.rpcUrls?.default?.http?.[0];return Qp.includes(e)?_v(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,n),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:BT.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>Xa.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){const r=[];return n?.forEach(s=>{r.push(Mu(s.url,s.config))}),Qp.includes(t.caipNetworkId)&&r.push(Mu(_v(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{r.push(Mu(s))}),lw(r)},extendWagmiTransports(t,e,n){if(Qp.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return lw([n,Mu(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:j.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=te.getActiveCaipNetworkId(),n=I.getAllRequestedCaipNetworks(),r=Array.from(I.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||n?.[0]}};class Nl{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){const{metadata:c,sdkVersion:l,sdkType:u}=Z.getSnapshot();return Nl.instance||(Nl.instance=new EM({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!Z.state.remoteFeatures?.emailCapture,metadata:c,sdkVersion:l,sdkType:u})),Nl.instance}}const QX={interpolate(t,e,n){if(t.length!==2||e.length!==2)throw new Error("inputRange and outputRange must be an array of length 2");const r=t[0]||0,s=t[1]||0,i=e[0]||0,o=e[1]||0;return n<r?i:n>s?o:(o-i)/(s-r)*(n-r)+i}};const Kd=globalThis,Fy=Kd.ShadowRoot&&(Kd.ShadyCSS===void 0||Kd.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,jy=Symbol(),Cv=new WeakMap;let jT=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==jy)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Fy&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Cv.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Cv.set(n,e))}return e}toString(){return this.cssText}};const cs=t=>new jT(typeof t=="string"?t:t+"",void 0,jy),no=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new jT(n,t,jy)},FY=(t,e)=>{if(Fy)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=Kd.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},Av=Fy?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return cs(n)})(t):t;const{is:jY,defineProperty:WY,getOwnPropertyDescriptor:HY,getOwnPropertyNames:zY,getOwnPropertySymbols:qY,getPrototypeOf:VY}=Object,Ef=globalThis,Iv=Ef.trustedTypes,KY=Iv?Iv.emptyScript:"",GY=Ef.reactiveElementPolyfillSupport,Ol=(t,e)=>t,Tm={toAttribute(t,e){switch(e){case Boolean:t=t?KY:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},WT=(t,e)=>!jY(t,e),Sv={attribute:!0,type:String,converter:Tm,reflect:!1,useDefault:!1,hasChanged:WT};Symbol.metadata??=Symbol("metadata"),Ef.litPropertyMetadata??=new WeakMap;let Qa=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=Sv){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&WY(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=HY(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Sv}static _$Ei(){if(this.hasOwnProperty(Ol("elementProperties")))return;const e=VY(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ol("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ol("properties"))){const n=this.properties,r=[...zY(n),...qY(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(Av(s))}else e!==void 0&&n.push(Av(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return FY(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:Tm).toAttribute(n,r.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,n){const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:Tm;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,n,r,s=!1,i){if(e!==void 0){const o=this.constructor;if(s===!1&&(i=this[e]),r??=o.getPropertyOptions(e),!((r.hasChanged??WT)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(e){}firstUpdated(e){}};Qa.elementStyles=[],Qa.shadowRootOptions={mode:"open"},Qa[Ol("elementProperties")]=new Map,Qa[Ol("finalized")]=new Map,GY?.({ReactiveElement:Qa}),(Ef.reactiveElementVersions??=[]).push("2.1.2");const Wy=globalThis,Tv=t=>t,Ph=Wy.trustedTypes,Nv=Ph?Ph.createPolicy("lit-html",{createHTML:t=>t}):void 0,HT="$lit$",ro=`lit$${Math.random().toFixed(9).slice(2)}$`,zT="?"+ro,YY=`<${zT}>`,ya=document,ou=()=>ya.createComment(""),au=t=>t===null||typeof t!="object"&&typeof t!="function",Hy=Array.isArray,JY=t=>Hy(t)||typeof t?.[Symbol.iterator]=="function",eg=`[ 	
\f\r]`,cl=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ov=/-->/g,Rv=/>/g,jo=RegExp(`>|${eg}(?:([^\\s"'>=/]+)(${eg}*=${eg}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Pv=/'/g,xv=/"/g,qT=/^(?:script|style|textarea|title)$/i,VT=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),nQ=VT(1),rQ=VT(2),_c=Symbol.for("lit-noChange"),_n=Symbol.for("lit-nothing"),kv=new WeakMap,ea=ya.createTreeWalker(ya,129);function KT(t,e){if(!Hy(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Nv!==void 0?Nv.createHTML(e):e}const ZY=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=cl;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===cl?u[1]==="!--"?o=Ov:u[1]!==void 0?o=Rv:u[2]!==void 0?(qT.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=jo):u[3]!==void 0&&(o=jo):o===jo?u[0]===">"?(o=s??cl,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?jo:u[3]==='"'?xv:Pv):o===xv||o===Pv?o=jo:o===Ov||o===Rv?o=cl:(o=jo,s=void 0);const f=o===jo&&t[a+1].startsWith("/>")?" ":"";i+=o===cl?c+YY:d>=0?(r.push(l),c.slice(0,d)+HT+c.slice(d)+ro+f):c+ro+(d===-2?a:f)}return[KT(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class cu{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=ZY(e,n);if(this.el=cu.createElement(l,r),ea.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=ea.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(HT)){const h=u[o++],f=s.getAttribute(d).split(ro),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?QY:p[1]==="?"?eJ:p[1]==="@"?tJ:bf}),s.removeAttribute(d)}else d.startsWith(ro)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(qT.test(s.tagName)){const d=s.textContent.split(ro),h=d.length-1;if(h>0){s.textContent=Ph?Ph.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],ou()),ea.nextNode(),c.push({type:2,index:++i});s.append(d[h],ou())}}}else if(s.nodeType===8)if(s.data===zT)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(ro,d+1))!==-1;)c.push({type:7,index:i}),d+=ro.length-1}i++}}static createElement(e,n){const r=ya.createElement("template");return r.innerHTML=e,r}}function Cc(t,e,n=t,r){if(e===_c)return e;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=au(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(e=Cc(t,s._$AS(t,e.values),s,r)),e}class XY{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=(e?.creationScope??ya).importNode(n,!0);ea.currentNode=s;let i=ea.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Ou(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new nJ(i,this,e)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=ea.nextNode(),o++)}return ea.currentNode=ya,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Ou{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=_n,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Cc(this,e,n),au(e)?e===_n||e==null||e===""?(this._$AH!==_n&&this._$AR(),this._$AH=_n):e!==this._$AH&&e!==_c&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):JY(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==_n&&au(this._$AH)?this._$AA.nextSibling.data=e:this.T(ya.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=cu.createElement(KT(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new XY(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(e){let n=kv.get(e.strings);return n===void 0&&kv.set(e.strings,n=new cu(e)),n}k(e){Hy(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Ou(this.O(ou()),this.O(ou()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=Tv(e).nextSibling;Tv(e).remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class bf{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=_n,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=_n}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Cc(this,e,n,0),o=!au(e)||e!==this._$AH&&e!==_c,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=Cc(this,a[r+c],n,c),l===_c&&(l=this._$AH[c]),o||=!au(l)||l!==this._$AH[c],l===_n?e=_n:e!==_n&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===_n?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class QY extends bf{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===_n?void 0:e}}class eJ extends bf{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==_n)}}class tJ extends bf{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Cc(this,e,n,0)??_n)===_c)return;const r=this._$AH,s=e===_n&&r!==_n||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==_n&&(r===_n||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class nJ{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Cc(this,e)}}const rJ=Wy.litHtmlPolyfillSupport;rJ?.(cu,Ou),(Wy.litHtmlVersions??=[]).push("3.3.2");const sJ=(t,e,n)=>{const r=n?.renderBefore??e;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new Ou(e.insertBefore(ou(),i),i,void 0,n??{})}return s._$AI(t),s};const zy=globalThis;class Gd extends Qa{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=sJ(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return _c}}Gd._$litElement$=!0,Gd.finalized=!0,zy.litElementHydrateSupport?.({LitElement:Gd});const iJ=zy.litElementPolyfillSupport;iJ?.({LitElement:Gd});(zy.litElementVersions??=[]).push("4.2.2");const oJ={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},xh={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},aJ={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},cJ={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},lJ={regular:"KHTeka",mono:"KHTekaMono"},uJ={regular:"400",medium:"500"},dJ={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},hJ={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},fJ={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},pJ={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},Nm={colors:oJ,fontFamily:lJ,fontWeight:uJ,textSize:dJ,typography:hJ,tokens:{core:xh.core,theme:xh.dark},borderRadius:aJ,spacing:cJ,durations:pJ,easings:fJ},Dv="--apkt";function bd(t){if(!t)return{};const e={};return e["font-family"]=t["--apkt-font-family"]??t["--w3m-font-family"]??"KHTeka",e.accent=t["--apkt-accent"]??t["--w3m-accent"]??"#0988F0",e["color-mix"]=t["--apkt-color-mix"]??t["--w3m-color-mix"]??"#000",e["color-mix-strength"]=t["--apkt-color-mix-strength"]??t["--w3m-color-mix-strength"]??0,e["font-size-master"]=t["--apkt-font-size-master"]??t["--w3m-font-size-master"]??"10px",e["border-radius-master"]=t["--apkt-border-radius-master"]??t["--w3m-border-radius-master"]??"4px",t["--apkt-z-index"]!==void 0?e["z-index"]=t["--apkt-z-index"]:t["--w3m-z-index"]!==void 0&&(e["z-index"]=t["--w3m-z-index"]),e}const oi={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[c,l]of Object.entries(i)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},r(l,o[c],u)):typeof l=="string"&&(o[c]=`${Dv}-${u}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,c]of Object.entries(s)){const l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?r(c,u,l):typeof u=="string"&&(n[`${Dv}-${l}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...Nm,tokens:{...Nm.tokens,theme:t==="light"?xh.light:xh.dark}},{cssVariables:r}=oi.createCSSVariables(n),s=oi.assignCSSVariables(r,n),i=oi.generateW3MVariables(e),o=oi.generateW3MOverrides(e),a=oi.generateScaledVariables(e),c=oi.generateBaseVariables(s),l={...s,...c,...i,...o,...a},u=oi.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([f,p])=>`${f}:${p.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e=bd(t),n={};return n["--w3m-font-family"]=e["font-family"],n["--w3m-accent"]=e.accent,n["--w3m-color-mix"]=e["color-mix"],n["--w3m-color-mix-strength"]=`${e["color-mix-strength"]}%`,n["--w3m-font-size-master"]=e["font-size-master"],n["--w3m-border-radius-master"]=e["border-radius-master"],n},generateW3MOverrides(t){if(!t)return{};const e=bd(t),n={};if(t["--apkt-accent"]||t["--w3m-accent"]){const r=e.accent;n["--apkt-tokens-core-iconAccentPrimary"]=r,n["--apkt-tokens-core-borderAccentPrimary"]=r,n["--apkt-tokens-core-textAccentPrimary"]=r,n["--apkt-tokens-core-backgroundAccentPrimary"]=r}return(t["--apkt-font-family"]||t["--w3m-font-family"])&&(n["--apkt-fontFamily-regular"]=e["font-family"]),e["z-index"]!==void 0&&(n["--apkt-tokens-core-zIndex"]=`${e["z-index"]}`),n},generateScaledVariables(t){if(!t)return{};const e=bd(t),n={};if(t["--apkt-font-size-master"]||t["--w3m-font-size-master"]){const r=parseFloat(e["font-size-master"].replace("px",""));n["--apkt-textSize-h1"]=`${Number(r)*5}px`,n["--apkt-textSize-h2"]=`${Number(r)*4.4}px`,n["--apkt-textSize-h3"]=`${Number(r)*3.8}px`,n["--apkt-textSize-h4"]=`${Number(r)*3.2}px`,n["--apkt-textSize-h5"]=`${Number(r)*2.6}px`,n["--apkt-textSize-h6"]=`${Number(r)*2}px`,n["--apkt-textSize-large"]=`${Number(r)*1.6}px`,n["--apkt-textSize-medium"]=`${Number(r)*1.4}px`,n["--apkt-textSize-small"]=`${Number(r)*1.2}px`}if(t["--apkt-border-radius-master"]||t["--w3m-border-radius-master"]){const r=parseFloat(e["border-radius-master"].replace("px",""));n["--apkt-borderRadius-1"]=`${Number(r)}px`,n["--apkt-borderRadius-2"]=`${Number(r)*2}px`,n["--apkt-borderRadius-3"]=`${Number(r)*3}px`,n["--apkt-borderRadius-4"]=`${Number(r)*4}px`,n["--apkt-borderRadius-5"]=`${Number(r)*5}px`,n["--apkt-borderRadius-6"]=`${Number(r)*6}px`,n["--apkt-borderRadius-8"]=`${Number(r)*8}px`,n["--apkt-borderRadius-16"]=`${Number(r)*16}px`,n["--apkt-borderRadius-20"]=`${Number(r)*20}px`,n["--apkt-borderRadius-32"]=`${Number(r)*32}px`,n["--apkt-borderRadius-64"]=`${Number(r)*64}px`,n["--apkt-borderRadius-128"]=`${Number(r)*128}px`}return n},generateColorMixCSS(t,e){if(!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};e?.["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)");const r=bd(t),s=r["color-mix"],i=r["color-mix-strength"];if(!i||i===0)return n;const o=Object.keys(e||{}).filter(a=>{const c=a.includes("-tokens-core-background")||a.includes("-tokens-core-text")||a.includes("-tokens-core-border")||a.includes("-tokens-core-foreground")||a.includes("-tokens-core-icon")||a.includes("-tokens-theme-background")||a.includes("-tokens-theme-text")||a.includes("-tokens-theme-border")||a.includes("-tokens-theme-foreground")||a.includes("-tokens-theme-icon")||a.includes("-tokens-theme-overlay"),l=a.includes("-borderRadius-")||a.includes("-spacing-")||a.includes("-textSize-")||a.includes("-fontFamily-")||a.includes("-fontWeight-")||a.includes("-typography-")||a.includes("-duration-")||a.includes("-ease-")||a.includes("-path-")||a.includes("-width-")||a.includes("-height-")||a.includes("-visual-size-")||a.includes("-modal-width")||a.includes("-cover");return c&&!l});return o.length===0||o.forEach(a=>{const c=e?.[a]||"";a.endsWith("-base")||(a==="--apkt-tokens-theme-backgroundPrimary"||a==="--apkt-tokens-core-backgroundAccentPrimary"?n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?n[a]=`color-mix(in srgb, ${s} ${i}%, ${c})`:n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base, ${c}))`)}),n}},{cssVariablesVarPrefix:gJ}=oi.createCSSVariables(Nm);function sQ(t,...e){return no(t,...e.map(n=>cs(typeof n=="function"?n(gJ):n)))}let Yo,ta,Us,us,kh;const ri={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function Dh(t,e="dark"){Yo&&document.head.removeChild(Yo),Yo=document.createElement("style"),Yo.textContent=oi.createRootStyles(e,t),document.head.appendChild(Yo)}function iQ(t,e="dark"){if(kh=t,ta=document.createElement("style"),Us=document.createElement("style"),us=document.createElement("style"),ta.textContent=dc(t).core.cssText,Us.textContent=dc(t).dark.cssText,us.textContent=dc(t).light.cssText,document.head.appendChild(ta),document.head.appendChild(Us),document.head.appendChild(us),Dh(t,e),Om(e),!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]))for(const[r,s]of Object.entries(ri)){const i=document.createElement("link");i.rel="preload",i.href=s,i.as="font",i.type=r.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}Om(e)}function Om(t="dark"){Us&&us&&Yo&&(t==="light"?(Dh(kh,t),Us.removeAttribute("media"),us.media="enabled"):(Dh(kh,t),us.removeAttribute("media"),Us.media="enabled"))}function mJ(t){if(kh=t,ta&&Us&&us){ta.textContent=dc(t).core.cssText,Us.textContent=dc(t).dark.cssText,us.textContent=dc(t).light.cssText;const e=t?.["--apkt-font-family"]||t?.["--w3m-font-family"];e&&(ta.textContent=ta.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),Us.textContent=Us.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),us.textContent=us.textContent?.replace("font-family: KHTeka",`font-family: ${e}`))}if(Yo){const e=us?.media==="enabled"?"light":"dark";Dh(t,e)}}function dc(t){const e=!!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]);return{core:no`
      ${e?no``:no`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${cs(ri["KHTeka-400-woff2"])}) format('woff2'),
                url(${cs(ri["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${cs(ri["KHTeka-300-woff2"])}) format('woff2'),
                url(${cs(ri["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${cs(ri["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${cs(ri["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${cs(ri["KHTeka-400-woff2"])}) format('woff2'),
                url(${cs(ri["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:no`
      :root {
      }
    `,light:no`
      :root {
      }
    `}}const oQ=no`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,aQ=no`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,vd=".",Uv={getSpacingStyles(t,e){if(Array.isArray(t))return t[e]?`var(--apkt-spacing-${t[e]})`:void 0;if(typeof t=="string")return`var(--apkt-spacing-${t})`},getFormattedDate(t){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(t)},formatCurrency(t=0,e={}){const n=Number(t);return isNaN(n)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2,...e}).format(n)},getHostName(t){try{return new URL(t).hostname}catch{return""}},getTruncateString({string:t,charsStart:e,charsEnd:n,truncate:r}){return t.length<=e+n?t:r==="end"?`${t.substring(0,e)}...`:r==="start"?`...${t.substring(t.length-n)}`:`${t.substring(0,Math.floor(e))}...${t.substring(t.length-Math.floor(n))}`},generateAvatarColors(t){const n=t.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),r=this.hexToRgb(n),s=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),o=100-3*Number(s?.replace("px","")),a=`${o}% ${o}% at 65% 40%`,c=[];for(let l=0;l<5;l+=1){const u=this.tintColor(r,.15*l);c.push(`rgb(${u[0]}, ${u[1]}, ${u[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${a}
   `},hexToRgb(t){const e=parseInt(t,16),n=e>>16&255,r=e>>8&255,s=e&255;return[n,r,s]},tintColor(t,e){const[n,r,s]=t,i=Math.round(n+(255-n)*e),o=Math.round(r+(255-r)*e),a=Math.round(s+(255-s)*e);return[i,o,a]},isNumber(t){return{number:/^[0-9]+$/u}.number.test(t)},getColorTheme(t){return t||(typeof window<"u"&&window.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark")},splitBalance(t){const e=t.split(".");return e.length===2?[e[0],e[1]]:["0","00"]},roundNumber(t,e,n){return t.toString().length>=e?Number(t).toFixed(n):t},cssDurationToNumber(t){return t.endsWith("s")?Number(t.replace("s",""))*1e3:t.endsWith("ms")?Number(t.replace("ms","")):0},maskInput({value:t,decimals:e,integers:n}){if(t=t.replace(",","."),t===vd)return`0${vd}`;const[r="",s]=t.split(vd).map(u=>u.replace(/[^0-9]/gu,"")),i=n?r.substring(0,n):r,o=i.length===2?String(Number(i)):i,a=typeof e=="number"?s?.substring(0,e):s,c=typeof e!="number"||e>0;return(typeof a=="string"&&c?[o,a].join(vd):o)??""},capitalize(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}},yJ=3,_d=.1,wJ=["receive","deposit","borrow","claim"],EJ=["withdraw","repay","burn"],Mv={getTransactionGroupTitle(t,e){const n=nE.getYear(),r=nE.getMonthNameByIndex(e);return t===n?r:`${r} ${t}`},getTransactionImages(t){const[e]=t;return t?.length>1?t.map(r=>this.getTransactionImage(r)):[this.getTransactionImage(e)]},getTransactionImage(t){return{type:Mv.getTransactionTransferTokenType(t),url:Mv.getTransactionImageURL(t)}},getTransactionImageURL(t){let e;const n=!!t?.nft_info,r=!!t?.fungible_info;return t&&n?e=t?.nft_info?.content?.preview?.url:t&&r&&(e=t?.fungible_info?.icon?.url),e},getTransactionTransferTokenType(t){if(t?.fungible_info)return"FUNGIBLE";if(t?.nft_info)return"NFT"},getTransactionDescriptions(t,e){const n=t?.metadata?.operationType,r=e||t?.transfers,s=r&&r.length>0,i=r&&r.length>1,o=s&&r.every(h=>!!h?.fungible_info),[a,c]=r||[];let l=this.getTransferDescription(a),u=this.getTransferDescription(c);if(!s)return(n==="send"||n==="receive")&&o?(l=Uv.getTruncateString({string:t?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),u=Uv.getTruncateString({string:t?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[l,u]):[t.metadata.status];if(i)return r?.map(h=>this.getTransferDescription(h));let d="";return wJ.includes(n)?d="+":EJ.includes(n)&&(d="-"),l=d.concat(l),[l]},getTransferDescription(t){let e="";return t&&(t?.nft_info?e=t?.nft_info?.name||"-":t?.fungible_info&&(e=this.getFungibleTransferDescription(t)||"-")),e},getFungibleTransferDescription(t){return t?[this.getQuantityFixedValue(t?.quantity.numeric),t?.fungible_info?.symbol].join(" ").trim():null},mergeTransfers(t){if(t?.length<=1)return t;const n=this.filterGasFeeTransfers(t).reduce((s,i)=>{const o=i?.fungible_info?.name,a=s.find(({fungible_info:c,direction:l})=>o&&o===c?.name&&l===i.direction);if(a){const c=Number(a.quantity.numeric)+Number(i.quantity.numeric);a.quantity.numeric=c.toString(),a.value=(a.value||0)+(i.value||0)}else s.push(i);return s},[]);let r=n;return n.length>2&&(r=n.sort((s,i)=>(i.value||0)-(s.value||0)).slice(0,2)),r=r.sort((s,i)=>s.direction==="out"&&i.direction==="in"?-1:s.direction==="in"&&i.direction==="out"?1:0),r},filterGasFeeTransfers(t){const e=t?.reduce((r,s)=>{const i=s?.fungible_info?.name;return i&&(r[i]||(r[i]=[]),r[i].push(s)),r},{}),n=[];return Object.values(e??{}).forEach(r=>{if(r.length===1){const s=r[0];s&&n.push(s)}else{const s=r.filter(o=>o.direction==="in"),i=r.filter(o=>o.direction==="out");if(s.length===1&&i.length===1){const o=s[0],a=i[0];let c=!1;if(o&&a){const l=Number(o.quantity.numeric),u=Number(a.quantity.numeric);u<l*_d?(n.push(o),c=!0):l<u*_d&&(n.push(a),c=!0)}c||n.push(...r)}else{const o=this.filterGasFeesFromTokenGroup(r);n.push(...o)}}}),t?.forEach(r=>{r?.fungible_info?.name||n.push(r)}),n},filterGasFeesFromTokenGroup(t){if(t.length<=1)return t;const e=t?.map(a=>Number(a.quantity.numeric)),n=Math.max(...e),r=Math.min(...e),s=.01;if(r<n*s)return t?.filter(c=>Number(c.quantity.numeric)>=n*s);const i=t?.filter(a=>a.direction==="in"),o=t?.filter(a=>a.direction==="out");if(i.length===1&&o.length===1){const a=i[0],c=o[0];if(a&&c){const l=Number(a.quantity.numeric),u=Number(c.quantity.numeric);if(u<l*_d)return[a];if(l<u*_d)return[c]}}return t},getQuantityFixedValue(t){return t?parseFloat(t).toFixed(yJ):null}};function bJ(t,e){const{kind:n,elements:r}=e;return{kind:n,elements:r,finisher(s){customElements.get(t)||customElements.define(t,s)}}}function vJ(t,e){return customElements.get(t)||customElements.define(t,e),e}function cQ(t){return function(n){return typeof n=="function"?vJ(t,n):bJ(t,n)}}const co={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};class _J extends UT{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new MT({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch{}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const r=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>de.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&et.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};const r=I.getAccountData();if(r?.balanceLoading&&e.chainId===I.state.activeCaipNetwork?.id)return{balance:r?.balance||"0.00",symbol:r?.balanceSymbol||""};const i=(await I.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return I.state.activeCaipNetwork?.chainNamespace===j.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Nc.encode(new TextEncoder().encode(r)),pubkey:s}},I.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},I.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===j.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:uw(n.id)}]})}catch(s){if(s.code===co.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===co.ERROR_INVALID_CHAIN_ID||s.code===co.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===co.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:uw(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const CJ=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication","headless"],Cd={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?et.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?et.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?et.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?et.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>et.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>et.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>et.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?et.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t},headless:{apiFeatureName:"headless",localFeatureName:"headless",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>et.DEFAULT_REMOTE_FEATURES.headless}},AJ={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Cd[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Cd[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Cd[t].processApi(e)},processFallbackFeature(t,e){return Cd[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await _e.fetchProjectConfig(),s=r!=null}catch{}const i=s&&!e?et.DEFAULT_REMOTE_FEATURES:et.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of CJ){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch{return et.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;kn.open({debugMessage:Kn.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class IJ{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=I.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=I.getNetworkData(n)?.caipNetwork;return i||I.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return I.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>I.getCaipNetworks(n),this.getActiveChainNamespace=()=>I.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{I.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>I.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>I.state.activeChain===n||!n?I.state.activeCaipAddress:I.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{Ue.setClientId(n)},this.getProvider=n=>yt.getProvider(n),this.getProviderType=n=>yt.getProviderId(n),this.getPreferredAccountType=n=>An(n),this.setCaipAddress=(n,r,s=!1)=>{I.setAccountProp("caipAddress",n,r,s),I.setAccountProp("address",de.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{I.setAccountProp("balance",n,s),I.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{I.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{I.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{I.setAccountProp("user",n,r)},this.resetAccount=n=>{I.resetAccount(n)},this.setCaipNetwork=n=>{I.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{I.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{I.setAccountProp("status",n,r),re.isConnected()?te.setConnectionStatus("connected"):te.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>I.getAccountData(n)?.address,this.setConnectors=n=>{const r=[...re.state.allConnectors,...n];re.setConnectors(r)},this.setConnections=(n,r)=>{te.setConnections(n,r),ue.setConnections(n,r)},this.fetchIdentity=n=>Ue.fetchIdentity(n),this.getReownName=n=>Tl.getNamesForAddress(n),this.getConnectors=()=>re.getConnectors(),this.getConnectorImage=n=>_A.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?yh.getConnectionsData(n).connections:(kn.open(j.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?yh.getConnectionsData(n).recentConnections:(kn.open(j.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){kn.open(j.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await ue.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){kn.open(j.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}te.deleteAddressFromConnection(n),ue.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=yt.getProviderId(r),i=n?{...n,type:s}:void 0;I.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!I.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{const i=I.getAccountData(s)?.addressLabels||{};I.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{const s=I.getAccountData(r)?.addressLabels||{};I.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{const r=n||I.state.activeChain;return I.getAccountData(r)?.address},this.resetNetwork=n=>{I.resetNetwork(n)},this.addConnector=n=>{re.addConnector(n)},this.resetWcConnection=()=>{ue.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{I.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{I.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{I.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{Z.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),e.features?.headless&&!Vr.hasInjectedConnectors()&&_e.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1,fetchRecommendedWallets:!0}),Z.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),!e.basic&&!e.manualWCControl&&(this.remoteFeatures=await AJ.fetchRemoteFeatures(e)),await _e.fetchUsage(),Z.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Lg.setOnrampProviders(this.remoteFeatures.onramp),(Z.state.remoteFeatures?.email||Array.isArray(Z.state.remoteFeatures?.socials)&&Z.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),Z.state.features?.reownAuthentication||Z.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:n}=await hn(async()=>{const{ReownAuthentication:s}=await import("./features-DBU5X4_o.js");return{ReownAuthentication:s}},__vite__mapDeps([3,1,2,0,4,5])),r=Z.state.siwx;r instanceof n||Z.setSIWX(new n)}}async openSend(e){const n=e.namespace||I.state.activeChain,r=this.getCaipAddress(n),s=this.getCaipNetwork(n)?.id;if(!r)throw new Error("openSend: caipAddress not found");if(s?.toString()!==e.chainId.toString()){const i=I.getCaipNetworkById(e.chainId,n);if(!i)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(i,{throwOnFailure:!0})}try{const i=FT.getTokenSymbolByAddress(e.assetAddress);i&&await _e.fetchTokenImages([i])}catch{}return await at.open({view:"WalletSend",data:{send:e}}),new Promise((i,o)=>{const a=st.subscribeKey("hash",u=>{u&&(l(),i({hash:u}))}),c=at.subscribe(u=>{u.open||(l(),o(new Error("Modal closed")))}),l=this.createCleanupHandler([a,c])})}toModalOptions(){function e(r){return r?.view==="Swap"}function n(r){return r?.view==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await _e.fetchAllowedOrigins();if(!de.isClient())return;const n=window.location.origin;Bs.isOriginAllowed(n,e,j.DEFAULT_ALLOWED_ANCESTORS)||kn.open(Kn.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":kn.open(Kn.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;kn.open({displayMessage:Kn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:Kn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){const{...n}=e;delete n.adapters,delete n.universalProvider,ze.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){AA.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&pr.setThemeMode(e.themeMode),e.themeVariables&&pr.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");I.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});const n=this.getDefaultNetwork();n&&I.setActiveCaipNetwork(n)}initializeConnectionController(e){ue.initialize(e.adapters??[]),ue.setWcBasic(e.basic??!1)}initializeConnectorController(){re.initialize(this.chainNamespaces)}initializeProjectSettings(e){Z.setProjectId(e.projectId),Z.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){Z.setDebug(e.debug!==!1),Z.setEnableWalletGuide(e.enableWalletGuide!==!1),Z.setEnableWallets(e.enableWallets!==!1),Z.setEIP6963Enabled(e.enableEIP6963!==!1),Z.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),Z.setEnableReconnect(e.enableReconnect!==!1),Z.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),Z.setCoinbasePreference(e.coinbasePreference),Z.setEnableAuthLogger(e.enableAuthLogger!==!1),Z.setCustomRpcUrls(e.customRpcUrls),Z.setEnableEmbedded(e.enableEmbedded),Z.setAllWallets(e.allWallets),Z.setIncludeWalletIds(e.includeWalletIds),Z.setExcludeWalletIds(e.excludeWalletIds),Z.setFeaturedWalletIds(e.featuredWalletIds),Z.setTokens(e.tokens),Z.setTermsConditionsUrl(e.termsConditionsUrl),Z.setPrivacyPolicyUrl(e.privacyPolicyUrl),Z.setCustomWallets(e.customWallets),Z.setFeatures(e.features),Z.setAllowUnsupportedChain(e.allowUnsupportedChain),Z.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),Z.setPreferUniversalLinks(e.experimental_preferUniversalLinks),Z.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),Z.setMetadata(e.metadata),Z.setDisableAppend(e.disableAppend),Z.setEnableEmbedded(e.enableEmbedded),Z.setSIWX(e.siwx),this.features=Z.state.features??{},!e.projectId){kn.open(Kn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===j.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");Z.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return de.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=Xa.getUnsupportedNetwork(`${n}:${e}`);I.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Xa.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return Xa.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return Xa.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>s.id===e.defaultNetwork?.id);return n?Xa.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e);return(I.state.chains.get(e)?.accountState?.caipAddress||!Z.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=I.state.activeChain,n=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,s=ue.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),te.setConnectedNamespaces([...I.state.chains.keys()]),await this.syncWalletConnectAccount(),await nr.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{const i=I.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),te.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||I.state.activeChain,o=re.getConnectorId(i),a=n===j.CONNECTOR_ID.AUTH||o===j.CONNECTOR_ID.AUTH,c=n===j.CONNECTOR_ID.WALLET_CONNECT||o===j.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(I.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async p=>{const m=re.getConnectorId(p),g=n||m,T=await this.disconnectConnector(p,g);T&&(a&&te.deleteConnectedSocialProvider(),T.connections.forEach(N=>{te.addDisconnectedConnectorId(N.connectorId,p)})),s&&this.onDisconnectNamespace({chainNamespace:p,closeModal:!1})}),h=await Promise.allSettled(d);st.resetSend(),ue.resetWcConnection(),nr.getSIWX()?.signOutOnDisconnect&&await nr.clearSessions(),re.setFilterByNamespace(void 0),ue.syncStorageConnections();const f=h.filter(p=>p.status==="rejected");if(f.length>0)throw new Error(f.map(p=>p.reason.message).join(", "));ze.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async e=>{const n=I.state.activeChain,r=this.getAdapter(I.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");return(await r?.signMessage({message:e,address:s,provider:yt.getProvider(n)}))?.signature||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(et.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=yt.getProvider(n);return(await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===j.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=yt.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=I.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:n,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),I.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await Bs.resolveReownName(e),writeContract:async e=>{const n=I.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=yt.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,n)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:n})??0n},formatUnits:(e,n)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:n})??"0"},getCapabilities:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(e)},grantPermissions:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(e)},revokePermissions:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(e)??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r?.id,e)}},ue.setClient(this.connectionControllerClient)}async onConnectExternal(e){const n=I.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===tr.CONNECTOR_TYPE_AUTH&&j.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>re.getConnectorId(d)===j.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&i&&this.setCaipNetwork(l)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return te.addConnectedNamespace(r),this.syncProvider({...c,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),te.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){const r=e.type===tr.CONNECTOR_TYPE_AUTH,s=di.getOtherAuthNamespaces(n?.connectedCaipNetwork?.chainNamespace),i=I.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace);r&&(await Promise.all(s.map(async a=>{try{const c=yt.getProvider(a),l=this.getCaipNetwork(a);await this.getAdapter(a)?.connect({...e,provider:c,socialUri:void 0,chainId:l?.id,rpcUrl:l?.rpcUrls?.default?.http?.[0]})&&(te.addConnectedNamespace(a),te.removeDisconnectedConnectorId(e.id,a),this.setStatus("connected",a),this.syncConnectedWalletInfo(a))}catch(c){kn.warn(Kn.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,Kn.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(a,c instanceof Error?c.message:void 0),Kn.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i}))}getApprovedCaipNetworksData(){if(yt.getProviderId(I.state.activeChain)===tr.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=yt.getProviderId(n);if(e.chainNamespace===I.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:e});else if(this.setCaipNetwork(e),s===tr.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(n);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=pn.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=e?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===r)}),n[r]=s):n[r]=new _J({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);const n=this.getAdapter(e);if(!n)throw new Error("adapter not found");await n.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=te.getConnectionStatus();Z.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(te.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=I.state.activeChain===e,c=I.state.chains.get(e)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(ue.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=I.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{this.handlePreviousConnectorConnection(o);const a=I.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=I.getNetworkData(e)?.caipNetwork?.id,l=i||c;a&&l?this.syncAccount({address:s,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(s,l,e),this.syncBalance({address:s,chainId:l,chainNamespace:e})):this.syncAccountInfo(s,i,e),te.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){const n=e?.chain,r=e?.id,s=re.getConnectorId(n),i=Z.state.remoteFeatures?.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await ue.disconnect({id:s,namespace:n})}catch{}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>ue.disconnect({namespace:e,initialDisconnect:!0})))}catch{}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||te.deleteRecentWallet();const n=te.getRecentWallet();ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:de.isMobile()?"mobile":"qrcode",name:n?.name||"Unknown",reconnect:!0,view:Ie.state.view,walletRank:n?.order}})}async syncNamespaceConnection(e){try{e===j.CHAIN.EVM&&de.isSafeApp()&&re.setConnectorId(j.CONNECTOR_ID.SAFE,e);const n=re.getConnectorId(e);switch(this.setStatus("connecting",e),n){case j.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case j.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch{this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};I.resetAccount(n),I.resetNetwork(n),te.removeConnectedNamespace(n);const s=Array.from(I.state.chains.keys());(n?[n]:s).forEach(o=>te.addDisconnectedConnectorId(re.getConnectorId(o)||"",o)),re.removeConnectorId(n),yt.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&at.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n?.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=re.getConnectorId(e),o=re.getConnectors(e).find(a=>a.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:Ie.state.view,walletRank:o?.explorerWallet?.order}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=I.state.activeCaipNetwork?.id,a=i.find(l=>{const{chainId:u}=pn.parseCaipAddress(l);return u===o?.toString()})||i[0];if(a){const l=pn.validateCaipAddress(a),{chainId:u,address:d}=pn.parseCaipAddress(l);if(yt.setProviderId(r,tr.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&I.state.activeCaipNetwork&&s.namespace!==j.CHAIN.EVM){const h=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:I.state.activeCaipNetwork});yt.setProvider(r,h)}else yt.setProvider(r,this.universalProvider);re.setConnectorId(j.CONNECTOR_ID.WALLET_CONNECT,r),te.addConnectedNamespace(r),await this.syncAccount({address:d,chainId:u,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);const c=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(r),I.setApprovedCaipNetworksData(r,{approvedCaipNetworkIds:c.approvedCaipNetworkIds,supportsAllNetworks:c.supportsAllNetworks})});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){yt.setProviderId(s,e),yt.setProvider(s,n),re.setConnectorId(r,s)}async syncAccount(e){const n=e.chainNamespace===I.state.activeChain,r=I.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=te.getActiveNetworkProps(),c=r?.id||a,l=I.state.activeCaipNetwork?.name===j.UNSUPPORTED_NETWORK_NAME,u=I.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),h=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!u&&!d&&!h){const m=this.getApprovedCaipNetworkIds()||[],g=m.find(N=>pn.parseCaipNetworkId(N)?.chainId===c.toString()),T=m.find(N=>pn.parseCaipNetworkId(N)?.chainNamespace===o);d=this.getCaipNetworks().find(N=>N.caipNetworkId===g),h=this.getCaipNetworks().find(N=>N.caipNetworkId===T||"deprecatedCaipNetworkId"in N&&N.deprecatedCaipNetworkId===T)}const f=d||h;f?.chainNamespace===I.state.activeChain?Z.state.enableNetworkSwitch&&!Z.state.allowUnsupportedChain&&I.state.activeCaipNetwork?.name===j.UNSUPPORTED_NETWORK_NAME?I.showUnsupportedChainUI():this.setCaipNetwork(f):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const p=this.getAddress(o);di.isLowerCaseMatch(s,p)||this.syncAccountInfo(s,f?.id,o),n?await this.syncBalance({address:s,chainId:f?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){const n=re.getConnectorId(e),r=yt.getProviderId(e);if(r===tr.CONNECTOR_TYPE_ANNOUNCED||r===tr.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===tr.CONNECTOR_TYPE_WALLET_CONNECT){const s=yt.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(n&&(n===j.CONNECTOR_ID.COINBASE_SDK||n===j.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!rA.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=I.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const e=$Y.createLogger((s,...i)=>{s&&this.handleAlertError(s)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};Z.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await tY.init(n);const r=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await r()}catch(s){if(s instanceof Error&&s.message.includes("Missing or invalid. Record was recently deleted"))return;throw s}},Z.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Bs.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{ue.setUri(n)},onConnect:n=>{const{address:r}=de.getAccount(n[0]);ue.finalizeWcConnection(r)},onDisconnect:()=>{I.state.noAdapters&&this.resetAccount(e),ue.resetWcConnection()},onChainChanged:n=>{const r=I.state.activeChain,s=r&&re.state.activeConnectorIds[r]===j.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=I.state.activeChain,s=r&&re.state.activeConnectorIds[r]===j.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=n?.[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&de.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){ze.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}})}return this.universalProvider}getDisabledCaipNetworks(){const e=I.getAllApprovedCaipNetworkIds(),n=I.getAllRequestedCaipNetworks();return de.sortRequestedNetworks(e,n).filter(s=>I.isCaipNetworkDisabled(s))}handleAlertError(e){const n=Object.entries(Kn.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=Kn.ALERT_ERRORS[o];a&&(kn.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e?.uri&&ue.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?at.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):at.open(e)}async close(){await this.injectModalUi(),at.close()}setLoading(e,n){at.setLoading(e,n)}async disconnect(e){await ue.disconnect({namespace:e})}getSIWX(){return Z.state.siwx}getError(){return""}getChainId(){return I.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){kn.open(Kn.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await I.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return I.state.activeChain?yt.state.providers[I.state.activeChain]:null}getWalletProviderType(){return yt.getProviderId(I.state.activeChain)}subscribeProviders(e){return yt.subscribeProviders(e)}getThemeMode(){return pr.state.themeMode}getThemeVariables(){return pr.state.themeVariables}setThemeMode(e){pr.setThemeMode(e),Om(pr.state.themeMode)}setTermsConditionsUrl(e){Z.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){Z.setPrivacyPolicyUrl(e)}setThemeVariables(e){pr.setThemeVariables(e),mJ(pr.state.themeVariables)}subscribeTheme(e){return pr.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?ue.subscribe(e):(kn.open(j.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?I.state.chains.get(e)?.accountState?.connectedWalletInfo:I.getAccountData()?.connectedWalletInfo}getAccount(e){const n=e||I.state.activeChain,r=re.getAuthConnector(n),s=I.getAccountData(n),i=te.getConnectedConnectorId(I.state.activeChain),o=ue.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>de.createAccount(n,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:de.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===j.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:te.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:An(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?I.subscribeChainProp("accountState",r,n):I.subscribe(r),re.subscribe(r)}subscribeNetwork(e){return I.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(e,n){return n?I.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo),n):I.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){I.subscribeChainProp("accountState",n=>e(n?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){I.subscribeKey("activeCaipNetwork",e)}getState(){return Dr.state}getRemoteFeatures(){return Z.state.remoteFeatures}subscribeState(e){return Dr.subscribe(e)}subscribeRemoteFeatures(e){return Z.subscribeKey("remoteFeatures",e)}showErrorMessage(e){Wt.showError(e)}showSuccessMessage(e){Wt.showSuccess(e)}getEvent(){return{...ze.state}}subscribeEvents(e){return ze.subscribe(e)}replace(e){Ie.replace(e)}redirect(e){Ie.push(e)}popTransactionStack(e){Ie.popTransactionStack(e)}isOpen(){return at.state.open}isTransactionStackEmpty(){return Ie.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){Z.setFeatures(e)}updateRemoteFeatures(e){Z.setRemoteFeatures(e)}updateOptions(e){const r={...Z.state||{},...e};Z.setOptions(r)}setConnectMethodsOrder(e){Z.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){Z.setWalletFeaturesOrder(e)}setCollapseWallets(e){Z.setCollapseWallets(e)}setSocialsOrder(e){Z.setSocialsOrder(e)}getConnectMethodsOrder(){return ao.getConnectOrderMethod(Z.state.features,re.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||I.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&I.removeNetwork(e,n)}}let Lv=!1;class SJ extends IJ{async onAuthProviderConnected(e){const n=di.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await nr.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===j.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=Z.state.defaultAccountTypes[n],i=An(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e,d=I.getAccountData(n);this.setUser({...d?.user||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),await Promise.all([this.syncAuthConnectorTheme(this.authProvider),this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:n})]),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{kr.checkIfRequestExists(n)?kr.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),setTimeout(()=>{this.showErrorMessage(Kt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=kr.checkIfRequestIsSafe(r),i=this.getAddress(),o=I.state.activeCaipNetwork;s||(i&&o?.id&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=I.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");re.getConnectorId(n)===j.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=I.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=pr.getSnapshot();await e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Fl(n.themeVariables,n.themeMode)})}async syncAuthConnector(e,n){const r=j.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===I.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),c=I.getAccountData(n)?.user||{};this.setUser({...c,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:l}=await e.isConnected();if(n&&r&&s)if(l&&this.connectionControllerClient?.connectExternal){await e.init(),await this.syncAuthConnectorTheme(e),await this.connectionControllerClient?.connectExternal({id:j.CONNECTOR_ID.AUTH,info:{name:j.CONNECTOR_ID.AUTH},type:tr.CONNECTOR_TYPE_AUTH,provider:e,chainId:I.getNetworkData(n)?.caipNetwork?.id,chain:n}),this.setStatus("connected",n);const u=te.getConnectedSocialProvider();u?ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:u,reconnect:!0}}):ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0,view:Ie.state.view,walletRank:void 0}})}else re.getConnectorId(n)===j.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),te.removeConnectedNamespace(n));this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){try{if(!de.isTelegram())return;const n=te.getTelegramSocialProvider();if(!n||!de.isClient())return;const s=new URL(window.location.href).searchParams.get("result_uri");if(!s)return;n&&I.setAccountProp("socialProvider",n,e),await this.authProvider?.init();const i=re.getAuthConnector();n&&i&&(this.setLoading(!0,e),await ue.connectExternal({id:i.id,type:i.type,socialUri:s},i.chain),te.setConnectedSocialProvider(n),te.removeTelegramSocialProvider(),ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch{this.setLoading(!1,e)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch{}}createAuthProvider(e){if(!j.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=this.remoteFeatures?.email,s=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=di.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=Nl.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:Kn.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?kn.open(Kn.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?kn.open(Kn.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&kn.open(Kn.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>gl(l),getCaipNetworks:l=>I.getCaipNetworks(l)}),Dr.subscribeOpen(l=>{!l&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===I.state.activeChain&&Z.state.enableReconnect;Z.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&_e.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const n=I.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&I.getAccountData(r)?.caipAddress)await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e);else{const a=yt.getProviderId(n)===tr.CONNECTOR_TYPE_AUTH,c=yt.getProviderId(r),l=c===tr.CONNECTOR_TYPE_AUTH,u=j.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||l)&&u)try{I.state.activeChain=e.chainNamespace,s?await this.getAdapter(r)?.switchNetwork({caipNetwork:e}):await this.connectionControllerClient?.connectExternal?.({id:j.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:tr.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(r)?.switchNetwork({caipNetwork:e})}else c===tr.CONNECTOR_TYPE_WALLET_CONNECT?(I.state.noAdapters||await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r}))}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),Dr.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){const s=`${r}:${n}`;if(this.caipNetworks?.find(a=>a.caipNetworkId===s)?.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=re.getConnectorId(r)===j.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e});!a&&o?await this.syncReownName(e,r):(this.setProfileName(a,r),this.setProfileImage(c,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=yt.getProviderId(e);if(n===tr.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=te.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(de.isClient()&&!Lv)try{const e={...et.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),de.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!Z.state.disableAppend&&!Z.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Lv=!0}catch{}}async loadModalComponents(e,n){if(!de.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(hn(()=>import("./embedded-wallet-DvYjUEAS.js"),__vite__mapDeps([6,7,0,1,2,8,9,10,11,12,13,14,15,16,17,18,4,5]))),n.email&&r.push(hn(()=>import("./email-Du3JC2TG.js"),__vite__mapDeps([19,20,7,0,1,2,18,11,17,9,10,16,21,14,4,5]))),n.socials&&r.push(hn(()=>import("./socials-mAEzJhnn.js"),__vite__mapDeps([22,7,0,1,2,9,23,10,24,17,25,13,16,11,26,8,27,4,5]))),n.swaps&&n.swaps.length>0&&r.push(hn(()=>import("./swaps-AuoW-ZpA.js"),__vite__mapDeps([28,7,0,1,2,16,11,17,9,29,30,27,31,8,14,10,4,5]))),e.send&&r.push(hn(()=>import("./send-SOiirIzb.js"),__vite__mapDeps([32,7,0,1,2,16,11,17,9,33,10,34,18,31,8,27,14,35,36,4,5]))),e.receive&&r.push(hn(()=>import("./receive-CaNKdLO0.js"),__vite__mapDeps([37,7,0,1,2,9,8,26,4,5]))),n.onramp&&n.onramp.length>0&&r.push(hn(()=>import("./onramp-C8kaJLGL.js"),__vite__mapDeps([38,7,0,1,2,9,39,11,23,10,8,40,41,18,16,17,25,14,4,5]))),n.payWithExchange&&r.push(hn(()=>import("./pay-with-exchange-B1MxP0xw.js"),__vite__mapDeps([42,7,0,1,2,9,8,15,39,11,27,16,34,10,18,17,14,35,33,4,5]))),n.activity&&r.push(hn(()=>import("./transactions-BGVcbT2g.js"),__vite__mapDeps([43,7,0,1,2,44,17,9,18,8,27,4,5]))),(e.pay||n.payments)&&r.push(hn(()=>import("./index-T8CpGRAP.js"),__vite__mapDeps([45,7,0,1,2,9,16,11,46,15,8,39,47,33,48,17,25,4,5]))),n.emailCapture&&r.push(hn(()=>import("./data-capture-CXBxhp1e.js"),__vite__mapDeps([49,7,0,1,2,20,18,11,3,4,5]))),await Promise.all([...r,hn(()=>import("./index-CCYNP-nY.js"),__vite__mapDeps([50,7,0,1,2,9,8,11,36,17,51,41,18,12,13,48,15,39,16,44,27,35,29,30,33,10,14,47,21,23,24,25,26,40,4,5])),hn(()=>import("./w3m-modal-i2kTVUTs.js"),__vite__mapDeps([52,7,0,1,2,9,46,8,12,13,11,17,30,51,41,18,48,16,4,5]))])}}const TJ="1.8.15";function NJ(t){return new SJ({...t,sdkVersion:de.generateSdkVersion(t.adapters??[],"html",TJ)})}const hc={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([hc.getAddresses(t),hc.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){const n=e.rpcUrls.chainDefault?.http||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:hc.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[e.blockExplorers?.default.url],iconUrls:[BT.NetworkImageIds[e.id]]}]})}};class qy{constructor(){this.initialized=!1}async getProvider(){return Promise.resolve(this.provider)}}class OJ extends qy{async initialize(){const e=I.getCaipNetworks(),{metadata:n,coinbasePreference:r}=Z.state;try{const{createBaseAccountSDK:s}=await hn(async()=>{const{createBaseAccountSDK:o}=await import("./index-D11iBRcf.js");return{createBaseAccountSDK:o}},__vite__mapDeps([53,1,2,0,4,5]));if(typeof window>"u")return Promise.resolve();const i=s({appName:n?.name,appLogoUrl:n?.icons[0],appChainIds:e?.map(o=>o.id)||[1,84532],preference:{options:r??"all"}});return this.provider=i.getProvider(),this.initialized=!0,Promise.resolve()}catch{return Promise.resolve()}}async getProvider(){return Promise.resolve(this.provider)}}var GT={},vf={},YT={},Uh={},JT={},Ru={},Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.getSDKVersion=void 0;const RJ=()=>"9.1.0";Pu.getSDKVersion=RJ;var _f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.generateRequestId=void 0;const PJ=t=>t.toString(16).padStart(2,"0"),xJ=t=>{const e=new Uint8Array(t/2);return window.crypto.getRandomValues(e),Array.from(e,PJ).join("")},kJ=()=>typeof window<"u"?xJ(10):new Date().getTime().toString(36);_f.generateRequestId=kJ;Object.defineProperty(Ru,"__esModule",{value:!0});Ru.MessageFormatter=void 0;const DJ=Pu,UJ=_f;class Cf{}Ru.MessageFormatter=Cf;Cf.makeRequest=(t,e)=>({id:(0,UJ.generateRequestId)(),method:t,params:e,env:{sdkVersion:(0,DJ.getSDKVersion)()}});Cf.makeResponse=(t,e,n)=>({id:t,success:!0,version:n,data:e});Cf.makeErrorResponse=(t,e,n)=>({id:t,success:!1,error:e,version:n});var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.RestrictedMethods=ws.Methods=void 0;var $v;(function(t){t.sendTransactions="sendTransactions",t.rpcCall="rpcCall",t.getChainInfo="getChainInfo",t.getSafeInfo="getSafeInfo",t.getTxBySafeTxHash="getTxBySafeTxHash",t.getSafeBalances="getSafeBalances",t.signMessage="signMessage",t.signTypedMessage="signTypedMessage",t.getEnvironmentInfo="getEnvironmentInfo",t.getOffChainSignature="getOffChainSignature",t.requestAddressBook="requestAddressBook",t.wallet_getPermissions="wallet_getPermissions",t.wallet_requestPermissions="wallet_requestPermissions"})($v||(ws.Methods=$v={}));var Bv;(function(t){t.requestAddressBook="requestAddressBook"})(Bv||(ws.RestrictedMethods=Bv={}));(function(t){var e=it&&it.__createBinding||(Object.create?function(i,o,a,c){c===void 0&&(c=a);var l=Object.getOwnPropertyDescriptor(o,a);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(i,c,l)}:function(i,o,a,c){c===void 0&&(c=a),i[c]=o[a]}),n=it&&it.__exportStar||function(i,o){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&e(o,i,a)};Object.defineProperty(t,"__esModule",{value:!0});const r=Ru;class s{constructor(o=null,a=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:c,data:l,source:u})=>{const d=!l,h=!this.isServer&&u===window.parent,f=typeof l.version<"u"&&parseInt(l.version.split(".")[0]),p=typeof f=="number"&&f>=1;let m=!0;return Array.isArray(this.allowedOrigins)&&(m=this.allowedOrigins.find(g=>g.test(c))!==void 0),!d&&h&&p&&m},this.logIncomingMessage=c=>{},this.onParentMessage=c=>{this.isValidMessage(c)&&(this.debugMode&&this.logIncomingMessage(c),this.handleIncomingMessage(c.data))},this.handleIncomingMessage=c=>{const{id:l}=c,u=this.callbacks.get(l);u&&(u(c),this.callbacks.delete(l))},this.send=(c,l)=>{const u=r.MessageFormatter.makeRequest(c,l);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(u,"*"),new Promise((d,h)=>{this.callbacks.set(u.id,f=>{if(!f.success){h(new Error(f.error));return}d(f)})})},this.allowedOrigins=o,this.debugMode=a,this.isServer||window.addEventListener("message",this.onParentMessage)}}t.default=s,n(ws,t)})(JT);var Af={},If={},Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.isObjectEIP712TypedData=void 0;const MJ=t=>typeof t=="object"&&t!=null&&"domain"in t&&"types"in t&&"message"in t;Sf.isObjectEIP712TypedData=MJ;var ZT={};Object.defineProperty(ZT,"__esModule",{value:!0});var XT={},QT={},Mc={},Lc={},Vy=it&&it.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.insertParams=BJ;Lc.stringifyQuery=FJ;Lc.fetchData=jJ;Lc.getData=WJ;const LJ=t=>typeof t=="object"&&t!==null&&("code"in t||"statusCode"in t)&&"message"in t;function $J(t,e,n){return t.replace(new RegExp(`\\{${e}\\}`,"g"),n)}function BJ(t,e){return e?Object.keys(e).reduce((n,r)=>$J(n,r,String(e[r])),t):t}function FJ(t){if(!t)return"";const e=new URLSearchParams;Object.keys(t).forEach(r=>{t[r]!=null&&e.append(r,String(t[r]))});const n=e.toString();return n?`?${n}`:""}function e1(t){return Vy(this,void 0,void 0,function*(){var e;let n;try{n=yield t.json()}catch{n={}}if(!t.ok){const r=LJ(n)?`CGW error - ${(e=n.code)!==null&&e!==void 0?e:n.statusCode}: ${n.message}`:`CGW error - status ${t.statusText}`;throw new Error(r)}return n})}function jJ(t,e,n,r,s){return Vy(this,void 0,void 0,function*(){const i=Object.assign({"Content-Type":"application/json"},r),o={method:e??"POST",headers:i};s&&(o.credentials=s),n!=null&&(o.body=typeof n=="string"?n:JSON.stringify(n));const a=yield fetch(t,o);return e1(a)})}function WJ(t,e,n){return Vy(this,void 0,void 0,function*(){const r={method:"GET"};e&&(r.headers=Object.assign(Object.assign({},e),{"Content-Type":"application/json"})),n&&(r.credentials=n);const s=yield fetch(t,r);return e1(s)})}Object.defineProperty(Mc,"__esModule",{value:!0});Mc.postEndpoint=HJ;Mc.putEndpoint=zJ;Mc.deleteEndpoint=qJ;Mc.getEndpoint=VJ;const wa=Lc;function Tf(t,e,n,r){const s=(0,wa.insertParams)(e,n),i=(0,wa.stringifyQuery)(r);return`${t}${s}${i}`}function HJ(t,e,n){const r=Tf(t,e,n?.path,n?.query);return(0,wa.fetchData)(r,"POST",n?.body,n?.headers,n?.credentials)}function zJ(t,e,n){const r=Tf(t,e,n?.path,n?.query);return(0,wa.fetchData)(r,"PUT",n?.body,n?.headers,n?.credentials)}function qJ(t,e,n){const r=Tf(t,e,n?.path,n?.query);return(0,wa.fetchData)(r,"DELETE",n?.body,n?.headers,n?.credentials)}function VJ(t,e,n,r){if(r)return(0,wa.getData)(r,void 0,n?.credentials);const s=Tf(t,e,n?.path,n?.query);return(0,wa.getData)(s,n?.headers,n?.credentials)}var Nf={};Object.defineProperty(Nf,"__esModule",{value:!0});Nf.DEFAULT_BASE_URL=void 0;Nf.DEFAULT_BASE_URL="https://safe-client.safe.global";var Of={};Object.defineProperty(Of,"__esModule",{value:!0});Of.ImplementationVersionState=void 0;var Fv;(function(t){t.UP_TO_DATE="UP_TO_DATE",t.OUTDATED="OUTDATED",t.UNKNOWN="UNKNOWN"})(Fv||(Of.ImplementationVersionState=Fv={}));var ho={};Object.defineProperty(ho,"__esModule",{value:!0});ho.SafeAppSocialPlatforms=ho.SafeAppFeatures=ho.SafeAppAccessPolicyTypes=void 0;var jv;(function(t){t.NoRestrictions="NO_RESTRICTIONS",t.DomainAllowlist="DOMAIN_ALLOWLIST"})(jv||(ho.SafeAppAccessPolicyTypes=jv={}));var Wv;(function(t){t.BATCHED_TRANSACTIONS="BATCHED_TRANSACTIONS"})(Wv||(ho.SafeAppFeatures=Wv={}));var Hv;(function(t){t.TWITTER="TWITTER",t.GITHUB="GITHUB",t.DISCORD="DISCORD",t.TELEGRAM="TELEGRAM"})(Hv||(ho.SafeAppSocialPlatforms=Hv={}));var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.LabelValue=Mt.StartTimeValue=Mt.DurationType=Mt.DetailedExecutionInfoType=Mt.TransactionListItemType=Mt.ConflictType=Mt.TransactionInfoType=Mt.SettingsInfoType=Mt.TransactionTokenType=Mt.TransferDirection=Mt.TransactionStatus=Mt.Operation=void 0;var zv;(function(t){t[t.CALL=0]="CALL",t[t.DELEGATE=1]="DELEGATE"})(zv||(Mt.Operation=zv={}));var qv;(function(t){t.AWAITING_CONFIRMATIONS="AWAITING_CONFIRMATIONS",t.AWAITING_EXECUTION="AWAITING_EXECUTION",t.CANCELLED="CANCELLED",t.FAILED="FAILED",t.SUCCESS="SUCCESS"})(qv||(Mt.TransactionStatus=qv={}));var Vv;(function(t){t.INCOMING="INCOMING",t.OUTGOING="OUTGOING",t.UNKNOWN="UNKNOWN"})(Vv||(Mt.TransferDirection=Vv={}));var Kv;(function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_COIN="NATIVE_COIN"})(Kv||(Mt.TransactionTokenType=Kv={}));var Gv;(function(t){t.SET_FALLBACK_HANDLER="SET_FALLBACK_HANDLER",t.ADD_OWNER="ADD_OWNER",t.REMOVE_OWNER="REMOVE_OWNER",t.SWAP_OWNER="SWAP_OWNER",t.CHANGE_THRESHOLD="CHANGE_THRESHOLD",t.CHANGE_IMPLEMENTATION="CHANGE_IMPLEMENTATION",t.ENABLE_MODULE="ENABLE_MODULE",t.DISABLE_MODULE="DISABLE_MODULE",t.SET_GUARD="SET_GUARD",t.DELETE_GUARD="DELETE_GUARD"})(Gv||(Mt.SettingsInfoType=Gv={}));var Yv;(function(t){t.TRANSFER="Transfer",t.SETTINGS_CHANGE="SettingsChange",t.CUSTOM="Custom",t.CREATION="Creation",t.SWAP_ORDER="SwapOrder",t.TWAP_ORDER="TwapOrder",t.SWAP_TRANSFER="SwapTransfer",t.NATIVE_STAKING_DEPOSIT="NativeStakingDeposit",t.NATIVE_STAKING_VALIDATORS_EXIT="NativeStakingValidatorsExit",t.NATIVE_STAKING_WITHDRAW="NativeStakingWithdraw"})(Yv||(Mt.TransactionInfoType=Yv={}));var Jv;(function(t){t.NONE="None",t.HAS_NEXT="HasNext",t.END="End"})(Jv||(Mt.ConflictType=Jv={}));var Zv;(function(t){t.TRANSACTION="TRANSACTION",t.LABEL="LABEL",t.CONFLICT_HEADER="CONFLICT_HEADER",t.DATE_LABEL="DATE_LABEL"})(Zv||(Mt.TransactionListItemType=Zv={}));var Xv;(function(t){t.MULTISIG="MULTISIG",t.MODULE="MODULE"})(Xv||(Mt.DetailedExecutionInfoType=Xv={}));var Qv;(function(t){t.AUTO="AUTO",t.LIMIT_DURATION="LIMIT_DURATION"})(Qv||(Mt.DurationType=Qv={}));var e_;(function(t){t.AT_MINING_TIME="AT_MINING_TIME",t.AT_EPOCH="AT_EPOCH"})(e_||(Mt.StartTimeValue=e_={}));var t_;(function(t){t.Queued="Queued",t.Next="Next"})(t_||(Mt.LabelValue=t_={}));var fo={};Object.defineProperty(fo,"__esModule",{value:!0});fo.FEATURES=fo.GAS_PRICE_TYPE=fo.RPC_AUTHENTICATION=void 0;var n_;(function(t){t.API_KEY_PATH="API_KEY_PATH",t.NO_AUTHENTICATION="NO_AUTHENTICATION",t.UNKNOWN="UNKNOWN"})(n_||(fo.RPC_AUTHENTICATION=n_={}));var r_;(function(t){t.ORACLE="ORACLE",t.FIXED="FIXED",t.FIXED_1559="FIXED1559",t.UNKNOWN="UNKNOWN"})(r_||(fo.GAS_PRICE_TYPE=r_={}));var s_;(function(t){t.ERC721="ERC721",t.SAFE_APPS="SAFE_APPS",t.CONTRACT_INTERACTION="CONTRACT_INTERACTION",t.DOMAIN_LOOKUP="DOMAIN_LOOKUP",t.SPENDING_LIMIT="SPENDING_LIMIT",t.EIP1559="EIP1559",t.SAFE_TX_GAS_OPTIONAL="SAFE_TX_GAS_OPTIONAL",t.TX_SIMULATION="TX_SIMULATION",t.EIP1271="EIP1271"})(s_||(fo.FEATURES=s_={}));var Rf={};Object.defineProperty(Rf,"__esModule",{value:!0});Rf.TokenType=void 0;var i_;(function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_TOKEN="NATIVE_TOKEN",t.UNKNOWN="UNKNOWN"})(i_||(Rf.TokenType=i_={}));var t1={};Object.defineProperty(t1,"__esModule",{value:!0});var Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});Ac.NativeStakingStatus=Ac.ConfirmationViewTypes=void 0;var o_;(function(t){t.GENERIC="GENERIC",t.COW_SWAP_ORDER="COW_SWAP_ORDER",t.COW_SWAP_TWAP_ORDER="COW_SWAP_TWAP_ORDER",t.KILN_NATIVE_STAKING_DEPOSIT="KILN_NATIVE_STAKING_DEPOSIT",t.KILN_NATIVE_STAKING_VALIDATORS_EXIT="KILN_NATIVE_STAKING_VALIDATORS_EXIT",t.KILN_NATIVE_STAKING_WITHDRAW="KILN_NATIVE_STAKING_WITHDRAW"})(o_||(Ac.ConfirmationViewTypes=o_={}));var a_;(function(t){t.NOT_STAKED="NOT_STAKED",t.ACTIVATING="ACTIVATING",t.DEPOSIT_IN_PROGRESS="DEPOSIT_IN_PROGRESS",t.ACTIVE="ACTIVE",t.EXIT_REQUESTED="EXIT_REQUESTED",t.EXITING="EXITING",t.EXITED="EXITED",t.SLASHED="SLASHED"})(a_||(Ac.NativeStakingStatus=a_={}));var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.SafeMessageStatus=Ic.SafeMessageListItemType=void 0;var c_;(function(t){t.DATE_LABEL="DATE_LABEL",t.MESSAGE="MESSAGE"})(c_||(Ic.SafeMessageListItemType=c_={}));var l_;(function(t){t.NEEDS_CONFIRMATION="NEEDS_CONFIRMATION",t.CONFIRMED="CONFIRMED"})(l_||(Ic.SafeMessageStatus=l_={}));var Pf={};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.DeviceType=void 0;var u_;(function(t){t.ANDROID="ANDROID",t.IOS="IOS",t.WEB="WEB"})(u_||(Pf.DeviceType=u_={}));var n1={};Object.defineProperty(n1,"__esModule",{value:!0});(function(t){var e=it&&it.__createBinding||(Object.create?function(X,ae,Re,Xe){Xe===void 0&&(Xe=Re);var Tn=Object.getOwnPropertyDescriptor(ae,Re);(!Tn||("get"in Tn?!ae.__esModule:Tn.writable||Tn.configurable))&&(Tn={enumerable:!0,get:function(){return ae[Re]}}),Object.defineProperty(X,Xe,Tn)}:function(X,ae,Re,Xe){Xe===void 0&&(Xe=Re),X[Xe]=ae[Re]}),n=it&&it.__exportStar||function(X,ae){for(var Re in X)Re!=="default"&&!Object.prototype.hasOwnProperty.call(ae,Re)&&e(ae,X,Re)};Object.defineProperty(t,"__esModule",{value:!0}),t.setBaseUrl=void 0,t.relayTransaction=a,t.getRelayCount=c,t.getSafeInfo=l,t.getIncomingTransfers=u,t.getModuleTransactions=d,t.getMultisigTransactions=h,t.getBalances=f,t.getFiatCurrencies=p,t.getOwnedSafes=m,t.getAllOwnedSafes=g,t.getCollectibles=T,t.getCollectiblesPage=N,t.getTransactionHistory=_,t.getTransactionQueue=O,t.getTransactionDetails=A,t.deleteTransaction=x,t.postSafeGasEstimation=k,t.getNonces=L,t.proposeTransaction=M,t.getConfirmationView=z,t.getTxPreview=J,t.getChainsConfig=H,t.getChainConfig=F,t.getSafeApps=P,t.getMasterCopies=w,t.getDecodedData=E,t.getSafeMessages=R,t.getSafeMessage=b,t.proposeSafeMessage=y,t.confirmSafeMessage=C,t.getDelegates=$,t.registerDevice=B,t.unregisterSafe=G,t.unregisterDevice=Y,t.registerEmail=Q,t.changeEmail=ye,t.resendEmailVerificationCode=be,t.verifyEmail=De,t.getRegisteredEmail=ve,t.deleteRegisteredEmail=Be,t.registerRecoveryModule=ct,t.unsubscribeSingle=Ct,t.unsubscribeAll=$t,t.getSafeOverviews=tn,t.getContract=Sn,t.getAuthNonce=Bc,t.verifyAuth=Ra,t.createAccount=bi,t.getAccount=vi,t.deleteAccount=_i,t.getAccountDataTypes=Hs,t.getAccountDataSettings=To,t.putAccountDataSettings=No,t.getIndexingStatus=Oo;const r=Mc,s=Nf;n(Of,t),n(ho,t),n(Mt,t),n(fo,t),n(Rf,t),n(t1,t),n(Ac,t),n(Ic,t),n(Pf,t),n(n1,t);let i=s.DEFAULT_BASE_URL;const o=X=>{i=X};t.setBaseUrl=o;function a(X,ae){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/relay",{path:{chainId:X},body:ae})}function c(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/relay/{address}",{path:{chainId:X,address:ae}})}function l(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}",{path:{chainId:X,address:ae}})}function u(X,ae,Re,Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/incoming-transfers/",{path:{chainId:X,address:ae},query:Re},Xe)}function d(X,ae,Re,Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/module-transactions/",{path:{chainId:X,address:ae},query:Re},Xe)}function h(X,ae,Re,Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/multisig-transactions/",{path:{chainId:X,address:ae},query:Re},Xe)}function f(X,ae,Re="usd",Xe={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/balances/{currency}",{path:{chainId:X,address:ae,currency:Re},query:Xe})}function p(){return(0,r.getEndpoint)(i,"/v1/balances/supported-fiat-codes")}function m(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/owners/{address}/safes",{path:{chainId:X,address:ae}})}function g(X){return(0,r.getEndpoint)(i,"/v1/owners/{address}/safes",{path:{address:X}})}function T(X,ae,Re={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:X,address:ae},query:Re})}function N(X,ae,Re={},Xe){return(0,r.getEndpoint)(i,"/v2/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:X,address:ae},query:Re},Xe)}function _(X,ae,Re={},Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/history",{path:{chainId:X,safe_address:ae},query:Re},Xe)}function O(X,ae,Re={},Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/queued",{path:{chainId:X,safe_address:ae},query:Re},Xe)}function A(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/transactions/{transactionId}",{path:{chainId:X,transactionId:ae}})}function x(X,ae,Re){return(0,r.deleteEndpoint)(i,"/v1/chains/{chainId}/transactions/{safeTxHash}",{path:{chainId:X,safeTxHash:ae},body:{signature:Re}})}function k(X,ae,Re){return(0,r.postEndpoint)(i,"/v2/chains/{chainId}/safes/{safe_address}/multisig-transactions/estimations",{path:{chainId:X,safe_address:ae},body:Re})}function L(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/nonces",{path:{chainId:X,safe_address:ae}})}function M(X,ae,Re){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/transactions/{safe_address}/propose",{path:{chainId:X,safe_address:ae},body:Re})}function z(X,ae,Re,Xe,Tn,Ci){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/views/transaction-confirmation",{path:{chainId:X,safe_address:ae},body:{operation:Re,data:Xe,to:Tn,value:Ci}})}function J(X,ae,Re,Xe,Tn,Ci){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/transactions/{safe_address}/preview",{path:{chainId:X,safe_address:ae},body:{operation:Re,data:Xe,to:Tn,value:Ci}})}function H(X){return(0,r.getEndpoint)(i,"/v1/chains",{query:X})}function F(X){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}",{path:{chainId:X}})}function P(X,ae={}){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safe-apps",{path:{chainId:X},query:ae})}function w(X){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/about/master-copies",{path:{chainId:X}})}function E(X,ae,Re,Xe){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/data-decoder",{path:{chainId:X},body:{operation:ae,data:Re,to:Xe}})}function R(X,ae,Re){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:X,safe_address:ae},query:{}},Re)}function b(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}",{path:{chainId:X,message_hash:ae}})}function y(X,ae,Re){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:X,safe_address:ae},body:Re})}function C(X,ae,Re){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}/signatures",{path:{chainId:X,message_hash:ae},body:Re})}function $(X,ae={}){return(0,r.getEndpoint)(i,"/v2/chains/{chainId}/delegates",{path:{chainId:X},query:ae})}function B(X){return(0,r.postEndpoint)(i,"/v1/register/notifications",{body:X})}function G(X,ae,Re){return(0,r.deleteEndpoint)(i,"/v1/chains/{chainId}/notifications/devices/{uuid}/safes/{safe_address}",{path:{chainId:X,safe_address:ae,uuid:Re}})}function Y(X,ae){return(0,r.deleteEndpoint)(i,"/v1/chains/{chainId}/notifications/devices/{uuid}",{path:{chainId:X,uuid:ae}})}function Q(X,ae,Re,Xe){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails",{path:{chainId:X,safe_address:ae},body:Re,headers:Xe})}function ye(X,ae,Re,Xe,Tn){return(0,r.putEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:X,safe_address:ae,signer:Re},body:Xe,headers:Tn})}function be(X,ae,Re){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify-resend",{path:{chainId:X,safe_address:ae,signer:Re},body:""})}function De(X,ae,Re,Xe){return(0,r.putEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify",{path:{chainId:X,safe_address:ae,signer:Re},body:Xe})}function ve(X,ae,Re,Xe){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:X,safe_address:ae,signer:Re},headers:Xe})}function Be(X,ae,Re,Xe){return(0,r.deleteEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:X,safe_address:ae,signer:Re},headers:Xe})}function ct(X,ae,Re){return(0,r.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/recovery",{path:{chainId:X,safe_address:ae},body:Re})}function Ct(X){return(0,r.deleteEndpoint)(i,"/v1/subscriptions",{query:X})}function $t(X){return(0,r.deleteEndpoint)(i,"/v1/subscriptions/all",{query:X})}function tn(X,ae){return(0,r.getEndpoint)(i,"/v1/safes",{query:Object.assign(Object.assign({},ae),{safes:X.join(",")})})}function Sn(X,ae){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/contracts/{contractAddress}",{path:{chainId:X,contractAddress:ae}})}function Bc(){return(0,r.getEndpoint)(i,"/v1/auth/nonce",{credentials:"include"})}function Ra(X){return(0,r.postEndpoint)(i,"/v1/auth/verify",{body:X,credentials:"include"})}function bi(X){return(0,r.postEndpoint)(i,"/v1/accounts",{body:X,credentials:"include"})}function vi(X){return(0,r.getEndpoint)(i,"/v1/accounts/{address}",{path:{address:X},credentials:"include"})}function _i(X){return(0,r.deleteEndpoint)(i,"/v1/accounts/{address}",{path:{address:X},credentials:"include"})}function Hs(){return(0,r.getEndpoint)(i,"/v1/accounts/data-types")}function To(X){return(0,r.getEndpoint)(i,"/v1/accounts/{address}/data-settings",{path:{address:X},credentials:"include"})}function No(X,ae){return(0,r.putEndpoint)(i,"/v1/accounts/{address}/data-settings",{path:{address:X},body:ae,credentials:"include"})}function Oo(X){return(0,r.getEndpoint)(i,"/v1/chains/{chainId}/about/indexing",{path:{chainId:X}})}})(QT);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TransferDirection=t.TransactionStatus=t.TokenType=t.Operation=void 0;var e=QT;Object.defineProperty(t,"Operation",{enumerable:!0,get:function(){return e.Operation}}),Object.defineProperty(t,"TokenType",{enumerable:!0,get:function(){return e.TokenType}}),Object.defineProperty(t,"TransactionStatus",{enumerable:!0,get:function(){return e.TransactionStatus}}),Object.defineProperty(t,"TransferDirection",{enumerable:!0,get:function(){return e.TransferDirection}})})(XT);var r1={};Object.defineProperty(r1,"__esModule",{value:!0});(function(t){var e=it&&it.__createBinding||(Object.create?function(r,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(r,o,a)}:function(r,s,i,o){o===void 0&&(o=i),r[o]=s[i]}),n=it&&it.__exportStar||function(r,s){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,r,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(Sf,t),n(ZT,t),n(XT,t),n(r1,t)})(If);Object.defineProperty(Af,"__esModule",{value:!0});Af.TXs=void 0;const Ad=ws,KJ=If;class GJ{constructor(e){this.communicator=e}async getBySafeTxHash(e){if(!e)throw new Error("Invalid safeTxHash");return(await this.communicator.send(Ad.Methods.getTxBySafeTxHash,{safeTxHash:e})).data}async signMessage(e){const n={message:e};return(await this.communicator.send(Ad.Methods.signMessage,n)).data}async signTypedMessage(e){if(!(0,KJ.isObjectEIP712TypedData)(e))throw new Error("Invalid typed data");return(await this.communicator.send(Ad.Methods.signTypedMessage,{typedData:e})).data}async send({txs:e,params:n}){if(!e||!e.length)throw new Error("No transactions were passed");const r={txs:e,params:n};return(await this.communicator.send(Ad.Methods.sendTransactions,r)).data}}Af.TXs=GJ;var xf={},$c={};Object.defineProperty($c,"__esModule",{value:!0});$c.RPC_CALLS=void 0;$c.RPC_CALLS={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"};Object.defineProperty(xf,"__esModule",{value:!0});xf.Eth=void 0;const Sr=$c,YJ=ws,Xs={defaultBlockParam:(t="latest")=>t,returnFullTxObjectParam:(t=!1)=>t,blockNumberToHex:t=>Number.isInteger(t)?`0x${t.toString(16)}`:t};class JJ{constructor(e){this.communicator=e,this.call=this.buildRequest({call:Sr.RPC_CALLS.eth_call,formatters:[null,Xs.defaultBlockParam]}),this.getBalance=this.buildRequest({call:Sr.RPC_CALLS.eth_getBalance,formatters:[null,Xs.defaultBlockParam]}),this.getCode=this.buildRequest({call:Sr.RPC_CALLS.eth_getCode,formatters:[null,Xs.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:Sr.RPC_CALLS.eth_getStorageAt,formatters:[null,Xs.blockNumberToHex,Xs.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:Sr.RPC_CALLS.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:Sr.RPC_CALLS.eth_getBlockByHash,formatters:[null,Xs.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:Sr.RPC_CALLS.eth_getBlockByNumber,formatters:[Xs.blockNumberToHex,Xs.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:Sr.RPC_CALLS.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:Sr.RPC_CALLS.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:Sr.RPC_CALLS.eth_getTransactionCount,formatters:[null,Xs.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:Sr.RPC_CALLS.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:Sr.RPC_CALLS.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:Sr.RPC_CALLS.safe_setSettings})}buildRequest(e){const{call:n,formatters:r}=e;return async s=>{r&&Array.isArray(s)&&r.forEach((a,c)=>{a&&(s[c]=a(s[c]))});const i={call:n,params:s||[]};return(await this.communicator.send(YJ.Methods.rpcCall,i)).data}}}xf.Eth=JJ;var kf={};const ZJ=__(iN);var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.MAGIC_VALUE_BYTES=Sc.MAGIC_VALUE=void 0;const XJ="0x1626ba7e";Sc.MAGIC_VALUE=XJ;const QJ="0x20c13b0b";Sc.MAGIC_VALUE_BYTES=QJ;var Ky={},xu={},Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.PermissionsError=Ea.PERMISSIONS_REQUEST_REJECTED=void 0;Ea.PERMISSIONS_REQUEST_REJECTED=4001;class Gy extends Error{constructor(e,n,r){super(e),this.code=n,this.data=r,Object.setPrototypeOf(this,Gy.prototype)}}Ea.PermissionsError=Gy;Object.defineProperty(xu,"__esModule",{value:!0});xu.Wallet=void 0;const tg=ws,Id=Ea;class eZ{constructor(e){this.communicator=e}async getPermissions(){return(await this.communicator.send(tg.Methods.wallet_getPermissions,void 0)).data}async requestPermissions(e){if(!this.isPermissionRequestValid(e))throw new Id.PermissionsError("Permissions request is invalid",Id.PERMISSIONS_REQUEST_REJECTED);try{return(await this.communicator.send(tg.Methods.wallet_requestPermissions,e)).data}catch{throw new Id.PermissionsError("Permissions rejected",Id.PERMISSIONS_REQUEST_REJECTED)}}isPermissionRequestValid(e){return e.every(n=>typeof n=="object"?Object.keys(n).every(r=>!!Object.values(tg.RestrictedMethods).includes(r)):!1)}}xu.Wallet=eZ;Object.defineProperty(Ky,"__esModule",{value:!0});const tZ=xu,d_=Ea,h_=(t,e)=>e.some(n=>n.parentCapability===t),nZ=()=>(t,e,n)=>{const r=n.value;return n.value=async function(){const s=new tZ.Wallet(this.communicator);let i=await s.getPermissions();if(h_(e,i)||(i=await s.requestPermissions([{[e]:{}}])),!h_(e,i))throw new d_.PermissionsError("Permissions rejected",d_.PERMISSIONS_REQUEST_REJECTED);return r.apply(this)},n};Ky.default=nZ;var rZ=it&&it.__decorate||function(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i},sZ=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(kf,"__esModule",{value:!0});kf.Safe=void 0;const Sd=ZJ,f_=Sc,qi=ws,p_=$c,iZ=If,oZ=sZ(Ky);class s1{constructor(e){this.communicator=e}async getChainInfo(){return(await this.communicator.send(qi.Methods.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(qi.Methods.getSafeInfo,void 0)).data}async experimental_getBalances({currency:e="usd"}={}){return(await this.communicator.send(qi.Methods.getSafeBalances,{currency:e})).data}async check1271Signature(e,n="0x"){const r=await this.getInfo(),s=(0,Sd.encodeFunctionData)({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[e,n]}),i={call:p_.RPC_CALLS.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(qi.Methods.rpcCall,i)).data.slice(0,10).toLowerCase()===f_.MAGIC_VALUE}catch{return!1}}async check1271SignatureBytes(e,n="0x"){const r=await this.getInfo(),s=(0,Sd.encodeFunctionData)({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[e,n]}),i={call:p_.RPC_CALLS.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(qi.Methods.rpcCall,i)).data.slice(0,10).toLowerCase()===f_.MAGIC_VALUE_BYTES}catch{return!1}}calculateMessageHash(e){return(0,Sd.hashMessage)(e)}calculateTypedMessageHash(e){const n=typeof e.domain.chainId=="object"?e.domain.chainId.toNumber():Number(e.domain.chainId);let r=e.primaryType;if(!r){const s=Object.values(e.types),i=Object.keys(e.types).filter(o=>s.every(a=>a.every(({type:c})=>c.replace("[","").replace("]","")!==o)));if(i.length===0||i.length>1)throw new Error("Please specify primaryType");r=i[0]}return(0,Sd.hashTypedData)({message:e.message,domain:{...e.domain,chainId:n,verifyingContract:e.domain.verifyingContract,salt:e.domain.salt},types:e.types,primaryType:r})}async getOffChainSignature(e){return(await this.communicator.send(qi.Methods.getOffChainSignature,e)).data}async isMessageSigned(e,n="0x"){let r;if(typeof e=="string"&&(r=async()=>{const s=this.calculateMessageHash(e);return await this.isMessageHashSigned(s,n)}),(0,iZ.isObjectEIP712TypedData)(e)&&(r=async()=>{const s=this.calculateTypedMessageHash(e);return await this.isMessageHashSigned(s,n)}),r)return await r();throw new Error("Invalid message type")}async isMessageHashSigned(e,n="0x"){const r=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const s of r)if(await s(e,n))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(qi.Methods.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(qi.Methods.requestAddressBook,void 0)).data}}kf.Safe=s1;rZ([(0,oZ.default)()],s1.prototype,"requestAddressBook",null);var aZ=it&&it.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uh,"__esModule",{value:!0});const cZ=aZ(JT),lZ=Af,uZ=xf,dZ=kf,hZ=xu;class fZ{constructor(e={}){const{allowedDomains:n=null,debug:r=!1}=e;this.communicator=new cZ.default(n,r),this.eth=new uZ.Eth(this.communicator),this.txs=new lZ.TXs(this.communicator),this.safe=new dZ.Safe(this.communicator),this.wallet=new hZ.Wallet(this.communicator)}}Uh.default=fZ;(function(t){var e=it&&it.__createBinding||(Object.create?function(o,a,c,l){l===void 0&&(l=c);var u=Object.getOwnPropertyDescriptor(a,c);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(o,l,u)}:function(o,a,c,l){l===void 0&&(l=c),o[l]=a[c]}),n=it&&it.__exportStar||function(o,a){for(var c in o)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,o,c)},r=it&&it.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSDKVersion=void 0;const s=r(Uh);t.default=s.default,n(Uh,t),n(If,t),n(ws,t),n(Ru,t);var i=Pu;Object.defineProperty(t,"getSDKVersion",{enumerable:!0,get:function(){return i.getSDKVersion}}),n($c,t)})(YT);var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.numberToHex=Tc.getLowerCase=void 0;function pZ(t){return t&&t.toLowerCase()}Tc.getLowerCase=pZ;function gZ(t){return`0x${t.toString(16)}`}Tc.numberToHex=gZ;Object.defineProperty(vf,"__esModule",{value:!0});vf.SafeAppProvider=void 0;const Va=YT,mZ=SA(),jr=Tc;class yZ extends mZ.EventEmitter{constructor(e,n){super(),this.submittedTxs=new Map,this.safe=e,this.sdk=n}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(e){const{method:n,params:r=[]}=e;switch(n){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return(0,jr.numberToHex)(this.chainId);case"personal_sign":{const[c,l]=r;if(this.safe.safeAddress.toLowerCase()!==l.toLowerCase())throw new Error("The address or message hash is invalid");const u=await this.sdk.txs.signMessage(c);return("signature"in u?u.signature:void 0)||"0x"}case"eth_sign":{const[c,l]=r;if(this.safe.safeAddress.toLowerCase()!==c.toLowerCase()||!l.startsWith("0x"))throw new Error("The address or message hash is invalid");const u=await this.sdk.txs.signMessage(l);return("signature"in u?u.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[c,l]=r,u=typeof l=="string"?JSON.parse(l):l;if(this.safe.safeAddress.toLowerCase()!==c.toLowerCase())throw new Error("The address is invalid");const d=await this.sdk.txs.signTypedMessage(u);return("signature"in d?d.signature:void 0)||"0x"}case"eth_sendTransaction":const s={...r[0],value:r[0].value||"0",data:r[0].data||"0x"};typeof s.gas=="string"&&s.gas.startsWith("0x")&&(s.gas=parseInt(s.gas,16));const i=await this.sdk.txs.send({txs:[s],params:{safeTxGas:s.gas}});return this.submittedTxs.set(i.safeTxHash,{from:this.safe.safeAddress,hash:i.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:s.data,value:s.value,to:s.to,blockHash:null,blockNumber:null,transactionIndex:null}),i.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,jr.getLowerCase)(r[0]),r[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,jr.getLowerCase)(r[0]),r[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,jr.getLowerCase)(r[0]),r[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,jr.getLowerCase)(r[0]),r[1],r[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([r[0],r[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([r[0],r[1]]);case"eth_getTransactionByHash":let a=r[0];try{a=(await this.sdk.txs.getBySafeTxHash(a)).txHash||a}catch{}return this.submittedTxs.has(a)?this.submittedTxs.get(a):this.sdk.eth.getTransactionByHash([a]).then(c=>(c&&(c.hash=r[0]),c));case"eth_getTransactionReceipt":{let c=r[0];try{c=(await this.sdk.txs.getBySafeTxHash(c)).txHash||c}catch{}return this.sdk.eth.getTransactionReceipt([c]).then(l=>(l&&(l.transactionHash=r[0]),l))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(r[0]);case"eth_call":return this.sdk.eth.call([r[0],r[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([r[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(r[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([r[0]]);case"wallet_sendCalls":{const{from:c,calls:l,chainId:u}=r[0];if(u!==(0,jr.numberToHex)(this.chainId))throw new Error(`Safe is not on chain ${u}`);if(c!==this.safe.safeAddress)throw Error("Invalid from address");const d=l.map((p,m)=>{if(!p.to)throw new Error(`Invalid call #${m}: missing "to" field`);return{to:p.to,data:p.data??"0x",value:p.value??(0,jr.numberToHex)(0)}}),{safeTxHash:h}=await this.sdk.txs.send({txs:d});return{id:h}}case"wallet_getCallsStatus":{const c=r[0],l={[Va.TransactionStatus.AWAITING_CONFIRMATIONS]:100,[Va.TransactionStatus.AWAITING_EXECUTION]:100,[Va.TransactionStatus.SUCCESS]:200,[Va.TransactionStatus.CANCELLED]:400,[Va.TransactionStatus.FAILED]:500},u=await this.sdk.txs.getBySafeTxHash(c),d={version:"1.0",id:c,chainId:(0,jr.numberToHex)(this.chainId),status:l[u.txStatus]};if(!u.txHash)return d;const h=await this.sdk.eth.getTransactionReceipt([u.txHash]);if(!h)return d;const f=u.txData?.dataDecoded?.method!=="multiSend"?1:u.txData.dataDecoded.parameters?.[0].valueDecoded?.length??1,p=Number(h.blockNumber),m=Number(h.gasUsed);return d.receipts=Array(f).fill({logs:h.logs,status:(0,jr.numberToHex)(u.txStatus===Va.TransactionStatus.SUCCESS?1:0),blockHash:h.blockHash,blockNumber:(0,jr.numberToHex)(p),gasUsed:(0,jr.numberToHex)(m),transactionHash:u.txHash}),d}case"wallet_showCallsStatus":throw new Error(`"${e.method}" not supported`);case"wallet_getCapabilities":return{[(0,jr.numberToHex)(this.chainId)]:{atomicBatch:{supported:!0}}};default:throw Error(`"${e.method}" not implemented`)}}send(e,n){e||n("Undefined request"),this.request(e).then(r=>n(null,{jsonrpc:"2.0",id:e.id,result:r})).catch(r=>n(r,null))}}vf.SafeAppProvider=yZ;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SafeAppProvider=void 0;var e=vf;Object.defineProperty(t,"SafeAppProvider",{enumerable:!0,get:function(){return e.SafeAppProvider}})})(GT);class wZ extends GT.SafeAppProvider{request(e){return e.method==="eth_requestAccounts"?this.request({method:"eth_accounts",params:[]}):super.request(e)}}class EZ extends qy{async initialize(){const{default:e}=await hn(async()=>{const{default:i}=await import("./index-DaxwYOrQ.js");return{default:i}},__vite__mapDeps([54,0,1,2,4,5])),n=new e,r=await n.safe.getInfo(),s=new wZ(r,n);await s.connect().catch(i=>{}),this.provider=s,this.initialized=!0}async getProvider(){return Promise.resolve(this.provider)}}class bZ extends qy{async initialize(){if(!(typeof window>"u")&&window.ethereum)return this.provider=window.ethereum,this.initialized=!0,Promise.resolve()}}const Ka={signMessage:async(t,e,n)=>{if(!e)throw new Error("signMessage - provider is undefined");const r=lN(t)?t:uN(dN(t));return await e.request({method:"personal_sign",params:[r,n]})},estimateGas:async(t,e,n,r)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!n)throw new Error("estimateGas - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:t.address,to:t.to,data:t.data,type:0},i=new jf(e,r);return await new Wf(i,n).estimateGas(s)},sendTransaction:async(t,e,n,r)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!n)throw new Error("sendTransaction - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:t.to,value:t.value,gasLimit:t.gas,gasPrice:t.gasPrice,data:t.data,type:0},i=new jf(e,r);return(await(await new Wf(i,n).sendTransaction(s)).wait())?.hash||null},writeContract:async(t,e,n,r)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!n)throw new Error("writeContract - address is undefined");const s=new jf(e,r),i=new Wf(s,n),o=new cN(t.tokenAddress,t.abi,i);if(!o||!t.method)throw new Error("Contract method is undefined");const a=o[t.method];if(a)return await a(...t.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:t=>{try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:aN,formatUnits:oN};class vZ extends UT{constructor(){super({adapterType:j.ADAPTER_TYPES.ETHERS,namespace:j.CHAIN.EVM}),this.balancePromises={},this.ethersProviders={}}async createEthersConfig(){const{metadata:e,enableCoinbase:n,enableInjected:r,enableEIP6963:s}=Z.state;if(e){if(r!==!1){const i=new bZ;await i.initialize(),this.ethersProviders.injected=i}if(n!==!1&&(this.ethersProviders.baseAccount=new OJ),de.isSafeApp()){const i=new EZ;await i.initialize(),this.ethersProviders.safe=i}return{...this.ethersProviders,EIP6963:s!==!1,metadata:e}}}async signMessage(e){const{message:n,address:r,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await Ka.signMessage(n,s,r)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){if(!e.provider)throw new Error("Provider is undefined");const n=I.getAccountData(j.CHAIN.EVM)?.address;if(!n)throw new Error("Address is undefined");return{hash:await Ka.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:n},e.provider,n,Number(e.caipNetwork?.id))}}async writeContract(e){if(!e.provider)throw new Error("Provider is undefined");const{address:n}=pn.parseCaipAddress(e.caipAddress);return{hash:await Ka.writeContract(e,e.provider,n,Number(e.caipNetwork?.id))}}async estimateGas(e){const{provider:n,caipNetwork:r,address:s}=e;if(!n)throw new Error("Provider is undefined");try{return{gas:await Ka.estimateGas({data:e.data,to:e.to,address:s},n,s,Number(r?.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return Ka.parseUnits(e.value,e.decimals)}formatUnits(e){return Ka.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:n,chainId:r}=e,s=this.connectors.find(c=>c.id===n),i=s?.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(n,i),!o[0])throw new Error("No accounts found");if(!s?.type)throw new Error("Connector type not found");return{address:this.toChecksummedAddress(o[0]),chainId:Number(a)||Number(r),provider:i,type:s.type,id:n}}async syncConnectors(){this.ethersConfig=await this.createEthersConfig(),this.ethersConfig?.EIP6963&&this.listenInjectedConnector(!0);const n=Object.keys(this.ethersConfig||{}).filter(r=>r!=="metadata"&&r!=="EIP6963").map(async r=>{const s=r===j.CONNECTOR_ID.INJECTED;if(this.namespace){const i=this.ethersProviders[r];this.addConnector({id:r,explorerId:Rr.ConnectorExplorerIds[r],imageUrl:Pr.state.connectorImages?.[r],name:Rr.ConnectorNamesMap[r]||"Unknown",imageId:Rr.ConnectorImageIds[r],type:Rr.ConnectorTypesMap[r]??"EXTERNAL",info:s?void 0:{rdns:r},chain:this.namespace,chains:[],provider:await i?.getProvider()})}});await Promise.all(n)}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async n=>{const r=this.connectors.find(s=>di.isLowerCaseMatch(s.id,n.connectorId));if(!r)throw new Error("Connector not found");return await this.disconnect({id:r.id}),n}))}}async syncConnections({connectToFirstConnector:e}){const n=this.getCaipNetworks();await Promise.all(this.connectors.filter(r=>{const{hasDisconnected:s,hasConnected:i}=di.getConnectorStorageInfo(r.id,this.namespace);return!s&&i}).map(async r=>{if(r.id===j.CONNECTOR_ID.WALLET_CONNECT){const s=Bs.getWalletConnectAccounts(this.universalProvider,this.namespace),i=n.find(o=>o.chainNamespace===this.namespace&&o.id.toString()===s[0]?.chainId?.toString());s.length>0&&this.addConnection({connectorId:r.id,accounts:s.map(o=>({address:o.address})),caipNetwork:i})}else{const{accounts:s,chainId:i}=await Vr.fetchProviderData(r);if(s.length>0&&i){const o=n.find(a=>a.chainNamespace===this.namespace&&a.id.toString()===i.toString());this.addConnection({connectorId:r.id,accounts:s.map(a=>({address:a})),caipNetwork:o}),r.provider&&r.id!==j.CONNECTOR_ID.AUTH&&r.id!==j.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(r.id,r.provider)}}})),e&&this.emitFirstAvailableConnection()}async setUniversalProvider(e){this.universalProvider=e;const n=j.CONNECTOR_ID.WALLET_CONNECT;return Bs.listenWcProvider({universalProvider:e,namespace:j.CHAIN.EVM,onConnect:r=>this.onConnect(r,n),onDisconnect:()=>this.onDisconnect(n),onAccountsChanged:r=>this.onAccountsChanged(r,n,!1),onChainChanged:r=>this.onChainChanged(r,n)}),this.addConnector(new MT({provider:e,caipNetworks:this.getCaipNetworks(),namespace:j.CHAIN.EVM})),Promise.resolve()}eip6963EventHandler(e){if(e.detail){const{info:n,provider:r}=e.detail;if(!this.connectors?.find(i=>i.name===n?.name)){const i=Rr.ConnectorTypesMap[j.CONNECTOR_ID.EIP6963],o=n?.rdns||n?.name||n?.uuid;this.namespace&&o&&this.addConnector({id:o,type:i,explorerId:Rr.ConnectorExplorerIds[n.rdns||""]??Rr.ConnectorExplorerIds[n.name||""],imageUrl:n?.icon,name:n?.name||"Unknown",provider:r,info:n,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const n=this.eip6963EventHandler.bind(this);window.addEventListener(j.EIP6963_ANNOUNCE_EVENT,n),window.dispatchEvent(new Event(j.EIP6963_REQUEST_EVENT))}}async connect({id:e,address:n,type:r,chainId:s,socialUri:i}){try{const o=this.connectors.find(h=>di.isLowerCaseMatch(h.id,e));if(!o)throw new Error("Connector not found");const a=this.getConnection({address:n,connectorId:e,connections:this.connections,connectors:this.connectors});if(a){const h=a.caipNetwork;if(!h)throw new Error("EthersAdapter:connect - could not find the caipNetwork to connect");if(a.account)return this.emit("accountChanged",{address:this.toChecksummedAddress(a.account.address),chainId:h.id,connector:o}),{address:this.toChecksummedAddress(a.account.address),chainId:h.id,provider:o.provider,type:o.type,id:e}}let c=o?.provider;const l=this.ethersProviders[o.id];if(l&&(await l.initialize(),c=await l.getProvider()),!c)throw new Error("Provider not found");o.provider=c;let u=[],d;if(r===j.CONNECTOR_TYPE_AUTH){const{address:h,accounts:f}=await nr.authConnectorAuthenticate({authConnector:c,chainNamespace:j.CHAIN.EVM,chainId:s,socialUri:i,preferredAccountType:An("eip155")}),p=this.getCaipNetworks().find(m=>m.id.toString()===s?.toString());u=[h],this.addConnection({connectorId:e,accounts:f?f.map(m=>({address:m.address})):u.map(m=>({address:m})),caipNetwork:p,auth:{name:te.getConnectedSocialProvider(),username:te.getConnectedSocialUsername()}}),this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:o})}else{u=await c.request({method:"eth_requestAccounts"}),d=await c.request({method:"eth_chainId"});const h=this.getCaipNetworks().find(f=>f.id.toString()===s?.toString());if(d!==s){if(!h)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await c?.request({method:"wallet_switchEthereumChain",params:[{chainId:hc.numberToHexString(h.id)}]})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:o}),this.addConnection({connectorId:e,accounts:u.map(f=>({address:f})),caipNetwork:h}),o.id!==j.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(e,c)}return{address:this.toChecksummedAddress(u[0]),chainId:Number(s),provider:c,type:r,id:e}}catch(o){throw xs.isUserRejectedRequestError(o)?new Zm(o):o}}async reconnect(e){const{id:n,chainId:r}=e,s=this.connectors.find(i=>i.id===n);s&&s.type==="AUTH"&&r&&await nr.authConnectorAuthenticate({authConnector:s.provider,chainNamespace:j.CHAIN.EVM,chainId:r,preferredAccountType:An("eip155")})}async getAccounts(e){const n=this.connectors.find(o=>o.id===e.id),r=n?.provider;if(!r||!n)throw new Error("Provider not found");const s=this.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});if(s)return{accounts:s.accounts.map(({address:o})=>de.createAccount(j.CHAIN.EVM,o,"eoa"))};if(e.id===j.CONNECTOR_ID.AUTH){const o=n.provider;if(!o.user)return{accounts:[]};const{accounts:a,address:c}=o.user;return Promise.resolve({accounts:(a||[{address:c,type:"eoa"}]).map(l=>de.createAccount(j.CHAIN.EVM,l.address,l.type))})}return{accounts:(await r.request({method:"eth_requestAccounts"})).map(o=>de.createAccount(j.CHAIN.EVM,o,"eoa"))}}async disconnect(e){if(e.id){const n=this.connectors.find(s=>di.isLowerCaseMatch(s.id,e.id));if(!n)throw new Error("Connector not found");const r=this.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});switch(n.type){case j.CONNECTOR_TYPE_WALLET_CONNECT:n.provider.session&&n.provider.disconnect();break;case j.CONNECTOR_TYPE_AUTH:await n.provider?.disconnect();break;case j.CONNECTOR_TYPE_ANNOUNCED:case j.CONNECTOR_TYPE_EXTERNAL:await this.revokeProviderPermissions(n.provider);break;default:throw new Error("Unsupported provider type")}return n.id&&(this.removeProviderListeners(n.id),this.deleteConnection(n.id)),this.connections.length===0?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:r?[r]:[]}}return this.disconnectAll()}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id.toString()===e.chainId?.toString());if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&r.chainNamespace===j.CHAIN.EVM){const s=`${r.caipNetworkId}:${n}`,i=this.balancePromises[s];if(i)return i;const o=te.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new hN(r.rpcUrls.default.http[0],{chainId:r.id,name:r.name});if(a)try{return this.balancePromises[s]=new Promise(async c=>{try{const l=await a.getBalance(n),u=fN(l);te.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:r.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:r.nativeCurrency.symbol})}catch{c({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async switchNetwork(e){const{caipNetwork:n}=e,r=yt.getProviderId(n.chainNamespace),s=yt.getProvider(n.chainNamespace);if(r==="AUTH"||r==="WALLET_CONNECT"){await super.switchNetwork(e);return}if(!s)throw new Error("Provider not found");try{await s?.request({method:"wallet_switchEthereumChain",params:[{chainId:hc.numberToHexString(n.id)}]})}catch(i){if(i.code===co.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||i.code===co.ERROR_INVALID_CHAIN_ID||i.code===co.ERROR_CODE_DEFAULT||i?.data?.originalError?.code===co.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await hc.addEthereumChain(s,n);else if(r==="ANNOUNCED"||r==="EXTERNAL"||r==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){return this.connectors.find(e=>e.type==="WALLET_CONNECT")?.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch{}}async getCapabilities(e){const n=yt.getProvider(j.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const n=yt.getProvider(j.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const n=yt.getProvider(j.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const n=yt.getProvider(j.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getAssets",params:[e]})}toChecksummedAddress(e){try{return pN(e.toLowerCase())}catch{return e}}}function lu(t){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lu(t)}function _Z(t,e){if(lu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(lu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CZ(t){var e=_Z(t,"string");return lu(e)=="symbol"?e:e+""}function i1(t,e,n){return(e=CZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const g_="5864e2ced7c293ed18ac35e0db085c09ed567d67346ccb6f58a0327a75137489",AZ=3e3;var Yy=class si extends Lh{async getWalletDeviceType(){return Promise.resolve($h.Browser)}createAppKit(){var e;const n=(e=this.metadata)===null||e===void 0||(e=e.walletConnect)===null||e===void 0?void 0:e.projectId;if(!n)throw new Ce(new Error("Please provide projectId in metadata for WalletConnect"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts});if(si.appKit)return si.appKit;const r=this.evmChainId||ng.Mainnet;return si.appKit=NJ({projectId:n,allWallets:"HIDE",enableEIP6963:!1,enableInjected:!1,enableCoinbase:!1,enableReconnect:!0,adapters:[new vZ],networks:[{id:r,name:"Injective",chainNamespace:"eip155",caipNetworkId:`eip155:${r}`,nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:[]}}}],metadata:{name:"Injective",description:"Injective Protocol",url:"https://injective.com",icons:[]},includeWalletIds:[g_],featuredWalletIds:[g_],features:{email:!1,socials:!1,allWallets:!1,connectMethodsOrder:["wallet"]}}),si.sessionRestorePromise=this.waitForSessionRestore(si.appKit),si.appKit}waitForSessionRestore(e){return e.getIsConnectedState()?Promise.resolve():new Promise(n=>{let r=!1;const s=()=>{r||(r=!0,clearTimeout(i),o(),n())},i=setTimeout(s,AZ),o=e.subscribeProviders(a=>{a?.eip155&&e.getIsConnectedState()&&s()})})}async initStrategy(){this.createAppKit(),si.sessionRestorePromise&&await si.sessionRestorePromise}async getProvider(){return this.createAppKit().getUniversalProvider()}async getWalletProvider(e){const n=(await this.getAppKit()).getWalletProvider();if(!n)throw new Es(new Error("No provider available"),{code:Me,type:Ke.WalletError,contextModule:e});return n}async getAppKit(){await this.initStrategy();const e=this.createAppKit();if(!e.getIsConnectedState())throw new Ce(new Error("Wallet not connected. Please call enable() first."),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts});return e}async enable(){return await this.initStrategy(),this.createAppKit().getIsConnectedState()||await this.connect(),!0}async connect(){const e=this.createAppKit();if(!e.getIsConnectedState()){try{var n;const r=await e.getUniversalProvider(),s=r==null||(n=r.client)===null||n===void 0||(n=n.core)===null||n===void 0?void 0:n.pairing;if(s){const i=s.getPairings()||[];await Promise.all(i.map(o=>s.disconnect({topic:o.topic}).catch(()=>{})))}}catch{}await e.open({view:"Connect"}),await q1(100),e.redirect("ConnectingWalletConnectBasic"),await new Promise((r,s)=>{const i=e.subscribeState(o=>{e.getIsConnectedState()?(i(),e.close(),r()):o.open||(i(),s(new Error("Connection cancelled")))})})}}async disconnect(){try{const e=this.createAppKit(),n=e.getWalletProvider();n?.removeListener&&(this.listeners[xa.AccountChange]&&n.removeListener("accountsChanged",this.listeners[xa.AccountChange]),this.listeners[xa.ChainIdChange]&&n.removeListener("chainChanged",this.listeners[xa.ChainIdChange])),await e.disconnect()}catch{}this.listeners={}}async onDisconnect(e){try{const n=await this.getProvider();n?.on("session_delete",e)}catch{}}async getAddresses(){const e=(await this.getAppKit()).getAddress();if(!e)throw new Es(new Error("No address available"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts});return[e]}async getSessionOrConfirm(){try{var e;const n=await this.getProvider();return(n==null||(e=n.session)===null||e===void 0?void 0:e.topic)||""}catch{return""}}async signEip712TypedData(e,n,r={}){await this.getAppKit();const s=await this.getProvider();if(!s)throw new Es(new Error("No provider available"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction});let i;if(r.txTimeout!==void 0){const a=Number(r.txTimeout);i=isNaN(a)||a<300?void 0:Math.min(a,604800)}const o=`eip155:${this.evmChainId||1}`;this.emit(yN.WalletConnectSigningWithTxTimeout,{timeout:i});try{return await s.request({method:"eth_signTypedData_v4",params:[n,e]},o,i)}catch(a){throw new Es(new Error(a.message),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}}async sendTransaction(e,n){const{endpoints:r,txTimeout:s}=n;if(!r)throw new Ce(new Error("You have to pass endpoints within the options"));const i=await new Mh(r.grpc).broadcast(e,{txTimeout:s});if(i.code!==0)throw new Rl(new Error(i.rawLog),{code:Me,contextCode:i.code,contextModule:i.codespace});return i}async sendEvmTransaction(e,n){const r=(await this.getAppKit()).getWalletProvider();if(!r)throw new Es(new Error("No provider available"),{code:Me,type:Ke.WalletError,contextModule:Ge.SendEvmTransaction});try{return await r.request({method:"eth_sendTransaction",params:[e]})}catch(s){throw new Es(new Error(s.message),{code:Me,type:Ke.WalletError,contextModule:Ge.SendEvmTransaction})}}async signArbitrary(e,n){const r=(await this.getAppKit()).getWalletProvider();if(!r)throw new Es(new Error("No provider available"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignArbitrary});try{return await r.request({method:"personal_sign",params:[y_(n),e]})}catch(s){throw new Es(new Error(s.message),{code:Me,type:Ke.WalletError,contextModule:Ge.SignArbitrary})}}async getEthereumChainId(){const e=(await this.getAppKit()).getWalletProvider();if(!e)throw new Es(new Error("No provider available"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetChainId});try{return await e.request({method:"eth_chainId",params:[]})}catch(n){throw new Es(new Error(n.message),{code:Me,type:Ke.WalletError,contextModule:Ge.GetChainId})}}async getEip1193Provider(){const e=(await this.getAppKit()).getWalletProvider();if(!e)throw new Ce(new Error("No wallet provider available"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts});return e}async onChainIdChanged(e){const n=(await this.getAppKit()).getWalletProvider();this.listeners[xa.ChainIdChange]=e,n?.on("chainChanged",e)}async onAccountChange(e){const n=(await this.getAppKit()).getWalletProvider();this.listeners[xa.AccountChange]=e,n?.on("accountsChanged",r=>e(r[0]))}async getAddressesInfo(){throw new Ce(new Error("getAddressesInfo is not supported by WalletConnect"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetAccounts})}async signAminoCosmosTransaction(e){throw new Ce(new Error("Cosmos transactions are not supported by WalletConnect"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async signCosmosTransaction(e){throw new Ce(new Error("Cosmos transactions are not supported by WalletConnect"),{code:Me,type:Ke.WalletError,contextModule:Ge.SignTransaction})}async getEvmTransactionReceipt(e){throw new Ce(new Error("getEvmTransactionReceipt is not supported by WalletConnect"),{code:Me,type:Ke.WalletError,contextModule:Ge.GetEvmTransactionReceipt})}async getPubKey(){throw new Ce(new Error("getPubKey is not supported by WalletConnect"))}};i1(Yy,"appKit",void 0);i1(Yy,"sessionRestorePromise",void 0);const lQ=Object.freeze(Object.defineProperty({__proto__:null,WalletConnectStrategy:Yy},Symbol.toStringTag,{value:"Module"}));export{nX as $,_n as A,EM as B,j as C,kn as D,ze as E,Kn as F,Ld as G,Mv as H,nE as I,yt as J,nD as K,en as L,at as M,Jt as N,Z as O,pn as P,Qt as Q,Ie as R,Wt as S,JX as T,Uv as U,Rt as V,Kt as W,Fl as X,dn as Y,st as Z,Tl as _,cQ as a,Lg as a0,Pr as a1,He as a2,tX as a3,QX as a4,Qh as a5,fa as a6,xs as a7,XX as a8,iQ as a9,nr as aa,AA as ab,WT as ac,Tm as ad,_c as ae,LX as af,Vr as ag,yh as ah,di as ai,ao as aj,Xa as ak,zM as al,SA as am,$m as an,Dt as ao,ks as ap,Je as aq,sr as ar,rA as as,gl as at,Ue as au,OZ as av,UZ as aw,eX as ax,lQ as ay,nQ as b,sQ as c,no as d,aQ as e,I as f,_A as g,pr as h,Gd as i,An as j,de as k,ZX as l,re as m,Bl as n,te as o,kr as p,Fo as q,oQ as r,ue as s,Pe as t,xe as u,gJ as v,rQ as w,tr as x,_e as y,et as z};
