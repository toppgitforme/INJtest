import{U as E,_ as A,a as P}from"./lib-es-BdVxwK9Z-B9dpt8vi.js";import{$ as f}from"./injective-utils-C9MYzl-J.js";import"./icons-Dj0zHVqu.js";var _=P({"../../../node_modules/.pnpm/bip32-path@0.4.2/node_modules/bip32-path/index.js":(t,i)=>{var e=function(r){if(!Array.isArray(r))throw new Error("Input must be an Array");if(r.length===0)throw new Error("Path must contain at least one level");for(var n=0;n<r.length;n++)if(typeof r[n]!="number")throw new Error("Path element is not a number");this.path=r};e.validatePathArray=function(r){try{return e.fromPathArray(r),!0}catch{return!1}},e.validateString=function(r,n){try{return e.fromString(r,n),!0}catch{return!1}},e.fromPathArray=function(r){return new e(r)},e.fromString=function(r,n){if(/^m\//i.test(r))r=r.slice(2);else if(n)throw new Error("Root element is required");for(var s=r.split("/"),o=new Array(s.length),a=0;a<s.length;a++){var h=/(\d+)([hH\']?)/.exec(s[a]);if(h===null)throw new Error("Invalid input");if(o[a]=parseInt(h[1],10),o[a]>=2147483648)throw new Error("Invalid child index");if(h[2]==="h"||h[2]==="H"||h[2]==="'")o[a]+=2147483648;else if(h[2].length!=0)throw new Error("Invalid modifier")}return new e(o)},e.prototype.toPathArray=function(){return this.path},e.prototype.toString=function(r,n){for(var s=new Array(this.path.length),o=0;o<this.path.length;o++){var a=this.path[o];a&2147483648?s[o]=(a&2147483647)+(n?"h":"'"):s[o]=a}return(r?"":"m/")+s.join("/")},e.prototype.inspect=function(){return"BIPPath <"+this.toString()+">"},i.exports=e}}),c=A(_());const d=250,u=85,w="CSM",m=0,p=2,v=4,I=0,S=1,D=2,g=36864,y=27014;var R=class{transport;constructor(t,i=w){this.transport=t,t.decorateAppAPIMethods(this,["getAddress","sign","getAppConfiguration"],i)}getAppConfiguration(){return this.transport.send(u,m,0,0).then(t=>({test_mode:t[0]!==0,version:""+t[1]+"."+t[2]+"."+t[3],device_locked:t[4]===1,major:t[1]}))}serializePath(t){const i=f.Buffer.alloc(20);return i.writeUInt32LE((2147483648|t[0])>>>0,0),i.writeUInt32LE((2147483648|t[1])>>>0,4),i.writeUInt32LE((2147483648|t[2])>>>0,8),i.writeUInt32LE(t[3],12),i.writeUInt32LE(t[4],16),i}serializeHRP(t){if(t==null||t.length===0||t.length>83)throw new Error("Invalid HRP");const i=f.Buffer.alloc(1+t.length);return i.writeUInt8(t.length,0),i.write(t,1),i}getAddress(t,i,l){const e=c.default.fromString(t).toPathArray(),r=this.serializePath(e),n=f.Buffer.concat([this.serializeHRP(i),r]);return this.transport.send(u,v,l?1:0,0,n,[g]).then(s=>({address:f.Buffer.from(s.slice(33,-2)).toString(),publicKey:f.Buffer.from(s.slice(0,33)).toString("hex")}))}foreach(t,i){function l(e,r,n){return e>=r.length?n:i(r[e],e).then(function(s){return n.push(s),l(e+1,r,n)})}return Promise.resolve().then(()=>l(0,t,[]))}async sign(t,i){const l=c.default.fromString(t).toPathArray(),e=this.serializePath(l),r=[];r.push(e);const n=f.Buffer.from(i);for(let o=0;o<n.length;o+=d){let a=o+d;o>n.length&&(a=n.length),r.push(n.slice(o,a))}let s={};return this.foreach(r,(o,a)=>this.transport.send(u,p,a===0?I:a+1===r.length?D:S,0,o,[g,y]).then(h=>s=h)).then(()=>{const o=s.slice(-2),a=o[0]*256+o[1];let h=null;if(s.length>2&&(h=s.slice(0,s.length-2)),a===27014)throw new E;return{signature:h,return_code:a}})}};export{R as default};
